(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function E_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ey={exports:{}},Jf={},_y={exports:{}},et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dc=Symbol.for("react.element"),__=Symbol.for("react.portal"),N_=Symbol.for("react.fragment"),A_=Symbol.for("react.strict_mode"),b_=Symbol.for("react.profiler"),T_=Symbol.for("react.provider"),C_=Symbol.for("react.context"),F_=Symbol.for("react.forward_ref"),R_=Symbol.for("react.suspense"),I_=Symbol.for("react.memo"),D_=Symbol.for("react.lazy"),Nx=Symbol.iterator;function O_(e){return e===null||typeof e!="object"?null:(e=Nx&&e[Nx]||e["@@iterator"],typeof e=="function"?e:null)}var Ny={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ay=Object.assign,by={};function wl(e,t,r){this.props=e,this.context=t,this.refs=by,this.updater=r||Ny}wl.prototype.isReactComponent={};wl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};wl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ty(){}Ty.prototype=wl.prototype;function km(e,t,r){this.props=e,this.context=t,this.refs=by,this.updater=r||Ny}var Em=km.prototype=new Ty;Em.constructor=km;Ay(Em,wl.prototype);Em.isPureReactComponent=!0;var Ax=Array.isArray,Cy=Object.prototype.hasOwnProperty,_m={current:null},Fy={key:!0,ref:!0,__self:!0,__source:!0};function Ry(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Cy.call(t,n)&&!Fy.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];a.children=o}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:dc,type:e,key:s,ref:i,props:a,_owner:_m.current}}function L_(e,t){return{$$typeof:dc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Nm(e){return typeof e=="object"&&e!==null&&e.$$typeof===dc}function P_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var bx=/\/+/g;function Y0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?P_(""+e.key):t.toString(36)}function Tu(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case dc:case __:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Y0(i,0):n,Ax(a)?(r="",e!=null&&(r=e.replace(bx,"$&/")+"/"),Tu(a,t,r,"",function(c){return c})):a!=null&&(Nm(a)&&(a=L_(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(bx,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",Ax(e))for(var l=0;l<e.length;l++){s=e[l];var o=n+Y0(s,l);i+=Tu(s,t,r,o,a)}else if(o=O_(e),typeof o=="function")for(e=o.call(e),l=0;!(s=e.next()).done;)s=s.value,o=n+Y0(s,l++),i+=Tu(s,t,r,o,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Wc(e,t,r){if(e==null)return e;var n=[],a=0;return Tu(e,n,"","",function(s){return t.call(r,s,a++)}),n}function j_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zr={current:null},Cu={transition:null},M_={ReactCurrentDispatcher:zr,ReactCurrentBatchConfig:Cu,ReactCurrentOwner:_m};function Iy(){throw Error("act(...) is not supported in production builds of React.")}et.Children={map:Wc,forEach:function(e,t,r){Wc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Wc(e,function(){t++}),t},toArray:function(e){return Wc(e,function(t){return t})||[]},only:function(e){if(!Nm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};et.Component=wl;et.Fragment=N_;et.Profiler=b_;et.PureComponent=km;et.StrictMode=A_;et.Suspense=R_;et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M_;et.act=Iy;et.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ay({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=_m.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(o in t)Cy.call(t,o)&&!Fy.hasOwnProperty(o)&&(n[o]=t[o]===void 0&&l!==void 0?l[o]:t[o])}var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){l=Array(o);for(var c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}return{$$typeof:dc,type:e.type,key:a,ref:s,props:n,_owner:i}};et.createContext=function(e){return e={$$typeof:C_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:T_,_context:e},e.Consumer=e};et.createElement=Ry;et.createFactory=function(e){var t=Ry.bind(null,e);return t.type=e,t};et.createRef=function(){return{current:null}};et.forwardRef=function(e){return{$$typeof:F_,render:e}};et.isValidElement=Nm;et.lazy=function(e){return{$$typeof:D_,_payload:{_status:-1,_result:e},_init:j_}};et.memo=function(e,t){return{$$typeof:I_,type:e,compare:t===void 0?null:t}};et.startTransition=function(e){var t=Cu.transition;Cu.transition={};try{e()}finally{Cu.transition=t}};et.unstable_act=Iy;et.useCallback=function(e,t){return zr.current.useCallback(e,t)};et.useContext=function(e){return zr.current.useContext(e)};et.useDebugValue=function(){};et.useDeferredValue=function(e){return zr.current.useDeferredValue(e)};et.useEffect=function(e,t){return zr.current.useEffect(e,t)};et.useId=function(){return zr.current.useId()};et.useImperativeHandle=function(e,t,r){return zr.current.useImperativeHandle(e,t,r)};et.useInsertionEffect=function(e,t){return zr.current.useInsertionEffect(e,t)};et.useLayoutEffect=function(e,t){return zr.current.useLayoutEffect(e,t)};et.useMemo=function(e,t){return zr.current.useMemo(e,t)};et.useReducer=function(e,t,r){return zr.current.useReducer(e,t,r)};et.useRef=function(e){return zr.current.useRef(e)};et.useState=function(e){return zr.current.useState(e)};et.useSyncExternalStore=function(e,t,r){return zr.current.useSyncExternalStore(e,t,r)};et.useTransition=function(){return zr.current.useTransition()};et.version="18.3.1";_y.exports=et;var _=_y.exports;const Mr=E_(_);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B_=_,U_=Symbol.for("react.element"),z_=Symbol.for("react.fragment"),H_=Object.prototype.hasOwnProperty,$_=B_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V_={key:!0,ref:!0,__self:!0,__source:!0};function Dy(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)H_.call(t,n)&&!V_.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:U_,type:e,key:s,ref:i,props:a,_owner:$_.current}}Jf.Fragment=z_;Jf.jsx=Dy;Jf.jsxs=Dy;Ey.exports=Jf;var f=Ey.exports,rh={},Oy={exports:{}},dn={},Ly={exports:{}},Py={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(H,L){var ee=H.length;H.push(L);e:for(;0<ee;){var te=ee-1>>>1,b=H[te];if(0<a(b,L))H[te]=L,H[ee]=b,ee=te;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var L=H[0],ee=H.pop();if(ee!==L){H[0]=ee;e:for(var te=0,b=H.length,A=b>>>1;te<A;){var O=2*(te+1)-1,P=H[O],U=O+1,q=H[U];if(0>a(P,ee))U<b&&0>a(q,P)?(H[te]=q,H[U]=ee,te=U):(H[te]=P,H[O]=ee,te=O);else if(U<b&&0>a(q,ee))H[te]=q,H[U]=ee,te=U;else break e}}return L}function a(H,L){var ee=H.sortIndex-L.sortIndex;return ee!==0?ee:H.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var o=[],c=[],u=1,d=null,h=3,p=!1,m=!1,x=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(H){for(var L=r(c);L!==null;){if(L.callback===null)n(c);else if(L.startTime<=H)n(c),L.sortIndex=L.expirationTime,t(o,L);else break;L=r(c)}}function k(H){if(x=!1,y(H),!m)if(r(o)!==null)m=!0,W(C);else{var L=r(c);L!==null&&Q(k,L.startTime-H)}}function C(H,L){m=!1,x&&(x=!1,v(N),N=-1),p=!0;var ee=h;try{for(y(L),d=r(o);d!==null&&(!(d.expirationTime>L)||H&&!D());){var te=d.callback;if(typeof te=="function"){d.callback=null,h=d.priorityLevel;var b=te(d.expirationTime<=L);L=e.unstable_now(),typeof b=="function"?d.callback=b:d===r(o)&&n(o),y(L)}else n(o);d=r(o)}if(d!==null)var A=!0;else{var O=r(c);O!==null&&Q(k,O.startTime-L),A=!1}return A}finally{d=null,h=ee,p=!1}}var E=!1,S=null,N=-1,F=5,R=-1;function D(){return!(e.unstable_now()-R<F)}function T(){if(S!==null){var H=e.unstable_now();R=H;var L=!0;try{L=S(!0,H)}finally{L?j():(E=!1,S=null)}}else E=!1}var j;if(typeof w=="function")j=function(){w(T)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,re=Z.port2;Z.port1.onmessage=T,j=function(){re.postMessage(null)}}else j=function(){g(T,0)};function W(H){S=H,E||(E=!0,j())}function Q(H,L){N=g(function(){H(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,W(C))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(o)},e.unstable_next=function(H){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var ee=h;h=L;try{return H()}finally{h=ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,L){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ee=h;h=H;try{return L()}finally{h=ee}},e.unstable_scheduleCallback=function(H,L,ee){var te=e.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?te+ee:te):ee=te,H){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=ee+b,H={id:u++,callback:L,priorityLevel:H,startTime:ee,expirationTime:b,sortIndex:-1},ee>te?(H.sortIndex=ee,t(c,H),r(o)===null&&H===r(c)&&(x?(v(N),N=-1):x=!0,Q(k,ee-te))):(H.sortIndex=b,t(o,H),m||p||(m=!0,W(C))),H},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(H){var L=h;return function(){var ee=h;h=L;try{return H.apply(this,arguments)}finally{h=ee}}}})(Py);Ly.exports=Py;var W_=Ly.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G_=_,on=W_;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jy=new Set,Ro={};function di(e,t){ll(e,t),ll(e+"Capture",t)}function ll(e,t){for(Ro[e]=t,e=0;e<t.length;e++)jy.add(t[e])}var Ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nh=Object.prototype.hasOwnProperty,Y_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tx={},Cx={};function K_(e){return nh.call(Cx,e)?!0:nh.call(Tx,e)?!1:Y_.test(e)?Cx[e]=!0:(Tx[e]=!0,!1)}function X_(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function J_(e,t,r,n){if(t===null||typeof t>"u"||X_(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Hr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){xr[e]=new Hr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];xr[t]=new Hr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){xr[e]=new Hr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){xr[e]=new Hr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){xr[e]=new Hr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){xr[e]=new Hr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){xr[e]=new Hr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){xr[e]=new Hr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){xr[e]=new Hr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Am=/[\-:]([a-z])/g;function bm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Am,bm);xr[t]=new Hr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Am,bm);xr[t]=new Hr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Am,bm);xr[t]=new Hr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){xr[e]=new Hr(e,1,!1,e.toLowerCase(),null,!1,!1)});xr.xlinkHref=new Hr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){xr[e]=new Hr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Tm(e,t,r,n){var a=xr.hasOwnProperty(t)?xr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(J_(t,r,a,n)&&(r=null),n||a===null?K_(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Va=G_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gc=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Pi=Symbol.for("react.fragment"),Cm=Symbol.for("react.strict_mode"),ah=Symbol.for("react.profiler"),My=Symbol.for("react.provider"),By=Symbol.for("react.context"),Fm=Symbol.for("react.forward_ref"),sh=Symbol.for("react.suspense"),ih=Symbol.for("react.suspense_list"),Rm=Symbol.for("react.memo"),ts=Symbol.for("react.lazy"),Uy=Symbol.for("react.offscreen"),Fx=Symbol.iterator;function Bl(e){return e===null||typeof e!="object"?null:(e=Fx&&e[Fx]||e["@@iterator"],typeof e=="function"?e:null)}var Rt=Object.assign,K0;function ro(e){if(K0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);K0=t&&t[1]||""}return`
`+K0+e}var X0=!1;function J0(e,t){if(!e||X0)return"";X0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,l=s.length-1;1<=i&&0<=l&&a[i]!==s[l];)l--;for(;1<=i&&0<=l;i--,l--)if(a[i]!==s[l]){if(i!==1||l!==1)do if(i--,l--,0>l||a[i]!==s[l]){var o=`
`+a[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}while(1<=i&&0<=l);break}}}finally{X0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ro(e):""}function q_(e){switch(e.tag){case 5:return ro(e.type);case 16:return ro("Lazy");case 13:return ro("Suspense");case 19:return ro("SuspenseList");case 0:case 2:case 15:return e=J0(e.type,!1),e;case 11:return e=J0(e.type.render,!1),e;case 1:return e=J0(e.type,!0),e;default:return""}}function lh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Pi:return"Fragment";case Li:return"Portal";case ah:return"Profiler";case Cm:return"StrictMode";case sh:return"Suspense";case ih:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case By:return(e.displayName||"Context")+".Consumer";case My:return(e._context.displayName||"Context")+".Provider";case Fm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Rm:return t=e.displayName||null,t!==null?t:lh(e.type)||"Memo";case ts:t=e._payload,e=e._init;try{return lh(e(t))}catch{}}return null}function Z_(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lh(t);case 8:return t===Cm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ws(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Q_(e){var t=zy(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Yc(e){e._valueTracker||(e._valueTracker=Q_(e))}function Hy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=zy(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function tf(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function oh(e,t){var r=t.checked;return Rt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Rx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ws(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $y(e,t){t=t.checked,t!=null&&Tm(e,"checked",t,!1)}function ch(e,t){$y(e,t);var r=ws(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?uh(e,t.type,r):t.hasOwnProperty("defaultValue")&&uh(e,t.type,ws(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ix(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function uh(e,t,r){(t!=="number"||tf(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var no=Array.isArray;function Ji(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ws(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function fh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return Rt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Dx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ke(92));if(no(r)){if(1<r.length)throw Error(ke(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ws(r)}}function Vy(e,t){var r=ws(t.value),n=ws(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Ox(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Wy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Wy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Kc,Gy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Kc=Kc||document.createElement("div"),Kc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Kc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Io(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var mo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eN=["Webkit","ms","Moz","O"];Object.keys(mo).forEach(function(e){eN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),mo[t]=mo[e]})});function Yy(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||mo.hasOwnProperty(e)&&mo[e]?(""+t).trim():t+"px"}function Ky(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Yy(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var tN=Rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hh(e,t){if(t){if(tN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function mh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ph=null;function Im(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xh=null,qi=null,Zi=null;function Lx(e){if(e=pc(e)){if(typeof xh!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=t0(t),xh(e.stateNode,e.type,t))}}function Xy(e){qi?Zi?Zi.push(e):Zi=[e]:qi=e}function Jy(){if(qi){var e=qi,t=Zi;if(Zi=qi=null,Lx(e),t)for(e=0;e<t.length;e++)Lx(t[e])}}function qy(e,t){return e(t)}function Zy(){}var q0=!1;function Qy(e,t,r){if(q0)return e(t,r);q0=!0;try{return qy(e,t,r)}finally{q0=!1,(qi!==null||Zi!==null)&&(Zy(),Jy())}}function Do(e,t){var r=e.stateNode;if(r===null)return null;var n=t0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ke(231,t,typeof r));return r}var gh=!1;if(Ma)try{var Ul={};Object.defineProperty(Ul,"passive",{get:function(){gh=!0}}),window.addEventListener("test",Ul,Ul),window.removeEventListener("test",Ul,Ul)}catch{gh=!1}function rN(e,t,r,n,a,s,i,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var po=!1,rf=null,nf=!1,vh=null,nN={onError:function(e){po=!0,rf=e}};function aN(e,t,r,n,a,s,i,l,o){po=!1,rf=null,rN.apply(nN,arguments)}function sN(e,t,r,n,a,s,i,l,o){if(aN.apply(this,arguments),po){if(po){var c=rf;po=!1,rf=null}else throw Error(ke(198));nf||(nf=!0,vh=c)}}function hi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function e2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Px(e){if(hi(e)!==e)throw Error(ke(188))}function iN(e){var t=e.alternate;if(!t){if(t=hi(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Px(a),e;if(s===n)return Px(a),t;s=s.sibling}throw Error(ke(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,l=a.child;l;){if(l===r){i=!0,r=a,n=s;break}if(l===n){i=!0,n=a,r=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===r){i=!0,r=s,n=a;break}if(l===n){i=!0,n=s,r=a;break}l=l.sibling}if(!i)throw Error(ke(189))}}if(r.alternate!==n)throw Error(ke(190))}if(r.tag!==3)throw Error(ke(188));return r.stateNode.current===r?e:t}function t2(e){return e=iN(e),e!==null?r2(e):null}function r2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=r2(e);if(t!==null)return t;e=e.sibling}return null}var n2=on.unstable_scheduleCallback,jx=on.unstable_cancelCallback,lN=on.unstable_shouldYield,oN=on.unstable_requestPaint,Ht=on.unstable_now,cN=on.unstable_getCurrentPriorityLevel,Dm=on.unstable_ImmediatePriority,a2=on.unstable_UserBlockingPriority,af=on.unstable_NormalPriority,uN=on.unstable_LowPriority,s2=on.unstable_IdlePriority,qf=null,ma=null;function fN(e){if(ma&&typeof ma.onCommitFiberRoot=="function")try{ma.onCommitFiberRoot(qf,e,void 0,(e.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:mN,dN=Math.log,hN=Math.LN2;function mN(e){return e>>>=0,e===0?32:31-(dN(e)/hN|0)|0}var Xc=64,Jc=4194304;function ao(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function sf(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~a;l!==0?n=ao(l):(s&=i,s!==0&&(n=ao(s)))}else i=r&~a,i!==0?n=ao(i):s!==0&&(n=ao(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Yn(t),a=1<<r,n|=e[r],t&=~a;return n}function pN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xN(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Yn(s),l=1<<i,o=a[i];o===-1?(!(l&r)||l&n)&&(a[i]=pN(l,t)):o<=t&&(e.expiredLanes|=l),s&=~l}}function yh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function i2(){var e=Xc;return Xc<<=1,!(Xc&4194240)&&(Xc=64),e}function Z0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function hc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yn(t),e[t]=r}function gN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Yn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Om(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Yn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var dt=0;function l2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var o2,Lm,c2,u2,f2,wh=!1,qc=[],fs=null,ds=null,hs=null,Oo=new Map,Lo=new Map,ns=[],vN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mx(e,t){switch(e){case"focusin":case"focusout":fs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":hs=null;break;case"pointerover":case"pointerout":Oo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lo.delete(t.pointerId)}}function zl(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=pc(t),t!==null&&Lm(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function yN(e,t,r,n,a){switch(t){case"focusin":return fs=zl(fs,e,t,r,n,a),!0;case"dragenter":return ds=zl(ds,e,t,r,n,a),!0;case"mouseover":return hs=zl(hs,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Oo.set(s,zl(Oo.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Lo.set(s,zl(Lo.get(s)||null,e,t,r,n,a)),!0}return!1}function d2(e){var t=Ms(e.target);if(t!==null){var r=hi(t);if(r!==null){if(t=r.tag,t===13){if(t=e2(r),t!==null){e.blockedOn=t,f2(e.priority,function(){c2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Sh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);ph=n,r.target.dispatchEvent(n),ph=null}else return t=pc(r),t!==null&&Lm(t),e.blockedOn=r,!1;t.shift()}return!0}function Bx(e,t,r){Fu(e)&&r.delete(t)}function wN(){wh=!1,fs!==null&&Fu(fs)&&(fs=null),ds!==null&&Fu(ds)&&(ds=null),hs!==null&&Fu(hs)&&(hs=null),Oo.forEach(Bx),Lo.forEach(Bx)}function Hl(e,t){e.blockedOn===t&&(e.blockedOn=null,wh||(wh=!0,on.unstable_scheduleCallback(on.unstable_NormalPriority,wN)))}function Po(e){function t(a){return Hl(a,e)}if(0<qc.length){Hl(qc[0],e);for(var r=1;r<qc.length;r++){var n=qc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(fs!==null&&Hl(fs,e),ds!==null&&Hl(ds,e),hs!==null&&Hl(hs,e),Oo.forEach(t),Lo.forEach(t),r=0;r<ns.length;r++)n=ns[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ns.length&&(r=ns[0],r.blockedOn===null);)d2(r),r.blockedOn===null&&ns.shift()}var Qi=Va.ReactCurrentBatchConfig,lf=!0;function SN(e,t,r,n){var a=dt,s=Qi.transition;Qi.transition=null;try{dt=1,Pm(e,t,r,n)}finally{dt=a,Qi.transition=s}}function kN(e,t,r,n){var a=dt,s=Qi.transition;Qi.transition=null;try{dt=4,Pm(e,t,r,n)}finally{dt=a,Qi.transition=s}}function Pm(e,t,r,n){if(lf){var a=Sh(e,t,r,n);if(a===null)od(e,t,n,of,r),Mx(e,n);else if(yN(a,e,t,r,n))n.stopPropagation();else if(Mx(e,n),t&4&&-1<vN.indexOf(e)){for(;a!==null;){var s=pc(a);if(s!==null&&o2(s),s=Sh(e,t,r,n),s===null&&od(e,t,n,of,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else od(e,t,n,null,r)}}var of=null;function Sh(e,t,r,n){if(of=null,e=Im(n),e=Ms(e),e!==null)if(t=hi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=e2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return of=e,null}function h2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cN()){case Dm:return 1;case a2:return 4;case af:case uN:return 16;case s2:return 536870912;default:return 16}default:return 16}}var ss=null,jm=null,Ru=null;function m2(){if(Ru)return Ru;var e,t=jm,r=t.length,n,a="value"in ss?ss.value:ss.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Ru=a.slice(e,1<n?1-n:void 0)}function Iu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zc(){return!0}function Ux(){return!1}function hn(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Zc:Ux,this.isPropagationStopped=Ux,this}return Rt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Zc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Zc)},persist:function(){},isPersistent:Zc}),t}var Sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mm=hn(Sl),mc=Rt({},Sl,{view:0,detail:0}),EN=hn(mc),Q0,ed,$l,Zf=Rt({},mc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$l&&($l&&e.type==="mousemove"?(Q0=e.screenX-$l.screenX,ed=e.screenY-$l.screenY):ed=Q0=0,$l=e),Q0)},movementY:function(e){return"movementY"in e?e.movementY:ed}}),zx=hn(Zf),_N=Rt({},Zf,{dataTransfer:0}),NN=hn(_N),AN=Rt({},mc,{relatedTarget:0}),td=hn(AN),bN=Rt({},Sl,{animationName:0,elapsedTime:0,pseudoElement:0}),TN=hn(bN),CN=Rt({},Sl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),FN=hn(CN),RN=Rt({},Sl,{data:0}),Hx=hn(RN),IN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ON={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LN(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ON[e])?!!t[e]:!1}function Bm(){return LN}var PN=Rt({},mc,{key:function(e){if(e.key){var t=IN[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Iu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?DN[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bm,charCode:function(e){return e.type==="keypress"?Iu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Iu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jN=hn(PN),MN=Rt({},Zf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$x=hn(MN),BN=Rt({},mc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bm}),UN=hn(BN),zN=Rt({},Sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),HN=hn(zN),$N=Rt({},Zf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),VN=hn($N),WN=[9,13,27,32],Um=Ma&&"CompositionEvent"in window,xo=null;Ma&&"documentMode"in document&&(xo=document.documentMode);var GN=Ma&&"TextEvent"in window&&!xo,p2=Ma&&(!Um||xo&&8<xo&&11>=xo),Vx=" ",Wx=!1;function x2(e,t){switch(e){case"keyup":return WN.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ji=!1;function YN(e,t){switch(e){case"compositionend":return g2(t);case"keypress":return t.which!==32?null:(Wx=!0,Vx);case"textInput":return e=t.data,e===Vx&&Wx?null:e;default:return null}}function KN(e,t){if(ji)return e==="compositionend"||!Um&&x2(e,t)?(e=m2(),Ru=jm=ss=null,ji=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return p2&&t.locale!=="ko"?null:t.data;default:return null}}var XN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!XN[e.type]:t==="textarea"}function v2(e,t,r,n){Xy(n),t=cf(t,"onChange"),0<t.length&&(r=new Mm("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var go=null,jo=null;function JN(e){C2(e,0)}function Qf(e){var t=Ui(e);if(Hy(t))return e}function qN(e,t){if(e==="change")return t}var y2=!1;if(Ma){var rd;if(Ma){var nd="oninput"in document;if(!nd){var Yx=document.createElement("div");Yx.setAttribute("oninput","return;"),nd=typeof Yx.oninput=="function"}rd=nd}else rd=!1;y2=rd&&(!document.documentMode||9<document.documentMode)}function Kx(){go&&(go.detachEvent("onpropertychange",w2),jo=go=null)}function w2(e){if(e.propertyName==="value"&&Qf(jo)){var t=[];v2(t,jo,e,Im(e)),Qy(JN,t)}}function ZN(e,t,r){e==="focusin"?(Kx(),go=t,jo=r,go.attachEvent("onpropertychange",w2)):e==="focusout"&&Kx()}function QN(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Qf(jo)}function eA(e,t){if(e==="click")return Qf(t)}function tA(e,t){if(e==="input"||e==="change")return Qf(t)}function rA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qn=typeof Object.is=="function"?Object.is:rA;function Mo(e,t){if(qn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!nh.call(t,a)||!qn(e[a],t[a]))return!1}return!0}function Xx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jx(e,t){var r=Xx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Xx(r)}}function S2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?S2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function k2(){for(var e=window,t=tf();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=tf(e.document)}return t}function zm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function nA(e){var t=k2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&S2(r.ownerDocument.documentElement,r)){if(n!==null&&zm(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Jx(r,s);var i=Jx(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var aA=Ma&&"documentMode"in document&&11>=document.documentMode,Mi=null,kh=null,vo=null,Eh=!1;function qx(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Eh||Mi==null||Mi!==tf(n)||(n=Mi,"selectionStart"in n&&zm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),vo&&Mo(vo,n)||(vo=n,n=cf(kh,"onSelect"),0<n.length&&(t=new Mm("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Mi)))}function Qc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Bi={animationend:Qc("Animation","AnimationEnd"),animationiteration:Qc("Animation","AnimationIteration"),animationstart:Qc("Animation","AnimationStart"),transitionend:Qc("Transition","TransitionEnd")},ad={},E2={};Ma&&(E2=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function e0(e){if(ad[e])return ad[e];if(!Bi[e])return e;var t=Bi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in E2)return ad[e]=t[r];return e}var _2=e0("animationend"),N2=e0("animationiteration"),A2=e0("animationstart"),b2=e0("transitionend"),T2=new Map,Zx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(e,t){T2.set(e,t),di(t,[e])}for(var sd=0;sd<Zx.length;sd++){var id=Zx[sd],sA=id.toLowerCase(),iA=id[0].toUpperCase()+id.slice(1);As(sA,"on"+iA)}As(_2,"onAnimationEnd");As(N2,"onAnimationIteration");As(A2,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(b2,"onTransitionEnd");ll("onMouseEnter",["mouseout","mouseover"]);ll("onMouseLeave",["mouseout","mouseover"]);ll("onPointerEnter",["pointerout","pointerover"]);ll("onPointerLeave",["pointerout","pointerover"]);di("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));di("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));di("onBeforeInput",["compositionend","keypress","textInput","paste"]);di("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));di("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));di("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var so="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lA=new Set("cancel close invalid load scroll toggle".split(" ").concat(so));function Qx(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,sN(n,t,void 0,e),e.currentTarget=null}function C2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==s&&a.isPropagationStopped())break e;Qx(a,l,c),s=o}else for(i=0;i<n.length;i++){if(l=n[i],o=l.instance,c=l.currentTarget,l=l.listener,o!==s&&a.isPropagationStopped())break e;Qx(a,l,c),s=o}}}if(nf)throw e=vh,nf=!1,vh=null,e}function gt(e,t){var r=t[Th];r===void 0&&(r=t[Th]=new Set);var n=e+"__bubble";r.has(n)||(F2(t,e,2,!1),r.add(n))}function ld(e,t,r){var n=0;t&&(n|=4),F2(r,e,n,t)}var eu="_reactListening"+Math.random().toString(36).slice(2);function Bo(e){if(!e[eu]){e[eu]=!0,jy.forEach(function(r){r!=="selectionchange"&&(lA.has(r)||ld(r,!1,e),ld(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[eu]||(t[eu]=!0,ld("selectionchange",!1,t))}}function F2(e,t,r,n){switch(h2(t)){case 1:var a=SN;break;case 4:a=kN;break;default:a=Pm}r=a.bind(null,t,r,e),a=void 0,!gh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function od(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var o=i.tag;if((o===3||o===4)&&(o=i.stateNode.containerInfo,o===a||o.nodeType===8&&o.parentNode===a))return;i=i.return}for(;l!==null;){if(i=Ms(l),i===null)return;if(o=i.tag,o===5||o===6){n=s=i;continue e}l=l.parentNode}}n=n.return}Qy(function(){var c=s,u=Im(r),d=[];e:{var h=T2.get(e);if(h!==void 0){var p=Mm,m=e;switch(e){case"keypress":if(Iu(r)===0)break e;case"keydown":case"keyup":p=jN;break;case"focusin":m="focus",p=td;break;case"focusout":m="blur",p=td;break;case"beforeblur":case"afterblur":p=td;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=zx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=NN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=UN;break;case _2:case N2:case A2:p=TN;break;case b2:p=HN;break;case"scroll":p=EN;break;case"wheel":p=VN;break;case"copy":case"cut":case"paste":p=FN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=$x}var x=(t&4)!==0,g=!x&&e==="scroll",v=x?h!==null?h+"Capture":null:h;x=[];for(var w=c,y;w!==null;){y=w;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,v!==null&&(k=Do(w,v),k!=null&&x.push(Uo(w,k,y)))),g)break;w=w.return}0<x.length&&(h=new p(h,m,null,r,u),d.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==ph&&(m=r.relatedTarget||r.fromElement)&&(Ms(m)||m[Ba]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=c,m=m?Ms(m):null,m!==null&&(g=hi(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(x=zx,k="onMouseLeave",v="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(x=$x,k="onPointerLeave",v="onPointerEnter",w="pointer"),g=p==null?h:Ui(p),y=m==null?h:Ui(m),h=new x(k,w+"leave",p,r,u),h.target=g,h.relatedTarget=y,k=null,Ms(u)===c&&(x=new x(v,w+"enter",m,r,u),x.target=y,x.relatedTarget=g,k=x),g=k,p&&m)t:{for(x=p,v=m,w=0,y=x;y;y=_i(y))w++;for(y=0,k=v;k;k=_i(k))y++;for(;0<w-y;)x=_i(x),w--;for(;0<y-w;)v=_i(v),y--;for(;w--;){if(x===v||v!==null&&x===v.alternate)break t;x=_i(x),v=_i(v)}x=null}else x=null;p!==null&&e1(d,h,p,x,!1),m!==null&&g!==null&&e1(d,g,m,x,!0)}}e:{if(h=c?Ui(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var C=qN;else if(Gx(h))if(y2)C=tA;else{C=QN;var E=ZN}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=eA);if(C&&(C=C(e,c))){v2(d,C,r,u);break e}E&&E(e,h,c),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&uh(h,"number",h.value)}switch(E=c?Ui(c):window,e){case"focusin":(Gx(E)||E.contentEditable==="true")&&(Mi=E,kh=c,vo=null);break;case"focusout":vo=kh=Mi=null;break;case"mousedown":Eh=!0;break;case"contextmenu":case"mouseup":case"dragend":Eh=!1,qx(d,r,u);break;case"selectionchange":if(aA)break;case"keydown":case"keyup":qx(d,r,u)}var S;if(Um)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else ji?x2(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(p2&&r.locale!=="ko"&&(ji||N!=="onCompositionStart"?N==="onCompositionEnd"&&ji&&(S=m2()):(ss=u,jm="value"in ss?ss.value:ss.textContent,ji=!0)),E=cf(c,N),0<E.length&&(N=new Hx(N,e,null,r,u),d.push({event:N,listeners:E}),S?N.data=S:(S=g2(r),S!==null&&(N.data=S)))),(S=GN?YN(e,r):KN(e,r))&&(c=cf(c,"onBeforeInput"),0<c.length&&(u=new Hx("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=S))}C2(d,t)})}function Uo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function cf(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Do(e,r),s!=null&&n.unshift(Uo(e,s,a)),s=Do(e,t),s!=null&&n.push(Uo(e,s,a))),e=e.return}return n}function _i(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function e1(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var l=r,o=l.alternate,c=l.stateNode;if(o!==null&&o===n)break;l.tag===5&&c!==null&&(l=c,a?(o=Do(r,s),o!=null&&i.unshift(Uo(r,o,l))):a||(o=Do(r,s),o!=null&&i.push(Uo(r,o,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var oA=/\r\n?/g,cA=/\u0000|\uFFFD/g;function t1(e){return(typeof e=="string"?e:""+e).replace(oA,`
`).replace(cA,"")}function tu(e,t,r){if(t=t1(t),t1(e)!==t&&r)throw Error(ke(425))}function uf(){}var _h=null,Nh=null;function Ah(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var bh=typeof setTimeout=="function"?setTimeout:void 0,uA=typeof clearTimeout=="function"?clearTimeout:void 0,r1=typeof Promise=="function"?Promise:void 0,fA=typeof queueMicrotask=="function"?queueMicrotask:typeof r1<"u"?function(e){return r1.resolve(null).then(e).catch(dA)}:bh;function dA(e){setTimeout(function(){throw e})}function cd(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Po(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Po(t)}function ms(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function n1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var kl=Math.random().toString(36).slice(2),fa="__reactFiber$"+kl,zo="__reactProps$"+kl,Ba="__reactContainer$"+kl,Th="__reactEvents$"+kl,hA="__reactListeners$"+kl,mA="__reactHandles$"+kl;function Ms(e){var t=e[fa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ba]||r[fa]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=n1(e);e!==null;){if(r=e[fa])return r;e=n1(e)}return t}e=r,r=e.parentNode}return null}function pc(e){return e=e[fa]||e[Ba],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ui(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function t0(e){return e[zo]||null}var Ch=[],zi=-1;function bs(e){return{current:e}}function wt(e){0>zi||(e.current=Ch[zi],Ch[zi]=null,zi--)}function xt(e,t){zi++,Ch[zi]=e.current,e.current=t}var Ss={},Fr=bs(Ss),Gr=bs(!1),Qs=Ss;function ol(e,t){var r=e.type.contextTypes;if(!r)return Ss;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Yr(e){return e=e.childContextTypes,e!=null}function ff(){wt(Gr),wt(Fr)}function a1(e,t,r){if(Fr.current!==Ss)throw Error(ke(168));xt(Fr,t),xt(Gr,r)}function R2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ke(108,Z_(e)||"Unknown",a));return Rt({},r,n)}function df(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ss,Qs=Fr.current,xt(Fr,e),xt(Gr,Gr.current),!0}function s1(e,t,r){var n=e.stateNode;if(!n)throw Error(ke(169));r?(e=R2(e,t,Qs),n.__reactInternalMemoizedMergedChildContext=e,wt(Gr),wt(Fr),xt(Fr,e)):wt(Gr),xt(Gr,r)}var ba=null,r0=!1,ud=!1;function I2(e){ba===null?ba=[e]:ba.push(e)}function pA(e){r0=!0,I2(e)}function Ts(){if(!ud&&ba!==null){ud=!0;var e=0,t=dt;try{var r=ba;for(dt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ba=null,r0=!1}catch(a){throw ba!==null&&(ba=ba.slice(e+1)),n2(Dm,Ts),a}finally{dt=t,ud=!1}}return null}var Hi=[],$i=0,hf=null,mf=0,Nn=[],An=0,ei=null,Ca=1,Fa="";function Os(e,t){Hi[$i++]=mf,Hi[$i++]=hf,hf=e,mf=t}function D2(e,t,r){Nn[An++]=Ca,Nn[An++]=Fa,Nn[An++]=ei,ei=e;var n=Ca;e=Fa;var a=32-Yn(n)-1;n&=~(1<<a),r+=1;var s=32-Yn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Ca=1<<32-Yn(t)+a|r<<a|n,Fa=s+e}else Ca=1<<s|r<<a|n,Fa=e}function Hm(e){e.return!==null&&(Os(e,1),D2(e,1,0))}function $m(e){for(;e===hf;)hf=Hi[--$i],Hi[$i]=null,mf=Hi[--$i],Hi[$i]=null;for(;e===ei;)ei=Nn[--An],Nn[An]=null,Fa=Nn[--An],Nn[An]=null,Ca=Nn[--An],Nn[An]=null}var sn=null,an=null,_t=!1,Vn=null;function O2(e,t){var r=Fn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function i1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,an=ms(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,an=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ei!==null?{id:Ca,overflow:Fa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Fn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,sn=e,an=null,!0):!1;default:return!1}}function Fh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rh(e){if(_t){var t=an;if(t){var r=t;if(!i1(e,t)){if(Fh(e))throw Error(ke(418));t=ms(r.nextSibling);var n=sn;t&&i1(e,t)?O2(n,r):(e.flags=e.flags&-4097|2,_t=!1,sn=e)}}else{if(Fh(e))throw Error(ke(418));e.flags=e.flags&-4097|2,_t=!1,sn=e}}}function l1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function ru(e){if(e!==sn)return!1;if(!_t)return l1(e),_t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ah(e.type,e.memoizedProps)),t&&(t=an)){if(Fh(e))throw L2(),Error(ke(418));for(;t;)O2(e,t),t=ms(t.nextSibling)}if(l1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){an=ms(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}an=null}}else an=sn?ms(e.stateNode.nextSibling):null;return!0}function L2(){for(var e=an;e;)e=ms(e.nextSibling)}function cl(){an=sn=null,_t=!1}function Vm(e){Vn===null?Vn=[e]:Vn.push(e)}var xA=Va.ReactCurrentBatchConfig;function Vl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ke(309));var n=r.stateNode}if(!n)throw Error(ke(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var l=a.refs;i===null?delete l[s]:l[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(ke(284));if(!r._owner)throw Error(ke(290,e))}return e}function nu(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function o1(e){var t=e._init;return t(e._payload)}function P2(e){function t(v,w){if(e){var y=v.deletions;y===null?(v.deletions=[w],v.flags|=16):y.push(w)}}function r(v,w){if(!e)return null;for(;w!==null;)t(v,w),w=w.sibling;return null}function n(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function a(v,w){return v=vs(v,w),v.index=0,v.sibling=null,v}function s(v,w,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<w?(v.flags|=2,w):y):(v.flags|=2,w)):(v.flags|=1048576,w)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,w,y,k){return w===null||w.tag!==6?(w=gd(y,v.mode,k),w.return=v,w):(w=a(w,y),w.return=v,w)}function o(v,w,y,k){var C=y.type;return C===Pi?u(v,w,y.props.children,k,y.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ts&&o1(C)===w.type)?(k=a(w,y.props),k.ref=Vl(v,w,y),k.return=v,k):(k=Bu(y.type,y.key,y.props,null,v.mode,k),k.ref=Vl(v,w,y),k.return=v,k)}function c(v,w,y,k){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=vd(y,v.mode,k),w.return=v,w):(w=a(w,y.children||[]),w.return=v,w)}function u(v,w,y,k,C){return w===null||w.tag!==7?(w=Vs(y,v.mode,k,C),w.return=v,w):(w=a(w,y),w.return=v,w)}function d(v,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=gd(""+w,v.mode,y),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Gc:return y=Bu(w.type,w.key,w.props,null,v.mode,y),y.ref=Vl(v,null,w),y.return=v,y;case Li:return w=vd(w,v.mode,y),w.return=v,w;case ts:var k=w._init;return d(v,k(w._payload),y)}if(no(w)||Bl(w))return w=Vs(w,v.mode,y,null),w.return=v,w;nu(v,w)}return null}function h(v,w,y,k){var C=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return C!==null?null:l(v,w,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Gc:return y.key===C?o(v,w,y,k):null;case Li:return y.key===C?c(v,w,y,k):null;case ts:return C=y._init,h(v,w,C(y._payload),k)}if(no(y)||Bl(y))return C!==null?null:u(v,w,y,k,null);nu(v,y)}return null}function p(v,w,y,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(y)||null,l(w,v,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Gc:return v=v.get(k.key===null?y:k.key)||null,o(w,v,k,C);case Li:return v=v.get(k.key===null?y:k.key)||null,c(w,v,k,C);case ts:var E=k._init;return p(v,w,y,E(k._payload),C)}if(no(k)||Bl(k))return v=v.get(y)||null,u(w,v,k,C,null);nu(w,k)}return null}function m(v,w,y,k){for(var C=null,E=null,S=w,N=w=0,F=null;S!==null&&N<y.length;N++){S.index>N?(F=S,S=null):F=S.sibling;var R=h(v,S,y[N],k);if(R===null){S===null&&(S=F);break}e&&S&&R.alternate===null&&t(v,S),w=s(R,w,N),E===null?C=R:E.sibling=R,E=R,S=F}if(N===y.length)return r(v,S),_t&&Os(v,N),C;if(S===null){for(;N<y.length;N++)S=d(v,y[N],k),S!==null&&(w=s(S,w,N),E===null?C=S:E.sibling=S,E=S);return _t&&Os(v,N),C}for(S=n(v,S);N<y.length;N++)F=p(S,v,N,y[N],k),F!==null&&(e&&F.alternate!==null&&S.delete(F.key===null?N:F.key),w=s(F,w,N),E===null?C=F:E.sibling=F,E=F);return e&&S.forEach(function(D){return t(v,D)}),_t&&Os(v,N),C}function x(v,w,y,k){var C=Bl(y);if(typeof C!="function")throw Error(ke(150));if(y=C.call(y),y==null)throw Error(ke(151));for(var E=C=null,S=w,N=w=0,F=null,R=y.next();S!==null&&!R.done;N++,R=y.next()){S.index>N?(F=S,S=null):F=S.sibling;var D=h(v,S,R.value,k);if(D===null){S===null&&(S=F);break}e&&S&&D.alternate===null&&t(v,S),w=s(D,w,N),E===null?C=D:E.sibling=D,E=D,S=F}if(R.done)return r(v,S),_t&&Os(v,N),C;if(S===null){for(;!R.done;N++,R=y.next())R=d(v,R.value,k),R!==null&&(w=s(R,w,N),E===null?C=R:E.sibling=R,E=R);return _t&&Os(v,N),C}for(S=n(v,S);!R.done;N++,R=y.next())R=p(S,v,N,R.value,k),R!==null&&(e&&R.alternate!==null&&S.delete(R.key===null?N:R.key),w=s(R,w,N),E===null?C=R:E.sibling=R,E=R);return e&&S.forEach(function(T){return t(v,T)}),_t&&Os(v,N),C}function g(v,w,y,k){if(typeof y=="object"&&y!==null&&y.type===Pi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Gc:e:{for(var C=y.key,E=w;E!==null;){if(E.key===C){if(C=y.type,C===Pi){if(E.tag===7){r(v,E.sibling),w=a(E,y.props.children),w.return=v,v=w;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ts&&o1(C)===E.type){r(v,E.sibling),w=a(E,y.props),w.ref=Vl(v,E,y),w.return=v,v=w;break e}r(v,E);break}else t(v,E);E=E.sibling}y.type===Pi?(w=Vs(y.props.children,v.mode,k,y.key),w.return=v,v=w):(k=Bu(y.type,y.key,y.props,null,v.mode,k),k.ref=Vl(v,w,y),k.return=v,v=k)}return i(v);case Li:e:{for(E=y.key;w!==null;){if(w.key===E)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(v,w.sibling),w=a(w,y.children||[]),w.return=v,v=w;break e}else{r(v,w);break}else t(v,w);w=w.sibling}w=vd(y,v.mode,k),w.return=v,v=w}return i(v);case ts:return E=y._init,g(v,w,E(y._payload),k)}if(no(y))return m(v,w,y,k);if(Bl(y))return x(v,w,y,k);nu(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(v,w.sibling),w=a(w,y),w.return=v,v=w):(r(v,w),w=gd(y,v.mode,k),w.return=v,v=w),i(v)):r(v,w)}return g}var ul=P2(!0),j2=P2(!1),pf=bs(null),xf=null,Vi=null,Wm=null;function Gm(){Wm=Vi=xf=null}function Ym(e){var t=pf.current;wt(pf),e._currentValue=t}function Ih(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function el(e,t){xf=e,Wm=Vi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wr=!0),e.firstContext=null)}function Ln(e){var t=e._currentValue;if(Wm!==e)if(e={context:e,memoizedValue:t,next:null},Vi===null){if(xf===null)throw Error(ke(308));Vi=e,xf.dependencies={lanes:0,firstContext:e}}else Vi=Vi.next=e;return t}var Bs=null;function Km(e){Bs===null?Bs=[e]:Bs.push(e)}function M2(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Km(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ua(e,n)}function Ua(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var rs=!1;function Xm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function B2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Da(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ps(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,at&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ua(e,r)}return a=n.interleaved,a===null?(t.next=t,Km(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ua(e,r)}function Du(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Om(e,r)}}function c1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function gf(e,t,r,n){var a=e.updateQueue;rs=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var o=l,c=o.next;o.next=null,i===null?s=c:i.next=c,i=o;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=c:l.next=c,u.lastBaseUpdate=o))}if(s!==null){var d=a.baseState;i=0,u=c=o=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,x=l;switch(h=t,p=r,x.tag){case 1:if(m=x.payload,typeof m=="function"){d=m.call(p,d,h);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=x.payload,h=typeof m=="function"?m.call(p,d,h):m,h==null)break e;d=Rt({},d,h);break e;case 2:rs=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(c=u=p,o=d):u=u.next=p,i|=h;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;h=l,l=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(u===null&&(o=d),a.baseState=o,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);ri|=i,e.lanes=i,e.memoizedState=d}}function u1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ke(191,a));a.call(n)}}}var xc={},pa=bs(xc),Ho=bs(xc),$o=bs(xc);function Us(e){if(e===xc)throw Error(ke(174));return e}function Jm(e,t){switch(xt($o,t),xt(Ho,e),xt(pa,xc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dh(t,e)}wt(pa),xt(pa,t)}function fl(){wt(pa),wt(Ho),wt($o)}function U2(e){Us($o.current);var t=Us(pa.current),r=dh(t,e.type);t!==r&&(xt(Ho,e),xt(pa,r))}function qm(e){Ho.current===e&&(wt(pa),wt(Ho))}var Tt=bs(0);function vf(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fd=[];function Zm(){for(var e=0;e<fd.length;e++)fd[e]._workInProgressVersionPrimary=null;fd.length=0}var Ou=Va.ReactCurrentDispatcher,dd=Va.ReactCurrentBatchConfig,ti=0,Ft=null,Jt=null,sr=null,yf=!1,yo=!1,Vo=0,gA=0;function yr(){throw Error(ke(321))}function Qm(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!qn(e[r],t[r]))return!1;return!0}function ep(e,t,r,n,a,s){if(ti=s,Ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ou.current=e===null||e.memoizedState===null?SA:kA,e=r(n,a),yo){s=0;do{if(yo=!1,Vo=0,25<=s)throw Error(ke(301));s+=1,sr=Jt=null,t.updateQueue=null,Ou.current=EA,e=r(n,a)}while(yo)}if(Ou.current=wf,t=Jt!==null&&Jt.next!==null,ti=0,sr=Jt=Ft=null,yf=!1,t)throw Error(ke(300));return e}function tp(){var e=Vo!==0;return Vo=0,e}function oa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sr===null?Ft.memoizedState=sr=e:sr=sr.next=e,sr}function Pn(){if(Jt===null){var e=Ft.alternate;e=e!==null?e.memoizedState:null}else e=Jt.next;var t=sr===null?Ft.memoizedState:sr.next;if(t!==null)sr=t,Jt=e;else{if(e===null)throw Error(ke(310));Jt=e,e={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},sr===null?Ft.memoizedState=sr=e:sr=sr.next=e}return sr}function Wo(e,t){return typeof t=="function"?t(e):t}function hd(e){var t=Pn(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=Jt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=i=null,o=null,c=s;do{var u=c.lane;if((ti&u)===u)o!==null&&(o=o.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};o===null?(l=o=d,i=n):o=o.next=d,Ft.lanes|=u,ri|=u}c=c.next}while(c!==null&&c!==s);o===null?i=n:o.next=l,qn(n,t.memoizedState)||(Wr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=o,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Ft.lanes|=s,ri|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function md(e){var t=Pn(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);qn(s,t.memoizedState)||(Wr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function z2(){}function H2(e,t){var r=Ft,n=Pn(),a=t(),s=!qn(n.memoizedState,a);if(s&&(n.memoizedState=a,Wr=!0),n=n.queue,rp(W2.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||sr!==null&&sr.memoizedState.tag&1){if(r.flags|=2048,Go(9,V2.bind(null,r,n,a,t),void 0,null),cr===null)throw Error(ke(349));ti&30||$2(r,t,a)}return a}function $2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ft.updateQueue,t===null?(t={lastEffect:null,stores:null},Ft.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function V2(e,t,r,n){t.value=r,t.getSnapshot=n,G2(t)&&Y2(e)}function W2(e,t,r){return r(function(){G2(t)&&Y2(e)})}function G2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!qn(e,r)}catch{return!0}}function Y2(e){var t=Ua(e,1);t!==null&&Kn(t,e,1,-1)}function f1(e){var t=oa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wo,lastRenderedState:e},t.queue=e,e=e.dispatch=wA.bind(null,Ft,e),[t.memoizedState,e]}function Go(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ft.updateQueue,t===null?(t={lastEffect:null,stores:null},Ft.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function K2(){return Pn().memoizedState}function Lu(e,t,r,n){var a=oa();Ft.flags|=e,a.memoizedState=Go(1|t,r,void 0,n===void 0?null:n)}function n0(e,t,r,n){var a=Pn();n=n===void 0?null:n;var s=void 0;if(Jt!==null){var i=Jt.memoizedState;if(s=i.destroy,n!==null&&Qm(n,i.deps)){a.memoizedState=Go(t,r,s,n);return}}Ft.flags|=e,a.memoizedState=Go(1|t,r,s,n)}function d1(e,t){return Lu(8390656,8,e,t)}function rp(e,t){return n0(2048,8,e,t)}function X2(e,t){return n0(4,2,e,t)}function J2(e,t){return n0(4,4,e,t)}function q2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Z2(e,t,r){return r=r!=null?r.concat([e]):null,n0(4,4,q2.bind(null,t,e),r)}function np(){}function Q2(e,t){var r=Pn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Qm(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ew(e,t){var r=Pn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Qm(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function tw(e,t,r){return ti&21?(qn(r,t)||(r=i2(),Ft.lanes|=r,ri|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wr=!0),e.memoizedState=r)}function vA(e,t){var r=dt;dt=r!==0&&4>r?r:4,e(!0);var n=dd.transition;dd.transition={};try{e(!1),t()}finally{dt=r,dd.transition=n}}function rw(){return Pn().memoizedState}function yA(e,t,r){var n=gs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},nw(e))aw(t,r);else if(r=M2(e,t,r,n),r!==null){var a=Br();Kn(r,e,n,a),sw(r,t,n)}}function wA(e,t,r){var n=gs(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(nw(e))aw(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,l=s(i,r);if(a.hasEagerState=!0,a.eagerState=l,qn(l,i)){var o=t.interleaved;o===null?(a.next=a,Km(t)):(a.next=o.next,o.next=a),t.interleaved=a;return}}catch{}finally{}r=M2(e,t,a,n),r!==null&&(a=Br(),Kn(r,e,n,a),sw(r,t,n))}}function nw(e){var t=e.alternate;return e===Ft||t!==null&&t===Ft}function aw(e,t){yo=yf=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function sw(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Om(e,r)}}var wf={readContext:Ln,useCallback:yr,useContext:yr,useEffect:yr,useImperativeHandle:yr,useInsertionEffect:yr,useLayoutEffect:yr,useMemo:yr,useReducer:yr,useRef:yr,useState:yr,useDebugValue:yr,useDeferredValue:yr,useTransition:yr,useMutableSource:yr,useSyncExternalStore:yr,useId:yr,unstable_isNewReconciler:!1},SA={readContext:Ln,useCallback:function(e,t){return oa().memoizedState=[e,t===void 0?null:t],e},useContext:Ln,useEffect:d1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Lu(4194308,4,q2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Lu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lu(4,2,e,t)},useMemo:function(e,t){var r=oa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=oa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=yA.bind(null,Ft,e),[n.memoizedState,e]},useRef:function(e){var t=oa();return e={current:e},t.memoizedState=e},useState:f1,useDebugValue:np,useDeferredValue:function(e){return oa().memoizedState=e},useTransition:function(){var e=f1(!1),t=e[0];return e=vA.bind(null,e[1]),oa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ft,a=oa();if(_t){if(r===void 0)throw Error(ke(407));r=r()}else{if(r=t(),cr===null)throw Error(ke(349));ti&30||$2(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,d1(W2.bind(null,n,s,e),[e]),n.flags|=2048,Go(9,V2.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=oa(),t=cr.identifierPrefix;if(_t){var r=Fa,n=Ca;r=(n&~(1<<32-Yn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Vo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=gA++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},kA={readContext:Ln,useCallback:Q2,useContext:Ln,useEffect:rp,useImperativeHandle:Z2,useInsertionEffect:X2,useLayoutEffect:J2,useMemo:ew,useReducer:hd,useRef:K2,useState:function(){return hd(Wo)},useDebugValue:np,useDeferredValue:function(e){var t=Pn();return tw(t,Jt.memoizedState,e)},useTransition:function(){var e=hd(Wo)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:z2,useSyncExternalStore:H2,useId:rw,unstable_isNewReconciler:!1},EA={readContext:Ln,useCallback:Q2,useContext:Ln,useEffect:rp,useImperativeHandle:Z2,useInsertionEffect:X2,useLayoutEffect:J2,useMemo:ew,useReducer:md,useRef:K2,useState:function(){return md(Wo)},useDebugValue:np,useDeferredValue:function(e){var t=Pn();return Jt===null?t.memoizedState=e:tw(t,Jt.memoizedState,e)},useTransition:function(){var e=md(Wo)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:z2,useSyncExternalStore:H2,useId:rw,unstable_isNewReconciler:!1};function Hn(e,t){if(e&&e.defaultProps){t=Rt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Dh(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Rt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var a0={isMounted:function(e){return(e=e._reactInternals)?hi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Br(),a=gs(e),s=Da(n,a);s.payload=t,r!=null&&(s.callback=r),t=ps(e,s,a),t!==null&&(Kn(t,e,a,n),Du(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Br(),a=gs(e),s=Da(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ps(e,s,a),t!==null&&(Kn(t,e,a,n),Du(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Br(),n=gs(e),a=Da(r,n);a.tag=2,t!=null&&(a.callback=t),t=ps(e,a,n),t!==null&&(Kn(t,e,n,r),Du(t,e,n))}};function h1(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Mo(r,n)||!Mo(a,s):!0}function iw(e,t,r){var n=!1,a=Ss,s=t.contextType;return typeof s=="object"&&s!==null?s=Ln(s):(a=Yr(t)?Qs:Fr.current,n=t.contextTypes,s=(n=n!=null)?ol(e,a):Ss),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=a0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function m1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&a0.enqueueReplaceState(t,t.state,null)}function Oh(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Xm(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Ln(s):(s=Yr(t)?Qs:Fr.current,a.context=ol(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Dh(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&a0.enqueueReplaceState(a,a.state,null),gf(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function dl(e,t){try{var r="",n=t;do r+=q_(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function pd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Lh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var _A=typeof WeakMap=="function"?WeakMap:Map;function lw(e,t,r){r=Da(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){kf||(kf=!0,Wh=n),Lh(e,t)},r}function ow(e,t,r){r=Da(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Lh(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Lh(e,t),typeof n!="function"&&(xs===null?xs=new Set([this]):xs.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function p1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new _A;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=MA.bind(null,e,t,r),t.then(e,e))}function x1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function g1(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Da(-1,1),t.tag=2,ps(r,t,1))),r.lanes|=1),e)}var NA=Va.ReactCurrentOwner,Wr=!1;function Lr(e,t,r,n){t.child=e===null?j2(t,null,r,n):ul(t,e.child,r,n)}function v1(e,t,r,n,a){r=r.render;var s=t.ref;return el(t,a),n=ep(e,t,r,n,s,a),r=tp(),e!==null&&!Wr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,za(e,t,a)):(_t&&r&&Hm(t),t.flags|=1,Lr(e,t,n,a),t.child)}function y1(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!fp(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,cw(e,t,s,n,a)):(e=Bu(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Mo,r(i,n)&&e.ref===t.ref)return za(e,t,a)}return t.flags|=1,e=vs(s,n),e.ref=t.ref,e.return=t,t.child=e}function cw(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Mo(s,n)&&e.ref===t.ref)if(Wr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Wr=!0);else return t.lanes=e.lanes,za(e,t,a)}return Ph(e,t,r,n,a)}function uw(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(Gi,en),en|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xt(Gi,en),en|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,xt(Gi,en),en|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,xt(Gi,en),en|=n;return Lr(e,t,a,r),t.child}function fw(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ph(e,t,r,n,a){var s=Yr(r)?Qs:Fr.current;return s=ol(t,s),el(t,a),r=ep(e,t,r,n,s,a),n=tp(),e!==null&&!Wr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,za(e,t,a)):(_t&&n&&Hm(t),t.flags|=1,Lr(e,t,r,a),t.child)}function w1(e,t,r,n,a){if(Yr(r)){var s=!0;df(t)}else s=!1;if(el(t,a),t.stateNode===null)Pu(e,t),iw(t,r,n),Oh(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ln(c):(c=Yr(r)?Qs:Fr.current,c=ol(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==n||o!==c)&&m1(t,i,n,c),rs=!1;var h=t.memoizedState;i.state=h,gf(t,n,i,a),o=t.memoizedState,l!==n||h!==o||Gr.current||rs?(typeof u=="function"&&(Dh(t,r,u,n),o=t.memoizedState),(l=rs||h1(t,r,l,n,h,o,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),i.props=n,i.state=o,i.context=c,n=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,B2(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:Hn(t.type,l),i.props=c,d=t.pendingProps,h=i.context,o=r.contextType,typeof o=="object"&&o!==null?o=Ln(o):(o=Yr(r)?Qs:Fr.current,o=ol(t,o));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==d||h!==o)&&m1(t,i,n,o),rs=!1,h=t.memoizedState,i.state=h,gf(t,n,i,a);var m=t.memoizedState;l!==d||h!==m||Gr.current||rs?(typeof p=="function"&&(Dh(t,r,p,n),m=t.memoizedState),(c=rs||h1(t,r,c,n,h,m,o)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,m,o),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,m,o)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=o,n=c):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return jh(e,t,r,n,s,a)}function jh(e,t,r,n,a,s){fw(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&s1(t,r,!1),za(e,t,s);n=t.stateNode,NA.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=ul(t,e.child,null,s),t.child=ul(t,null,l,s)):Lr(e,t,l,s),t.memoizedState=n.state,a&&s1(t,r,!0),t.child}function dw(e){var t=e.stateNode;t.pendingContext?a1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&a1(e,t.context,!1),Jm(e,t.containerInfo)}function S1(e,t,r,n,a){return cl(),Vm(a),t.flags|=256,Lr(e,t,r,n),t.child}var Mh={dehydrated:null,treeContext:null,retryLane:0};function Bh(e){return{baseLanes:e,cachePool:null,transitions:null}}function hw(e,t,r){var n=t.pendingProps,a=Tt.current,s=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),xt(Tt,a&1),e===null)return Rh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=l0(i,n,0,null),e=Vs(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Bh(r),t.memoizedState=Mh,e):ap(t,i));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return AA(e,t,i,n,l,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,l=a.sibling;var o={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=o,t.deletions=null):(n=vs(a,o),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=vs(l,s):(s=Vs(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?Bh(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Mh,n}return s=e.child,e=s.sibling,n=vs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function ap(e,t){return t=l0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function au(e,t,r,n){return n!==null&&Vm(n),ul(t,e.child,null,r),e=ap(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function AA(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=pd(Error(ke(422))),au(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=l0({mode:"visible",children:n.children},a,0,null),s=Vs(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ul(t,e.child,null,i),t.child.memoizedState=Bh(i),t.memoizedState=Mh,s);if(!(t.mode&1))return au(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(ke(419)),n=pd(s,n,void 0),au(e,t,i,n)}if(l=(i&e.childLanes)!==0,Wr||l){if(n=cr,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Ua(e,a),Kn(n,e,a,-1))}return up(),n=pd(Error(ke(421))),au(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=BA.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,an=ms(a.nextSibling),sn=t,_t=!0,Vn=null,e!==null&&(Nn[An++]=Ca,Nn[An++]=Fa,Nn[An++]=ei,Ca=e.id,Fa=e.overflow,ei=t),t=ap(t,n.children),t.flags|=4096,t)}function k1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ih(e.return,t,r)}function xd(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function mw(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Lr(e,t,n.children,r),n=Tt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&k1(e,r,t);else if(e.tag===19)k1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(xt(Tt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&vf(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),xd(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&vf(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}xd(t,!0,r,null,s);break;case"together":xd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Pu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function za(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ri|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,r=vs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=vs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bA(e,t,r){switch(t.tag){case 3:dw(t),cl();break;case 5:U2(t);break;case 1:Yr(t.type)&&df(t);break;case 4:Jm(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;xt(pf,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(xt(Tt,Tt.current&1),t.flags|=128,null):r&t.child.childLanes?hw(e,t,r):(xt(Tt,Tt.current&1),e=za(e,t,r),e!==null?e.sibling:null);xt(Tt,Tt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return mw(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),xt(Tt,Tt.current),n)break;return null;case 22:case 23:return t.lanes=0,uw(e,t,r)}return za(e,t,r)}var pw,Uh,xw,gw;pw=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Uh=function(){};xw=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Us(pa.current);var s=null;switch(r){case"input":a=oh(e,a),n=oh(e,n),s=[];break;case"select":a=Rt({},a,{value:void 0}),n=Rt({},n,{value:void 0}),s=[];break;case"textarea":a=fh(e,a),n=fh(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=uf)}hh(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var l=a[c];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ro.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var o=n[c];if(l=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&o!==l&&(o!=null||l!=null))if(c==="style")if(l){for(i in l)!l.hasOwnProperty(i)||o&&o.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in o)o.hasOwnProperty(i)&&l[i]!==o[i]&&(r||(r={}),r[i]=o[i])}else r||(s||(s=[]),s.push(c,r)),r=o;else c==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,l=l?l.__html:void 0,o!=null&&l!==o&&(s=s||[]).push(c,o)):c==="children"?typeof o!="string"&&typeof o!="number"||(s=s||[]).push(c,""+o):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ro.hasOwnProperty(c)?(o!=null&&c==="onScroll"&&gt("scroll",e),s||l===o||(s=[])):(s=s||[]).push(c,o))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};gw=function(e,t,r,n){r!==n&&(t.flags|=4)};function Wl(e,t){if(!_t)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function wr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function TA(e,t,r){var n=t.pendingProps;switch($m(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(t),null;case 1:return Yr(t.type)&&ff(),wr(t),null;case 3:return n=t.stateNode,fl(),wt(Gr),wt(Fr),Zm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ru(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Vn!==null&&(Kh(Vn),Vn=null))),Uh(e,t),wr(t),null;case 5:qm(t);var a=Us($o.current);if(r=t.type,e!==null&&t.stateNode!=null)xw(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ke(166));return wr(t),null}if(e=Us(pa.current),ru(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[fa]=t,n[zo]=s,e=(t.mode&1)!==0,r){case"dialog":gt("cancel",n),gt("close",n);break;case"iframe":case"object":case"embed":gt("load",n);break;case"video":case"audio":for(a=0;a<so.length;a++)gt(so[a],n);break;case"source":gt("error",n);break;case"img":case"image":case"link":gt("error",n),gt("load",n);break;case"details":gt("toggle",n);break;case"input":Rx(n,s),gt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},gt("invalid",n);break;case"textarea":Dx(n,s),gt("invalid",n)}hh(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&tu(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&tu(n.textContent,l,e),a=["children",""+l]):Ro.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&gt("scroll",n)}switch(r){case"input":Yc(n),Ix(n,s,!0);break;case"textarea":Yc(n),Ox(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=uf)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Wy(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[fa]=t,e[zo]=n,pw(e,t,!1,!1),t.stateNode=e;e:{switch(i=mh(r,n),r){case"dialog":gt("cancel",e),gt("close",e),a=n;break;case"iframe":case"object":case"embed":gt("load",e),a=n;break;case"video":case"audio":for(a=0;a<so.length;a++)gt(so[a],e);a=n;break;case"source":gt("error",e),a=n;break;case"img":case"image":case"link":gt("error",e),gt("load",e),a=n;break;case"details":gt("toggle",e),a=n;break;case"input":Rx(e,n),a=oh(e,n),gt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Rt({},n,{value:void 0}),gt("invalid",e);break;case"textarea":Dx(e,n),a=fh(e,n),gt("invalid",e);break;default:a=n}hh(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var o=l[s];s==="style"?Ky(e,o):s==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&Gy(e,o)):s==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&Io(e,o):typeof o=="number"&&Io(e,""+o):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ro.hasOwnProperty(s)?o!=null&&s==="onScroll"&&gt("scroll",e):o!=null&&Tm(e,s,o,i))}switch(r){case"input":Yc(e),Ix(e,n,!1);break;case"textarea":Yc(e),Ox(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ws(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Ji(e,!!n.multiple,s,!1):n.defaultValue!=null&&Ji(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=uf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wr(t),null;case 6:if(e&&t.stateNode!=null)gw(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ke(166));if(r=Us($o.current),Us(pa.current),ru(t)){if(n=t.stateNode,r=t.memoizedProps,n[fa]=t,(s=n.nodeValue!==r)&&(e=sn,e!==null))switch(e.tag){case 3:tu(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&tu(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[fa]=t,t.stateNode=n}return wr(t),null;case 13:if(wt(Tt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_t&&an!==null&&t.mode&1&&!(t.flags&128))L2(),cl(),t.flags|=98560,s=!1;else if(s=ru(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ke(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ke(317));s[fa]=t}else cl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wr(t),s=!1}else Vn!==null&&(Kh(Vn),Vn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Tt.current&1?Zt===0&&(Zt=3):up())),t.updateQueue!==null&&(t.flags|=4),wr(t),null);case 4:return fl(),Uh(e,t),e===null&&Bo(t.stateNode.containerInfo),wr(t),null;case 10:return Ym(t.type._context),wr(t),null;case 17:return Yr(t.type)&&ff(),wr(t),null;case 19:if(wt(Tt),s=t.memoizedState,s===null)return wr(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Wl(s,!1);else{if(Zt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=vf(e),i!==null){for(t.flags|=128,Wl(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return xt(Tt,Tt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ht()>hl&&(t.flags|=128,n=!0,Wl(s,!1),t.lanes=4194304)}else{if(!n)if(e=vf(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Wl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!_t)return wr(t),null}else 2*Ht()-s.renderingStartTime>hl&&r!==1073741824&&(t.flags|=128,n=!0,Wl(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ht(),t.sibling=null,r=Tt.current,xt(Tt,n?r&1|2:r&1),t):(wr(t),null);case 22:case 23:return cp(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?en&1073741824&&(wr(t),t.subtreeFlags&6&&(t.flags|=8192)):wr(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function CA(e,t){switch($m(t),t.tag){case 1:return Yr(t.type)&&ff(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fl(),wt(Gr),wt(Fr),Zm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return qm(t),null;case 13:if(wt(Tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));cl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return wt(Tt),null;case 4:return fl(),null;case 10:return Ym(t.type._context),null;case 22:case 23:return cp(),null;case 24:return null;default:return null}}var su=!1,_r=!1,FA=typeof WeakSet=="function"?WeakSet:Set,Le=null;function Wi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ot(e,t,n)}else r.current=null}function zh(e,t,r){try{r()}catch(n){Ot(e,t,n)}}var E1=!1;function RA(e,t){if(_h=lf,e=k2(),zm(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,l=-1,o=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var p;d!==r||a!==0&&d.nodeType!==3||(l=i+a),d!==s||n!==0&&d.nodeType!==3||(o=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++c===a&&(l=i),h===s&&++u===n&&(o=i),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=l===-1||o===-1?null:{start:l,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nh={focusedElem:e,selectionRange:r},lf=!1,Le=t;Le!==null;)if(t=Le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Le=e;else for(;Le!==null;){t=Le;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var x=m.memoizedProps,g=m.memoizedState,v=t.stateNode,w=v.getSnapshotBeforeUpdate(t.elementType===t.type?x:Hn(t.type,x),g);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(k){Ot(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Le=e;break}Le=t.return}return m=E1,E1=!1,m}function wo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&zh(t,r,s)}a=a.next}while(a!==n)}}function s0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Hh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function vw(e){var t=e.alternate;t!==null&&(e.alternate=null,vw(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[fa],delete t[zo],delete t[Th],delete t[hA],delete t[mA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function yw(e){return e.tag===5||e.tag===3||e.tag===4}function _1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||yw(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $h(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=uf));else if(n!==4&&(e=e.child,e!==null))for($h(e,t,r),e=e.sibling;e!==null;)$h(e,t,r),e=e.sibling}function Vh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Vh(e,t,r),e=e.sibling;e!==null;)Vh(e,t,r),e=e.sibling}var dr=null,$n=!1;function qa(e,t,r){for(r=r.child;r!==null;)ww(e,t,r),r=r.sibling}function ww(e,t,r){if(ma&&typeof ma.onCommitFiberUnmount=="function")try{ma.onCommitFiberUnmount(qf,r)}catch{}switch(r.tag){case 5:_r||Wi(r,t);case 6:var n=dr,a=$n;dr=null,qa(e,t,r),dr=n,$n=a,dr!==null&&($n?(e=dr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):dr.removeChild(r.stateNode));break;case 18:dr!==null&&($n?(e=dr,r=r.stateNode,e.nodeType===8?cd(e.parentNode,r):e.nodeType===1&&cd(e,r),Po(e)):cd(dr,r.stateNode));break;case 4:n=dr,a=$n,dr=r.stateNode.containerInfo,$n=!0,qa(e,t,r),dr=n,$n=a;break;case 0:case 11:case 14:case 15:if(!_r&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&zh(r,t,i),a=a.next}while(a!==n)}qa(e,t,r);break;case 1:if(!_r&&(Wi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ot(r,t,l)}qa(e,t,r);break;case 21:qa(e,t,r);break;case 22:r.mode&1?(_r=(n=_r)||r.memoizedState!==null,qa(e,t,r),_r=n):qa(e,t,r);break;default:qa(e,t,r)}}function N1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new FA),t.forEach(function(n){var a=UA.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Bn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:dr=l.stateNode,$n=!1;break e;case 3:dr=l.stateNode.containerInfo,$n=!0;break e;case 4:dr=l.stateNode.containerInfo,$n=!0;break e}l=l.return}if(dr===null)throw Error(ke(160));ww(s,i,a),dr=null,$n=!1;var o=a.alternate;o!==null&&(o.return=null),a.return=null}catch(c){Ot(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Sw(t,e),t=t.sibling}function Sw(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bn(t,e),ta(e),n&4){try{wo(3,e,e.return),s0(3,e)}catch(x){Ot(e,e.return,x)}try{wo(5,e,e.return)}catch(x){Ot(e,e.return,x)}}break;case 1:Bn(t,e),ta(e),n&512&&r!==null&&Wi(r,r.return);break;case 5:if(Bn(t,e),ta(e),n&512&&r!==null&&Wi(r,r.return),e.flags&32){var a=e.stateNode;try{Io(a,"")}catch(x){Ot(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,l=e.type,o=e.updateQueue;if(e.updateQueue=null,o!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&$y(a,s),mh(l,i);var c=mh(l,s);for(i=0;i<o.length;i+=2){var u=o[i],d=o[i+1];u==="style"?Ky(a,d):u==="dangerouslySetInnerHTML"?Gy(a,d):u==="children"?Io(a,d):Tm(a,u,d,c)}switch(l){case"input":ch(a,s);break;case"textarea":Vy(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Ji(a,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ji(a,!!s.multiple,s.defaultValue,!0):Ji(a,!!s.multiple,s.multiple?[]:"",!1))}a[zo]=s}catch(x){Ot(e,e.return,x)}}break;case 6:if(Bn(t,e),ta(e),n&4){if(e.stateNode===null)throw Error(ke(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(x){Ot(e,e.return,x)}}break;case 3:if(Bn(t,e),ta(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Po(t.containerInfo)}catch(x){Ot(e,e.return,x)}break;case 4:Bn(t,e),ta(e);break;case 13:Bn(t,e),ta(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(lp=Ht())),n&4&&N1(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(_r=(c=_r)||u,Bn(t,e),_r=c):Bn(t,e),ta(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Le=e,u=e.child;u!==null;){for(d=Le=u;Le!==null;){switch(h=Le,p=h.child,h.tag){case 0:case 11:case 14:case 15:wo(4,h,h.return);break;case 1:Wi(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(x){Ot(n,r,x)}}break;case 5:Wi(h,h.return);break;case 22:if(h.memoizedState!==null){b1(d);continue}}p!==null?(p.return=h,Le=p):b1(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=d.stateNode,o=d.memoizedProps.style,i=o!=null&&o.hasOwnProperty("display")?o.display:null,l.style.display=Yy("display",i))}catch(x){Ot(e,e.return,x)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(x){Ot(e,e.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Bn(t,e),ta(e),n&4&&N1(e);break;case 21:break;default:Bn(t,e),ta(e)}}function ta(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(yw(r)){var n=r;break e}r=r.return}throw Error(ke(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Io(a,""),n.flags&=-33);var s=_1(e);Vh(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,l=_1(e);$h(e,l,i);break;default:throw Error(ke(161))}}catch(o){Ot(e,e.return,o)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function IA(e,t,r){Le=e,kw(e)}function kw(e,t,r){for(var n=(e.mode&1)!==0;Le!==null;){var a=Le,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||su;if(!i){var l=a.alternate,o=l!==null&&l.memoizedState!==null||_r;l=su;var c=_r;if(su=i,(_r=o)&&!c)for(Le=a;Le!==null;)i=Le,o=i.child,i.tag===22&&i.memoizedState!==null?T1(a):o!==null?(o.return=i,Le=o):T1(a);for(;s!==null;)Le=s,kw(s),s=s.sibling;Le=a,su=l,_r=c}A1(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Le=s):A1(e)}}function A1(e){for(;Le!==null;){var t=Le;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_r||s0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!_r)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Hn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&u1(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}u1(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Po(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}_r||t.flags&512&&Hh(t)}catch(h){Ot(t,t.return,h)}}if(t===e){Le=null;break}if(r=t.sibling,r!==null){r.return=t.return,Le=r;break}Le=t.return}}function b1(e){for(;Le!==null;){var t=Le;if(t===e){Le=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Le=r;break}Le=t.return}}function T1(e){for(;Le!==null;){var t=Le;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{s0(4,t)}catch(o){Ot(t,r,o)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(o){Ot(t,a,o)}}var s=t.return;try{Hh(t)}catch(o){Ot(t,s,o)}break;case 5:var i=t.return;try{Hh(t)}catch(o){Ot(t,i,o)}}}catch(o){Ot(t,t.return,o)}if(t===e){Le=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Le=l;break}Le=t.return}}var DA=Math.ceil,Sf=Va.ReactCurrentDispatcher,sp=Va.ReactCurrentOwner,Dn=Va.ReactCurrentBatchConfig,at=0,cr=null,Xt=null,pr=0,en=0,Gi=bs(0),Zt=0,Yo=null,ri=0,i0=0,ip=0,So=null,Vr=null,lp=0,hl=1/0,Aa=null,kf=!1,Wh=null,xs=null,iu=!1,is=null,Ef=0,ko=0,Gh=null,ju=-1,Mu=0;function Br(){return at&6?Ht():ju!==-1?ju:ju=Ht()}function gs(e){return e.mode&1?at&2&&pr!==0?pr&-pr:xA.transition!==null?(Mu===0&&(Mu=i2()),Mu):(e=dt,e!==0||(e=window.event,e=e===void 0?16:h2(e.type)),e):1}function Kn(e,t,r,n){if(50<ko)throw ko=0,Gh=null,Error(ke(185));hc(e,r,n),(!(at&2)||e!==cr)&&(e===cr&&(!(at&2)&&(i0|=r),Zt===4&&as(e,pr)),Kr(e,n),r===1&&at===0&&!(t.mode&1)&&(hl=Ht()+500,r0&&Ts()))}function Kr(e,t){var r=e.callbackNode;xN(e,t);var n=sf(e,e===cr?pr:0);if(n===0)r!==null&&jx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&jx(r),t===1)e.tag===0?pA(C1.bind(null,e)):I2(C1.bind(null,e)),fA(function(){!(at&6)&&Ts()}),r=null;else{switch(l2(n)){case 1:r=Dm;break;case 4:r=a2;break;case 16:r=af;break;case 536870912:r=s2;break;default:r=af}r=Fw(r,Ew.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Ew(e,t){if(ju=-1,Mu=0,at&6)throw Error(ke(327));var r=e.callbackNode;if(tl()&&e.callbackNode!==r)return null;var n=sf(e,e===cr?pr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=_f(e,n);else{t=n;var a=at;at|=2;var s=Nw();(cr!==e||pr!==t)&&(Aa=null,hl=Ht()+500,$s(e,t));do try{PA();break}catch(l){_w(e,l)}while(!0);Gm(),Sf.current=s,at=a,Xt!==null?t=0:(cr=null,pr=0,t=Zt)}if(t!==0){if(t===2&&(a=yh(e),a!==0&&(n=a,t=Yh(e,a))),t===1)throw r=Yo,$s(e,0),as(e,n),Kr(e,Ht()),r;if(t===6)as(e,n);else{if(a=e.current.alternate,!(n&30)&&!OA(a)&&(t=_f(e,n),t===2&&(s=yh(e),s!==0&&(n=s,t=Yh(e,s))),t===1))throw r=Yo,$s(e,0),as(e,n),Kr(e,Ht()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ke(345));case 2:Ls(e,Vr,Aa);break;case 3:if(as(e,n),(n&130023424)===n&&(t=lp+500-Ht(),10<t)){if(sf(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Br(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=bh(Ls.bind(null,e,Vr,Aa),t);break}Ls(e,Vr,Aa);break;case 4:if(as(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Yn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=Ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*DA(n/1960))-n,10<n){e.timeoutHandle=bh(Ls.bind(null,e,Vr,Aa),n);break}Ls(e,Vr,Aa);break;case 5:Ls(e,Vr,Aa);break;default:throw Error(ke(329))}}}return Kr(e,Ht()),e.callbackNode===r?Ew.bind(null,e):null}function Yh(e,t){var r=So;return e.current.memoizedState.isDehydrated&&($s(e,t).flags|=256),e=_f(e,t),e!==2&&(t=Vr,Vr=r,t!==null&&Kh(t)),e}function Kh(e){Vr===null?Vr=e:Vr.push.apply(Vr,e)}function OA(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!qn(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function as(e,t){for(t&=~ip,t&=~i0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Yn(t),n=1<<r;e[r]=-1,t&=~n}}function C1(e){if(at&6)throw Error(ke(327));tl();var t=sf(e,0);if(!(t&1))return Kr(e,Ht()),null;var r=_f(e,t);if(e.tag!==0&&r===2){var n=yh(e);n!==0&&(t=n,r=Yh(e,n))}if(r===1)throw r=Yo,$s(e,0),as(e,t),Kr(e,Ht()),r;if(r===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ls(e,Vr,Aa),Kr(e,Ht()),null}function op(e,t){var r=at;at|=1;try{return e(t)}finally{at=r,at===0&&(hl=Ht()+500,r0&&Ts())}}function ni(e){is!==null&&is.tag===0&&!(at&6)&&tl();var t=at;at|=1;var r=Dn.transition,n=dt;try{if(Dn.transition=null,dt=1,e)return e()}finally{dt=n,Dn.transition=r,at=t,!(at&6)&&Ts()}}function cp(){en=Gi.current,wt(Gi)}function $s(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,uA(r)),Xt!==null)for(r=Xt.return;r!==null;){var n=r;switch($m(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ff();break;case 3:fl(),wt(Gr),wt(Fr),Zm();break;case 5:qm(n);break;case 4:fl();break;case 13:wt(Tt);break;case 19:wt(Tt);break;case 10:Ym(n.type._context);break;case 22:case 23:cp()}r=r.return}if(cr=e,Xt=e=vs(e.current,null),pr=en=t,Zt=0,Yo=null,ip=i0=ri=0,Vr=So=null,Bs!==null){for(t=0;t<Bs.length;t++)if(r=Bs[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Bs=null}return e}function _w(e,t){do{var r=Xt;try{if(Gm(),Ou.current=wf,yf){for(var n=Ft.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}yf=!1}if(ti=0,sr=Jt=Ft=null,yo=!1,Vo=0,sp.current=null,r===null||r.return===null){Zt=1,Yo=t,Xt=null;break}e:{var s=e,i=r.return,l=r,o=t;if(t=pr,l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var c=o,u=l,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=x1(i);if(p!==null){p.flags&=-257,g1(p,i,l,s,t),p.mode&1&&p1(s,c,t),t=p,o=c;var m=t.updateQueue;if(m===null){var x=new Set;x.add(o),t.updateQueue=x}else m.add(o);break e}else{if(!(t&1)){p1(s,c,t),up();break e}o=Error(ke(426))}}else if(_t&&l.mode&1){var g=x1(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),g1(g,i,l,s,t),Vm(dl(o,l));break e}}s=o=dl(o,l),Zt!==4&&(Zt=2),So===null?So=[s]:So.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=lw(s,o,t);c1(s,v);break e;case 1:l=o;var w=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(xs===null||!xs.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=ow(s,l,t);c1(s,k);break e}}s=s.return}while(s!==null)}bw(r)}catch(C){t=C,Xt===r&&r!==null&&(Xt=r=r.return);continue}break}while(!0)}function Nw(){var e=Sf.current;return Sf.current=wf,e===null?wf:e}function up(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),cr===null||!(ri&268435455)&&!(i0&268435455)||as(cr,pr)}function _f(e,t){var r=at;at|=2;var n=Nw();(cr!==e||pr!==t)&&(Aa=null,$s(e,t));do try{LA();break}catch(a){_w(e,a)}while(!0);if(Gm(),at=r,Sf.current=n,Xt!==null)throw Error(ke(261));return cr=null,pr=0,Zt}function LA(){for(;Xt!==null;)Aw(Xt)}function PA(){for(;Xt!==null&&!lN();)Aw(Xt)}function Aw(e){var t=Cw(e.alternate,e,en);e.memoizedProps=e.pendingProps,t===null?bw(e):Xt=t,sp.current=null}function bw(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=CA(r,t),r!==null){r.flags&=32767,Xt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Zt=6,Xt=null;return}}else if(r=TA(r,t,en),r!==null){Xt=r;return}if(t=t.sibling,t!==null){Xt=t;return}Xt=t=e}while(t!==null);Zt===0&&(Zt=5)}function Ls(e,t,r){var n=dt,a=Dn.transition;try{Dn.transition=null,dt=1,jA(e,t,r,n)}finally{Dn.transition=a,dt=n}return null}function jA(e,t,r,n){do tl();while(is!==null);if(at&6)throw Error(ke(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(gN(e,s),e===cr&&(Xt=cr=null,pr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||iu||(iu=!0,Fw(af,function(){return tl(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Dn.transition,Dn.transition=null;var i=dt;dt=1;var l=at;at|=4,sp.current=null,RA(e,r),Sw(r,e),nA(Nh),lf=!!_h,Nh=_h=null,e.current=r,IA(r),oN(),at=l,dt=i,Dn.transition=s}else e.current=r;if(iu&&(iu=!1,is=e,Ef=a),s=e.pendingLanes,s===0&&(xs=null),fN(r.stateNode),Kr(e,Ht()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(kf)throw kf=!1,e=Wh,Wh=null,e;return Ef&1&&e.tag!==0&&tl(),s=e.pendingLanes,s&1?e===Gh?ko++:(ko=0,Gh=e):ko=0,Ts(),null}function tl(){if(is!==null){var e=l2(Ef),t=Dn.transition,r=dt;try{if(Dn.transition=null,dt=16>e?16:e,is===null)var n=!1;else{if(e=is,is=null,Ef=0,at&6)throw Error(ke(331));var a=at;for(at|=4,Le=e.current;Le!==null;){var s=Le,i=s.child;if(Le.flags&16){var l=s.deletions;if(l!==null){for(var o=0;o<l.length;o++){var c=l[o];for(Le=c;Le!==null;){var u=Le;switch(u.tag){case 0:case 11:case 15:wo(8,u,s)}var d=u.child;if(d!==null)d.return=u,Le=d;else for(;Le!==null;){u=Le;var h=u.sibling,p=u.return;if(vw(u),u===c){Le=null;break}if(h!==null){h.return=p,Le=h;break}Le=p}}}var m=s.alternate;if(m!==null){var x=m.child;if(x!==null){m.child=null;do{var g=x.sibling;x.sibling=null,x=g}while(x!==null)}}Le=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Le=i;else e:for(;Le!==null;){if(s=Le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:wo(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Le=v;break e}Le=s.return}}var w=e.current;for(Le=w;Le!==null;){i=Le;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Le=y;else e:for(i=w;Le!==null;){if(l=Le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:s0(9,l)}}catch(C){Ot(l,l.return,C)}if(l===i){Le=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,Le=k;break e}Le=l.return}}if(at=a,Ts(),ma&&typeof ma.onPostCommitFiberRoot=="function")try{ma.onPostCommitFiberRoot(qf,e)}catch{}n=!0}return n}finally{dt=r,Dn.transition=t}}return!1}function F1(e,t,r){t=dl(r,t),t=lw(e,t,1),e=ps(e,t,1),t=Br(),e!==null&&(hc(e,1,t),Kr(e,t))}function Ot(e,t,r){if(e.tag===3)F1(e,e,r);else for(;t!==null;){if(t.tag===3){F1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(xs===null||!xs.has(n))){e=dl(r,e),e=ow(t,e,1),t=ps(t,e,1),e=Br(),t!==null&&(hc(t,1,e),Kr(t,e));break}}t=t.return}}function MA(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Br(),e.pingedLanes|=e.suspendedLanes&r,cr===e&&(pr&r)===r&&(Zt===4||Zt===3&&(pr&130023424)===pr&&500>Ht()-lp?$s(e,0):ip|=r),Kr(e,t)}function Tw(e,t){t===0&&(e.mode&1?(t=Jc,Jc<<=1,!(Jc&130023424)&&(Jc=4194304)):t=1);var r=Br();e=Ua(e,t),e!==null&&(hc(e,t,r),Kr(e,r))}function BA(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Tw(e,r)}function UA(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ke(314))}n!==null&&n.delete(t),Tw(e,r)}var Cw;Cw=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Gr.current)Wr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Wr=!1,bA(e,t,r);Wr=!!(e.flags&131072)}else Wr=!1,_t&&t.flags&1048576&&D2(t,mf,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Pu(e,t),e=t.pendingProps;var a=ol(t,Fr.current);el(t,r),a=ep(null,t,n,e,a,r);var s=tp();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yr(n)?(s=!0,df(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Xm(t),a.updater=a0,t.stateNode=a,a._reactInternals=t,Oh(t,n,e,r),t=jh(null,t,n,!0,s,r)):(t.tag=0,_t&&s&&Hm(t),Lr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Pu(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=HA(n),e=Hn(n,e),a){case 0:t=Ph(null,t,n,e,r);break e;case 1:t=w1(null,t,n,e,r);break e;case 11:t=v1(null,t,n,e,r);break e;case 14:t=y1(null,t,n,Hn(n.type,e),r);break e}throw Error(ke(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),Ph(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),w1(e,t,n,a,r);case 3:e:{if(dw(t),e===null)throw Error(ke(387));n=t.pendingProps,s=t.memoizedState,a=s.element,B2(e,t),gf(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=dl(Error(ke(423)),t),t=S1(e,t,n,r,a);break e}else if(n!==a){a=dl(Error(ke(424)),t),t=S1(e,t,n,r,a);break e}else for(an=ms(t.stateNode.containerInfo.firstChild),sn=t,_t=!0,Vn=null,r=j2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(cl(),n===a){t=za(e,t,r);break e}Lr(e,t,n,r)}t=t.child}return t;case 5:return U2(t),e===null&&Rh(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,Ah(n,a)?i=null:s!==null&&Ah(n,s)&&(t.flags|=32),fw(e,t),Lr(e,t,i,r),t.child;case 6:return e===null&&Rh(t),null;case 13:return hw(e,t,r);case 4:return Jm(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ul(t,null,n,r):Lr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),v1(e,t,n,a,r);case 7:return Lr(e,t,t.pendingProps,r),t.child;case 8:return Lr(e,t,t.pendingProps.children,r),t.child;case 12:return Lr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,xt(pf,n._currentValue),n._currentValue=i,s!==null)if(qn(s.value,i)){if(s.children===a.children&&!Gr.current){t=za(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){i=s.child;for(var o=l.firstContext;o!==null;){if(o.context===n){if(s.tag===1){o=Da(-1,r&-r),o.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?o.next=o:(o.next=u.next,u.next=o),c.pending=o}}s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Ih(s.return,r,t),l.lanes|=r;break}o=o.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ke(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Ih(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Lr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,el(t,r),a=Ln(a),n=n(a),t.flags|=1,Lr(e,t,n,r),t.child;case 14:return n=t.type,a=Hn(n,t.pendingProps),a=Hn(n.type,a),y1(e,t,n,a,r);case 15:return cw(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),Pu(e,t),t.tag=1,Yr(n)?(e=!0,df(t)):e=!1,el(t,r),iw(t,n,a),Oh(t,n,a,r),jh(null,t,n,!0,e,r);case 19:return mw(e,t,r);case 22:return uw(e,t,r)}throw Error(ke(156,t.tag))};function Fw(e,t){return n2(e,t)}function zA(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(e,t,r,n){return new zA(e,t,r,n)}function fp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function HA(e){if(typeof e=="function")return fp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Fm)return 11;if(e===Rm)return 14}return 2}function vs(e,t){var r=e.alternate;return r===null?(r=Fn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bu(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")fp(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Pi:return Vs(r.children,a,s,t);case Cm:i=8,a|=8;break;case ah:return e=Fn(12,r,t,a|2),e.elementType=ah,e.lanes=s,e;case sh:return e=Fn(13,r,t,a),e.elementType=sh,e.lanes=s,e;case ih:return e=Fn(19,r,t,a),e.elementType=ih,e.lanes=s,e;case Uy:return l0(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case My:i=10;break e;case By:i=9;break e;case Fm:i=11;break e;case Rm:i=14;break e;case ts:i=16,n=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=Fn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Vs(e,t,r,n){return e=Fn(7,e,n,t),e.lanes=r,e}function l0(e,t,r,n){return e=Fn(22,e,n,t),e.elementType=Uy,e.lanes=r,e.stateNode={isHidden:!1},e}function gd(e,t,r){return e=Fn(6,e,null,t),e.lanes=r,e}function vd(e,t,r){return t=Fn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $A(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Z0(0),this.expirationTimes=Z0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Z0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function dp(e,t,r,n,a,s,i,l,o){return e=new $A(e,t,r,l,o),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Fn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xm(s),e}function VA(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Rw(e){if(!e)return Ss;e=e._reactInternals;e:{if(hi(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var r=e.type;if(Yr(r))return R2(e,r,t)}return t}function Iw(e,t,r,n,a,s,i,l,o){return e=dp(r,n,!0,e,a,s,i,l,o),e.context=Rw(null),r=e.current,n=Br(),a=gs(r),s=Da(n,a),s.callback=t??null,ps(r,s,a),e.current.lanes=a,hc(e,a,n),Kr(e,n),e}function o0(e,t,r,n){var a=t.current,s=Br(),i=gs(a);return r=Rw(r),t.context===null?t.context=r:t.pendingContext=r,t=Da(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ps(a,t,i),e!==null&&(Kn(e,a,i,s),Du(e,a,i)),i}function Nf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function R1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function hp(e,t){R1(e,t),(e=e.alternate)&&R1(e,t)}function WA(){return null}var Dw=typeof reportError=="function"?reportError:function(e){console.error(e)};function mp(e){this._internalRoot=e}c0.prototype.render=mp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));o0(e,t,null,null)};c0.prototype.unmount=mp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ni(function(){o0(null,e,null,null)}),t[Ba]=null}};function c0(e){this._internalRoot=e}c0.prototype.unstable_scheduleHydration=function(e){if(e){var t=u2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ns.length&&t!==0&&t<ns[r].priority;r++);ns.splice(r,0,e),r===0&&d2(e)}};function pp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function I1(){}function GA(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Nf(i);s.call(c)}}var i=Iw(t,n,e,0,null,!1,!1,"",I1);return e._reactRootContainer=i,e[Ba]=i.current,Bo(e.nodeType===8?e.parentNode:e),ni(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var c=Nf(o);l.call(c)}}var o=dp(e,0,!1,null,null,!1,!1,"",I1);return e._reactRootContainer=o,e[Ba]=o.current,Bo(e.nodeType===8?e.parentNode:e),ni(function(){o0(t,o,r,n)}),o}function f0(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var l=a;a=function(){var o=Nf(i);l.call(o)}}o0(t,i,e,a)}else i=GA(r,t,e,a,n);return Nf(i)}o2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ao(t.pendingLanes);r!==0&&(Om(t,r|1),Kr(t,Ht()),!(at&6)&&(hl=Ht()+500,Ts()))}break;case 13:ni(function(){var n=Ua(e,1);if(n!==null){var a=Br();Kn(n,e,1,a)}}),hp(e,1)}};Lm=function(e){if(e.tag===13){var t=Ua(e,134217728);if(t!==null){var r=Br();Kn(t,e,134217728,r)}hp(e,134217728)}};c2=function(e){if(e.tag===13){var t=gs(e),r=Ua(e,t);if(r!==null){var n=Br();Kn(r,e,t,n)}hp(e,t)}};u2=function(){return dt};f2=function(e,t){var r=dt;try{return dt=e,t()}finally{dt=r}};xh=function(e,t,r){switch(t){case"input":if(ch(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=t0(n);if(!a)throw Error(ke(90));Hy(n),ch(n,a)}}}break;case"textarea":Vy(e,r);break;case"select":t=r.value,t!=null&&Ji(e,!!r.multiple,t,!1)}};qy=op;Zy=ni;var YA={usingClientEntryPoint:!1,Events:[pc,Ui,t0,Xy,Jy,op]},Gl={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KA={bundleType:Gl.bundleType,version:Gl.version,rendererPackageName:Gl.rendererPackageName,rendererConfig:Gl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Va.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=t2(e),e===null?null:e.stateNode},findFiberByHostInstance:Gl.findFiberByHostInstance||WA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lu.isDisabled&&lu.supportsFiber)try{qf=lu.inject(KA),ma=lu}catch{}}dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YA;dn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pp(t))throw Error(ke(200));return VA(e,t,null,r)};dn.createRoot=function(e,t){if(!pp(e))throw Error(ke(299));var r=!1,n="",a=Dw;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=dp(e,1,!1,null,null,r,!1,n,a),e[Ba]=t.current,Bo(e.nodeType===8?e.parentNode:e),new mp(t)};dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=t2(t),e=e===null?null:e.stateNode,e};dn.flushSync=function(e){return ni(e)};dn.hydrate=function(e,t,r){if(!u0(t))throw Error(ke(200));return f0(null,e,t,!0,r)};dn.hydrateRoot=function(e,t,r){if(!pp(e))throw Error(ke(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=Dw;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Iw(t,null,e,1,r??null,a,!1,s,i),e[Ba]=t.current,Bo(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new c0(t)};dn.render=function(e,t,r){if(!u0(t))throw Error(ke(200));return f0(null,e,t,!1,r)};dn.unmountComponentAtNode=function(e){if(!u0(e))throw Error(ke(40));return e._reactRootContainer?(ni(function(){f0(null,null,e,!1,function(){e._reactRootContainer=null,e[Ba]=null})}),!0):!1};dn.unstable_batchedUpdates=op;dn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!u0(r))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return f0(e,t,r,!1,n)};dn.version="18.3.1-next-f1338f8080-20240426";function Ow(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ow)}catch(e){console.error(e)}}Ow(),Oy.exports=dn;var XA=Oy.exports,D1=XA;rh.createRoot=D1.createRoot,rh.hydrateRoot=D1.hydrateRoot;/**
 * react-router v7.9.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var O1="popstate";function JA(e={}){function t(n,a){let{pathname:s,search:i,hash:l}=n.location;return Xh("",{pathname:s,search:i,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Ko(a)}return ZA(t,r,null,e)}function Qt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ga(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function qA(){return Math.random().toString(36).substring(2,10)}function L1(e,t){return{usr:e.state,key:e.key,idx:t}}function Xh(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?gc(t):t,state:r,key:t&&t.key||n||qA()}}function Ko({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function gc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function ZA(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,l="POP",o=null,c=u();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function u(){return(i.state||{idx:null}).idx}function d(){l="POP";let g=u(),v=g==null?null:g-c;c=g,o&&o({action:l,location:x.location,delta:v})}function h(g,v){l="PUSH";let w=Xh(x.location,g,v);c=u()+1;let y=L1(w,c),k=x.createHref(w);try{i.pushState(y,"",k)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(k)}s&&o&&o({action:l,location:x.location,delta:1})}function p(g,v){l="REPLACE";let w=Xh(x.location,g,v);c=u();let y=L1(w,c),k=x.createHref(w);i.replaceState(y,"",k),s&&o&&o({action:l,location:x.location,delta:0})}function m(g){return QA(g)}let x={get action(){return l},get location(){return e(a,i)},listen(g){if(o)throw new Error("A history only accepts one active listener");return a.addEventListener(O1,d),o=g,()=>{a.removeEventListener(O1,d),o=null}},createHref(g){return t(a,g)},createURL:m,encodeLocation(g){let v=m(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:p,go(g){return i.go(g)}};return x}function QA(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Qt(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Ko(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function Lw(e,t,r="/"){return eb(e,t,r,!1)}function eb(e,t,r,n){let a=typeof t=="string"?gc(t):t,s=Ha(a.pathname||"/",r);if(s==null)return null;let i=Pw(e);tb(i);let l=null;for(let o=0;l==null&&o<i.length;++o){let c=db(s);l=ub(i[o],c,n)}return l}function Pw(e,t=[],r=[],n="",a=!1){let s=(i,l,o=a,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&o)return;Qt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let d=Oa([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(Qt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),Pw(i.children,t,h,d,o)),!(i.path==null&&!i.index)&&t.push({path:d,score:ob(d,i.index),routesMeta:h})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let c of jw(i.path))s(i,l,!0,c)}),t}function jw(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=jw(n.join("/")),l=[];return l.push(...i.map(o=>o===""?s:[s,o].join("/"))),a&&l.push(...i),l.map(o=>e.startsWith("/")&&o===""?"/":o)}function tb(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:cb(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var rb=/^:[\w-]+$/,nb=3,ab=2,sb=1,ib=10,lb=-2,P1=e=>e==="*";function ob(e,t){let r=e.split("/"),n=r.length;return r.some(P1)&&(n+=lb),t&&(n+=ab),r.filter(a=>!P1(a)).reduce((a,s)=>a+(rb.test(s)?nb:s===""?sb:ib),n)}function cb(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function ub(e,t,r=!1){let{routesMeta:n}=e,a={},s="/",i=[];for(let l=0;l<n.length;++l){let o=n[l],c=l===n.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=Af({path:o.relativePath,caseSensitive:o.caseSensitive,end:c},u),h=o.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=Af({path:o.relativePath,caseSensitive:o.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Oa([s,d.pathname]),pathnameBase:xb(Oa([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Oa([s,d.pathnameBase]))}return i}function Af(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=fb(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let m=l[h]||"";i=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=l[h];return d&&!p?c[u]=void 0:c[u]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function fb(e,t=!1,r=!0){ga(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,o)=>(n.push({paramName:l,isOptional:o!=null}),o?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function db(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ga(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Ha(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function hb(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?gc(e):e;return{pathname:r?r.startsWith("/")?r:mb(r,t):t,search:gb(n),hash:vb(a)}}function mb(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function yd(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function pb(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Mw(e){let t=pb(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Bw(e,t,r,n=!1){let a;typeof e=="string"?a=gc(e):(a={...e},Qt(!a.pathname||!a.pathname.includes("?"),yd("?","pathname","search",a)),Qt(!a.pathname||!a.pathname.includes("#"),yd("#","pathname","hash",a)),Qt(!a.search||!a.search.includes("#"),yd("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,l;if(i==null)l=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}l=d>=0?t[d]:"/"}let o=hb(a,l),c=i&&i!=="/"&&i.endsWith("/"),u=(s||i===".")&&r.endsWith("/");return!o.pathname.endsWith("/")&&(c||u)&&(o.pathname+="/"),o}var Oa=e=>e.join("/").replace(/\/\/+/g,"/"),xb=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),gb=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,vb=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function yb(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Uw=["POST","PUT","PATCH","DELETE"];new Set(Uw);var wb=["GET",...Uw];new Set(wb);var El=_.createContext(null);El.displayName="DataRouter";var d0=_.createContext(null);d0.displayName="DataRouterState";_.createContext(!1);var zw=_.createContext({isTransitioning:!1});zw.displayName="ViewTransition";var Sb=_.createContext(new Map);Sb.displayName="Fetchers";var kb=_.createContext(null);kb.displayName="Await";var wa=_.createContext(null);wa.displayName="Navigation";var h0=_.createContext(null);h0.displayName="Location";var Wa=_.createContext({outlet:null,matches:[],isDataRoute:!1});Wa.displayName="Route";var xp=_.createContext(null);xp.displayName="RouteError";function Eb(e,{relative:t}={}){Qt(vc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=_.useContext(wa),{hash:a,pathname:s,search:i}=yc(e,{relative:t}),l=s;return r!=="/"&&(l=s==="/"?r:Oa([r,s])),n.createHref({pathname:l,search:i,hash:a})}function vc(){return _.useContext(h0)!=null}function mi(){return Qt(vc(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(h0).location}var Hw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $w(e){_.useContext(wa).static||_.useLayoutEffect(e)}function _b(){let{isDataRoute:e}=_.useContext(Wa);return e?jb():Nb()}function Nb(){Qt(vc(),"useNavigate() may be used only in the context of a <Router> component.");let e=_.useContext(El),{basename:t,navigator:r}=_.useContext(wa),{matches:n}=_.useContext(Wa),{pathname:a}=mi(),s=JSON.stringify(Mw(n)),i=_.useRef(!1);return $w(()=>{i.current=!0}),_.useCallback((o,c={})=>{if(ga(i.current,Hw),!i.current)return;if(typeof o=="number"){r.go(o);return}let u=Bw(o,JSON.parse(s),a,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Oa([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,a,e])}_.createContext(null);function yc(e,{relative:t}={}){let{matches:r}=_.useContext(Wa),{pathname:n}=mi(),a=JSON.stringify(Mw(r));return _.useMemo(()=>Bw(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function Ab(e,t,r,n,a){Qt(vc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=_.useContext(wa),{matches:i}=_.useContext(Wa),l=i[i.length-1],o=l?l.params:{},c=l?l.pathname:"/",u=l?l.pathnameBase:"/",d=l&&l.route;{let w=d&&d.path||"";Vw(c,!d||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let h=mi(),p;p=h;let m=p.pathname||"/",x=m;if(u!=="/"){let w=u.replace(/^\//,"").split("/");x="/"+m.replace(/^\//,"").split("/").slice(w.length).join("/")}let g=Lw(e,{pathname:x});return ga(d||g!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),ga(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),Rb(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Oa([u,s.encodeLocation?s.encodeLocation(w.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:Oa([u,s.encodeLocation?s.encodeLocation(w.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathnameBase])})),i,r,n,a)}function bb(){let e=Pb(),t=yb(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=_.createElement(_.Fragment,null,_.createElement("p",null," Hey developer "),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:s},"ErrorBoundary")," or"," ",_.createElement("code",{style:s},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),r?_.createElement("pre",{style:a},r):null,i)}var Tb=_.createElement(bb,null),Cb=class extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?_.createElement(Wa.Provider,{value:this.props.routeContext},_.createElement(xp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Fb({routeContext:e,match:t,children:r}){let n=_.useContext(El);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),_.createElement(Wa.Provider,{value:e},r)}function Rb(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,i=r==null?void 0:r.errors;if(i!=null){let c=s.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);Qt(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let l=!1,o=-1;if(r)for(let c=0;c<s.length;c++){let u=s[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(o=c),u.route.id){let{loaderData:d,errors:h}=r,p=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||p){l=!0,o>=0?s=s.slice(0,o+1):s=[s[0]];break}}}return s.reduceRight((c,u,d)=>{let h,p=!1,m=null,x=null;r&&(h=i&&u.route.id?i[u.route.id]:void 0,m=u.route.errorElement||Tb,l&&(o<0&&d===0?(Vw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,x=null):o===d&&(p=!0,x=u.route.hydrateFallbackElement||null)));let g=t.concat(s.slice(0,d+1)),v=()=>{let w;return h?w=m:p?w=x:u.route.Component?w=_.createElement(u.route.Component,null):u.route.element?w=u.route.element:w=c,_.createElement(Fb,{match:u,routeContext:{outlet:c,matches:g,isDataRoute:r!=null},children:w})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?_.createElement(Cb,{location:r.location,revalidation:r.revalidation,component:m,error:h,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0},unstable_onError:n}):v()},null)}function gp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ib(e){let t=_.useContext(El);return Qt(t,gp(e)),t}function Db(e){let t=_.useContext(d0);return Qt(t,gp(e)),t}function Ob(e){let t=_.useContext(Wa);return Qt(t,gp(e)),t}function vp(e){let t=Ob(e),r=t.matches[t.matches.length-1];return Qt(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Lb(){return vp("useRouteId")}function Pb(){var n;let e=_.useContext(xp),t=Db("useRouteError"),r=vp("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function jb(){let{router:e}=Ib("useNavigate"),t=vp("useNavigate"),r=_.useRef(!1);return $w(()=>{r.current=!0}),_.useCallback(async(a,s={})=>{ga(r.current,Hw),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...s}))},[e,t])}var j1={};function Vw(e,t,r){!t&&!j1[e]&&(j1[e]=!0,ga(!1,r))}_.memo(Mb);function Mb({routes:e,future:t,state:r,unstable_onError:n}){return Ab(e,void 0,r,n,t)}function Bb({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){Qt(!vc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),l=_.useMemo(()=>({basename:i,navigator:a,static:s,future:{}}),[i,a,s]);typeof r=="string"&&(r=gc(r));let{pathname:o="/",search:c="",hash:u="",state:d=null,key:h="default"}=r,p=_.useMemo(()=>{let m=Ha(o,i);return m==null?null:{location:{pathname:m,search:c,hash:u,state:d,key:h},navigationType:n}},[i,o,c,u,d,h,n]);return ga(p!=null,`<Router basename="${i}"> is not able to match the URL "${o}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:_.createElement(wa.Provider,{value:l},_.createElement(h0.Provider,{children:t,value:p}))}var Uu="get",zu="application/x-www-form-urlencoded";function m0(e){return e!=null&&typeof e.tagName=="string"}function Ub(e){return m0(e)&&e.tagName.toLowerCase()==="button"}function zb(e){return m0(e)&&e.tagName.toLowerCase()==="form"}function Hb(e){return m0(e)&&e.tagName.toLowerCase()==="input"}function $b(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Vb(e,t){return e.button===0&&(!t||t==="_self")&&!$b(e)}var ou=null;function Wb(){if(ou===null)try{new FormData(document.createElement("form"),0),ou=!1}catch{ou=!0}return ou}var Gb=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function wd(e){return e!=null&&!Gb.has(e)?(ga(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zu}"`),null):e}function Yb(e,t){let r,n,a,s,i;if(zb(e)){let l=e.getAttribute("action");n=l?Ha(l,t):null,r=e.getAttribute("method")||Uu,a=wd(e.getAttribute("enctype"))||zu,s=new FormData(e)}else if(Ub(e)||Hb(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||l.getAttribute("action");if(n=o?Ha(o,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||Uu,a=wd(e.getAttribute("formenctype"))||wd(l.getAttribute("enctype"))||zu,s=new FormData(l,e),!Wb()){let{name:c,type:u,value:d}=e;if(u==="image"){let h=c?`${c}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else c&&s.append(c,d)}}else{if(m0(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Uu,n=null,a=zu,i=e}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function yp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Kb(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&Ha(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function Xb(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Jb(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function qb(e,t,r){let n=await Promise.all(e.map(async a=>{let s=t.routes[a.route.id];if(s){let i=await Xb(s,r);return i.links?i.links():[]}return[]}));return tT(n.flat(1).filter(Jb).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function M1(e,t,r,n,a,s){let i=(o,c)=>r[c]?o.route.id!==r[c].route.id:!0,l=(o,c)=>{var u;return r[c].pathname!==o.pathname||((u=r[c].route.path)==null?void 0:u.endsWith("*"))&&r[c].params["*"]!==o.params["*"]};return s==="assets"?t.filter((o,c)=>i(o,c)||l(o,c)):s==="data"?t.filter((o,c)=>{var d;let u=n.routes[o.route.id];if(!u||!u.hasLoader)return!1;if(i(o,c)||l(o,c))return!0;if(o.route.shouldRevalidate){let h=o.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=r[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:o.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function Zb(e,t,{includeHydrateFallback:r}={}){return Qb(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function Qb(e){return[...new Set(e)]}function eT(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function tT(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let s=JSON.stringify(eT(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function Ww(){let e=_.useContext(El);return yp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function rT(){let e=_.useContext(d0);return yp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var wp=_.createContext(void 0);wp.displayName="FrameworkContext";function Gw(){let e=_.useContext(wp);return yp(e,"You must render this element inside a <HydratedRouter> element"),e}function nT(e,t){let r=_.useContext(wp),[n,a]=_.useState(!1),[s,i]=_.useState(!1),{onFocus:l,onBlur:o,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=t,h=_.useRef(null);_.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let x=v=>{v.forEach(w=>{i(w.isIntersecting)})},g=new IntersectionObserver(x,{threshold:.5});return h.current&&g.observe(h.current),()=>{g.disconnect()}}},[e]),_.useEffect(()=>{if(n){let x=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(x)}}},[n]);let p=()=>{a(!0)},m=()=>{a(!1),i(!1)};return r?e!=="intent"?[s,h,{}]:[s,h,{onFocus:Yl(l,p),onBlur:Yl(o,m),onMouseEnter:Yl(c,p),onMouseLeave:Yl(u,m),onTouchStart:Yl(d,p)}]:[!1,h,{}]}function Yl(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function aT({page:e,...t}){let{router:r}=Ww(),n=_.useMemo(()=>Lw(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?_.createElement(iT,{page:e,matches:n,...t}):null}function sT(e){let{manifest:t,routeModules:r}=Gw(),[n,a]=_.useState([]);return _.useEffect(()=>{let s=!1;return qb(e,t,r).then(i=>{s||a(i)}),()=>{s=!0}},[e,t,r]),n}function iT({page:e,matches:t,...r}){let n=mi(),{manifest:a,routeModules:s}=Gw(),{basename:i}=Ww(),{loaderData:l,matches:o}=rT(),c=_.useMemo(()=>M1(e,t,o,a,n,"data"),[e,t,o,a,n]),u=_.useMemo(()=>M1(e,t,o,a,n,"assets"),[e,t,o,a,n]),d=_.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let m=new Set,x=!1;if(t.forEach(v=>{var y;let w=a.routes[v.route.id];!w||!w.hasLoader||(!c.some(k=>k.route.id===v.route.id)&&v.route.id in l&&((y=s[v.route.id])!=null&&y.shouldRevalidate)||w.hasClientLoader?x=!0:m.add(v.route.id))}),m.size===0)return[];let g=Kb(e,i,"data");return x&&m.size>0&&g.searchParams.set("_routes",t.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[g.pathname+g.search]},[i,l,n,a,c,t,e,s]),h=_.useMemo(()=>Zb(u,a),[u,a]),p=sT(u);return _.createElement(_.Fragment,null,d.map(m=>_.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),h.map(m=>_.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),p.map(({key:m,link:x})=>_.createElement("link",{key:m,nonce:r.nonce,...x})))}function lT(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Yw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Yw&&(window.__reactRouterVersion="7.9.3")}catch{}function oT({basename:e,children:t,window:r}){let n=_.useRef();n.current==null&&(n.current=JA({window:r,v5Compat:!0}));let a=n.current,[s,i]=_.useState({action:a.action,location:a.location}),l=_.useCallback(o=>{_.startTransition(()=>i(o))},[i]);return _.useLayoutEffect(()=>a.listen(l),[a,l]),_.createElement(Bb,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:a})}var Kw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xw=_.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,state:l,target:o,to:c,preventScrollReset:u,viewTransition:d,...h},p){let{basename:m}=_.useContext(wa),x=typeof c=="string"&&Kw.test(c),g,v=!1;if(typeof c=="string"&&x&&(g=c,Yw))try{let F=new URL(window.location.href),R=c.startsWith("//")?new URL(F.protocol+c):new URL(c),D=Ha(R.pathname,m);R.origin===F.origin&&D!=null?c=D+R.search+R.hash:v=!0}catch{ga(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=Eb(c,{relative:a}),[y,k,C]=nT(n,h),E=dT(c,{replace:i,state:l,target:o,preventScrollReset:u,relative:a,viewTransition:d});function S(F){t&&t(F),F.defaultPrevented||E(F)}let N=_.createElement("a",{...h,...C,href:g||w,onClick:v||s?t:S,ref:lT(p,k),target:o,"data-discover":!x&&r==="render"?"true":void 0});return y&&!x?_.createElement(_.Fragment,null,N,_.createElement(aT,{page:w})):N});Xw.displayName="Link";var cT=_.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:l,children:o,...c},u){let d=yc(i,{relative:c.relative}),h=mi(),p=_.useContext(d0),{navigator:m,basename:x}=_.useContext(wa),g=p!=null&&gT(d)&&l===!0,v=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,w=h.pathname,y=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;r||(w=w.toLowerCase(),y=y?y.toLowerCase():null,v=v.toLowerCase()),y&&x&&(y=Ha(y,x)||y);const k=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let C=w===v||!a&&w.startsWith(v)&&w.charAt(k)==="/",E=y!=null&&(y===v||!a&&y.startsWith(v)&&y.charAt(v.length)==="/"),S={isActive:C,isPending:E,isTransitioning:g},N=C?t:void 0,F;typeof n=="function"?F=n(S):F=[n,C?"active":null,E?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let R=typeof s=="function"?s(S):s;return _.createElement(Xw,{...c,"aria-current":N,className:F,ref:u,style:R,to:i,viewTransition:l},typeof o=="function"?o(S):o)});cT.displayName="NavLink";var uT=_.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:s,method:i=Uu,action:l,onSubmit:o,relative:c,preventScrollReset:u,viewTransition:d,...h},p)=>{let m=pT(),x=xT(l,{relative:c}),g=i.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&Kw.test(l),w=y=>{if(o&&o(y),y.defaultPrevented)return;y.preventDefault();let k=y.nativeEvent.submitter,C=(k==null?void 0:k.getAttribute("formmethod"))||i;m(k||y.currentTarget,{fetcherKey:t,method:C,navigate:r,replace:a,state:s,relative:c,preventScrollReset:u,viewTransition:d})};return _.createElement("form",{ref:p,method:g,action:x,onSubmit:n?o:w,...h,"data-discover":!v&&e==="render"?"true":void 0})});uT.displayName="Form";function fT(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jw(e){let t=_.useContext(El);return Qt(t,fT(e)),t}function dT(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:i}={}){let l=_b(),o=mi(),c=yc(e,{relative:s});return _.useCallback(u=>{if(Vb(u,t)){u.preventDefault();let d=r!==void 0?r:Ko(o)===Ko(c);l(e,{replace:d,state:n,preventScrollReset:a,relative:s,viewTransition:i})}},[o,l,c,r,n,t,e,a,s,i])}var hT=0,mT=()=>`__${String(++hT)}__`;function pT(){let{router:e}=Jw("useSubmit"),{basename:t}=_.useContext(wa),r=Lb();return _.useCallback(async(n,a={})=>{let{action:s,method:i,encType:l,formData:o,body:c}=Yb(n,t);if(a.navigate===!1){let u=a.fetcherKey||mT();await e.fetch(u,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:o,body:c,formMethod:a.method||i,formEncType:a.encType||l,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:o,body:c,formMethod:a.method||i,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function xT(e,{relative:t}={}){let{basename:r}=_.useContext(wa),n=_.useContext(Wa);Qt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...yc(e||".",{relative:t})},i=mi();if(e==null){s.search=i.search;let l=new URLSearchParams(s.search),o=l.getAll("index");if(o.some(u=>u==="")){l.delete("index"),o.filter(d=>d).forEach(d=>l.append("index",d));let u=l.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:Oa([r,s.pathname])),Ko(s)}function gT(e,{relative:t}={}){let r=_.useContext(zw);Qt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Jw("useViewTransitionState"),a=yc(e,{relative:t});if(!r.isTransitioning)return!1;let s=Ha(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Ha(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Af(a.pathname,i)!=null||Af(a.pathname,s)!=null}function qw(e,t){return function(){return e.apply(t,arguments)}}const{toString:vT}=Object.prototype,{getPrototypeOf:Sp}=Object,{iterator:p0,toStringTag:Zw}=Symbol,x0=(e=>t=>{const r=vT.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Zn=e=>(e=e.toLowerCase(),t=>x0(t)===e),g0=e=>t=>typeof t===e,{isArray:_l}=Array,ml=g0("undefined");function wc(e){return e!==null&&!ml(e)&&e.constructor!==null&&!ml(e.constructor)&&Xr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Qw=Zn("ArrayBuffer");function yT(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Qw(e.buffer),t}const wT=g0("string"),Xr=g0("function"),eS=g0("number"),Sc=e=>e!==null&&typeof e=="object",ST=e=>e===!0||e===!1,Hu=e=>{if(x0(e)!=="object")return!1;const t=Sp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Zw in e)&&!(p0 in e)},kT=e=>{if(!Sc(e)||wc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},ET=Zn("Date"),_T=Zn("File"),NT=Zn("Blob"),AT=Zn("FileList"),bT=e=>Sc(e)&&Xr(e.pipe),TT=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Xr(e.append)&&((t=x0(e))==="formdata"||t==="object"&&Xr(e.toString)&&e.toString()==="[object FormData]"))},CT=Zn("URLSearchParams"),[FT,RT,IT,DT]=["ReadableStream","Request","Response","Headers"].map(Zn),OT=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function kc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),_l(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(wc(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let l;for(n=0;n<i;n++)l=s[n],t.call(null,e[l],l,e)}}function tS(e,t){if(wc(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const zs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,rS=e=>!ml(e)&&e!==zs;function Jh(){const{caseless:e,skipUndefined:t}=rS(this)&&this||{},r={},n=(a,s)=>{const i=e&&tS(r,s)||s;Hu(r[i])&&Hu(a)?r[i]=Jh(r[i],a):Hu(a)?r[i]=Jh({},a):_l(a)?r[i]=a.slice():(!t||!ml(a))&&(r[i]=a)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&kc(arguments[a],n);return r}const LT=(e,t,r,{allOwnKeys:n}={})=>(kc(t,(a,s)=>{r&&Xr(a)?e[s]=qw(a,r):e[s]=a},{allOwnKeys:n}),e),PT=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),jT=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},MT=(e,t,r,n)=>{let a,s,i;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],(!n||n(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=r!==!1&&Sp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},BT=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},UT=e=>{if(!e)return null;if(_l(e))return e;let t=e.length;if(!eS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},zT=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Sp(Uint8Array)),HT=(e,t)=>{const n=(e&&e[p0]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},$T=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},VT=Zn("HTMLFormElement"),WT=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),B1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),GT=Zn("RegExp"),nS=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};kc(r,(a,s)=>{let i;(i=t(a,s,e))!==!1&&(n[s]=i||a)}),Object.defineProperties(e,n)},YT=e=>{nS(e,(t,r)=>{if(Xr(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Xr(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},KT=(e,t)=>{const r={},n=a=>{a.forEach(s=>{r[s]=!0})};return _l(e)?n(e):n(String(e).split(t)),r},XT=()=>{},JT=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function qT(e){return!!(e&&Xr(e.append)&&e[Zw]==="FormData"&&e[p0])}const ZT=e=>{const t=new Array(10),r=(n,a)=>{if(Sc(n)){if(t.indexOf(n)>=0)return;if(wc(n))return n;if(!("toJSON"in n)){t[a]=n;const s=_l(n)?[]:{};return kc(n,(i,l)=>{const o=r(i,a+1);!ml(o)&&(s[l]=o)}),t[a]=void 0,s}}return n};return r(e,0)},QT=Zn("AsyncFunction"),e4=e=>e&&(Sc(e)||Xr(e))&&Xr(e.then)&&Xr(e.catch),aS=((e,t)=>e?setImmediate:t?((r,n)=>(zs.addEventListener("message",({source:a,data:s})=>{a===zs&&s===r&&n.length&&n.shift()()},!1),a=>{n.push(a),zs.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Xr(zs.postMessage)),t4=typeof queueMicrotask<"u"?queueMicrotask.bind(zs):typeof process<"u"&&process.nextTick||aS,r4=e=>e!=null&&Xr(e[p0]),ce={isArray:_l,isArrayBuffer:Qw,isBuffer:wc,isFormData:TT,isArrayBufferView:yT,isString:wT,isNumber:eS,isBoolean:ST,isObject:Sc,isPlainObject:Hu,isEmptyObject:kT,isReadableStream:FT,isRequest:RT,isResponse:IT,isHeaders:DT,isUndefined:ml,isDate:ET,isFile:_T,isBlob:NT,isRegExp:GT,isFunction:Xr,isStream:bT,isURLSearchParams:CT,isTypedArray:zT,isFileList:AT,forEach:kc,merge:Jh,extend:LT,trim:OT,stripBOM:PT,inherits:jT,toFlatObject:MT,kindOf:x0,kindOfTest:Zn,endsWith:BT,toArray:UT,forEachEntry:HT,matchAll:$T,isHTMLForm:VT,hasOwnProperty:B1,hasOwnProp:B1,reduceDescriptors:nS,freezeMethods:YT,toObjectSet:KT,toCamelCase:WT,noop:XT,toFiniteNumber:JT,findKey:tS,global:zs,isContextDefined:rS,isSpecCompliantForm:qT,toJSONObject:ZT,isAsyncFn:QT,isThenable:e4,setImmediate:aS,asap:t4,isIterable:r4};function We(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}ce.inherits(We,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ce.toJSONObject(this.config),code:this.code,status:this.status}}});const sS=We.prototype,iS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{iS[e]={value:e}});Object.defineProperties(We,iS);Object.defineProperty(sS,"isAxiosError",{value:!0});We.from=(e,t,r,n,a,s)=>{const i=Object.create(sS);ce.toFlatObject(e,i,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const l=e&&e.message?e.message:"Error",o=t==null&&e?e.code:t;return We.call(i,l,o,r,n,a),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",s&&Object.assign(i,s),i};const n4=null;function qh(e){return ce.isPlainObject(e)||ce.isArray(e)}function lS(e){return ce.endsWith(e,"[]")?e.slice(0,-2):e}function U1(e,t,r){return e?e.concat(t).map(function(a,s){return a=lS(a),!r&&s?"["+a+"]":a}).join(r?".":""):t}function a4(e){return ce.isArray(e)&&!e.some(qh)}const s4=ce.toFlatObject(ce,{},null,function(t){return/^is[A-Z]/.test(t)});function v0(e,t,r){if(!ce.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ce.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,g){return!ce.isUndefined(g[x])});const n=r.metaTokens,a=r.visitor||u,s=r.dots,i=r.indexes,o=(r.Blob||typeof Blob<"u"&&Blob)&&ce.isSpecCompliantForm(t);if(!ce.isFunction(a))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(ce.isDate(m))return m.toISOString();if(ce.isBoolean(m))return m.toString();if(!o&&ce.isBlob(m))throw new We("Blob is not supported. Use a Buffer instead.");return ce.isArrayBuffer(m)||ce.isTypedArray(m)?o&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,x,g){let v=m;if(m&&!g&&typeof m=="object"){if(ce.endsWith(x,"{}"))x=n?x:x.slice(0,-2),m=JSON.stringify(m);else if(ce.isArray(m)&&a4(m)||(ce.isFileList(m)||ce.endsWith(x,"[]"))&&(v=ce.toArray(m)))return x=lS(x),v.forEach(function(y,k){!(ce.isUndefined(y)||y===null)&&t.append(i===!0?U1([x],k,s):i===null?x:x+"[]",c(y))}),!1}return qh(m)?!0:(t.append(U1(g,x,s),c(m)),!1)}const d=[],h=Object.assign(s4,{defaultVisitor:u,convertValue:c,isVisitable:qh});function p(m,x){if(!ce.isUndefined(m)){if(d.indexOf(m)!==-1)throw Error("Circular reference detected in "+x.join("."));d.push(m),ce.forEach(m,function(v,w){(!(ce.isUndefined(v)||v===null)&&a.call(t,v,ce.isString(w)?w.trim():w,x,h))===!0&&p(v,x?x.concat(w):[w])}),d.pop()}}if(!ce.isObject(e))throw new TypeError("data must be an object");return p(e),t}function z1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function kp(e,t){this._pairs=[],e&&v0(e,this,t)}const oS=kp.prototype;oS.append=function(t,r){this._pairs.push([t,r])};oS.toString=function(t){const r=t?function(n){return t.call(this,n,z1)}:z1;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function i4(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function cS(e,t,r){if(!t)return e;const n=r&&r.encode||i4;ce.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(a?s=a(t,r):s=ce.isURLSearchParams(t)?t.toString():new kp(t,r).toString(n),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class H1{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ce.forEach(this.handlers,function(n){n!==null&&t(n)})}}const uS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},l4=typeof URLSearchParams<"u"?URLSearchParams:kp,o4=typeof FormData<"u"?FormData:null,c4=typeof Blob<"u"?Blob:null,u4={isBrowser:!0,classes:{URLSearchParams:l4,FormData:o4,Blob:c4},protocols:["http","https","file","blob","url","data"]},Ep=typeof window<"u"&&typeof document<"u",Zh=typeof navigator=="object"&&navigator||void 0,f4=Ep&&(!Zh||["ReactNative","NativeScript","NS"].indexOf(Zh.product)<0),d4=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",h4=Ep&&window.location.href||"http://localhost",m4=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ep,hasStandardBrowserEnv:f4,hasStandardBrowserWebWorkerEnv:d4,navigator:Zh,origin:h4},Symbol.toStringTag,{value:"Module"})),Ar={...m4,...u4};function p4(e,t){return v0(e,new Ar.classes.URLSearchParams,{visitor:function(r,n,a,s){return Ar.isNode&&ce.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function x4(e){return ce.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function g4(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}function fS(e){function t(r,n,a,s){let i=r[s++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),o=s>=r.length;return i=!i&&ce.isArray(a)?a.length:i,o?(ce.hasOwnProp(a,i)?a[i]=[a[i],n]:a[i]=n,!l):((!a[i]||!ce.isObject(a[i]))&&(a[i]=[]),t(r,n,a[i],s)&&ce.isArray(a[i])&&(a[i]=g4(a[i])),!l)}if(ce.isFormData(e)&&ce.isFunction(e.entries)){const r={};return ce.forEachEntry(e,(n,a)=>{t(x4(n),a,r,0)}),r}return null}function v4(e,t,r){if(ce.isString(e))try{return(t||JSON.parse)(e),ce.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Ec={transitional:uS,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,s=ce.isObject(t);if(s&&ce.isHTMLForm(t)&&(t=new FormData(t)),ce.isFormData(t))return a?JSON.stringify(fS(t)):t;if(ce.isArrayBuffer(t)||ce.isBuffer(t)||ce.isStream(t)||ce.isFile(t)||ce.isBlob(t)||ce.isReadableStream(t))return t;if(ce.isArrayBufferView(t))return t.buffer;if(ce.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return p4(t,this.formSerializer).toString();if((l=ce.isFileList(t))||n.indexOf("multipart/form-data")>-1){const o=this.env&&this.env.FormData;return v0(l?{"files[]":t}:t,o&&new o,this.formSerializer)}}return s||a?(r.setContentType("application/json",!1),v4(t)):t}],transformResponse:[function(t){const r=this.transitional||Ec.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(ce.isResponse(t)||ce.isReadableStream(t))return t;if(t&&ce.isString(t)&&(n&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(l){if(i)throw l.name==="SyntaxError"?We.from(l,We.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ar.classes.FormData,Blob:Ar.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ce.forEach(["delete","get","head","post","put","patch"],e=>{Ec.headers[e]={}});const y4=ce.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),w4=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),n=i.substring(a+1).trim(),!(!r||t[r]&&y4[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},$1=Symbol("internals");function Kl(e){return e&&String(e).trim().toLowerCase()}function $u(e){return e===!1||e==null?e:ce.isArray(e)?e.map($u):String(e)}function S4(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const k4=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Sd(e,t,r,n,a){if(ce.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!ce.isString(t)){if(ce.isString(n))return t.indexOf(n)!==-1;if(ce.isRegExp(n))return n.test(t)}}function E4(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function _4(e,t){const r=ce.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,s,i){return this[n].call(this,t,a,s,i)},configurable:!0})})}let Jr=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function s(l,o,c){const u=Kl(o);if(!u)throw new Error("header name must be a non-empty string");const d=ce.findKey(a,u);(!d||a[d]===void 0||c===!0||c===void 0&&a[d]!==!1)&&(a[d||o]=$u(l))}const i=(l,o)=>ce.forEach(l,(c,u)=>s(c,u,o));if(ce.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(ce.isString(t)&&(t=t.trim())&&!k4(t))i(w4(t),r);else if(ce.isObject(t)&&ce.isIterable(t)){let l={},o,c;for(const u of t){if(!ce.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[c=u[0]]=(o=l[c])?ce.isArray(o)?[...o,u[1]]:[o,u[1]]:u[1]}i(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=Kl(t),t){const n=ce.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return S4(a);if(ce.isFunction(r))return r.call(this,a,n);if(ce.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Kl(t),t){const n=ce.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Sd(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function s(i){if(i=Kl(i),i){const l=ce.findKey(n,i);l&&(!r||Sd(n,n[l],l,r))&&(delete n[l],a=!0)}}return ce.isArray(t)?t.forEach(s):s(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const s=r[n];(!t||Sd(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const r=this,n={};return ce.forEach(this,(a,s)=>{const i=ce.findKey(n,s);if(i){r[i]=$u(a),delete r[s];return}const l=t?E4(s):String(s).trim();l!==s&&delete r[s],r[l]=$u(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ce.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&ce.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[$1]=this[$1]={accessors:{}}).accessors,a=this.prototype;function s(i){const l=Kl(i);n[l]||(_4(a,i),n[l]=!0)}return ce.isArray(t)?t.forEach(s):s(t),this}};Jr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ce.reduceDescriptors(Jr.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});ce.freezeMethods(Jr);function kd(e,t){const r=this||Ec,n=t||r,a=Jr.from(n.headers);let s=n.data;return ce.forEach(e,function(l){s=l.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function dS(e){return!!(e&&e.__CANCEL__)}function Nl(e,t,r){We.call(this,e??"canceled",We.ERR_CANCELED,t,r),this.name="CanceledError"}ce.inherits(Nl,We,{__CANCEL__:!0});function hS(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new We("Request failed with status code "+r.status,[We.ERR_BAD_REQUEST,We.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function N4(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function A4(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,s=0,i;return t=t!==void 0?t:1e3,function(o){const c=Date.now(),u=n[s];i||(i=c),r[a]=o,n[a]=c;let d=s,h=0;for(;d!==a;)h+=r[d++],d=d%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),c-i<t)return;const p=u&&c-u;return p?Math.round(h*1e3/p):void 0}}function b4(e,t){let r=0,n=1e3/t,a,s;const i=(c,u=Date.now())=>{r=u,a=null,s&&(clearTimeout(s),s=null),e(...c)};return[(...c)=>{const u=Date.now(),d=u-r;d>=n?i(c,u):(a=c,s||(s=setTimeout(()=>{s=null,i(a)},n-d)))},()=>a&&i(a)]}const bf=(e,t,r=3)=>{let n=0;const a=A4(50,250);return b4(s=>{const i=s.loaded,l=s.lengthComputable?s.total:void 0,o=i-n,c=a(o),u=i<=l;n=i;const d={loaded:i,total:l,progress:l?i/l:void 0,bytes:o,rate:c||void 0,estimated:c&&l&&u?(l-i)/c:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(d)},r)},V1=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},W1=e=>(...t)=>ce.asap(()=>e(...t)),T4=Ar.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Ar.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Ar.origin),Ar.navigator&&/(msie|trident)/i.test(Ar.navigator.userAgent)):()=>!0,C4=Ar.hasStandardBrowserEnv?{write(e,t,r,n,a,s){const i=[e+"="+encodeURIComponent(t)];ce.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),ce.isString(n)&&i.push("path="+n),ce.isString(a)&&i.push("domain="+a),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function F4(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function R4(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function mS(e,t,r){let n=!F4(t);return e&&(n||r==!1)?R4(e,t):t}const G1=e=>e instanceof Jr?{...e}:e;function ai(e,t){t=t||{};const r={};function n(c,u,d,h){return ce.isPlainObject(c)&&ce.isPlainObject(u)?ce.merge.call({caseless:h},c,u):ce.isPlainObject(u)?ce.merge({},u):ce.isArray(u)?u.slice():u}function a(c,u,d,h){if(ce.isUndefined(u)){if(!ce.isUndefined(c))return n(void 0,c,d,h)}else return n(c,u,d,h)}function s(c,u){if(!ce.isUndefined(u))return n(void 0,u)}function i(c,u){if(ce.isUndefined(u)){if(!ce.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function l(c,u,d){if(d in t)return n(c,u);if(d in e)return n(void 0,c)}const o={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(c,u,d)=>a(G1(c),G1(u),d,!0)};return ce.forEach(Object.keys({...e,...t}),function(u){const d=o[u]||a,h=d(e[u],t[u],u);ce.isUndefined(h)&&d!==l||(r[u]=h)}),r}const pS=e=>{const t=ai({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:i,auth:l}=t;if(t.headers=i=Jr.from(i),t.url=cS(mS(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ce.isFormData(r)){if(Ar.hasStandardBrowserEnv||Ar.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(ce.isFunction(r.getHeaders)){const o=r.getHeaders(),c=["content-type","content-length"];Object.entries(o).forEach(([u,d])=>{c.includes(u.toLowerCase())&&i.set(u,d)})}}if(Ar.hasStandardBrowserEnv&&(n&&ce.isFunction(n)&&(n=n(t)),n||n!==!1&&T4(t.url))){const o=a&&s&&C4.read(s);o&&i.set(a,o)}return t},I4=typeof XMLHttpRequest<"u",D4=I4&&function(e){return new Promise(function(r,n){const a=pS(e);let s=a.data;const i=Jr.from(a.headers).normalize();let{responseType:l,onUploadProgress:o,onDownloadProgress:c}=a,u,d,h,p,m;function x(){p&&p(),m&&m(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function v(){if(!g)return;const y=Jr.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),C={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:y,config:e,request:g};hS(function(S){r(S),x()},function(S){n(S),x()},C),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(n(new We("Request aborted",We.ECONNABORTED,e,g)),g=null)},g.onerror=function(k){const C=k&&k.message?k.message:"Network Error",E=new We(C,We.ERR_NETWORK,e,g);E.event=k||null,n(E),g=null},g.ontimeout=function(){let k=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const C=a.transitional||uS;a.timeoutErrorMessage&&(k=a.timeoutErrorMessage),n(new We(k,C.clarifyTimeoutError?We.ETIMEDOUT:We.ECONNABORTED,e,g)),g=null},s===void 0&&i.setContentType(null),"setRequestHeader"in g&&ce.forEach(i.toJSON(),function(k,C){g.setRequestHeader(C,k)}),ce.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),l&&l!=="json"&&(g.responseType=a.responseType),c&&([h,m]=bf(c,!0),g.addEventListener("progress",h)),o&&g.upload&&([d,p]=bf(o),g.upload.addEventListener("progress",d),g.upload.addEventListener("loadend",p)),(a.cancelToken||a.signal)&&(u=y=>{g&&(n(!y||y.type?new Nl(null,e,g):y),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const w=N4(a.url);if(w&&Ar.protocols.indexOf(w)===-1){n(new We("Unsupported protocol "+w+":",We.ERR_BAD_REQUEST,e));return}g.send(s||null)})},O4=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const s=function(c){if(!a){a=!0,l();const u=c instanceof Error?c:this.reason;n.abort(u instanceof We?u:new Nl(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,s(new We(`timeout ${t} of ms exceeded`,We.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:o}=n;return o.unsubscribe=()=>ce.asap(l),o}},L4=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},P4=async function*(e,t){for await(const r of j4(e))yield*L4(r,t)},j4=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Y1=(e,t,r,n)=>{const a=P4(e,t);let s=0,i,l=o=>{i||(i=!0,n&&n(o))};return new ReadableStream({async pull(o){try{const{done:c,value:u}=await a.next();if(c){l(),o.close();return}let d=u.byteLength;if(r){let h=s+=d;r(h)}o.enqueue(new Uint8Array(u))}catch(c){throw l(c),c}},cancel(o){return l(o),a.return()}},{highWaterMark:2})},K1=64*1024,{isFunction:cu}=ce,M4=(({Request:e,Response:t})=>({Request:e,Response:t}))(ce.global),{ReadableStream:X1,TextEncoder:J1}=ce.global,q1=(e,...t)=>{try{return!!e(...t)}catch{return!1}},B4=e=>{e=ce.merge.call({skipUndefined:!0},M4,e);const{fetch:t,Request:r,Response:n}=e,a=t?cu(t):typeof fetch=="function",s=cu(r),i=cu(n);if(!a)return!1;const l=a&&cu(X1),o=a&&(typeof J1=="function"?(m=>x=>m.encode(x))(new J1):async m=>new Uint8Array(await new r(m).arrayBuffer())),c=s&&l&&q1(()=>{let m=!1;const x=new r(Ar.origin,{body:new X1,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!x}),u=i&&l&&q1(()=>ce.isReadableStream(new n("").body)),d={stream:u&&(m=>m.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!d[m]&&(d[m]=(x,g)=>{let v=x&&x[m];if(v)return v.call(x);throw new We(`Response type '${m}' is not supported`,We.ERR_NOT_SUPPORT,g)})});const h=async m=>{if(m==null)return 0;if(ce.isBlob(m))return m.size;if(ce.isSpecCompliantForm(m))return(await new r(Ar.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(ce.isArrayBufferView(m)||ce.isArrayBuffer(m))return m.byteLength;if(ce.isURLSearchParams(m)&&(m=m+""),ce.isString(m))return(await o(m)).byteLength},p=async(m,x)=>{const g=ce.toFiniteNumber(m.getContentLength());return g??h(x)};return async m=>{let{url:x,method:g,data:v,signal:w,cancelToken:y,timeout:k,onDownloadProgress:C,onUploadProgress:E,responseType:S,headers:N,withCredentials:F="same-origin",fetchOptions:R}=pS(m),D=t||fetch;S=S?(S+"").toLowerCase():"text";let T=O4([w,y&&y.toAbortSignal()],k),j=null;const Z=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let re;try{if(E&&c&&g!=="get"&&g!=="head"&&(re=await p(N,v))!==0){let te=new r(x,{method:"POST",body:v,duplex:"half"}),b;if(ce.isFormData(v)&&(b=te.headers.get("content-type"))&&N.setContentType(b),te.body){const[A,O]=V1(re,bf(W1(E)));v=Y1(te.body,K1,A,O)}}ce.isString(F)||(F=F?"include":"omit");const W=s&&"credentials"in r.prototype,Q={...R,signal:T,method:g.toUpperCase(),headers:N.normalize().toJSON(),body:v,duplex:"half",credentials:W?F:void 0};j=s&&new r(x,Q);let H=await(s?D(j,R):D(x,Q));const L=u&&(S==="stream"||S==="response");if(u&&(C||L&&Z)){const te={};["status","statusText","headers"].forEach(P=>{te[P]=H[P]});const b=ce.toFiniteNumber(H.headers.get("content-length")),[A,O]=C&&V1(b,bf(W1(C),!0))||[];H=new n(Y1(H.body,K1,A,()=>{O&&O(),Z&&Z()}),te)}S=S||"text";let ee=await d[ce.findKey(d,S)||"text"](H,m);return!L&&Z&&Z(),await new Promise((te,b)=>{hS(te,b,{data:ee,headers:Jr.from(H.headers),status:H.status,statusText:H.statusText,config:m,request:j})})}catch(W){throw Z&&Z(),W&&W.name==="TypeError"&&/Load failed|fetch/i.test(W.message)?Object.assign(new We("Network Error",We.ERR_NETWORK,m,j),{cause:W.cause||W}):We.from(W,W&&W.code,m,j)}}},U4=new Map,xS=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:a}=t,s=[n,a,r];let i=s.length,l=i,o,c,u=U4;for(;l--;)o=s[l],c=u.get(o),c===void 0&&u.set(o,c=l?new Map:B4(t)),u=c;return c};xS();const Qh={http:n4,xhr:D4,fetch:{get:xS}};ce.forEach(Qh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Z1=e=>`- ${e}`,z4=e=>ce.isFunction(e)||e===null||e===!1,gS={getAdapter:(e,t)=>{e=ce.isArray(e)?e:[e];const{length:r}=e;let n,a;const s={};for(let i=0;i<r;i++){n=e[i];let l;if(a=n,!z4(n)&&(a=Qh[(l=String(n)).toLowerCase()],a===void 0))throw new We(`Unknown adapter '${l}'`);if(a&&(ce.isFunction(a)||(a=a.get(t))))break;s[l||"#"+i]=a}if(!a){const i=Object.entries(s).map(([o,c])=>`adapter ${o} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=r?i.length>1?`since :
`+i.map(Z1).join(`
`):" "+Z1(i[0]):"as no adapter specified";throw new We("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a},adapters:Qh};function Ed(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Nl(null,e)}function Q1(e){return Ed(e),e.headers=Jr.from(e.headers),e.data=kd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),gS.getAdapter(e.adapter||Ec.adapter,e)(e).then(function(n){return Ed(e),n.data=kd.call(e,e.transformResponse,n),n.headers=Jr.from(n.headers),n},function(n){return dS(n)||(Ed(e),n&&n.response&&(n.response.data=kd.call(e,e.transformResponse,n.response),n.response.headers=Jr.from(n.response.headers))),Promise.reject(n)})}const vS="1.12.2",y0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{y0[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const eg={};y0.transitional=function(t,r,n){function a(s,i){return"[Axios v"+vS+"] Transitional option '"+s+"'"+i+(n?". "+n:"")}return(s,i,l)=>{if(t===!1)throw new We(a(i," has been removed"+(r?" in "+r:"")),We.ERR_DEPRECATED);return r&&!eg[i]&&(eg[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,i,l):!0}};y0.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function H4(e,t,r){if(typeof e!="object")throw new We("options must be an object",We.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],i=t[s];if(i){const l=e[s],o=l===void 0||i(l,s,e);if(o!==!0)throw new We("option "+s+" must be "+o,We.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new We("Unknown option "+s,We.ERR_BAD_OPTION)}}const Vu={assertOptions:H4,validators:y0},ra=Vu.validators;let Ws=class{constructor(t){this.defaults=t||{},this.interceptors={request:new H1,response:new H1}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ai(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:s}=r;n!==void 0&&Vu.assertOptions(n,{silentJSONParsing:ra.transitional(ra.boolean),forcedJSONParsing:ra.transitional(ra.boolean),clarifyTimeoutError:ra.transitional(ra.boolean)},!1),a!=null&&(ce.isFunction(a)?r.paramsSerializer={serialize:a}:Vu.assertOptions(a,{encode:ra.function,serialize:ra.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Vu.assertOptions(r,{baseUrl:ra.spelling("baseURL"),withXsrfToken:ra.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=s&&ce.merge(s.common,s[r.method]);s&&ce.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),r.headers=Jr.concat(i,s);const l=[];let o=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(o=o&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const c=[];this.interceptors.response.forEach(function(x){c.push(x.fulfilled,x.rejected)});let u,d=0,h;if(!o){const m=[Q1.bind(this),void 0];for(m.unshift(...l),m.push(...c),h=m.length,u=Promise.resolve(r);d<h;)u=u.then(m[d++],m[d++]);return u}h=l.length;let p=r;for(;d<h;){const m=l[d++],x=l[d++];try{p=m(p)}catch(g){x.call(this,g);break}}try{u=Q1.call(this,p)}catch(m){return Promise.reject(m)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(t){t=ai(this.defaults,t);const r=mS(t.baseURL,t.url,t.allowAbsoluteUrls);return cS(r,t.params,t.paramsSerializer)}};ce.forEach(["delete","get","head","options"],function(t){Ws.prototype[t]=function(r,n){return this.request(ai(n||{},{method:t,url:r,data:(n||{}).data}))}});ce.forEach(["post","put","patch"],function(t){function r(n){return function(s,i,l){return this.request(ai(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}Ws.prototype[t]=r(),Ws.prototype[t+"Form"]=r(!0)});let $4=class yS{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const i=new Promise(l=>{n.subscribe(l),s=l}).then(a);return i.cancel=function(){n.unsubscribe(s)},i},t(function(s,i,l){n.reason||(n.reason=new Nl(s,i,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new yS(function(a){t=a}),cancel:t}}};function V4(e){return function(r){return e.apply(null,r)}}function W4(e){return ce.isObject(e)&&e.isAxiosError===!0}const em={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(em).forEach(([e,t])=>{em[t]=e});function wS(e){const t=new Ws(e),r=qw(Ws.prototype.request,t);return ce.extend(r,Ws.prototype,t,{allOwnKeys:!0}),ce.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return wS(ai(e,a))},r}const Mt=wS(Ec);Mt.Axios=Ws;Mt.CanceledError=Nl;Mt.CancelToken=$4;Mt.isCancel=dS;Mt.VERSION=vS;Mt.toFormData=v0;Mt.AxiosError=We;Mt.Cancel=Mt.CanceledError;Mt.all=function(t){return Promise.all(t)};Mt.spread=V4;Mt.isAxiosError=W4;Mt.mergeConfig=ai;Mt.AxiosHeaders=Jr;Mt.formToJSON=e=>fS(ce.isHTMLForm(e)?new FormData(e):e);Mt.getAdapter=gS.getAdapter;Mt.HttpStatusCode=em;Mt.default=Mt;const{Axios:Z9,AxiosError:Q9,CanceledError:eU,isCancel:tU,CancelToken:rU,VERSION:nU,all:aU,Cancel:sU,isAxiosError:iU,spread:lU,toFormData:oU,AxiosHeaders:cU,HttpStatusCode:uU,formToJSON:fU,getAdapter:dU,mergeConfig:hU}=Mt,tm="authToken",_p=()=>{if(typeof window>"u")return null;try{return localStorage.getItem(tm)}catch{return null}},Gs=e=>{if(!(typeof window>"u"))try{e?localStorage.setItem(tm,e):localStorage.removeItem(tm)}catch{}},SS="https://hastane15.onrender.com/api/auth".replace(/\/$/,""),G4=SS.replace(/\/?api\/auth$/,"/api"),kS=e=>(e.interceptors.request.use(t=>{const r=_p();return r&&(t.headers.Authorization=`Bearer ${r}`),t}),e),La=kS(Mt.create({baseURL:SS,withCredentials:!0}));kS(Mt.create({baseURL:G4,withCredentials:!0}));const Y4=e=>La.post("/password/request-reset",{email:e}).then(t=>t.data),K4=(e,t)=>La.post("/password/reset",{token:e,password:t}).then(r=>r.data),ES=_.createContext(null);function X4({children:e}){const[t,r]=_.useState(null),[n,a]=_.useState(!1),o={user:t,loading:n,login:async({identifier:c,email:u,password:d})=>{var h,p;a(!0);try{const m=await La.post("/login",{identifier:c||u,password:d});return(h=m.data)!=null&&h.token&&Gs(m.data.token),r(((p=m.data)==null?void 0:p.user)??null),m.data}finally{a(!1)}},register:async({name:c,email:u,password:d})=>{var h,p;a(!0);try{const m=await La.post("/register",{name:c,email:u,password:d});return(h=m.data)!=null&&h.token&&Gs(m.data.token),r(((p=m.data)==null?void 0:p.user)??null),m.data}finally{a(!1)}},logout:async()=>{await La.post("/logout").catch(()=>{}),Gs(""),r(null)}};return f.jsx(ES.Provider,{value:o,children:e})}function pi(){const e=_.useContext(ES);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_S=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var q4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=_.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...l},o)=>_.createElement("svg",{ref:o,...q4,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:_S("lucide",a),...l},[...i.map(([c,u])=>_.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=(e,t)=>{const r=_.forwardRef(({className:n,...a},s)=>_.createElement(Z4,{ref:s,iconNode:t,className:_S(`lucide-${J4(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=Ut("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=Ut("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NS=Ut("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=Ut("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ap=Ut("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=Ut("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rC=Ut("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=Ut("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=Ut("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=Ut("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=Ut("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iC=Ut("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=Ut("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=Ut("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=Ut("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=Ut("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=Ut("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=Ut("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=Ut("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=Ut("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dC=Ut("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=Ut("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);class mC extends Mr.Component{constructor(t){super(t),this.state={hasError:!1,err:null}}static getDerivedStateFromError(t){return{hasError:!0,err:t}}componentDidCatch(t,r){}render(){var t;return this.state.hasError?f.jsxs("div",{className:"p-4 m-4 rounded-xl border bg-red-50 text-red-800",children:[f.jsx("div",{className:"font-semibold mb-1",children:"Bir eyler ters gitti."}),f.jsx("div",{className:"text-sm opacity-80",children:String(((t=this.state.err)==null?void 0:t.message)||this.state.err||"Bilinmeyen hata")})]}):this.props.children}}const pC=e=>String(e).padStart(2,"0"),xC=(e,t)=>`${Number(e)}-${pC(Number(t))}`,Fe={get(e,t=null){try{const r=localStorage.getItem(e);return r==null?t:JSON.parse(r)}catch{return t}},set(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}},remove(e){try{localStorage.removeItem(e)}catch{}}},CS="services:model:v1";function Ni(){try{const e=localStorage.getItem(CS);return e?JSON.parse(e):{items:[]}}catch{return{items:[]}}}function Xl(e){localStorage.setItem(CS,JSON.stringify(e))}function Is(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"id_"+Math.random().toString(36).slice(2)+Date.now().toString(36)}function w0(){return{list:()=>Ni().items,add:i=>{const l=Ni(),o={id:Is(),name:i.name??"Yeni Servis",code:(i.code??"YENI_SERVIS").toUpperCase(),active:i.active!==!1};return l.items.push(o),Xl(l),o},update:(i,l)=>{var u;const o=Ni(),c=o.items.findIndex(d=>d.id===i);c!==-1&&(o.items[c]={...o.items[c],...l,code:(u=l.code??o.items[c].code)==null?void 0:u.toUpperCase()},Xl(o))},toggle:i=>{const l=Ni(),o=l.items.find(c=>c.id===i);o&&(o.active=!o.active,Xl(l))},remove:i=>{const l=Ni();l.items=l.items.filter(o=>o.id!==i),Xl(l)},seed:()=>{const i=Ni();i.items.length||(i.items=[{id:Is(),name:"Kardiyoloji",code:"KARDIYOLOJI",active:!0},{id:Is(),name:"Genel Cerrahi",code:"GENEL_CERRAHI",active:!0},{id:Is(),name:"Acil Servis",code:"ACIL",active:!0},{id:Is(),name:"Radyoloji",code:"RADYOLOJI",active:!0},{id:Is(),name:"Biyokimya Lab.",code:"BIYOKIMYA",active:!0},{id:Is(),name:"Ortopedi",code:"ORTOPEDI",active:!0}],Xl(i))}}}function FS(){const{user:e}=pi(),t=w0(),r=String((e==null?void 0:e.role)||"").toUpperCase()==="ADMIN",n=_.useMemo(()=>{var o;return r?(((o=t.list)==null?void 0:o.call(t))||[]).map(c=>String(c.id??c._id??c.code??c.name)):((e==null?void 0:e.serviceIds)||[]).map(String)},[r,t,e]),a=_.useMemo(()=>{var c;const o=new Map;return(((c=t.list)==null?void 0:c.call(t))||[]).forEach(u=>{const d=String(u.id??u._id??u.code??u.name);o.set(d,u)}),o},[t]),s=_.useMemo(()=>r?"":n[0]||"",[r,n]),i=o=>String((o==null?void 0:o.serviceId)??(o==null?void 0:o.service)??(o==null?void 0:o.serviceCode)??(o==null?void 0:o.service_id)??(o==null?void 0:o.departmentId)??(o==null?void 0:o.sectionId)??"");function l(o){if(r)return o||[];const c=new Set(n);return(o||[]).filter(u=>c.has(i(u)))}return{isAdmin:r,allowedIds:n,defaultServiceId:s,servicesById:a,getServiceId:i,filterByScope:l}}const tg=e=>{let t;const r=new Set,n=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),r.forEach(p=>p(t,h))}},a=()=>t,l={setState:n,getState:a,getInitialState:()=>o,subscribe:c=>(r.add(c),()=>r.delete(c))},o=t=e(n,a,l);return l},gC=e=>e?tg(e):tg,vC=e=>e;function yC(e,t=vC){const r=Mr.useSyncExternalStore(e.subscribe,Mr.useCallback(()=>t(e.getState()),[e,t]),Mr.useCallback(()=>t(e.getInitialState()),[e,t]));return Mr.useDebugValue(r),r}const rg=e=>{const t=gC(e),r=n=>yC(t,n);return Object.assign(r,t),r},wC=e=>e?rg(e):rg;function RS(e,t){let r;try{r=e()}catch{return}return{getItem:a=>{var s;const i=o=>o===null?null:JSON.parse(o,void 0),l=(s=r.getItem(a))!=null?s:null;return l instanceof Promise?l.then(i):i(l)},setItem:(a,s)=>r.setItem(a,JSON.stringify(s,void 0)),removeItem:a=>r.removeItem(a)}}const rm=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return rm(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return rm(n)(r)}}}},SC=(e,t)=>(r,n,a)=>{let s={storage:RS(()=>localStorage),partialize:x=>x,version:0,merge:(x,g)=>({...g,...x}),...t},i=!1;const l=new Set,o=new Set;let c=s.storage;if(!c)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...x)},n,a);const u=()=>{const x=s.partialize({...n()});return c.setItem(s.name,{state:x,version:s.version})},d=a.setState;a.setState=(x,g)=>(d(x,g),u());const h=e((...x)=>(r(...x),u()),n,a);a.getInitialState=()=>h;let p;const m=()=>{var x,g;if(!c)return;i=!1,l.forEach(w=>{var y;return w((y=n())!=null?y:h)});const v=((g=s.onRehydrateStorage)==null?void 0:g.call(s,(x=n())!=null?x:h))||void 0;return rm(c.getItem.bind(c))(s.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==s.version){if(s.migrate){const y=s.migrate(w.state,w.version);return y instanceof Promise?y.then(k=>[!0,k]):[!0,y]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var y;const[k,C]=w;if(p=s.merge(C,(y=n())!=null?y:h),r(p,!0),k)return u()}).then(()=>{v==null||v(p,void 0),p=n(),i=!0,o.forEach(w=>w(p))}).catch(w=>{v==null||v(void 0,w)})};return a.persist={setOptions:x=>{s={...s,...x},x.storage&&(c=x.storage)},clearStorage:()=>{c==null||c.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:x=>(l.add(x),()=>{l.delete(x)}),onFinishHydration:x=>(o.add(x),()=>{o.delete(x)})},s.skipHydration||m(),p||h},kC=SC;function IS(){const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1}}const EC={ym:IS(),personnelById:{},rulesById:{},shiftsById:{},leaveTypesById:{},leavesByPerson:{},shiftCodeHours:{}},Ds=wC(kC((e,t)=>({...EC,setYM:r=>{const n=Number(r==null?void 0:r.year),a=Number(r==null?void 0:r.month);!Number.isFinite(n)||!Number.isFinite(a)||a<1||a>12||e({ym:{year:n,month:a}})},gotoPrev:()=>{const{year:r,month:n}=t().ym,a=new Date(r,n-2,1);e({ym:{year:a.getFullYear(),month:a.getMonth()+1}})},gotoNext:()=>{const{year:r,month:n}=t().ym,a=new Date(r,n,1);e({ym:{year:a.getFullYear(),month:a.getMonth()+1}})},gotoToday:()=>e({ym:IS()}),upsertPersonnel:r=>e(n=>{const a={...n.personnelById};return(r||[]).forEach(s=>{const i=s.id||_d();a[i]={...s,id:i}}),{personnelById:a}}),removePersonnel:r=>e(n=>{const a={...n.personnelById};return delete a[r],{personnelById:a}}),setShiftCodeHours:r=>e(()=>{const n={};return(r||[]).forEach(a=>{if(!(a!=null&&a.code))return;const s=String(a.code).trim().toUpperCase();let i=0;if(a.hours!==void 0&&a.hours!==null&&String(a.hours).trim()!==""){const l=Number(a.hours);i=isNaN(l)?0:l}else a.start&&a.end&&(i=_C(a.start,a.end));n[s]=i}),{shiftCodeHours:n}}),setLeavesForPersonMonth:(r,n)=>e(a=>({leavesByPerson:{...a.leavesByPerson,[r]:Array.isArray(n)?n:[]}})),upsertRules:r=>e(n=>{const a={...n.rulesById};return(r||[]).forEach(s=>{const i=s.id||_d();a[i]={...s,id:i}}),{rulesById:a}}),upsertLeaveTypes:r=>e(n=>{const a={...n.leaveTypesById};return(r||[]).forEach(s=>{const i=s.id||_d();a[i]={id:i,code:s.code,name:s.name}}),{leaveTypesById:a}})}),{name:"appStoreV1",storage:RS(()=>localStorage),version:1}));function _d(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function ng(e){if(!e)return null;const t=String(e).match(/^(\d{1,2}):(\d{2})$/);if(!t)return null;const r=+t[1],n=+t[2];return r<0||r>29||n<0||n>59?null:r*60+n}function _C(e,t){const r=ng(e),n=ng(t);if(r==null||n==null)return 0;let a=n-r;return a<0&&(a+=24*60),Math.round(a/60*100)/100}const ag="activeYM.year",sg="activeYM.month",ig="plannerYear",lg="plannerMonth",og="plannerMonth1";function cg(e){const t=Number(e);return Number.isFinite(t)&&t>=1&&t<=12?Math.trunc(t):null}function NC(e){const t=Number(e);return Number.isFinite(t)?t>=0&&t<=11?t+1:t>=1&&t<=12?t:null:null}function ug(){const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1}}function _c(e={syncLegacyLS:!0}){const t=Ds(o=>o.ym),r=Ds(o=>o.setYM),n=Ds(o=>o.gotoPrev),a=Ds(o=>o.gotoNext),s=Ds(o=>o.gotoToday),i=_.useCallback(o=>{const c=Ds.getState().ym;r({year:Number(o),month:c.month})},[r]),l=_.useCallback(o=>{const c=Ds.getState().ym;r({year:c.year,month:Number(o)})},[r]);return _.useEffect(()=>{if(e!=null&&e.syncLegacyLS)try{const o=Number(localStorage.getItem(ag)),c=cg(localStorage.getItem(sg)),u=Number.isFinite(o)?o:Number(localStorage.getItem(ig)),d=cg(localStorage.getItem(og)),h=NC(localStorage.getItem(lg));let p=Number.isFinite(u)?u:ug().year,m=c??d??h??ug().month;(p!==t.year||m!==t.month)&&r({year:p,month:m})}catch{}},[]),_.useEffect(()=>{if(e!=null&&e.syncLegacyLS)try{const{year:o,month:c}=t;localStorage.setItem(ag,String(o)),localStorage.setItem(sg,String(c)),localStorage.setItem(ig,String(o)),localStorage.setItem(og,String(c)),localStorage.setItem(lg,String(c-1)),window.__activeYM={year:o,month:c,month0:c-1},window.dispatchEvent(new Event("storage")),window.dispatchEvent(new CustomEvent("activeYM:changed",{detail:{year:o,month:c,month0:c-1}}))}catch{}},[t.year,t.month,e==null?void 0:e.syncLegacyLS]),{ym:t,setYM:r,setYear:i,setMonth:l,gotoPrev:n,gotoNext:a,gotoToday:s}}const nm="allLeavesByNameV1",DS="leaveSuppressV1";let io=null;function Nc(){io=null}typeof window<"u"&&typeof window.addEventListener=="function"&&window.addEventListener("leaves:changed",Nc);function AC(e){return(e||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(//g,"G").replace(//g,"U").replace(//g,"S").replace(//g,"I").replace(//g,"O").replace(//g,"C").replace(//g,"g").replace(//g,"u").replace(//g,"s").replace(//g,"i").replace(//g,"o").replace(//g,"c")}const Tp=e=>AC((e||"").toString().trim().toLocaleUpperCase("tr-TR")).replace(/\s+/g," ").trim(),Al=(e,t)=>`${e}-${String(t).padStart(2,"0")}`,bn=e=>e&&typeof e=="object"&&!Array.isArray(e),ys=e=>Number.isFinite(Number(e))?Number(e):NaN;function na(e,t,r,n,a,s){const i=Al(r,n);e[t]||(e[t]={}),e[t][i]||(e[t][i]={});const l=bn(s)?s:{code:String(s||"").trim()};l.code&&(e[t][i][String(a)]={code:l.code,...l.note?{note:l.note}:{}})}function bC(){var t;if(io)return io;const e={};for(const r of["personLeavesV2","personLeaves","allLeaves"])try{const n=Fe.get(r);if(!bn(n))continue;const a=(t=Object.keys(n)[0])==null?void 0:t.includes("-"),s=!a;if(a)for(const[i,l]of Object.entries(n)){const[o,c]=i.split("-").map(u=>parseInt(u,10));for(const[u,d]of Object.entries(l||{}))for(const[h,p]of Object.entries(d||{})){const m=parseInt(h,10);if(Number.isFinite(m))na(e,String(u),o,c,m,p);else if(/^\d{4}-\d{2}-\d{2}$/.test(h)){const x=parseInt(h.slice(8,10),10);Number.isFinite(x)&&na(e,String(u),o,c,x,p)}}}else if(s){const i=n[Object.keys(n)[0]];if(i&&Object.keys(i).some(o=>/^\d{4}$/.test(o)))for(const[o,c]of Object.entries(n))for(const[u,d]of Object.entries(c||{}))for(const[h,p]of Object.entries(d||{})){const m=parseInt(u,10),x=parseInt(h,10);for(const[g,v]of Object.entries(p||{})){const w=parseInt(g,10);Number.isFinite(w)&&na(e,String(o),m,x,w,v)}}else for(const[o,c]of Object.entries(n))for(const[u,d]of Object.entries(c||{})){const[h,p]=u.split("-").map(m=>parseInt(m,10));for(const[m,x]of Object.entries(d||{})){const g=parseInt(m,10);if(Number.isFinite(g))na(e,String(o),h,p,g,x);else if(/^\d{4}-\d{2}-\d{2}$/.test(m)){const v=parseInt(m.slice(8,10),10);Number.isFinite(v)&&na(e,String(o),h,p,v,x)}}}}}catch{}try{const r=Fe.get("leavesV2");if(bn(r))for(const[n,a]of Object.entries(r))for(const[s,i]of Object.entries(a||{})){const[l,o]=s.split("-").map(c=>parseInt(c,10));for(const[c,u]of Object.entries(i||{})){const d=parseInt(c,10);if(Number.isFinite(d))na(e,String(n),l,o,d,u);else if(/^\d{2}$/.test(c))na(e,String(n),l,o,parseInt(c,10),u);else if(/^\d{4}-\d{2}-\d{2}$/.test(c)){const h=parseInt(c.slice(8,10),10);Number.isFinite(h)&&na(e,String(n),l,o,h,u)}}}}catch{}try{const r=Fe.get("allLeavesV1");if(bn(r))for(const[n,a]of Object.entries(r))for(const[s,i]of Object.entries(a||{})){const[l,o]=s.split("-").map(c=>parseInt(c,10));for(const[c,u]of Object.entries(i||{})){const d=parseInt(c,10);if(Number.isFinite(d))na(e,String(n),l,o,d,u);else if(/^\d{4}-\d{2}-\d{2}$/.test(c)){const h=parseInt(c.slice(8,10),10);Number.isFinite(h)&&na(e,String(n),l,o,h,u)}}}}catch{}try{const r=S0(),n=r!=null&&r.ids&&bn(r.ids)?r.ids:null;if(n)for(const[a,s]of Object.entries(n)){const i=e[a];if(bn(i)){for(const[l,o]of Object.entries(s||{})){const c=i==null?void 0:i[l];if(bn(c)){for(const u of Object.keys(o||{}))delete c[u];Object.keys(c).length||delete i[l]}}Object.keys(i).length||delete e[a]}}}catch{}return io=e,io}function $a(){return bC()}function S0(){return Fe.get(DS,{ids:{},canon:{}})||{ids:{},canon:{}}}function TC(e){Fe.set(DS,e),Nc()}function OS(){return S0()}function LS({canon:e,year:t,month:r,day:n,rec:a}){var l;if(!e)return;const s=Fe.get(nm,{}),i=Al(t,r);s[e]??(s[e]={}),(l=s[e])[i]??(l[i]={}),a?s[e][i][String(n)]=a:delete s[e][i][String(n)],s[e][i]&&!Object.keys(s[e][i]).length&&delete s[e][i],s[e]&&!Object.keys(s[e]).length&&delete s[e],Fe.set(nm,s),Nc()}function PS({pid:e,canon:t,year:r,month:n,day:a,suppress:s}){var o,c,u,d;const i=S0(),l=Al(r,n);e&&((o=i.ids)[e]??(o[e]={}),(c=i.ids[e])[l]??(c[l]={}),s?i.ids[e][l][String(a)]=!0:(delete i.ids[e][l][String(a)],Object.keys(i.ids[e][l]).length||delete i.ids[e][l],Object.keys(i.ids[e]||{}).length||delete i.ids[e])),t&&((u=i.canon)[t]??(u[t]={}),(d=i.canon[t])[l]??(d[l]={}),s?i.canon[t][l][String(a)]=!0:(delete i.canon[t][l][String(a)],Object.keys(i.canon[t][l]).length||delete i.canon[t][l],Object.keys(i.canon[t]||{}).length||delete i.canon[t])),TC(i)}function Tf({personId:e,personName:t,year:r,month:n,day:a,code:s,note:i}){var m;const l=e??"",o=typeof l=="string"?l:String(l),c=ys(r),u=ys(n),d=ys(a),h=(s??"").toString().trim(),p=t?Tp(t):null;if(!(!Number.isFinite(c)||!Number.isFinite(u)||!Number.isFinite(d)||!h)){if(o&&o!=="undefined"&&o!=="null"&&o!==""){const x=Fe.get("allLeavesV1",{}),g=Al(c,u);x[o]??(x[o]={}),(m=x[o])[g]??(m[g]={}),x[o][g][String(d)]=i?{code:h,note:i}:{code:h},Fe.set("allLeavesV1",x),Nc()}(!o||o==="undefined"||o==="null"||o==="")&&!p||(p&&LS({canon:p,year:c,month:u,day:d,rec:i?{code:h,note:i}:{code:h}}),PS({pid:o,canon:p,year:c,month:u,day:d,suppress:!1}),window.dispatchEvent(new Event("leaves:changed")))}}function Cf({personId:e,personName:t,year:r,month:n,day:a}){var d;const s=e??"",i=typeof s=="string"?s:String(s),l=ys(r),o=ys(n),c=ys(a),u=t?Tp(t):null;if(!(!Number.isFinite(l)||!Number.isFinite(o)||!Number.isFinite(c))){if(i&&i!=="undefined"&&i!=="null"&&i!==""){const h=Fe.get("allLeavesV1",{}),p=Al(l,o);(d=h==null?void 0:h[i])!=null&&d[p]&&(delete h[i][p][String(c)],Object.keys(h[i][p]).length||delete h[i][p],Object.keys(h[i]).length||delete h[i],Fe.set("allLeavesV1",h),Nc())}u&&LS({canon:u,year:l,month:o,day:c,rec:null}),PS({pid:i,canon:u,year:l,month:o,day:c,suppress:!0}),window.dispatchEvent(new Event("leaves:changed"))}}function jS(e={},t,r){var i,l,o,c,u,d;const n={},a=Al(t,r),s=S0();for(const[h,p]of Object.entries(e||{})){const m=p==null?void 0:p[a];if(bn(m))for(const[x,g]of Object.entries(m)){let v=NaN;/^\d{4}-\d{2}-\d{2}$/.test(x)?v=parseInt(x.slice(8,10),10):v=parseInt(x,10),!(!Number.isFinite(v)||v<1||v>31||!(bn(g)?g.code:String(g||"")))&&((o=(l=(i=s.ids)==null?void 0:i[h])==null?void 0:l[a])!=null&&o[String(v)]||(n[h]??(n[h]={}),n[h][v]=!0))}}try{const h=Fe.get(nm,{});for(const[p,m]of Object.entries(h||{})){const x=m==null?void 0:m[a];if(!bn(x))continue;const g=`__name__:${p}`;for(const[v,w]of Object.entries(x)){let y=NaN;/^\d{4}-\d{2}-\d{2}$/.test(v)?y=parseInt(v.slice(8,10),10):y=parseInt(v,10),!(!Number.isFinite(y)||y<1||y>31||!(bn(w)?w.code:String(w||"")))&&((d=(u=(c=s.canon)==null?void 0:c[p])==null?void 0:u[a])!=null&&d[String(y)]||(n[g]??(n[g]={}),n[g][y]=!0))}}}catch{}return n}function CC(e=[],t,r){var c;const n=ys(t),a=ys(r);if(!Number.isFinite(n)||!Number.isFinite(a))return new Map;const s=jS($a(),n,a),i=new Map,l=(u,d)=>{if(!u||!bn(d))return;i.has(u)||i.set(u,new Set);const h=i.get(u);for(const p of Object.keys(d)){const m=parseInt(p,10);Number.isFinite(m)&&h.add(m)}},o=u=>[u==null?void 0:u.id,u==null?void 0:u.personId,u==null?void 0:u.pid,u==null?void 0:u.tc,u==null?void 0:u.tcNo,u==null?void 0:u.kod,u==null?void 0:u.code].map(d=>d==null?"":String(d).trim()).filter(Boolean);for(const u of e||[]){const d=(u==null?void 0:u.fullName)||(u==null?void 0:u.name)||(u==null?void 0:u["AD SOYAD"])||(u==null?void 0:u["Ad Soyad"])||(u==null?void 0:u["ad soyad"])||"",h=Tp(d);if(h){for(const p of o(u))l(h,s==null?void 0:s[p]);l(h,s==null?void 0:s[`__name__:${h}`]),(c=i.get(h))!=null&&c.size||i.delete(h)}}return i}function fg(e,t,r){if(e&&typeof e=="object")return Tf(e);const n=String(e||""),a=String(t||"").slice(0,10);if(!n||!/^\d{4}-\d{2}-\d{2}$/.test(a))return;const[s,i,l]=a.split("-").map(c=>parseInt(c,10)),o=(r??"").toString().trim();if(o)return Tf({personId:n,year:s,month:i,day:l,code:o})}function dg(e,t){if(e&&typeof e=="object")return Cf(e);const r=String(e||""),n=String(t||"").slice(0,10);if(!r||!/^\d{4}-\d{2}-\d{2}$/.test(n))return;const[a,s,i]=n.split("-").map(l=>parseInt(l,10));return Cf({personId:r,year:a,month:s,day:i})}function Ii({title:e="alma izelgesi",year:t,month:r,setYear:n,setMonth:a,onAi:s,onBuild:i,onExport:l,onImport:o,onReset:c,onSave:u,saving:d=!1}){const h=Number.isFinite(t)?t:new Date().getFullYear(),p=Number.isFinite(r)?Math.min(Math.max(Number(r)-1,0),11):0,m=()=>{let v=h,w=p-1;w<0&&(w=11,n==null||n(v-1)),a==null||a(w+1)},x=()=>{let v=h,w=p+1;w>11&&(w=0,n==null||n(v+1)),a==null||a(w+1)},g=["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"];return f.jsx("div",{className:"w-full mb-3 rounded-2xl border border-slate-200 bg-white shadow-sm",children:f.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-3",children:[f.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:e}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:m,className:"inline-flex items-center gap-1 rounded-xl border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50",title:"nceki Ay",type:"button",children:f.jsx(Np,{className:"w-4 h-4"})}),f.jsxs("div",{className:"min-w-[180px] text-center font-medium",children:[g[p]," ",h]}),f.jsx("button",{onClick:x,className:"inline-flex items-center gap-1 rounded-xl border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50",title:"Sonraki Ay",type:"button",children:f.jsx(Ap,{className:"w-4 h-4"})})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s&&f.jsxs("button",{type:"button",onClick:s,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700",title:"Yapay Zeka",children:[f.jsx(fC,{className:"w-4 h-4"}),"Yapay Zeka"]}),u&&f.jsxs("button",{type:"button",onClick:u,disabled:d,className:`inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm ${d?"cursor-wait bg-slate-100 text-slate-500":"hover:bg-slate-50"}`,title:"Kaydet",children:[f.jsx(bS,{className:"w-4 h-4"}),d?"Kaydediliyor":"Kaydet"]}),i&&f.jsxs("button",{type:"button",onClick:i,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50",title:"Liste Olutur",children:[f.jsx(AS,{className:"w-4 h-4"}),"Liste Olutur"]}),l&&f.jsxs("button",{type:"button",onClick:l,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50",title:"Excel'e Aktar",children:[f.jsx(rC,{className:"w-4 h-4"}),"Excel'e Aktar"]}),o&&f.jsxs("button",{type:"button",onClick:o,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50",title:"Excel'den Ykle",children:[f.jsx(aC,{className:"w-4 h-4"}),"Excel'den Ykle"]}),c&&f.jsxs("button",{type:"button",onClick:c,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700 hover:bg-rose-100",title:"Sfrla",children:[f.jsx(oC,{className:"w-4 h-4"}),"Sfrla"]})]})]})})}function FC(e,t){const r=new Date(e,t,1),a=new Date(e,t+1,0).getDate(),s=(r.getDay()+6)%7,i=[];for(let l=0;l<s;l++)i.push(null);for(let l=1;l<=a;l++)i.push(new Date(e,t,l));for(;i.length%7!==0;)i.push(null);for(;i.length<42;)i.push(null);return{cells:i,daysInMonth:a}}function hg(e){const[t,r]=(e||"00:00").split(":").map(s=>parseInt(s||"0",10)),n=Number.isFinite(t)?t%24:0,a=Number.isFinite(r)?r%60:0;return n*60+a}function Nd(e,t){const r=hg(e);let a=hg(t)-r;return a<=0&&(a+=24*60),Math.round(a/60*100)/100}const Wn=e=>String(e).padStart(2,"0"),RC=(e="")=>e.toString().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),""),va=(e="")=>RC(e).replace(/\s+/g," ").toLocaleUpperCase("tr-TR"),mg=["Pzt","Sal","ar","Per","Cum","Cmt","Paz"],MS={map:new Map,mismatch:null},IC=["workAreasV2","workAreas"];function DC(){const e=new Map,t=r=>{if(r){if(Array.isArray(r)){r.forEach(t);return}if(typeof r=="string"){const n=r.trim();n&&e.set(n,n);return}if(typeof r=="object"){const n=r.id??r.code??r.serviceId??r.serviceCode??r.label??null,a=r.name??r.title??r.label??r.displayName??r.code??r.serviceName??null;if(n!=null){const s=String(n).trim();if(s){const i=a!=null?String(a).trim():s;i&&e.set(s,i)}}if(a!=null){const s=String(a).trim();s&&e.set(s,s)}for(const s of Object.values(r))Array.isArray(s)&&t(s)}}};for(const r of IC){let n;try{n=localStorage.getItem(r)}catch{n=null}if(n)try{const a=JSON.parse(n);t(a)}catch{}}return e}function OC(e){if(!e)return null;const r=[e.id,e.personId,e.pid,e.tc,e.tcNo,e.TCKN,e.kod,e.code].map(s=>s==null?"":String(s).trim()).filter(Boolean)[0]||"",a=[e.fullName,e.name,e.displayName,e.personName,[e.firstName,e.lastName].filter(Boolean).join(" "),e["Ad Soyad"],e["AD SOYAD"],e["ad soyad"]].map(s=>s==null?"":String(s).trim()).filter(Boolean)[0]||"";return!a&&!r?null:{id:r,name:a||r,canon:va(a||r),raw:e,service:e.service||e.serviceId||e.department||""}}function pg(e,t){if(!e||!t.length)return"";const r=[e.personId,e.person_id,e.staffId,e.id,e.tc,e.tcNo,e.tcno,e.TCKN,e.employeeId,e.code].map(i=>i==null?"":String(i).trim()).filter(Boolean);for(const i of r){const l=t.find(o=>o.id&&o.id===i);if(l)return l.id}const n=[e.fullName,e.name,e.displayName,[e.firstName,e.lastName].filter(Boolean).join(" ")].map(i=>i==null?"":String(i).trim()).filter(Boolean);if(!n.length)return"";const a=va(n[0]);if(!a)return"";const s=t.find(i=>i.canon===a);return(s==null?void 0:s.id)||""}function LC(e){const t=[e==null?void 0:e.personName,e==null?void 0:e.name,e==null?void 0:e.displayName,e==null?void 0:e.fullName].map(r=>r==null?"":String(r).trim()).filter(Boolean);return t.length?va(t[0]):""}function PC({year:e,month0:t,personId:r,personCanon:n}){var c;const a=(()=>{try{return JSON.parse(localStorage.getItem("dpResultLast")||"null")}catch{return null}})();if(!a||!((c=a.result)!=null&&c.assignments))return MS;if(Number(a.year)!==Number(e)||Number(a.month)!==Number(t))return{map:new Map,mismatch:a};const s=`${e}-${Wn(t+1)}`,i=new Map,l=r?String(r):"",o=n?va(n):"";for(const u of a.result.assignments||[]){if(!u)continue;const d=l&&String(u.personId??u.personID??u.staffId??u.pid??"")===l,h=!d&&o&&LC(u)===o;if(!d&&!h||!u.day||!u.day.startsWith(s))continue;const p=parseInt(u.day.slice(8,10),10);Number.isFinite(p)&&(i.has(p)||i.set(p,[]),i.get(p).push(u))}return{map:i,mismatch:null}}function jC({year:e,month0:t,personId:r,personCanon:n}){const a=new Map;try{const s=localStorage.getItem("assignmentsBuffer");if(!s)return a;const i=JSON.parse(s);if(!Array.isArray(i))return a;const l=r?String(r):"",o=n?va(n):"";for(const c of i){if(!c)continue;const u=c.personId??c.personID??c.staffId??c.pid??"",d=u==null?"":String(u).trim(),h=c.fullName??c.personName??c.name??"",p=h?va(String(h)):"",m=l&&d&&d===l;if(!m&&!(!m&&o&&p&&p===o))continue;let g=c.date??c.Date??"";if(!g&&Number.isFinite(Number(c.day??c.Day))){const C=Number(c.day??c.Day);C>=1&&C<=31&&(g=`${e}-${Wn(t+1)}-${Wn(C)}`)}if(g=String(g||"").trim(),!g)continue;const v=new Date(g);if(Number.isNaN(v.getTime())||v.getFullYear()!==e||v.getMonth()!==t)continue;const w=v.getDate();if(!Number.isFinite(w))continue;const y=c.shiftCode??c.Shift??c.code??c.Vardiya??c.VARDIYA??"",k=c.service??c.Service??c.role??c.Grev??c.GREV??"";a.has(w)||a.set(w,[]),a.get(w).push({day:`${e}-${Wn(t+1)}-${Wn(w)}`,roleLabel:k,shiftCode:y,personId:d||l||void 0,personName:h||void 0,source:"buffer"})}}catch{}return a}function MC({year:e,month0:t,personId:r,personCanon:n}){const a=new Map;let s=null;try{s=JSON.parse(localStorage.getItem("scheduleRowsV2")||"null")}catch{s=null}if(!s||!Array.isArray(s.rows)||Number(s.year)!==Number(e)||Number(s.month)!==Number(t+1))return a;const i=DC(),l=r?String(r):"",o=n?va(n):"";for(const c of s.rows){if(!c)continue;const u=c.personId??c.personID??c.staffId??c.pid??null,d=u==null?"":String(u).trim(),h=c.personName??c.fullName??c.name??"",p=h?va(h):"",m=l&&d&&d===l;if(!m&&!(!m&&o&&p&&p===o))continue;const g=String(c.date??c.day??"").slice(0,10);if(!/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(g))continue;const v=new Date(g);if(Number.isNaN(v.getTime())||v.getFullYear()!==Number(e)||v.getMonth()!==Number(t))continue;const w=v.getDate();if(!Number.isFinite(w))continue;const y=c.shiftCode??c.shift??c.code??"",k=c.serviceId??c.service??c.role??"",C=String(k||"").trim(),E=i.get(C)||C,S={day:g,shiftCode:y?String(y).trim():void 0,roleLabel:E||void 0,personId:d||l||void 0,personName:h||void 0,note:c.note||void 0,source:"aiPlan",serviceId:k??void 0};a.has(w)||a.set(w,[]),a.get(w).push(S)}return a}function BC({year:e,month0:t,personId:r,personCanon:n}){const a=new Map;let s=null;try{s=JSON.parse(localStorage.getItem("generatedRosterFlat")||"null")}catch{s=null}if(!s||typeof s!="object")return a;const i=r?String(r):"",l=n?va(n):"",o=`${e}-${Wn(t+1)}`,c=Object.values(s).filter(u=>u&&typeof u=="object");for(const u of c){const d=u==null?void 0:u[o];if(Array.isArray(d))for(const h of d){if(!h)continue;const p=h.personId??null,m=p==null?"":String(p).trim(),x=h.personName??"",g=x?va(x):"",v=i&&m&&m===i;if(!v&&!(!v&&l&&g&&g===l))continue;const y=String(h.date||"").slice(0,10);if(!/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(y))continue;const k=new Date(y);if(Number.isNaN(k.getTime())||k.getFullYear()!==Number(e)||k.getMonth()!==Number(t))continue;const C=k.getDate();if(!Number.isFinite(C))continue;const E={day:y,shiftCode:h.shiftCode?String(h.shiftCode).trim():void 0,roleLabel:h.roleLabel?String(h.roleLabel).trim():void 0,personId:m||i||void 0,personName:x||void 0,note:h.note||void 0,source:"rosterPreview"};a.has(C)||a.set(C,[]),a.get(C).push(E)}}return a}function BS(e){if(!e)return"";if(typeof e=="string")return e.toUpperCase();if(Array.isArray(e))return e.map(t=>BS(t)).filter(Boolean).join(", ");if(typeof e=="object"){const t=e.code||e.type||e.kind||"",r=e.note||e.description||"";return[t,r].filter(Boolean).join(" ")}return String(e)}function UC(e,t,r,n){const a=((e==null?void 0:e[t])||{})[n]||{};return r?{...((e==null?void 0:e[`__name__:${r}`])||{})[n]||{},...a}:a}function zC({year:e,month:t,people:r=[],allLeaves:n={},user:a,role:s={isAdmin:!1,isAuthorized:!1,isStandard:!1}}){var N,F;const i=Math.max(0,Math.min(11,Number(t)-1||0)),l=`${e}-${Wn(i+1)}`,o=_.useMemo(()=>{const R=[],D=new Set;return(r||[]).forEach(T=>{const j=OC(T);!j||!j.id||D.has(j.id)||(D.add(j.id),R.push(j))}),R.sort((T,j)=>T.name.localeCompare(j.name,"tr",{sensitivity:"base"})),R},[r]),c=_.useMemo(()=>{var R;if(s.isStandard){const D=pg(a,o);if(D)return D}return((R=o[0])==null?void 0:R.id)||""},[s.isStandard,a,o]),[u,d]=_.useState(c),[h,p]=_.useState(0);_.useEffect(()=>{d(c)},[c]),_.useEffect(()=>{const R=()=>p(D=>D+1);return window.addEventListener("planner:dpResult",R),window.addEventListener("planner:assignments",R),window.addEventListener("planner:aiPlan",R),window.addEventListener("storage",R),()=>{window.removeEventListener("planner:dpResult",R),window.removeEventListener("planner:assignments",R),window.removeEventListener("planner:aiPlan",R),window.removeEventListener("storage",R)}},[]);const m=_.useMemo(()=>o.find(R=>String(R.id)===String(u))||null,[o,u]),x=_.useMemo(()=>m?UC(n,m.id,m.canon,l):{},[n,m,l]),g=_.useMemo(()=>m?PC({year:e,month0:i,personId:m.id,personCanon:m.canon}):MS,[m,e,i,h]),v=_.useMemo(()=>m?jC({year:e,month0:i,personId:m.id,personCanon:m.canon}):new Map,[m,e,i,h]),w=_.useMemo(()=>m?MC({year:e,month0:i,personId:m.id,personCanon:m.canon}):new Map,[m,e,i,h]),y=_.useMemo(()=>m?BC({year:e,month0:i,personId:m.id,personCanon:m.canon}):new Map,[m,e,i,h]),k=_.useMemo(()=>{const R=new Map,D=T=>{var j;if(T instanceof Map){for(const[Z,re]of T.entries())R.has(Z)||R.set(Z,[]),R.get(Z).push(...re);T&&((j=T.clear)==null||j.call(T))}};return(g==null?void 0:g.map)instanceof Map&&D(g.map),D(v),D(w),D(y),R},[g==null?void 0:g.map,v,w,y]),{cells:C}=_.useMemo(()=>FC(e,i),[e,i]),E=(R=[])=>R.map((D,T)=>f.jsxs("div",{className:"rounded bg-blue-50 border border-blue-200 px-1 py-0.5 text-[11px] text-blue-700 mt-1",children:[f.jsx("span",{className:"font-semibold",children:D.shiftCode||D.code||"-"}),D.roleLabel?f.jsx("span",{className:"ml-1",children:D.roleLabel}):null]},T)),S=R=>R?f.jsx("div",{className:"rounded bg-rose-50 border border-rose-200 px-1 py-0.5 text-[11px] text-rose-700 mt-1",children:R}):null;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("span",{className:"text-xs text-slate-500",children:"Yl"}),f.jsx("span",{className:"text-sm font-semibold text-slate-800",children:e})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("span",{className:"text-xs text-slate-500",children:"Ay"}),f.jsx("span",{className:"text-sm font-semibold text-slate-800",children:Intl.DateTimeFormat("tr-TR",{month:"long"}).format(new Date(e,i))})]}),f.jsx("div",{className:"flex-1"}),(s.isAdmin||s.isAuthorized)&&f.jsxs("label",{className:"flex flex-col text-xs text-slate-500 gap-1 w-64",children:["Personel",f.jsx("select",{value:u,onChange:R=>d(R.target.value),className:"h-9 rounded border px-2 text-sm text-slate-700",children:o.map(R=>f.jsx("option",{value:R.id,children:R.name},R.id))})]}),s.isStandard&&m&&f.jsxs("div",{className:"text-sm text-slate-600",children:["Personel: ",f.jsx("span",{className:"font-medium text-slate-800",children:m.name})]})]}),!m&&f.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 text-amber-800 px-4 py-3 text-sm",children:"Bu kullancyla eleen bir personel kayd bulunamad. Personel listesinde kimlik bilgilerinizi gncelleyip tekrar deneyin."}),m&&s.isStandard&&!pg(a,o)&&f.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 text-amber-800 px-4 py-3 text-sm",children:"Hesabnzla eleen personel kayd bulunamad. u an listeden ilk kayt gsteriliyor."}),g.mismatch&&f.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 text-amber-800 px-4 py-3 text-sm",children:["Son oluturulan plan ",(N=g.mismatch)==null?void 0:N.year,"-",Wn(Number((F=g.mismatch)==null?void 0:F.month)+1)," ","dnemine ait. ",e,"-",Wn(i+1)," iin nbet verisi bulunamad."]}),f.jsx("div",{className:"grid grid-cols-7 gap-1 text-xs font-semibold text-slate-500",children:mg.map(R=>f.jsx("div",{className:"text-center py-1",children:R},R))}),f.jsx("div",{className:"grid grid-cols-7 gap-1",children:C.map((R,D)=>{if(!R)return f.jsx("div",{className:"h-24 rounded-lg bg-transparent"},`empty-${D}`);const T=R.getDate(),j=x[String(T)]||x[`${e}-${Wn(i+1)}-${Wn(T)}`],Z=BS(j),re=k.get(T)||[],W=R.getDay()===0||R.getDay()===6;return f.jsxs("div",{className:`h-24 rounded-lg border p-2 flex flex-col text-xs ${W?"bg-slate-50 border-slate-200":"bg-white border-slate-100"}`,children:[f.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[f.jsx("span",{className:"font-semibold text-sm text-slate-800",children:T}),f.jsx("span",{className:"text-[11px] uppercase text-slate-400",children:mg[(R.getDay()+6)%7]})]}),f.jsxs("div",{className:"flex-1 overflow-hidden",children:[Z?S(Z):null,re.length?E(re):null,!Z&&!re.length&&f.jsx("div",{className:"text-[11px] text-slate-300 mt-2 text-center",children:""})]})]},`day-${T}`)})}),f.jsxs("div",{className:"text-xs text-slate-500",children:[f.jsxs("div",{children:[f.jsx("span",{className:"inline-block h-3 w-3 bg-rose-100 border border-rose-200 mr-2 align-middle rounded"}),"zin kaytlar (Toplu zin Listesi)"]}),f.jsxs("div",{children:[f.jsx("span",{className:"inline-block h-3 w-3 bg-blue-100 border border-blue-200 mr-2 align-middle rounded"}),"Nbet atamalar (son plan / ie aktarlan grevler)"]}),f.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Not: Excelden ie aktarlan grevler, serbest metin tarih ve vardiya alanlarn dzgn biimde parse edebildiimiz srece burada gsterilir."})]})]})}const HC=(e,t)=>`${Intl.DateTimeFormat("tr-TR",{month:"long"}).format(new Date(e,t-1,1))} ${e}`;function $C(e=""){return e.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")}function US(e=""){return $C(e).toLocaleUpperCase("tr-TR").replace(/\s+/g," ").trim()}function VC(e,t){if(!e)return null;const n=[e.id,e.personId,e.pid,e.tc,e.tcNo,e.tcno,e.TCKN,e.kod,e.code].map(l=>l==null?"":String(l).trim()).filter(Boolean)[0]||String(t+1),s=[e.fullName,e.name,e.displayName,e.personName,[e.firstName,e.lastName].filter(Boolean).join(" "),e["Ad Soyad"],e["AD SOYAD"],e["ad soyad"]].map(l=>l==null?"":String(l).trim()).filter(Boolean)[0]||n,i=String(e.service??e.serviceId??e.department??e.departmentId??e.sectionId??e.servis??e.Servis??"").trim();return{id:n,name:s,canon:US(s),raw:e,service:i}}function xg(){const e=["peopleAll","people","personList","personnel","nurses","staff","doctors"],t=[],r=new Set;return e.forEach(n=>{try{const a=localStorage.getItem(n);if(!a)return;const s=JSON.parse(a);(Array.isArray(s)?s:Array.isArray(s==null?void 0:s.items)?s.items:Array.isArray(s==null?void 0:s.data)?s.data:[]).forEach((l,o)=>{const c=VC(l,o);!c||r.has(c.id)||(r.add(c.id),t.push(c))})}catch{}}),t.sort((n,a)=>n.name.localeCompare(a.name,"tr",{sensitivity:"base"})),t}function WC(e,t){if(!e||!t.length)return null;const r=[e.personId,e.person_id,e.staffId,e.id,e.tc,e.tcNo,e.tcno,e.TCKN,e.kod,e.code].map(s=>s==null?"":String(s).trim()).filter(Boolean);for(const s of r){const i=t.find(l=>l.id&&String(l.id)===String(s));if(i)return i}const n=[e.fullName,e.name,e.displayName,[e.firstName,e.lastName].filter(Boolean).join(" ")].map(s=>s==null?"":String(s).trim()).filter(Boolean),a=new Set(n.map(s=>US(s)));for(const s of t)if(a.has(s.canon))return s;return null}function GC(){const{user:e}=pi(),t=FS(),{ym:r,setYear:n,setMonth:a}=_c(),{year:s,month:i}=r,[l,o]=_.useState(()=>xg());_.useEffect(()=>{const N=()=>o(xg());return window.addEventListener("people:changed",N),window.addEventListener("storage",N),()=>{window.removeEventListener("people:changed",N),window.removeEventListener("storage",N)}},[]);const[c,u]=_.useState(()=>$a());_.useEffect(()=>{const N=()=>u($a());return window.addEventListener("leaves:changed",N),window.addEventListener("storage",N),window.addEventListener("planner:dpResult",N),()=>{window.removeEventListener("leaves:changed",N),window.removeEventListener("storage",N),window.removeEventListener("planner:dpResult",N)}},[]);const d=String((e==null?void 0:e.role)||(e==null?void 0:e.roleKey)||(e==null?void 0:e.type)||"").toUpperCase(),h=d==="ADMIN",p=!h&&(d==="AUTHORIZED"||d==="MANAGER"||d==="STAFF"||Array.isArray(e==null?void 0:e.serviceIds)&&e.serviceIds.length>0),m=!!e&&!h&&!p,[x,g]=_.useState(t.defaultServiceId||"");_.useEffect(()=>{g(t.defaultServiceId||"")},[t.defaultServiceId]);const v=_.useMemo(()=>t.filterByScope(l),[l,t]),w=_.useMemo(()=>x?v.filter(N=>t.getServiceId(N.raw)===String(x)||N.service===String(x)):v,[v,x,t]),y=_.useMemo(()=>WC(e,v),[e,v]),k=_.useMemo(()=>h||p?w:y?[y]:[],[h,p,w,y]),C=_.useMemo(()=>{const N=[];h&&N.push({id:"",name:"Tm"});for(const F of t.allowedIds||[]){const R=t.servicesById.get(String(F)),D=(R==null?void 0:R.name)||(R==null?void 0:R.code)||F;N.push({id:String(F),name:D})}return N},[t.allowedIds,t.servicesById,h]),E=h||p,S={isAdmin:h,isAuthorized:p,isStandard:m};return f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsx(Ii,{title:`Planlama  ${HC(s,i)}`,year:s,month:i,setYear:n,setMonth:a}),E&&f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsx("label",{className:"text-sm text-slate-600",children:"Servis:"}),f.jsx("select",{className:"h-9 px-2 rounded-lg border text-sm text-slate-700",value:x,onChange:N=>g(N.target.value),children:C.map(N=>f.jsx("option",{value:N.id??"",children:N.name},N.id??"_"))})]}),m&&!y&&f.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-700",children:"Kullanc bilgilerinizle eleen bir personel kayd bulunamad. Personel listesinde kimlik bilgilerinizi gncelledikten sonra tekrar deneyin."}),f.jsx("div",{className:"rounded-lg border bg-white p-4",children:f.jsx(zC,{year:s,month:i,people:k,allLeaves:c,user:e,role:S})})]})}const YC="modulepreload",KC=function(e){return"/hastane15/"+e},gg={},zS=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(o=>{if(o=KC(o),o in gg)return;gg[o]=!0;const c=o.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":YC,c||(d.as="script"),d.crossOrigin="",d.href=o,l&&d.setAttribute("nonce",l),document.head.appendChild(d),c)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${o}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xo={};Xo.version="0.18.5";var ln=1200,si=1252,XC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Cp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},k0=function(e){XC.indexOf(e)!=-1&&(si=Cp[0]=e)};function JC(){k0(1252)}var Rn=function(e){ln=e,k0(e)};function E0(){Rn(1200),JC()}function Ff(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function qC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function HS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Yi=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?qC(e.slice(2)):t==254&&r==255?HS(e.slice(2)):t==65279?e.slice(1):e},lo=function(t){return String.fromCharCode(t)},am=function(t){return String.fromCharCode(t)},nt;function ZC(e){nt=e,Rn=function(t){ln=t,k0(t)},Yi=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?nt.utils.decode(1200,Ff(t.slice(2))):t},lo=function(r){return ln===1200?String.fromCharCode(r):nt.utils.decode(ln,[r&255,r>>8])[0]},am=function(r){return nt.utils.decode(si,[r])[0]},gk()}var ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jo(e){for(var t="",r=0,n=0,a=0,s=0,i=0,l=0,o=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),l=(n&15)<<2|a>>6,o=a&63,isNaN(n)?l=o=64:isNaN(a)&&(o=64),t+=ls.charAt(s)+ls.charAt(i)+ls.charAt(l)+ls.charAt(o);return t}function cn(e){var t="",r=0,n=0,a=0,s=0,i=0,l=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=ls.indexOf(e.charAt(c++)),i=ls.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),l=ls.indexOf(e.charAt(c++)),n=(i&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),o=ls.indexOf(e.charAt(c++)),a=(l&3)<<6|o,o!==64&&(t+=String.fromCharCode(a));return t}var Xe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ga=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ks(e){return Xe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function vg(e){return Xe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var rn=function(t){return Xe?Ga(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ac(e){if(typeof ArrayBuffer>"u")return rn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Cs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function QC(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Fp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Fp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var lr=Xe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ga(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function e3(e){for(var t=[],r=0,n=e.length+250,a=ks(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|l>>6&15|(i&3)<<4,a[r++]=128|l&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ks(65535),n=65530)}return t.push(a.slice(0,r)),lr(t)}var Tr=/\u0000/g,oo=/[\u0001-\u0006]/g;function rl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Gn(e,t){var r=""+e;return r.length>=t?r:Lt("0",t-r.length)+r}function Rp(e,t){var r=""+e;return r.length>=t?r:Lt(" ",t-r.length)+r}function Rf(e,t){var r=""+e;return r.length>=t?r:r+Lt(" ",t-r.length)}function t3(e,t){var r=""+Math.round(e);return r.length>=t?r:Lt("0",t-r.length)+r}function r3(e,t){var r=""+e;return r.length>=t?r:Lt("0",t-r.length)+r}var yg=Math.pow(2,32);function Ai(e,t){if(e>yg||e<-yg)return t3(e,t);var r=Math.round(e);return r3(r,t)}function If(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var wg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ad=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function n3(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Sg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},a3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Df(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,l=0,o=1,c=0,u=0,d=Math.floor(a);c<t&&(d=Math.floor(a),l=d*i+s,u=d*c+o,!(a-d<5e-8));)a=1/(a-d),s=i,i=l,o=c,c=u;if(u>t&&(c>t?(u=o,l=s):(u=c,l=i)),!r)return[0,n*l,u];var h=Math.floor(n*l/u);return[h,n*l-h*u,u]}function os(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var o=new Date(1900,0,1);o.setDate(o.getDate()+n-1),i=[o.getFullYear(),o.getMonth()+1,o.getDate()],s=o.getDay(),n<60&&(s=(s+6)%7),r&&(s=u3(o,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var $S=new Date(1899,11,31,0,0,0),s3=$S.getTime(),i3=new Date(1900,2,1,0,0,0);function VS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=i3&&(r+=24*60*60*1e3),(r-(s3+(e.getTimezoneOffset()-$S.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ip(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function l3(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function o3(e){var t=e<0?12:11,r=Ip(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function c3(e){var t=Ip(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function qo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=o3(e):t===10?r=e.toFixed(10).substr(0,12):r=c3(e),Ip(l3(r.toUpperCase()))}function ii(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):qo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return un(14,VS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function u3(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function f3(e,t,r,n){var a="",s=0,i=0,l=r.y,o,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:o=l%100,c=2;break;default:o=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,c=t.length;break;case 3:return Ad[r.m-1][1];case 5:return Ad[r.m-1][0];default:return Ad[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,c=t.length;break;case 3:return wg[r.q][0];default:return wg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Gn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Gn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:o=l,c=1;break}var u=c>0?Gn(o,c):"";return u}function cs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var WS=/%/g;function d3(e,t,r){var n=t.replace(WS,""),a=t.length-n.length;return Pa(e,n,r*Math.pow(10,2*a))+Lt("%",a)}function h3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Pa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function GS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+GS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,o,c,u){return o+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var YS=/# (\?+)( ?)\/( ?)(\d+)/;function m3(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(i===0?Lt(" ",e[1].length+1+e[4].length):Rp(i,e[1].length)+e[2]+"/"+e[3]+Gn(l,e[4].length))}function p3(e,t,r){return r+(t===0?"":""+t)+Lt(" ",e[1].length+2+e[4].length)}var KS=/^#*0*\.([0#]+)/,XS=/\).*[0#]/,JS=/\(###\) ###\\?-####/;function Pr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function kg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Eg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function x3(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function g3(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function yn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(XS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yn("n",n,r):"("+yn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return h3(e,t,r);if(t.indexOf("%")!==-1)return d3(e,t,r);if(t.indexOf("E")!==-1)return GS(t,r);if(t.charCodeAt(0)===36)return"$"+yn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ai(o,t.length);if(t.match(/^[#?]+$/))return a=Ai(r,0),a==="0"&&(a=""),a.length>t.length?a:Pr(t.substr(0,t.length-a.length))+a;if(s=t.match(YS))return m3(s,o,c);if(t.match(/^#+0+$/))return c+Ai(o,t.length-t.indexOf("0"));if(s=t.match(KS))return a=kg(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])).replace(/\.(\d*)$/,function(m,x){return"."+x+Lt("0",Pr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+kg(o,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+cs(Ai(o,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yn(e,t,-r):cs(""+(Math.floor(r)+x3(r,s[1].length)))+"."+Gn(Eg(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return yn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rl(yn(e,t.replace(/[\\-]/g,""),r)),i=0,rl(rl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<a.length?a.charAt(i++):m==="0"?"0":""}));if(t.match(JS))return a=yn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=Df(o,Math.pow(10,i)-1,!1),a=""+c,u=Pa("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Rf(l[2],i),u.length<s[4].length&&(u=Pr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),l=Df(o,Math.pow(10,i)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Rp(l[1],i)+s[2]+"/"+s[3]+Rf(l[2],i):Lt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Ai(r,0),t.length<=a.length?a:Pr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Pr(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Eg(r,s[1].length),r<0?"-"+yn(e,t,-r):cs(g3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Gn(0,3-m.length):"")+m})+"."+Gn(i,s[1].length);switch(t){case"###,##0.00":return yn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=cs(Ai(o,0));return p!=="0"?c+p:"";case"###,###.00":return yn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return yn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function v3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Pa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function y3(e,t,r){var n=t.replace(WS,""),a=t.length-n.length;return Pa(e,n,r*Math.pow(10,2*a))+Lt("%",a)}function qS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,o,c,u){return o+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ia(e,t,r){if(e.charCodeAt(0)===40&&!t.match(XS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ia("n",n,r):"("+ia("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return v3(e,t,r);if(t.indexOf("%")!==-1)return y3(e,t,r);if(t.indexOf("E")!==-1)return qS(t,r);if(t.charCodeAt(0)===36)return"$"+ia(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Gn(o,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Pr(t.substr(0,t.length-a.length))+a;if(s=t.match(YS))return p3(s,o,c);if(t.match(/^#+0+$/))return c+Gn(o,t.length-t.indexOf("0"));if(s=t.match(KS))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])),a=a.replace(/\.(\d*)$/,function(m,x){return"."+x+Lt("0",Pr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+cs(""+o);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ia(e,t,-r):cs(""+r)+"."+Lt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ia(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rl(ia(e,t.replace(/[\\-]/g,""),r)),i=0,rl(rl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<a.length?a.charAt(i++):m==="0"?"0":""}));if(t.match(JS))return a=ia(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=Df(o,Math.pow(10,i)-1,!1),a=""+c,u=Pa("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Rf(l[2],i),u.length<s[4].length&&(u=Pr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),l=Df(o,Math.pow(10,i)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Rp(l[1],i)+s[2]+"/"+s[3]+Rf(l[2],i):Lt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Pr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Pr(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ia(e,t,-r):cs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Gn(0,3-m.length):"")+m})+"."+Gn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=cs(""+o);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return ia(e,t.slice(0,t.lastIndexOf(".")),r)+Pr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Pa(e,t,r){return(r|0)===r?ia(e,t,r):yn(e,t,r)}function w3(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ZS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xi(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":If(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ZS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function S3(e,t,r,n){for(var a=[],s="",i=0,l="",o="t",c,u,d,h="H";i<e.length;)switch(l=e.charAt(i)){case"G":if(!If(e,i))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),m=p==="("||p===")"?p:"t";a[a.length]={t:m,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=os(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},o=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=os(t,r),c==null))return"";for(s=l;++i<e.length&&e.charAt(i).toLowerCase()===l;)s+=l;l==="m"&&o.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),a[a.length]={t:l,v:s},o=l;break;case"A":case"a":case"":var x={t:l,v:l};if(c==null&&(c=os(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",i+=5,h="h"):(x.t="t",++i),c==null&&x.t==="T")return"";a[a.length]=x,o=l;break;case"[":for(s=l;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ZS)){if(c==null&&(c=os(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},o=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",xi(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=l;++i<e.length&&(l=e.charAt(i))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++i<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(i))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++i)===l;)s+=l;a[a.length]={t:l,v:s},o=l;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++i;break}var g=0,v=0,w;for(i=a.length-1,o="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,o="h",g<1&&(g=1);break;case"s":(w=a[i].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":o=a[i].t;break;case"m":o==="s"&&(a[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[i].v.match(/[Hh]/)&&(g=1),g<2&&a[i].v.match(/[Mm]/)&&(g=2),g<3&&a[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",k;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=f3(a[i].t.charCodeAt(0),a[i].v,c,v),a[i].t="t";break;case"n":case"?":for(k=i+1;a[k]!=null&&((l=a[k].t)==="?"||l==="D"||(l===" "||l==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[i].v+=a[k].v,a[k]={v:"",t:";"},++k;y+=a[i].v,i=k-1;break;case"G":a[i].t="t",a[i].v=ii(t,r);break}var C="",E,S;if(y.length>0){y.charCodeAt(0)==40?(E=t<0&&y.charCodeAt(0)===45?-t:t,S=Pa("n",y,E)):(E=t<0&&n>1?-t:t,S=Pa("n",y,E),E<0&&a[0]&&a[0].t=="t"&&(S=S.substr(1),a[0].v="-"+a[0].v)),k=S.length-1;var N=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){N=i;break}var F=a.length;if(N===a.length&&S.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(k>=a[i].v.length-1?(k-=a[i].v.length,a[i].v=S.substr(k+1,a[i].v.length)):k<0?a[i].v="":(a[i].v=S.substr(0,k+1),k=-1),a[i].t="t",F=i);k>=0&&F<a.length&&(a[F].v=S.substr(0,k+1)+a[F].v)}else if(N!==a.length&&S.indexOf("E")===-1){for(k=S.indexOf(".")-1,i=N;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===N?a[i].v.indexOf(".")-1:a[i].v.length-1,C=a[i].v.substr(u+1);u>=0;--u)k>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(C=S.charAt(k--)+C);a[i].v=C,a[i].t="t",F=i}for(k>=0&&F<a.length&&(a[F].v=S.substr(0,k+1)+a[F].v),k=S.indexOf(".")+1,i=N;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==N)){for(u=a[i].v.indexOf(".")>-1&&i===N?a[i].v.indexOf(".")+1:0,C=a[i].v.substr(0,u);u<a[i].v.length;++u)k<S.length&&(C+=S.charAt(k++));a[i].v=C,a[i].t="t",F=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(E=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=Pa(a[i].t,a[i].v,E),a[i].t="t");var R="";for(i=0;i!==a.length;++i)a[i]!=null&&(R+=a[i].v);return R}var _g=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ng(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function k3(e,t){var r=w3(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(_g),l=r[1].match(_g);return Ng(t,i)?[n,r[0]]:Ng(t,l)?[n,r[1]]:[n,r[i!=null&&l!=null?2:1]]}return[n,s]}function un(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[e],n==null&&(n=r.table&&r.table[Sg[e]]||ze[Sg[e]]),n==null&&(n=a3[e]||"General");break}if(If(n,0))return ii(t,r);t instanceof Date&&(t=VS(t,r.date1904));var a=k3(n,t);if(If(a[1]))return ii(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return S3(a[1],t,r,a[0])}function xa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ze[r]==null){t<0&&(t=r);continue}if(ze[r]==e){t=r;break}}t<0&&(t=391)}return ze[t]=e,t}function bc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&xa(e[t],t)}function bl(){ze=n3()}var QS={format:un,load:xa,_table:ze,load_table:bc,parse_date_code:os,is_date:xi,get_table:function(){return QS._table=ze}},E3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ek=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _3(e){var t=typeof e=="number"?ze[e]:e;return t=t.replace(ek,"(\\d+)"),new RegExp("^"+t+"$")}function N3(e,t,r){var n=-1,a=-1,s=-1,i=-1,l=-1,o=-1;(t.match(ek)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":o=p;break;case"m":i>=0?l=p:a=p;break}}),o>=0&&l==-1&&a>=0&&(l=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return i==-1&&l==-1&&o==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var A3=function(){var e={};e.version="1.2.0";function t(){for(var S=0,N=new Array(256),F=0;F!=256;++F)S=F,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,N[F]=S;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function n(S){var N=0,F=0,R=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)D[R]=S[R];for(R=0;R!=256;++R)for(F=S[R],N=256+R;N<4096;N+=256)F=D[N]=F>>>8^S[F&255];var T=[];for(R=1;R!=16;++R)T[R-1]=typeof Int32Array<"u"?D.subarray(R*256,R*256+256):D.slice(R*256,R*256+256);return T}var a=n(r),s=a[0],i=a[1],l=a[2],o=a[3],c=a[4],u=a[5],d=a[6],h=a[7],p=a[8],m=a[9],x=a[10],g=a[11],v=a[12],w=a[13],y=a[14];function k(S,N){for(var F=N^-1,R=0,D=S.length;R<D;)F=F>>>8^r[(F^S.charCodeAt(R++))&255];return~F}function C(S,N){for(var F=N^-1,R=S.length-15,D=0;D<R;)F=y[S[D++]^F&255]^w[S[D++]^F>>8&255]^v[S[D++]^F>>16&255]^g[S[D++]^F>>>24]^x[S[D++]]^m[S[D++]]^p[S[D++]]^h[S[D++]]^d[S[D++]]^u[S[D++]]^c[S[D++]]^o[S[D++]]^l[S[D++]]^i[S[D++]]^s[S[D++]]^r[S[D++]];for(R+=15;D<R;)F=F>>>8^r[(F^S[D++])&255];return~F}function E(S,N){for(var F=N^-1,R=0,D=S.length,T=0,j=0;R<D;)T=S.charCodeAt(R++),T<128?F=F>>>8^r[(F^T)&255]:T<2048?(F=F>>>8^r[(F^(192|T>>6&31))&255],F=F>>>8^r[(F^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,j=S.charCodeAt(R++)&1023,F=F>>>8^r[(F^(240|T>>8&7))&255],F=F>>>8^r[(F^(128|T>>2&63))&255],F=F>>>8^r[(F^(128|j>>6&15|(T&3)<<4))&255],F=F>>>8^r[(F^(128|j&63))&255]):(F=F>>>8^r[(F^(224|T>>12&15))&255],F=F>>>8^r[(F^(128|T>>6&63))&255],F=F>>>8^r[(F^(128|T&63))&255]);return~F}return e.table=r,e.bstr=k,e.buf=C,e.str=E,e}(),Ue=function(){var t={};t.version="1.2.1";function r(I,Y){for(var z=I.split("/"),V=Y.split("/"),K=0,X=0,ie=Math.min(z.length,V.length);K<ie;++K){if(X=z[K].length-V[K].length)return X;if(z[K]!=V[K])return z[K]<V[K]?-1:1}return z.length-V.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var Y=I.lastIndexOf("/");return Y===-1?I:I.slice(0,Y+1)}function a(I){if(I.charAt(I.length-1)=="/")return a(I.slice(0,-1));var Y=I.lastIndexOf("/");return Y===-1?I:I.slice(Y+1)}function s(I,Y){typeof Y=="string"&&(Y=new Date(Y));var z=Y.getHours();z=z<<6|Y.getMinutes(),z=z<<5|Y.getSeconds()>>>1,I.write_shift(2,z);var V=Y.getFullYear()-1980;V=V<<4|Y.getMonth()+1,V=V<<5|Y.getDate(),I.write_shift(2,V)}function i(I){var Y=I.read_shift(2)&65535,z=I.read_shift(2)&65535,V=new Date,K=z&31;z>>>=5;var X=z&15;z>>>=4,V.setMilliseconds(0),V.setFullYear(z+1980),V.setMonth(X-1),V.setDate(K);var ie=Y&31;Y>>>=5;var me=Y&63;return Y>>>=6,V.setHours(Y),V.setMinutes(me),V.setSeconds(ie<<1),V}function l(I){hr(I,0);for(var Y={},z=0;I.l<=I.length-4;){var V=I.read_shift(2),K=I.read_shift(2),X=I.l+K,ie={};switch(V){case 21589:z=I.read_shift(1),z&1&&(ie.mtime=I.read_shift(4)),K>5&&(z&2&&(ie.atime=I.read_shift(4)),z&4&&(ie.ctime=I.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}I.l=X,Y[V]=ie}return Y}var o;function c(){return o||(o={})}function u(I,Y){if(I[0]==80&&I[1]==75)return Il(I,Y);if((I[0]|32)==109&&(I[1]|32)==105)return z0(I,Y);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var z=3,V=512,K=0,X=0,ie=0,me=0,se=0,le=[],oe=I.slice(0,512);hr(oe,0);var Se=d(oe);switch(z=Se[0],z){case 3:V=512;break;case 4:V=4096;break;case 0:if(Se[1]==0)return Il(I,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}V!==512&&(oe=I.slice(0,V),hr(oe,28));var Ae=I.slice(0,V);h(oe,z);var De=oe.read_shift(4,"i");if(z===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);oe.l+=4,ie=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),me=oe.read_shift(4,"i"),K=oe.read_shift(4,"i"),se=oe.read_shift(4,"i"),X=oe.read_shift(4,"i");for(var Ee=-1,Re=0;Re<109&&(Ee=oe.read_shift(4,"i"),!(Ee<0));++Re)le[Re]=Ee;var G=p(I,V);g(se,X,G,V,le);var ae=w(G,ie,le,V);ae[ie].name="!Directory",K>0&&me!==j&&(ae[me].name="!MiniFAT"),ae[le[0]].name="!FAT",ae.fat_addrs=le,ae.ssz=V;var he={},xe=[],Ce=[],Ie=[];y(ie,ae,G,xe,K,he,Ce,me),m(Ce,Ie,xe),xe.shift();var we={FileIndex:Ce,FullPaths:Ie};return Y&&Y.raw&&(we.raw={header:Ae,sectors:G}),we}function d(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(Z,"Header Signature: "),I.l+=16;var Y=I.read_shift(2,"u");return[I.read_shift(2,"u"),Y]}function h(I,Y){var z=9;switch(I.l+=2,z=I.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,Y){for(var z=Math.ceil(I.length/Y)-1,V=[],K=1;K<z;++K)V[K-1]=I.slice(K*Y,(K+1)*Y);return V[z-1]=I.slice(z*Y),V}function m(I,Y,z){for(var V=0,K=0,X=0,ie=0,me=0,se=z.length,le=[],oe=[];V<se;++V)le[V]=oe[V]=V,Y[V]=z[V];for(;me<oe.length;++me)V=oe[me],K=I[V].L,X=I[V].R,ie=I[V].C,le[V]===V&&(K!==-1&&le[K]!==K&&(le[V]=le[K]),X!==-1&&le[X]!==X&&(le[V]=le[X])),ie!==-1&&(le[ie]=V),K!==-1&&V!=le[V]&&(le[K]=le[V],oe.lastIndexOf(K)<me&&oe.push(K)),X!==-1&&V!=le[V]&&(le[X]=le[V],oe.lastIndexOf(X)<me&&oe.push(X));for(V=1;V<se;++V)le[V]===V&&(X!==-1&&le[X]!==X?le[V]=le[X]:K!==-1&&le[K]!==K&&(le[V]=le[K]));for(V=1;V<se;++V)if(I[V].type!==0){if(me=V,me!=le[me])do me=le[me],Y[V]=Y[me]+"/"+Y[V];while(me!==0&&le[me]!==-1&&me!=le[me]);le[V]=-1}for(Y[0]+="/",V=1;V<se;++V)I[V].type!==2&&(Y[V]+="/")}function x(I,Y,z){for(var V=I.start,K=I.size,X=[],ie=V;z&&K>0&&ie>=0;)X.push(Y.slice(ie*T,ie*T+T)),K-=T,ie=js(z,ie*4);return X.length===0?de(0):lr(X).slice(0,I.size)}function g(I,Y,z,V,K){var X=j;if(I===j){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ie=z[I],me=(V>>>2)-1;if(!ie)return;for(var se=0;se<me&&(X=js(ie,se*4))!==j;++se)K.push(X);g(js(ie,V-4),Y-1,z,V,K)}}function v(I,Y,z,V,K){var X=[],ie=[];K||(K=[]);var me=V-1,se=0,le=0;for(se=Y;se>=0;){K[se]=!0,X[X.length]=se,ie.push(I[se]);var oe=z[Math.floor(se*4/V)];if(le=se*4&me,V<4+le)throw new Error("FAT boundary crossed: "+se+" 4 "+V);if(!I[oe])break;se=js(I[oe],le)}return{nodes:X,data:jg([ie])}}function w(I,Y,z,V){var K=I.length,X=[],ie=[],me=[],se=[],le=V-1,oe=0,Se=0,Ae=0,De=0;for(oe=0;oe<K;++oe)if(me=[],Ae=oe+Y,Ae>=K&&(Ae-=K),!ie[Ae]){se=[];var Ee=[];for(Se=Ae;Se>=0;){Ee[Se]=!0,ie[Se]=!0,me[me.length]=Se,se.push(I[Se]);var Re=z[Math.floor(Se*4/V)];if(De=Se*4&le,V<4+De)throw new Error("FAT boundary crossed: "+Se+" 4 "+V);if(!I[Re]||(Se=js(I[Re],De),Ee[Se]))break}X[Ae]={nodes:me,data:jg([se])}}return X}function y(I,Y,z,V,K,X,ie,me){for(var se=0,le=V.length?2:0,oe=Y[I].data,Se=0,Ae=0,De;Se<oe.length;Se+=128){var Ee=oe.slice(Se,Se+128);hr(Ee,64),Ae=Ee.read_shift(2),De=b0(Ee,0,Ae-le),V.push(De);var Re={name:De,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},G=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);G!==0&&(Re.ct=k(Ee,Ee.l-8));var ae=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);ae!==0&&(Re.mt=k(Ee,Ee.l-8)),Re.start=Ee.read_shift(4,"i"),Re.size=Ee.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=j,Re.name=""),Re.type===5?(se=Re.start,K>0&&se!==j&&(Y[se].name="!StreamData")):Re.size>=4096?(Re.storage="fat",Y[Re.start]===void 0&&(Y[Re.start]=v(z,Re.start,Y.fat_addrs,Y.ssz)),Y[Re.start].name=Re.name,Re.content=Y[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:se!==j&&Re.start!==j&&Y[se]&&(Re.content=x(Re,Y[se].data,(Y[me]||{}).data))),Re.content&&hr(Re.content,0),X[De]=Re,ie.push(Re)}}function k(I,Y){return new Date((ir(I,Y+4)/1e7*Math.pow(2,32)+ir(I,Y)/1e7-11644473600)*1e3)}function C(I,Y){return c(),u(o.readFileSync(I),Y)}function E(I,Y){var z=Y&&Y.type;switch(z||Xe&&Buffer.isBuffer(I)&&(z="buffer"),z||"base64"){case"file":return C(I,Y);case"base64":return u(rn(cn(I)),Y);case"binary":return u(rn(I),Y)}return u(I,Y)}function S(I,Y){var z=Y||{},V=z.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=V+"/",I.FileIndex[0]={name:V,type:5}),z.CLSID&&(I.FileIndex[0].clsid=z.CLSID),N(I)}function N(I){var Y="Sh33tJ5";if(!Ue.find(I,"/"+Y)){var z=de(4);z[0]=55,z[1]=z[3]=50,z[2]=54,I.FileIndex.push({name:Y,type:2,content:z,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+Y),F(I)}}function F(I,Y){S(I);for(var z=!1,V=!1,K=I.FullPaths.length-1;K>=0;--K){var X=I.FileIndex[K];switch(X.type){case 0:V?z=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(X.R*X.L*X.C)&&(z=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!Y)){var ie=new Date(1987,1,19),me=0,se=Object.create?Object.create(null):{},le=[];for(K=0;K<I.FullPaths.length;++K)se[I.FullPaths[K]]=!0,I.FileIndex[K].type!==0&&le.push([I.FullPaths[K],I.FileIndex[K]]);for(K=0;K<le.length;++K){var oe=n(le[K][0]);V=se[oe],V||(le.push([oe,{name:a(oe).replace("/",""),type:1,clsid:W,ct:ie,mt:ie,content:null}]),se[oe]=!0)}for(le.sort(function(De,Ee){return r(De[0],Ee[0])}),I.FullPaths=[],I.FileIndex=[],K=0;K<le.length;++K)I.FullPaths[K]=le[K][0],I.FileIndex[K]=le[K][1];for(K=0;K<le.length;++K){var Se=I.FileIndex[K],Ae=I.FullPaths[K];if(Se.name=a(Ae).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||W,K===0)Se.C=le.length>1?1:-1,Se.size=0,Se.type=5;else if(Ae.slice(-1)=="/"){for(me=K+1;me<le.length&&n(I.FullPaths[me])!=Ae;++me);for(Se.C=me>=le.length?-1:me,me=K+1;me<le.length&&n(I.FullPaths[me])!=n(Ae);++me);Se.R=me>=le.length?-1:me,Se.type=1}else n(I.FullPaths[K+1]||"")==n(Ae)&&(Se.R=K+1),Se.type=2}}}function R(I,Y){var z=Y||{};if(z.fileType=="mad")return H0(I,z);switch(F(I),z.fileType){case"zip":return Dl(I,z)}var V=function(De){for(var Ee=0,Re=0,G=0;G<De.FileIndex.length;++G){var ae=De.FileIndex[G];if(ae.content){var he=ae.content.length;he>0&&(he<4096?Ee+=he+63>>6:Re+=he+511>>9)}}for(var xe=De.FullPaths.length+3>>2,Ce=Ee+7>>3,Ie=Ee+127>>7,we=Ce+Re+xe+Ie,je=we+127>>7,rt=je<=109?0:Math.ceil((je-109)/127);we+je+rt+127>>7>je;)rt=++je<=109?0:Math.ceil((je-109)/127);var ot=[1,rt,je,Ie,xe,Re,Ee,0];return De.FileIndex[0].size=Ee<<6,ot[7]=(De.FileIndex[0].start=ot[0]+ot[1]+ot[2]+ot[3]+ot[4]+ot[5])+(ot[6]+7>>3),ot}(I),K=de(V[7]<<9),X=0,ie=0;{for(X=0;X<8;++X)K.write_shift(1,re[X]);for(X=0;X<8;++X)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),X=0;X<3;++X)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,V[2]),K.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:j),K.write_shift(4,V[3]),K.write_shift(-4,V[1]?V[0]-1:j),K.write_shift(4,V[1]),X=0;X<109;++X)K.write_shift(-4,X<V[2]?V[1]+X:-1)}if(V[1])for(ie=0;ie<V[1];++ie){for(;X<236+ie*127;++X)K.write_shift(-4,X<V[2]?V[1]+X:-1);K.write_shift(-4,ie===V[1]-1?j:ie+1)}var me=function(De){for(ie+=De;X<ie-1;++X)K.write_shift(-4,X+1);De&&(++X,K.write_shift(-4,j))};for(ie=X=0,ie+=V[1];X<ie;++X)K.write_shift(-4,Q.DIFSECT);for(ie+=V[2];X<ie;++X)K.write_shift(-4,Q.FATSECT);me(V[3]),me(V[4]);for(var se=0,le=0,oe=I.FileIndex[0];se<I.FileIndex.length;++se)oe=I.FileIndex[se],oe.content&&(le=oe.content.length,!(le<4096)&&(oe.start=ie,me(le+511>>9)));for(me(V[6]+7>>3);K.l&511;)K.write_shift(-4,Q.ENDOFCHAIN);for(ie=X=0,se=0;se<I.FileIndex.length;++se)oe=I.FileIndex[se],oe.content&&(le=oe.content.length,!(!le||le>=4096)&&(oe.start=ie,me(le+63>>6)));for(;K.l&511;)K.write_shift(-4,Q.ENDOFCHAIN);for(X=0;X<V[4]<<2;++X){var Se=I.FullPaths[X];if(!Se||Se.length===0){for(se=0;se<17;++se)K.write_shift(4,0);for(se=0;se<3;++se)K.write_shift(4,-1);for(se=0;se<12;++se)K.write_shift(4,0);continue}oe=I.FileIndex[X],X===0&&(oe.start=oe.size?oe.start-1:j);var Ae=X===0&&z.root||oe.name;if(le=2*(Ae.length+1),K.write_shift(64,Ae,"utf16le"),K.write_shift(2,le),K.write_shift(1,oe.type),K.write_shift(1,oe.color),K.write_shift(-4,oe.L),K.write_shift(-4,oe.R),K.write_shift(-4,oe.C),oe.clsid)K.write_shift(16,oe.clsid,"hex");else for(se=0;se<4;++se)K.write_shift(4,0);K.write_shift(4,oe.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,oe.start),K.write_shift(4,oe.size),K.write_shift(4,0)}for(X=1;X<I.FileIndex.length;++X)if(oe=I.FileIndex[X],oe.size>=4096)if(K.l=oe.start+1<<9,Xe&&Buffer.isBuffer(oe.content))oe.content.copy(K,K.l,0,oe.size),K.l+=oe.size+511&-512;else{for(se=0;se<oe.size;++se)K.write_shift(1,oe.content[se]);for(;se&511;++se)K.write_shift(1,0)}for(X=1;X<I.FileIndex.length;++X)if(oe=I.FileIndex[X],oe.size>0&&oe.size<4096)if(Xe&&Buffer.isBuffer(oe.content))oe.content.copy(K,K.l,0,oe.size),K.l+=oe.size+63&-64;else{for(se=0;se<oe.size;++se)K.write_shift(1,oe.content[se]);for(;se&63;++se)K.write_shift(1,0)}if(Xe)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function D(I,Y){var z=I.FullPaths.map(function(se){return se.toUpperCase()}),V=z.map(function(se){var le=se.split("/");return le[le.length-(se.slice(-1)=="/"?2:1)]}),K=!1;Y.charCodeAt(0)===47?(K=!0,Y=z[0].slice(0,-1)+Y):K=Y.indexOf("/")!==-1;var X=Y.toUpperCase(),ie=K===!0?z.indexOf(X):V.indexOf(X);if(ie!==-1)return I.FileIndex[ie];var me=!X.match(oo);for(X=X.replace(Tr,""),me&&(X=X.replace(oo,"!")),ie=0;ie<z.length;++ie)if((me?z[ie].replace(oo,"!"):z[ie]).replace(Tr,"")==X||(me?V[ie].replace(oo,"!"):V[ie]).replace(Tr,"")==X)return I.FileIndex[ie];return null}var T=64,j=-2,Z="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:Z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(I,Y,z){c();var V=R(I,z);o.writeFileSync(Y,V)}function L(I){for(var Y=new Array(I.length),z=0;z<I.length;++z)Y[z]=String.fromCharCode(I[z]);return Y.join("")}function ee(I,Y){var z=R(I,Y);switch(Y&&Y.type||"buffer"){case"file":return c(),o.writeFileSync(Y.filename,z),z;case"binary":return typeof z=="string"?z:L(z);case"base64":return Jo(typeof z=="string"?z:L(z));case"buffer":if(Xe)return Buffer.isBuffer(z)?z:Ga(z);case"array":return typeof z=="string"?rn(z):z}return z}var te;function b(I){try{var Y=I.InflateRaw,z=new Y;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)te=I;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function A(I,Y){if(!te)return Bc(I,Y);var z=te.InflateRaw,V=new z,K=V._processChunk(I.slice(I.l),V._finishFlushFlag);return I.l+=V.bytesRead,K}function O(I){return te?te.deflateRawSync(I):Oe(I)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(I){var Y=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var B=typeof Uint8Array<"u",ne=B?new Uint8Array(256):[],fe=0;fe<256;++fe)ne[fe]=J(fe);function M(I,Y){var z=ne[I&255];return Y<=8?z>>>8-Y:(z=z<<8|ne[I>>8&255],Y<=16?z>>>16-Y:(z=z<<8|ne[I>>16&255],z>>>24-Y))}function ue(I,Y){var z=Y&7,V=Y>>>3;return(I[V]|(z<=6?0:I[V+1]<<8))>>>z&3}function ye(I,Y){var z=Y&7,V=Y>>>3;return(I[V]|(z<=5?0:I[V+1]<<8))>>>z&7}function Te(I,Y){var z=Y&7,V=Y>>>3;return(I[V]|(z<=4?0:I[V+1]<<8))>>>z&15}function ve(I,Y){var z=Y&7,V=Y>>>3;return(I[V]|(z<=3?0:I[V+1]<<8))>>>z&31}function pe(I,Y){var z=Y&7,V=Y>>>3;return(I[V]|(z<=1?0:I[V+1]<<8))>>>z&127}function Me(I,Y,z){var V=Y&7,K=Y>>>3,X=(1<<z)-1,ie=I[K]>>>V;return z<8-V||(ie|=I[K+1]<<8-V,z<16-V)||(ie|=I[K+2]<<16-V,z<24-V)||(ie|=I[K+3]<<24-V),ie&X}function Ke(I,Y,z){var V=Y&7,K=Y>>>3;return V<=5?I[K]|=(z&7)<<V:(I[K]|=z<<V&255,I[K+1]=(z&7)>>8-V),Y+3}function Be(I,Y,z){var V=Y&7,K=Y>>>3;return z=(z&1)<<V,I[K]|=z,Y+1}function Pe(I,Y,z){var V=Y&7,K=Y>>>3;return z<<=V,I[K]|=z&255,z>>>=8,I[K+1]=z,Y+8}function Ze(I,Y,z){var V=Y&7,K=Y>>>3;return z<<=V,I[K]|=z&255,z>>>=8,I[K+1]=z&255,I[K+2]=z>>>8,Y+16}function Nt(I,Y){var z=I.length,V=2*z>Y?2*z:Y+5,K=0;if(z>=Y)return I;if(Xe){var X=vg(V);if(I.copy)I.copy(X);else for(;K<I.length;++K)X[K]=I[K];return X}else if(B){var ie=new Uint8Array(V);if(ie.set)ie.set(I);else for(;K<z;++K)ie[K]=I[K];return ie}return I.length=V,I}function tr(I){for(var Y=new Array(I),z=0;z<I;++z)Y[z]=0;return Y}function mn(I,Y,z){var V=1,K=0,X=0,ie=0,me=0,se=I.length,le=B?new Uint16Array(32):tr(32);for(X=0;X<32;++X)le[X]=0;for(X=se;X<z;++X)I[X]=0;se=I.length;var oe=B?new Uint16Array(se):tr(se);for(X=0;X<se;++X)le[K=I[X]]++,V<K&&(V=K),oe[X]=0;for(le[0]=0,X=1;X<=V;++X)le[X+16]=me=me+le[X-1]<<1;for(X=0;X<se;++X)me=I[X],me!=0&&(oe[X]=le[me+16]++);var Se=0;for(X=0;X<se;++X)if(Se=I[X],Se!=0)for(me=M(oe[X],V)>>V-Se,ie=(1<<V+4-Se)-1;ie>=0;--ie)Y[me|ie<<Se]=Se&15|X<<4;return V}var Qn=B?new Uint16Array(512):tr(512),Xa=B?new Uint16Array(32):tr(32);if(!B){for(var ur=0;ur<512;++ur)Qn[ur]=0;for(ur=0;ur<32;++ur)Xa[ur]=0}(function(){for(var I=[],Y=0;Y<32;Y++)I.push(5);mn(I,Xa,32);var z=[];for(Y=0;Y<=143;Y++)z.push(8);for(;Y<=255;Y++)z.push(9);for(;Y<=279;Y++)z.push(7);for(;Y<=287;Y++)z.push(8);mn(z,Qn,288)})();var Qr=function(){for(var Y=B?new Uint8Array(32768):[],z=0,V=0;z<q.length-1;++z)for(;V<q[z+1];++V)Y[V]=z;for(;V<32768;++V)Y[V]=29;var K=B?new Uint8Array(259):[];for(z=0,V=0;z<U.length-1;++z)for(;V<U[z+1];++V)K[V]=z;function X(me,se){for(var le=0;le<me.length;){var oe=Math.min(65535,me.length-le),Se=le+oe==me.length;for(se.write_shift(1,+Se),se.write_shift(2,oe),se.write_shift(2,~oe&65535);oe-- >0;)se[se.l++]=me[le++]}return se.l}function ie(me,se){for(var le=0,oe=0,Se=B?new Uint16Array(32768):[];oe<me.length;){var Ae=Math.min(65535,me.length-oe);if(Ae<10){for(le=Ke(se,le,+(oe+Ae==me.length)),le&7&&(le+=8-(le&7)),se.l=le/8|0,se.write_shift(2,Ae),se.write_shift(2,~Ae&65535);Ae-- >0;)se[se.l++]=me[oe++];le=se.l*8;continue}le=Ke(se,le,+(oe+Ae==me.length)+2);for(var De=0;Ae-- >0;){var Ee=me[oe];De=(De<<5^Ee)&32767;var Re=-1,G=0;if((Re=Se[De])&&(Re|=oe&-32768,Re>oe&&(Re-=32768),Re<oe))for(;me[Re+G]==me[oe+G]&&G<250;)++G;if(G>2){Ee=K[G],Ee<=22?le=Pe(se,le,ne[Ee+1]>>1)-1:(Pe(se,le,3),le+=5,Pe(se,le,ne[Ee-23]>>5),le+=3);var ae=Ee<8?0:Ee-4>>2;ae>0&&(Ze(se,le,G-U[Ee]),le+=ae),Ee=Y[oe-Re],le=Pe(se,le,ne[Ee]>>3),le-=3;var he=Ee<4?0:Ee-2>>1;he>0&&(Ze(se,le,oe-Re-q[Ee]),le+=he);for(var xe=0;xe<G;++xe)Se[De]=oe&32767,De=(De<<5^me[oe])&32767,++oe;Ae-=G-1}else Ee<=143?Ee=Ee+48:le=Be(se,le,1),le=Pe(se,le,ne[Ee]),Se[De]=oe&32767,++oe}le=Pe(se,le,0)-1}return se.l=(le+7)/8|0,se.l}return function(se,le){return se.length<8?X(se,le):ie(se,le)}}();function Oe(I){var Y=de(50+Math.floor(I.length*1.1)),z=Qr(I,Y);return Y.slice(0,z)}var At=B?new Uint16Array(32768):tr(32768),rr=B?new Uint16Array(32768):tr(32768),ht=B?new Uint16Array(128):tr(128),pn=1,jc=1;function Mc(I,Y){var z=ve(I,Y)+257;Y+=5;var V=ve(I,Y)+1;Y+=5;var K=Te(I,Y)+4;Y+=4;for(var X=0,ie=B?new Uint8Array(19):tr(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,le=B?new Uint8Array(8):tr(8),oe=B?new Uint8Array(8):tr(8),Se=ie.length,Ae=0;Ae<K;++Ae)ie[P[Ae]]=X=ye(I,Y),se<X&&(se=X),le[X]++,Y+=3;var De=0;for(le[0]=0,Ae=1;Ae<=se;++Ae)oe[Ae]=De=De+le[Ae-1]<<1;for(Ae=0;Ae<Se;++Ae)(De=ie[Ae])!=0&&(me[Ae]=oe[De]++);var Ee=0;for(Ae=0;Ae<Se;++Ae)if(Ee=ie[Ae],Ee!=0){De=ne[me[Ae]]>>8-Ee;for(var Re=(1<<7-Ee)-1;Re>=0;--Re)ht[De|Re<<Ee]=Ee&7|Ae<<3}var G=[];for(se=1;G.length<z+V;)switch(De=ht[pe(I,Y)],Y+=De&7,De>>>=3){case 16:for(X=3+ue(I,Y),Y+=2,De=G[G.length-1];X-- >0;)G.push(De);break;case 17:for(X=3+ye(I,Y),Y+=3;X-- >0;)G.push(0);break;case 18:for(X=11+pe(I,Y),Y+=7;X-- >0;)G.push(0);break;default:G.push(De),se<De&&(se=De);break}var ae=G.slice(0,z),he=G.slice(z);for(Ae=z;Ae<286;++Ae)ae[Ae]=0;for(Ae=V;Ae<30;++Ae)he[Ae]=0;return pn=mn(ae,At,286),jc=mn(he,rr,30),Y}function P0(I,Y){if(I[0]==3&&!(I[1]&3))return[ks(Y),2];for(var z=0,V=0,K=vg(Y||1<<18),X=0,ie=K.length>>>0,me=0,se=0;!(V&1);){if(V=ye(I,z),z+=3,V>>>1)V>>1==1?(me=9,se=5):(z=Mc(I,z),me=pn,se=jc);else{z&7&&(z+=8-(z&7));var le=I[z>>>3]|I[(z>>>3)+1]<<8;if(z+=32,le>0)for(!Y&&ie<X+le&&(K=Nt(K,X+le),ie=K.length);le-- >0;)K[X++]=I[z>>>3],z+=8;continue}for(;;){!Y&&ie<X+32767&&(K=Nt(K,X+32767),ie=K.length);var oe=Me(I,z,me),Se=V>>>1==1?Qn[oe]:At[oe];if(z+=Se&15,Se>>>=4,!(Se>>>8&255))K[X++]=Se;else{if(Se==256)break;Se-=257;var Ae=Se<8?0:Se-4>>2;Ae>5&&(Ae=0);var De=X+U[Se];Ae>0&&(De+=Me(I,z,Ae),z+=Ae),oe=Me(I,z,se),Se=V>>>1==1?Xa[oe]:rr[oe],z+=Se&15,Se>>>=4;var Ee=Se<4?0:Se-2>>1,Re=q[Se];for(Ee>0&&(Re+=Me(I,z,Ee),z+=Ee),!Y&&ie<De&&(K=Nt(K,De+100),ie=K.length);X<De;)K[X]=K[X-Re],++X}}}return Y?[K,z+7>>>3]:[K.slice(0,X),z+7>>>3]}function Bc(I,Y){var z=I.slice(I.l||0),V=P0(z,Y);return I.l+=V[1],V[0]}function Uc(I,Y){if(I)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function Il(I,Y){var z=I;hr(z,0);var V=[],K=[],X={FileIndex:V,FullPaths:K};S(X,{root:Y.root});for(var ie=z.length-4;(z[ie]!=80||z[ie+1]!=75||z[ie+2]!=5||z[ie+3]!=6)&&ie>=0;)--ie;z.l=ie+4,z.l+=4;var me=z.read_shift(2);z.l+=6;var se=z.read_shift(4);for(z.l=se,ie=0;ie<me;++ie){z.l+=20;var le=z.read_shift(4),oe=z.read_shift(4),Se=z.read_shift(2),Ae=z.read_shift(2),De=z.read_shift(2);z.l+=8;var Ee=z.read_shift(4),Re=l(z.slice(z.l+Se,z.l+Se+Ae));z.l+=Se+Ae+De;var G=z.l;z.l=Ee+4,j0(z,le,oe,X,Re),z.l=G}return X}function j0(I,Y,z,V,K){I.l+=2;var X=I.read_shift(2),ie=I.read_shift(2),me=i(I);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var se=I.read_shift(4),le=I.read_shift(4),oe=I.read_shift(4),Se=I.read_shift(2),Ae=I.read_shift(2),De="",Ee=0;Ee<Se;++Ee)De+=String.fromCharCode(I[I.l++]);if(Ae){var Re=l(I.slice(I.l,I.l+Ae));(Re[21589]||{}).mt&&(me=Re[21589].mt),((K||{})[21589]||{}).mt&&(me=K[21589].mt)}I.l+=Ae;var G=I.slice(I.l,I.l+le);switch(ie){case 8:G=A(I,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var ae=!1;X&8&&(se=I.read_shift(4),se==134695760&&(se=I.read_shift(4),ae=!0),le=I.read_shift(4),oe=I.read_shift(4)),le!=Y&&Uc(ae,"Bad compressed size: "+Y+" != "+le),oe!=z&&Uc(ae,"Bad uncompressed size: "+z+" != "+oe),Ll(V,De,G,{unsafe:!0,mt:me})}function Dl(I,Y){var z=Y||{},V=[],K=[],X=de(1),ie=z.compression?8:0,me=0,se=0,le=0,oe=0,Se=0,Ae=I.FullPaths[0],De=Ae,Ee=I.FileIndex[0],Re=[],G=0;for(se=1;se<I.FullPaths.length;++se)if(De=I.FullPaths[se].slice(Ae.length),Ee=I.FileIndex[se],!(!Ee.size||!Ee.content||De=="Sh33tJ5")){var ae=oe,he=de(De.length);for(le=0;le<De.length;++le)he.write_shift(1,De.charCodeAt(le)&127);he=he.slice(0,he.l),Re[Se]=A3.buf(Ee.content,0);var xe=Ee.content;ie==8&&(xe=O(xe)),X=de(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,me),X.write_shift(2,ie),Ee.mt?s(X,Ee.mt):X.write_shift(4,0),X.write_shift(-4,Re[Se]),X.write_shift(4,xe.length),X.write_shift(4,Ee.content.length),X.write_shift(2,he.length),X.write_shift(2,0),oe+=X.length,V.push(X),oe+=he.length,V.push(he),oe+=xe.length,V.push(xe),X=de(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,me),X.write_shift(2,ie),X.write_shift(4,0),X.write_shift(-4,Re[Se]),X.write_shift(4,xe.length),X.write_shift(4,Ee.content.length),X.write_shift(2,he.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,ae),G+=X.l,K.push(X),G+=he.length,K.push(he),++Se}return X=de(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Se),X.write_shift(2,Se),X.write_shift(4,G),X.write_shift(4,oe),X.write_shift(2,0),lr([lr(V),lr(K),X])}var Ei={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function M0(I,Y){if(I.ctype)return I.ctype;var z=I.name||"",V=z.match(/\.([^\.]+)$/);return V&&Ei[V[1]]||Y&&(V=(z=Y).match(/[\.\\]([^\.\\])+$/),V&&Ei[V[1]])?Ei[V[1]]:"application/octet-stream"}function Ol(I){for(var Y=Jo(I),z=[],V=0;V<Y.length;V+=76)z.push(Y.slice(V,V+76));return z.join(`\r
`)+`\r
`}function B0(I){var Y=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var oe=le.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],V=Y.split(`\r
`),K=0;K<V.length;++K){var X=V[K];if(X.length==0){z.push("");continue}for(var ie=0;ie<X.length;){var me=76,se=X.slice(ie,ie+me);se.charAt(me-1)=="="?me--:se.charAt(me-2)=="="?me-=2:se.charAt(me-3)=="="&&(me-=3),se=X.slice(ie,ie+me),ie+=me,ie<X.length&&(se+="="),z.push(se)}}return z.join(`\r
`)}function U0(I){for(var Y=[],z=0;z<I.length;++z){for(var V=I[z];z<=I.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+I[++z];Y.push(V)}for(var K=0;K<Y.length;++K)Y[K]=Y[K].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return rn(Y.join(`\r
`))}function zc(I,Y,z){for(var V="",K="",X="",ie,me=0;me<10;++me){var se=Y[me];if(!se||se.match(/^\s*$/))break;var le=se.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":V=le[2].trim();break;case"content-type":X=le[2].trim();break;case"content-transfer-encoding":K=le[2].trim();break}}switch(++me,K.toLowerCase()){case"base64":ie=rn(cn(Y.slice(me).join("")));break;case"quoted-printable":ie=U0(Y.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var oe=Ll(I,V.slice(z.length),ie,{unsafe:!0});X&&(oe.ctype=X)}function z0(I,Y){if(L(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=Y&&Y.root||"",V=(Xe&&Buffer.isBuffer(I)?I.toString("binary"):L(I)).split(`\r
`),K=0,X="";for(K=0;K<V.length;++K)if(X=V[K],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),z||(z=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),X.slice(0,z.length)!=z););var ie=(V[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var me="--"+(ie[1]||""),se=[],le=[],oe={FileIndex:se,FullPaths:le};S(oe);var Se,Ae=0;for(K=0;K<V.length;++K){var De=V[K];De!==me&&De!==me+"--"||(Ae++&&zc(oe,V.slice(Se,K),z),Se=K)}return oe}function H0(I,Y){var z=Y||{},V=z.boundary||"SheetJS";V="------="+V;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],X=I.FullPaths[0],ie=X,me=I.FileIndex[0],se=1;se<I.FullPaths.length;++se)if(ie=I.FullPaths[se].slice(X.length),me=I.FileIndex[se],!(!me.size||!me.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(G){return"_x"+G.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(G){return"_u"+G.charCodeAt(0).toString(16)+"_"});for(var le=me.content,oe=Xe&&Buffer.isBuffer(le)?le.toString("binary"):L(le),Se=0,Ae=Math.min(1024,oe.length),De=0,Ee=0;Ee<=Ae;++Ee)(De=oe.charCodeAt(Ee))>=32&&De<128&&++Se;var Re=Se>=Ae*4/5;K.push(V),K.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+ie),K.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),K.push("Content-Type: "+M0(me,ie)),K.push(""),K.push(Re?B0(oe):Ol(oe))}return K.push(V+`--\r
`),K.join(`\r
`)}function $0(I){var Y={};return S(Y,I),Y}function Ll(I,Y,z,V){var K=V&&V.unsafe;K||S(I);var X=!K&&Ue.find(I,Y);if(!X){var ie=I.FullPaths[0];Y.slice(0,ie.length)==ie?ie=Y:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+Y).replace("//","/")),X={name:a(Y),type:2},I.FileIndex.push(X),I.FullPaths.push(ie),K||Ue.utils.cfb_gc(I)}return X.content=z,X.size=z?z.length:0,V&&(V.CLSID&&(X.clsid=V.CLSID),V.mt&&(X.mt=V.mt),V.ct&&(X.ct=V.ct)),X}function Hc(I,Y){S(I);var z=Ue.find(I,Y);if(z){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==z)return I.FileIndex.splice(V,1),I.FullPaths.splice(V,1),!0}return!1}function V0(I,Y,z){S(I);var V=Ue.find(I,Y);if(V){for(var K=0;K<I.FileIndex.length;++K)if(I.FileIndex[K]==V)return I.FileIndex[K].name=a(z),I.FullPaths[K]=z,!0}return!1}function W0(I){F(I,!0)}return t.find=D,t.read=E,t.parse=u,t.write=ee,t.writeFile=H,t.utils={cfb_new:$0,cfb_add:Ll,cfb_del:Hc,cfb_mov:V0,cfb_gc:W0,ReadShift:Eo,CheckField:vk,prep_blob:hr,bconcat:lr,use_zlib:b,_deflateRaw:Oe,_inflateRaw:Bc,consts:Q},t}();let us;function b3(e){us=e}function T3(e){return typeof e=="string"?Ac(e):Array.isArray(e)?QC(e):e}function Tc(e,t,r){if(typeof us<"u"&&us.writeFileSync)return r?us.writeFileSync(e,t,r):us.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ac(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?da(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([T3(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Cs(t)),l.write(t),l.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+e)}function C3(e){if(typeof us<"u")return us.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Ag(e,t){for(var r=[],n=Bt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function _0(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function N0(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function F3(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Of=new Date(1899,11,30,0,0,0);function er(e,t){var r=e.getTime(),n=Of.getTime()+(e.getTimezoneOffset()-Of.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var tk=new Date,R3=Of.getTime()+(tk.getTimezoneOffset()-Of.getTimezoneOffset())*6e4,bg=tk.getTimezoneOffset();function A0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+R3),t.getTimezoneOffset()!==bg&&t.setTime(t.getTime()+(t.getTimezoneOffset()-bg)*6e4),t}function I3(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Tg=new Date("2017-02-19T19:06:09.000Z"),rk=isNaN(Tg.getFullYear())?new Date("2/19/17"):Tg,D3=rk.getFullYear()==2017;function kt(e,t){var r=new Date(e);if(D3)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(rk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function li(e,t){if(Xe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return da(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return da(HS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return da(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return da(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function pt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=pt(e[r]));return t}function Lt(e,t){for(var r="";r.length<t;)r+=e;return r}function Xn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var O3=["january","february","march","april","may","june","july","august","september","october","november","december"];function pl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&O3.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var L3=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],l=1;l<s.length;++l)i.push(a),i.push(s[l]);return i}}();function nk(e){return e?e.content&&e.type?li(e.content,!0):e.data?Yi(e.data):e.asNodeBuffer&&Xe?Yi(e.asNodeBuffer().toString("binary")):e.asBinary?Yi(e.asBinary()):e._data&&e._data.getContent?Yi(li(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ak(e){if(!e)return null;if(e.data)return Ff(e.data);if(e.asNodeBuffer&&Xe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Ff(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function P3(e){return e&&e.name.slice(-4)===".bin"?ak(e):nk(e)}function kn(e,t){for(var r=e.FullPaths||Bt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Dp(e,t){var r=kn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Yt(e,t,r){if(!r)return P3(Dp(e,t));if(!t)return null;try{return Yt(e,t)}catch{return null}}function nn(e,t,r){if(!r)return nk(Dp(e,t));if(!t)return null;try{return nn(e,t)}catch{return null}}function j3(e,t,r){return ak(Dp(e,t))}function Cg(e){for(var t=e.FullPaths||Bt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ye(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Xe?n=Ga(r):n=e3(r),Ue.utils.cfb_add(e,t,n)}Ue.utils.cfb_add(e,t,r)}else e.file(t,r)}function Op(){return Ue.utils.cfb_new()}function sk(e,t){switch(t.type){case"base64":return Ue.read(e,{type:"base64"});case"binary":return Ue.read(e,{type:"binary"});case"buffer":case"array":return Ue.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function co(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var $t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,M3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Fg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,B3=/<[^>]*>/g,Ir=$t.match(Fg)?Fg:B3,U3=/<\w*:/,z3=/<(\/?)\w+:/;function $e(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(M3),l=0,o="",c=0,u="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(u=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,o=d.slice(s+1+h,d.length-h),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=o,n[u.toLowerCase()]=o;else{var p=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[p]&&u.slice(l-3,l)=="ext")continue;n[p]=o,n[p.toLowerCase()]=o}}return n}function Sa(e){return e.replace(z3,"<$1")}var ik={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lp=_0(ik),st=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(l,o){return ik[l]||String.fromCharCode(parseInt(o,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,o){return String.fromCharCode(parseInt(o,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Pp=/[&<>'"]/g,H3=/[\u0000-\u0008\u000b-\u001f]/g;function ft(e){var t=e+"";return t.replace(Pp,function(r){return Lp[r]}).replace(H3,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Rg(e){return ft(e).replace(/ /g,"_x0020_")}var lk=/[\u0000-\u001f]/g;function jp(e){var t=e+"";return t.replace(Pp,function(r){return Lp[r]}).replace(/\n/g,"<br/>").replace(lk,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function $3(e){var t=e+"";return t.replace(Pp,function(r){return Lp[r]}).replace(lk,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Ig=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function V3(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function yt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bd(e){for(var t="",r=0,n=0,a=0,s=0,i=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Dg(e){var t=ks(2*e.length),r,n,a=1,s=0,i=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Og(e){return Ga(e,"binary").toString("utf8")}var uu="foo bar baz",mt=Xe&&(Og(uu)==bd(uu)&&Og||Dg(uu)==bd(uu)&&Dg)||bd,da=Xe?function(e){return Ga(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Zo=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),ok=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),W3=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),G3=/<\/?(?:vt:)?variant>/g,Y3=/<(?:vt:)([^>]*)>([\s\S]*)</;function Lg(e,t){var r=$e(e),n=e.match(W3(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(G3,"").match(Y3);i&&a.push({v:mt(i[2]),t:i[1]})}),a}var ck=/(^\s|\s$|\n)/;function mr(e,t){return"<"+e+(t.match(ck)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Qo(e){return Bt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function _e(e,t,r){return"<"+e+(r!=null?Qo(r):"")+(t!=null?(t.match(ck)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function sm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function K3(e,t){switch(typeof e){case"string":var r=_e("vt:lpwstr",ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return _e((e|0)==e?"vt:i4":"vt:r8",ft(String(e)));case"boolean":return _e("vt:bool",e?"true":"false")}if(e instanceof Date)return _e("vt:filetime",sm(e));throw new Error("Unable to serialize "+e)}function Mp(e){if(Xe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return mt(Cs(Fp(e)));throw new Error("Bad input format: expected Buffer or string")}var ec=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],tn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X3(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function J3(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Pg=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},jg=Xe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ga(t)})):Pg(e)}:Pg,Mg=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ra(e,a)));return n.join("").replace(Tr,"")},b0=Xe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Tr,""):Mg(e,t,r)}:Mg,Bg=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},uk=Xe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Bg(e,t,r)}:Bg,Ug=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Di(e,a)));return n.join("")},Tl=Xe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Ug(t,r,n)}:Ug,fk=function(e,t){var r=ir(e,t);return r>0?Tl(e,t+4,t+4+r-1):""},Bp=fk,dk=function(e,t){var r=ir(e,t);return r>0?Tl(e,t+4,t+4+r-1):""},Up=dk,hk=function(e,t){var r=2*ir(e,t);return r>0?Tl(e,t+4,t+4+r-1):""},zp=hk,mk=function(t,r){var n=ir(t,r);return n>0?b0(t,r+4,r+4+n):""},Hp=mk,pk=function(e,t){var r=ir(e,t);return r>0?Tl(e,t+4,t+4+r):""},$p=pk,xk=function(e,t){return X3(e,t)},Lf=xk,Vp=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Xe&&(Bp=function(t,r){if(!Buffer.isBuffer(t))return fk(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Up=function(t,r){if(!Buffer.isBuffer(t))return dk(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},zp=function(t,r){if(!Buffer.isBuffer(t))return hk(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Hp=function(t,r){if(!Buffer.isBuffer(t))return mk(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},$p=function(t,r){if(!Buffer.isBuffer(t))return pk(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Lf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):xk(t,r)},Vp=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function gk(){b0=function(e,t,r){return nt.utils.decode(1200,e.slice(t,r)).replace(Tr,"")},Tl=function(e,t,r){return nt.utils.decode(65001,e.slice(t,r))},Bp=function(e,t){var r=ir(e,t);return r>0?nt.utils.decode(si,e.slice(t+4,t+4+r-1)):""},Up=function(e,t){var r=ir(e,t);return r>0?nt.utils.decode(ln,e.slice(t+4,t+4+r-1)):""},zp=function(e,t){var r=2*ir(e,t);return r>0?nt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Hp=function(e,t){var r=ir(e,t);return r>0?nt.utils.decode(1200,e.slice(t+4,t+4+r)):""},$p=function(e,t){var r=ir(e,t);return r>0?nt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof nt<"u"&&gk();var Di=function(e,t){return e[t]},Ra=function(e,t){return e[t+1]*256+e[t]},q3=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ir=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},js=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Z3=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Eo(e,t){var r="",n,a,s=[],i,l,o,c;switch(t){case"dbcs":if(c=this.l,Xe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode(Ra(this,c)),c+=2;e*=2;break;case"utf8":r=Tl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=b0(this,this.l,this.l+e);break;case"wstr":if(typeof nt<"u")r=nt.utils.decode(ln,this.slice(this.l,this.l+2*e));else return Eo.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Bp(this,this.l),e=4+ir(this,this.l);break;case"lpstr-cp":r=Up(this,this.l),e=4+ir(this,this.l);break;case"lpwstr":r=zp(this,this.l),e=4+2*ir(this,this.l);break;case"lpp4":e=4+ir(this,this.l),r=Hp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ir(this,this.l),r=$p(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Di(this,this.l+e++))!==0;)s.push(lo(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Ra(this,this.l+e))!==0;)s.push(lo(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Di(this,c),this.l=c+1,l=Eo.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(lo(Ra(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":if(typeof nt<"u"){r=nt.utils.decode(ln,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",c=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Di(this,c),this.l=c+1,l=Eo.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(lo(Di(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Di(this,this.l),this.l++,n;case 2:return n=(t==="i"?q3:Ra)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?js:Z3)(this,this.l),this.l+=4,n):(a=ir(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Lf(this,this.l):a=Lf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=uk(this,this.l,e);break}}return this.l+=e,r}var Q3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},eF=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},tF=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function rF(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)tF(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof nt<"u"&&si==874)for(a=0;a!=t.length;++a){var s=nt.utils.encode(si,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Q3(this,t,this.l);break;case 8:if(n=8,r==="f"){J3(this,t,this.l);break}case 16:break;case-4:n=4,eF(this,t,this.l);break}return this.l+=n,this}function vk(e,t){var r=uk(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hr(e,t){e.l=t,e.read_shift=Eo,e.chk=vk,e.write_shift=rF}function Rr(e,t){e.l+=t}function de(e){var t=ks(e);return hr(t,0),t}function Ya(e,t,r){if(e){var n,a,s;hr(e,e.l||0);for(var i=e.length,l=0,o=0;e.l<i;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var c=ic[l]||ic[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;o=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=o,t(u,c,l))return}}}function qr(){var e=[],t=Xe?256:2048,r=function(c){var u=de(c);return hr(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),lr(e)},l=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:i,_bufs:e}}function ge(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=ic[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Vp(r)&&e.push(r)}}function _o(e,t,r){var n=pt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function zg(e,t,r){var n=pt(e);return n.s=_o(n.s,t.s,r),n.e=_o(n.e,t.s,r),n}function No(e,t){if(e.cRel&&e.c<0)for(e=pt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=He(e);return!e.cRel&&e.cRel!=null&&(r=sF(r)),!e.rRel&&e.rRel!=null&&(r=nF(r)),r}function Td(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+St(e.s.c)+":"+(e.e.cRel?"":"$")+St(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Pt(e.s.r)+":"+(e.e.rRel?"":"$")+Pt(e.e.r):No(e.s,t.biff)+":"+No(e.e,t.biff)}function Wp(e){return parseInt(aF(e),10)-1}function Pt(e){return""+(e+1)}function nF(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aF(e){return e.replace(/\$(\d+)$/,"$1")}function Gp(e){for(var t=iF(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function St(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function sF(e){return e.replace(/^([A-Z])/,"$$$1")}function iF(e){return e.replace(/^\$([A-Z])/,"$1")}function lF(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ct(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function He(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ur(e){var t=e.indexOf(":");return t==-1?{s:Ct(e),e:Ct(e)}:{s:Ct(e.slice(0,t)),e:Ct(e.slice(t+1))}}function Ge(e,t){return typeof t>"u"||typeof t=="number"?Ge(e.s,e.e):(typeof e!="string"&&(e=He(e)),typeof t!="string"&&(t=He(t)),e==t?e:e+":"+t)}function tt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Hg(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=un(e.z,r?er(t):t)}catch{}try{return e.w=un((e.XF||{}).numFmtId||(r?14:0),r?er(t):t)}catch{return""+t}}function ya(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ka[e.v]||e.v:t==null?Hg(e,e.v):Hg(e,t))}function Fs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function yk(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Ct(n.origin):n.origin;i=o.r,l=o.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=tt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},m=i+d,x=l+h;if(c.s.r>m&&(c.s.r=m),c.s.c>x&&(c.s.c=x),c.e.r<m&&(c.e.r=m),c.e.c<x&&(c.e.c=x),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ze[14],n.cellDates?(p.t="d",p.w=un(p.z,er(p.v))):(p.t="n",p.v=er(p.v),p.w=un(p.z,p.v))):p.t="s";if(a)s[m]||(s[m]=[]),s[m][x]&&s[m][x].z&&(p.z=s[m][x].z),s[m][x]=p;else{var g=He({c:x,r:m});s[g]&&s[g].z&&(p.z=s[g].z),s[g]=p}}}return c.s.c<1e7&&(s["!ref"]=Ge(c)),s}function Cl(e,t){return yk(null,e,t)}function oF(e){return e.read_shift(4,"i")}function Jn(e,t){return t||(t=de(4)),t.write_shift(4,e),t}function Cr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function or(e,t){var r=!1;return t==null&&(r=!0,t=de(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function cF(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function uF(e,t){return t||(t=de(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Yp(e,t){var r=e.l,n=e.read_shift(1),a=Cr(e),s=[],i={t:a,h:a};if(n&1){for(var l=e.read_shift(4),o=0;o!=l;++o)s.push(cF(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function fF(e,t){var r=!1;return t==null&&(r=!0,t=de(15+4*e.t.length)),t.write_shift(1,0),or(e.t,t),r?t.slice(0,t.l):t}var dF=Yp;function hF(e,t){var r=!1;return t==null&&(r=!0,t=de(23+4*e.t.length)),t.write_shift(1,1),or(e.t,t),t.write_shift(4,1),uF({},t),r?t.slice(0,t.l):t}function Mn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vi(e,t){return t==null&&(t=de(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function yi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function wi(e,t){return t==null&&(t=de(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var mF=Cr,wk=or;function Kp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Pf(e,t){var r=!1;return t==null&&(r=!0,t=de(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var pF=Cr,im=Kp,Xp=Pf;function Jp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Lf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):js(t,0)>>2;return r?a/100:a}function Sk(e,t){t==null&&(t=de(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function kk(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function xF(e,t){return t||(t=de(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Si=kk,Fl=xF;function br(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function oi(e,t){return(t||de(8)).write_shift(8,e,"f")}function gF(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Ys[a];c&&(t.rgb=rc(c));break;case 2:t.rgb=rc([i,l,o]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function jf(e,t){if(t||(t=de(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function vF(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function yF(e,t){t||(t=de(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Ek(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function wF(e){return Ek(e,1)}function SF(e){return Ek(e,2)}var qp=2,$r=3,fu=11,$g=12,Mf=19,du=64,kF=65,EF=71,_F=4108,NF=4126,ar=80,_k=81,AF=[ar,_k],lm={1:{n:"CodePage",t:qp},2:{n:"Category",t:ar},3:{n:"PresentationFormat",t:ar},4:{n:"ByteCount",t:$r},5:{n:"LineCount",t:$r},6:{n:"ParagraphCount",t:$r},7:{n:"SlideCount",t:$r},8:{n:"NoteCount",t:$r},9:{n:"HiddenCount",t:$r},10:{n:"MultimediaClipCount",t:$r},11:{n:"ScaleCrop",t:fu},12:{n:"HeadingPairs",t:_F},13:{n:"TitlesOfParts",t:NF},14:{n:"Manager",t:ar},15:{n:"Company",t:ar},16:{n:"LinksUpToDate",t:fu},17:{n:"CharacterCount",t:$r},19:{n:"SharedDoc",t:fu},22:{n:"HyperlinksChanged",t:fu},23:{n:"AppVersion",t:$r,p:"version"},24:{n:"DigSig",t:kF},26:{n:"ContentType",t:ar},27:{n:"ContentStatus",t:ar},28:{n:"Language",t:ar},29:{n:"Version",t:ar},255:{},2147483648:{n:"Locale",t:Mf},2147483651:{n:"Behavior",t:Mf},1919054434:{}},om={1:{n:"CodePage",t:qp},2:{n:"Title",t:ar},3:{n:"Subject",t:ar},4:{n:"Author",t:ar},5:{n:"Keywords",t:ar},6:{n:"Comments",t:ar},7:{n:"Template",t:ar},8:{n:"LastAuthor",t:ar},9:{n:"RevNumber",t:ar},10:{n:"EditTime",t:du},11:{n:"LastPrinted",t:du},12:{n:"CreatedDate",t:du},13:{n:"ModifiedDate",t:du},14:{n:"PageCount",t:$r},15:{n:"WordCount",t:$r},16:{n:"CharCount",t:$r},17:{n:"Thumbnail",t:EF},18:{n:"Application",t:ar},19:{n:"DocSecurity",t:$r},255:{},2147483648:{n:"Locale",t:Mf},2147483651:{n:"Behavior",t:Mf},1919054434:{}},Vg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},bF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function TF(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var CF=TF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ys=pt(CF),Ka={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Nk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},cm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Zp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function FF(e){var t=Zp();if(!e||!e.match)return t;var r={};if((e.match(Ir)||[]).forEach(function(n){var a=$e(n);switch(a[0].replace(U3,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[cm[a.ContentType]]!==void 0&&t[cm[a.ContentType]].push(a.PartName);break}}),t.xmlns!==qt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Ak(e,t){var r=F3(cm),n=[],a;n[n.length]=$t,n[n.length]=_e("Types",null,{xmlns:qt.CT,"xmlns:xsd":qt.xsd,"xmlns:xsi":qt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(o){return _e("Default",null,{Extension:o[0],ContentType:o[1]})}));var s=function(o){e[o]&&e[o].length>0&&(a=e[o][0],n[n.length]=_e("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:hu[o][t.bookType]||hu[o].xlsx}))},i=function(o){(e[o]||[]).forEach(function(c){n[n.length]=_e("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:hu[o][t.bookType]||hu[o].xlsx})})},l=function(o){(e[o]||[]).forEach(function(c){n[n.length]=_e("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[o][0]})})};return s("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var qe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ao(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ir)||[]).forEach(function(a){var s=$e(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:co(s.Target,t);r[l]=i,n[s.Id]=i}}),r["!id"]=n,r}function nl(e){var t=[$t,_e("Relationships",null,{xmlns:qt.RELS})];return Bt(e["!id"]).forEach(function(r){t[t.length]=_e("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ut(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[qe.HLINK,qe.XPATH,qe.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var RF="application/vnd.oasis.opendocument.spreadsheet";function IF(e,t){for(var r=Mp(e),n,a;n=ec.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=$e(n[0],!1),a.path=="/"&&a.type!==RF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function DF(e){var t=[$t];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Wg(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function OF(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function LF(e){var t=[$t];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Wg(e[r][0],e[r][1])),t.push(OF("",e[r][0]));return t.push(Wg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function bk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xo.version+"</meta:generator></office:meta></office:document-meta>"}var On=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],PF=function(){for(var e=new Array(On.length),t=0;t<On.length;++t){var r=On[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Tk(e){var t={};e=mt(e);for(var r=0;r<On.length;++r){var n=On[r],a=e.match(PF[r]);a!=null&&a.length>0&&(t[n[1]]=st(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=kt(t[n[1]]))}return t}function Cd(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=ft(t),n[n.length]=r?_e(e,t,r):mr(e,t))}function Ck(e,t){var r=t||{},n=[$t,_e("cp:coreProperties",null,{"xmlns:cp":qt.CORE_PROPS,"xmlns:dc":qt.dc,"xmlns:dcterms":qt.dcterms,"xmlns:dcmitype":qt.dcmitype,"xmlns:xsi":qt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Cd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:sm(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Cd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:sm(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=On.length;++s){var i=On[s],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Cd(i[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ks=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Fk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Rk(e,t,r,n){var a=[];if(typeof e=="string")a=Lg(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var i=typeof t=="string"?Lg(t,n).map(function(u){return u.v}):t,l=0,o=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(o=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=i.slice(l,l+o);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=o,r.DefinedNames=i.slice(l,l+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=i.slice(l,l+o);break}l+=o}}function jF(e,t,r){var n={};return t||(t={}),e=mt(e),Ks.forEach(function(a){var s=(e.match(Zo(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=st(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Rk(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Ik(e){var t=[],r=_e;return e||(e={}),e.Application="SheetJS",t[t.length]=$t,t[t.length]=_e("Properties",null,{xmlns:qt.EXT_PROPS,"xmlns:vt":qt.vt}),Ks.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=ft(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ft(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var MF=/<[^>]+>[^<]*/g;function BF(e,t){var r={},n="",a=e.match(MF);if(a)for(var s=0;s!=a.length;++s){var i=a[s],l=$e(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(l.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var o=i.split(">"),c=o[0].slice(4),u=o[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=st(u);break;case"bool":r[n]=yt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=kt(u);break;case"cy":case"error":r[n]=st(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,o)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Dk(e){var t=[$t,_e("Properties",null,{xmlns:qt.CUST_PROPS,"xmlns:vt":qt.vt})];if(!e)return t.join("");var r=1;return Bt(e).forEach(function(a){++r,t[t.length]=_e("property",K3(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ft(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var um={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Fd;function UF(e,t,r){Fd||(Fd=_0(um)),t=Fd[t]||t,e[t]=r}function zF(e,t){var r=[];return Bt(um).map(function(n){for(var a=0;a<On.length;++a)if(On[a][1]==n)return On[a];for(a=0;a<Ks.length;++a)if(Ks[a][1]==n)return Ks[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(mr(um[n[1]]||n[1],a))}}),_e("DocumentProperties",r.join(""),{xmlns:tn.o})}function HF(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Bt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<On.length;++i)if(s==On[i][1])return;for(i=0;i<Ks.length;++i)if(s==Ks[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var l=e[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l=String(l),a.push(_e(Rg(s),l,{"dt:dt":o}))}}),t&&Bt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),a.push(_e(Rg(s),i,{"dt:dt":l}))}}),"<"+n+' xmlns="'+tn.o+'">'+a.join("")+"</"+n+">"}function Qp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $F(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=de(8);return i.write_shift(4,n),i.write_shift(4,a),i}function Ok(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Lk(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Pk(e,t,r){return t===31?Lk(e):Ok(e,t,r)}function fm(e,t,r){return Pk(e,t,r===!1?0:4)}function VF(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Pk(e,t,0)}function WF(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Tr,""),e.l-a&2&&(e.l+=2)}return r}function GF(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Tr,"");return r}function YF(e){var t=e.l,r=Bf(e,_k);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Bf(e,$r);return[r,n]}function KF(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(YF(e));return r}function Gg(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Tr,"").replace(oo,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function jk(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function XF(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Bf(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==$g&&n!==t&&AF.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===$g?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Ok(e,n,4).replace(Tr,"");case 31:return Lk(e);case 64:return Qp(e);case 65:return jk(e);case 71:return XF(e);case 80:return fm(e,n,!s.raw).replace(Tr,"");case 81:return VF(e,n).replace(Tr,"");case 4108:return KF(e);case 4126:case 4127:return n==4127?WF(e):GF(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Yg(e,t){var r=de(4),n=de(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=de(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=$F(t);break;case 31:case 80:for(n=de(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return lr([r,n])}function Kg(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,l=0,o=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),d=e.read_shift(4);s[i]=[u,d+r]}s.sort(function(w,y){return w[1]-y[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(h[m.n]=Bf(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Rn(l=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[i][0]===1){if(l=h.CodePage=Bf(e,qp),Rn(l),o!==-1){var x=e.l;e.l=s[o][1],c=Gg(e,l),e.l=x}}else if(s[i][0]===0){if(l===0){o=i,e.l=s[i+1][1];continue}c=Gg(e,l)}else{var g=c[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=jk(e);break;case 30:e.l+=4,v=fm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=fm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=zt(e,4);break;case 64:e.l+=4,v=kt(Qp(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=r+n,h}var Mk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function JF(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Xg(e,t,r){var n=de(8),a=[],s=[],i=8,l=0,o=de(8),c=de(8);if(o.write_shift(4,2),o.write_shift(4,1200),c.write_shift(4,1),s.push(o),a.push(c),i+=8+o.length,!t){c=de(8),c.write_shift(4,0),a.unshift(c);var u=[de(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var d=e[l][0];for(o=de(8+2*(d.length+1)+(d.length%2?0:2)),o.write_shift(4,l+2),o.write_shift(4,d.length+1),o.write_shift(0,d,"dbcs");o.l!=o.length;)o.write_shift(1,0);u.push(o)}o=lr(u),s.unshift(o),i+=8+o.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(Mk.indexOf(e[l][0])>-1||Fk.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],p=0;if(t){p=+t[e[l][0]];var m=r[p];if(m.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}o=Yg(m.t,h)}else{var g=JF(h);g==-1&&(g=31,h=String(h)),o=Yg(g,h)}s.push(o),c=de(8),c.write_shift(4,t?p:2+l),a.push(c),i+=8+o.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,i),n.write_shift(4,s.length),lr([n].concat(a).concat(s))}function Jg(e,t,r){var n=e.content;if(!n)return{};hr(n,0);var a,s,i,l,o=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Ue.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(i=n.read_shift(16),o=n.read_shift(4));var d=Kg(n,t),h={SystemIdentifier:c};for(var p in d)h[p]=d[p];if(h.FMTID=s,a===1)return h;if(o-n.l==2&&(n.l+=2),n.l!==o)throw new Error("Length mismatch 2: "+n.l+" !== "+o);var m;try{m=Kg(n,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[s,i],h}function qg(e,t,r,n,a,s){var i=de(a?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ue.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var o=Xg(e,r,n);if(l.push(o),a){var c=Xg(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+o.length),l.push(c)}return lr(l)}function Za(e,t){return e.read_shift(t),null}function qF(e,t){t||(t=de(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function ZF(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function zt(e,t){return e.read_shift(t)===1}function jr(e,t){return t||(t=de(2)),t.write_shift(2,+!!e),t}function Kt(e){return e.read_shift(2,"u")}function En(e,t){return t||(t=de(2)),t.write_shift(2,e),t}function Bk(e,t){return ZF(e,t,Kt)}function QF(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Uk(e,t,r){return r||(r=de(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Cc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=ln;if(r&&r.biff>=8&&(ln=1200),!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return ln=s,l}function eR(e){var t=ln;ln=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,s=n&8,i=1+(n&1),l=0,o,c={};s&&(l=e.read_shift(2)),a&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=r===0?"":e.read_shift(r,u);return s&&(e.l+=4*l),a&&(e.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),ln=t,c}function tR(e){var t=e.t||"",r=de(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=de(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return lr(a)}function ci(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Fc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ci(e,n,r)}function ki(e,t,r){if(r.biff>5)return Fc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zk(e,t,r){return r||(r=de(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function rR(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function nR(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Tr,"");return n&&(e.l+=24),a}function aR(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Tr,"");return r+i}function sR(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return nR(e);case"0303000000000000c000000000000046":return aR(e);default:throw new Error("Unsupported Moniker "+r)}}function mu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Tr,""):"";return r}function Zg(e,t){t||(t=de(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function iR(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,l,o,c="",u,d;a&16&&(s=mu(e,r-e.l)),a&128&&(i=mu(e,r-e.l)),(a&257)===257&&(l=mu(e,r-e.l)),(a&257)===1&&(o=sR(e,r-e.l)),a&8&&(c=mu(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(d=Qp(e)),e.l=r;var h=i||l||o||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),d&&(p.time=d),s&&(p.Tooltip=s),p}function lR(e){var t=de(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),Zg(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&Zg(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var o=0;n.slice(o*3,o*3+3)=="../"||n.slice(o*3,o*3+3)=="..\\";)++o;for(t.write_shift(2,o),t.write_shift(4,n.length-3*o+1),r=0;r<n.length-3*o;++r)t.write_shift(1,n.charCodeAt(r+3*o)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Hk(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function $k(e,t){var r=Hk(e);return r[3]=0,r}function ka(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ui(e,t,r,n){return n||(n=de(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function oR(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function cR(e,t,r){return t===0?"":ki(e,t,r)}function uR(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Vk(e){var t=e.read_shift(2),r=Jp(e);return[t,r]}function fR(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Cc(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function T0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Wk(e,t){return t||(t=de(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Gk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var dR=Gk;function Yk(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function hR(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function mR(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Sr(e){e.l+=2,e.l+=e.read_shift(2)}var pR={0:Sr,4:Sr,5:Sr,6:Sr,7:mR,8:Sr,9:Sr,10:Sr,11:Sr,12:Sr,13:hR,14:Sr,15:Sr,16:Sr,17:Sr,18:Sr,19:Sr,20:Sr,21:Yk};function xR(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(pR[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function pu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ex(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=de(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function gR(e,t){return t===0||e.read_shift(2),1200}function vR(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=ki(e,0,r);return e.read_shift(t+n-e.l),a}function yR(e,t){var r=!t||t.biff==8,n=de(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function wR(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function SR(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Cc(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function kR(e,t){var r=!t||t.biff>=8?2:1,n=de(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function ER(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(eR(e));return s.Count=n,s.Unique=a,s}function _R(e,t){var r=de(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=tR(e[a]);var s=lr([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function NR(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function AR(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function bR(e){var t=oR(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function TR(e){return e.read_shift(2),e.read_shift(4)}function Qg(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function CR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:l,Selected:o,TabRatio:c}}function FR(){var e=de(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function RR(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function IR(e){var t=de(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function DR(){}function OR(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Cc(e,0,r),n}function LR(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=de(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function PR(e){var t=ka(e);return t.isst=e.read_shift(4),t}function jR(e,t,r,n){var a=de(10);return ui(e,t,n,a),a.write_shift(4,r),a}function MR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=ka(e);r.biff==2&&e.l++;var s=Fc(e,n-e.l,r);return a.val=s,a}function BR(e,t,r,n,a){var s=!a||a.biff==8,i=de(8+ +s+(1+s)*r.length);return ui(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function UR(e,t,r){var n=e.read_shift(2),a=ki(e,0,r);return[n,a]}function zR(e,t,r,n){var a=r&&r.biff==5;n||(n=de(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var HR=ki;function ev(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(2),o=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:i,c:o}}}function $R(e,t){var r=t.biff==8||!t.biff?4:2,n=de(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function VR(e){var t=e.read_shift(2),r=e.read_shift(2),n=Vk(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function WR(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Vk(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function GR(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function YR(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(2);return a.patternType=bF[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=o&127,a.icvBack=o>>7&127,a.fsxButton=o>>14&1),a}function KR(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=YR(e,t,n.fStyle,r),n}function tv(e,t,r,n){var a=r&&r.biff==5;n||(n=de(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function XR(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function JR(e){var t=de(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function rv(e,t,r){var n=ka(e);(r.biff==2||t==9)&&++e.l;var a=QF(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function qR(e,t,r,n,a,s){var i=de(8);return ui(e,t,n,i),Uk(r,s,i),i}function ZR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ka(e),a=br(e);return n.val=a,n}function QR(e,t,r,n){var a=de(14);return ui(e,t,n,a),oi(r,a),a}var nv=cR;function eI(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ci(e,s),l=[];n>e.l;)l.push(Fc(e));return[s,a,i,l]}function av(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=fR(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var tI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function sv(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),o=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),o=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=ci(e,i,r);a&32&&(c=tI[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var d=n==e.l||l===0||!(u>0)?[]:x6(e,u,r,l);return{chKey:s,Name:c,itab:o,rgce:d}}function Kk(e,t,r){if(r.biff<8)return rI(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(uR(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function rI(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Cc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function nI(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=ci(e,n,r),i=ci(e,a,r);return[s,i]}function aI(e,t,r){var n=Gk(e);e.l++;var a=e.read_shift(1);return t-=8,[g6(e,t,r),a,n]}function iv(e,t,r){var n=dR(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,m6(e,t,r)]}function sI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function iI(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=ki(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,i,s]}}function lI(e,t,r){return iI(e,t,r)}function oI(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(T0(e));return r}function cI(e){var t=de(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Wk(e[r],t);return t}function uI(e,t,r){if(r&&r.biff<8)return dI(e,t,r);var n=Yk(e),a=xR(e,t-22,n[1]);return{cmo:n,ft:a}}var fI={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function dI(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((fI[n]||Rr)(e,t,r)),{cmo:[a,n,s],ft:i}}function hI(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=rR(e,6,r);var l=e.read_shift(2);e.read_shift(2),Kt(e,2);var o=e.read_shift(2);e.l+=o;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=ci(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(u?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function mI(e,t){var r=T0(e);e.l+=16;var n=iR(e,t-24);return[r,n]}function pI(e){var t=de(24),r=Ct(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return lr([t,lR(e[1])])}function xI(e,t){e.read_shift(2);var r=T0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Tr,""),[r,n]}function gI(e){var t=e[1].Tooltip,r=de(10+2*(t.length+1));r.write_shift(2,2048);var n=Ct(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function vI(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Vg[r]||r,r=e.read_shift(2),t[1]=Vg[r]||r,t}function yI(e){return e||(e=de(4)),e.write_shift(2,1),e.write_shift(2,1),e}function wI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($k(e));return r}function SI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($k(e));return r}function kI(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Xk(e,t,r){if(!r.cellStyles)return Rr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:l,flags:o};return(r.biff>=5||!r.biff)&&(c.level=o>>8&7),c}function EI(e,t){var r=de(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function _I(e,t){var r={};return t<32||(e.l+=16,r.header=br(e),r.footer=br(e),e.l+=2),r}function NI(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function AI(e){for(var t=de(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var bI=ka,TI=Bk,CI=Fc;function FI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function RI(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ka(e);++e.l;var a=ki(e,t-7,r);return n.t="str",n.val=a,n}function II(e){var t=ka(e);++e.l;var r=br(e);return t.t="n",t.val=r,t}function DI(e,t,r){var n=de(15);return Oc(n,e,t),n.write_shift(8,r,"f"),n}function OI(e){var t=ka(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function LI(e,t,r){var n=de(9);return Oc(n,e,t),n.write_shift(2,r),n}function PI(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function jI(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function MI(e,t,r){var n=e.l+t,a=ka(e),s=e.read_shift(2),i=ci(e,s,r);return e.l=n,a.t="str",a.val=i,a}var BI=[2,3,48,49,131,139,140,245],dm=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,o){var c=[],u=ks(1);switch(o.type){case"base64":u=rn(cn(l));break;case"binary":u=rn(l);break;case"buffer":case"array":u=l;break}hr(u,0);var d=u.read_shift(1),h=!!(d&136),p=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,g=521;d==2&&(x=u.read_shift(2)),u.l+=3,d!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(g=u.read_shift(2));var v=u.read_shift(2),w=o.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var y=[],k={},C=Math.min(u.length,d==2?521:g-10-(p?264:0)),E=m?32:11;u.l<C&&u[u.l]!=13;)switch(k={},k.name=nt.utils.decode(w,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,k.type=String.fromCharCode(u.read_shift(1)),d!=2&&!m&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),d==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&y.push(k),d!=2&&(u.l+=m?13:14),k.type){case"B":(!p||k.len!=8)&&o.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var S=0,N=0;for(c[0]=[],N=0;N!=y.length;++N)c[0][N]=y[N].name;for(;x-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++S]=[],N=0,N=0;N!=y.length;++N){var F=u.slice(u.l,u.l+y[N].len);u.l+=y[N].len,hr(F,0);var R=nt.utils.decode(w,F);switch(y[N].type){case"C":R.trim().length&&(c[S][N]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[S][N]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[S][N]=R;break;case"F":c[S][N]=parseFloat(R.trim());break;case"+":case"I":c[S][N]=m?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[S][N]=!0;break;case"N":case"F":c[S][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[S][N]="##MEMO##"+(m?parseInt(R.trim(),10):F.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[S][N]=+R||0);break;case"@":c[S][N]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":c[S][N]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":c[S][N]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][N]=-F.read_shift(-8,"f");break;case"B":if(p&&y[N].len==8){c[S][N]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[N].len;break;case"0":if(y[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[N].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return o&&o.sheetRows&&(c=c.slice(0,o.sheetRows)),o.DBF=y,c}function n(l,o){var c=o||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Cl(r(l,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function a(l,o){try{return Fs(n(l,o),o)}catch(c){if(o&&o.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,o){var c=o||{};if(+c.codepage>=0&&Rn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=qr(),d=Hf(l,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),m=l["!cols"]||[],x=0,g=0,v=0,w=1;for(x=0;x<h.length;++x){if(((m[x]||{}).DBF||{}).name){h[x]=m[x].DBF.name,++v;continue}if(h[x]!=null){if(++v,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(g=0;g<1024;++g)if(h.indexOf(h[x]+"_"+g)==-1){h[x]+="_"+g;break}}}}var y=tt(l["!ref"]),k=[],C=[],E=[];for(x=0;x<=y.e.c-y.s.c;++x){var S="",N="",F=0,R=[];for(g=0;g<p.length;++g)p[g][x]!=null&&R.push(p[g][x]);if(R.length==0||h[x]==null){k[x]="?";continue}for(g=0;g<R.length;++g){switch(typeof R[g]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=R[g]instanceof Date?"D":"C";break;default:N="C"}F=Math.max(F,String(R[g]).length),S=S&&S!=N?"C":N}F>250&&(F=250),N=((m[x]||{}).DBF||{}).type,N=="C"&&m[x].DBF.len>F&&(F=m[x].DBF.len),S=="B"&&N=="N"&&(S="N",E[x]=m[x].DBF.dec,F=m[x].DBF.len),C[x]=S=="C"||N=="N"?F:s[S]||0,w+=C[x],k[x]=S}var D=u.next(32);for(D.write_shift(4,318902576),D.write_shift(4,p.length),D.write_shift(2,296+32*v),D.write_shift(2,w),x=0;x<4;++x)D.write_shift(4,0);for(D.write_shift(4,0|(+t[si]||3)<<8),x=0,g=0;x<h.length;++x)if(h[x]!=null){var T=u.next(32),j=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,j,"sbcs"),T.write_shift(1,k[x]=="?"?"C":k[x],"sbcs"),T.write_shift(4,g),T.write_shift(1,C[x]||s[k[x]]||0),T.write_shift(1,E[x]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),g+=C[x]||s[k[x]]||0}var Z=u.next(264);for(Z.write_shift(4,13),x=0;x<65;++x)Z.write_shift(4,0);for(x=0;x<p.length;++x){var re=u.next(w);for(re.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(k[g]){case"L":re.write_shift(1,p[x][g]==null?63:p[x][g]?84:70);break;case"B":re.write_shift(8,p[x][g]||0,"f");break;case"N":var W="0";for(typeof p[x][g]=="number"&&(W=p[x][g].toFixed(E[g]||0)),v=0;v<C[g]-W.length;++v)re.write_shift(1,32);re.write_shift(1,W,"sbcs");break;case"D":p[x][g]?(re.write_shift(4,("0000"+p[x][g].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(p[x][g].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+p[x][g].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(p[x][g]!=null?p[x][g]:"").slice(0,C[g]);for(re.write_shift(1,Q,"sbcs"),v=0;v<C[g]-Q.length;++v)re.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),Jk=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=e[p];return typeof m=="number"?am(m):m},n=function(h,p,m){var x=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return x==59?h:am(x)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return s(cn(h),p);case"binary":return s(h,p);case"buffer":return s(Xe&&Buffer.isBuffer(h)?h.toString("binary"):Cs(h),p);case"array":return s(li(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var m=h.split(/[\n\r]+/),x=-1,g=-1,v=0,w=0,y=[],k=[],C=null,E={},S=[],N=[],F=[],R=0,D;for(+p.codepage>=0&&Rn(+p.codepage);v!==m.length;++v){R=0;var T=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),j=T.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),Z=j[0],re;if(T.length>0)switch(Z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&k.push(T.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,Q=!1,H=!1,L=!1,ee=-1,te=-1;for(w=1;w<j.length;++w)switch(j[w].charAt(0)){case"A":break;case"X":g=parseInt(j[w].slice(1))-1,Q=!0;break;case"Y":for(x=parseInt(j[w].slice(1))-1,Q||(g=0),D=y.length;D<=x;++D)y[D]=[];break;case"K":re=j[w].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Xn(re))?isNaN(pl(re).getDate())||(re=kt(re)):(re=Xn(re),C!==null&&xi(C)&&(re=A0(re))),typeof nt<"u"&&typeof re=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(re=nt.utils.decode(p.codepage,re)),W=!0;break;case"E":L=!0;var b=al(j[w].slice(1),{r:x,c:g});y[x][g]=[y[x][g],b];break;case"S":H=!0,y[x][g]=[y[x][g],"S5S"];break;case"G":break;case"R":ee=parseInt(j[w].slice(1))-1;break;case"C":te=parseInt(j[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(W&&(y[x][g]&&y[x][g].length==2?y[x][g][0]=re:y[x][g]=re,C=null),H){if(L)throw new Error("SYLK shared formula cannot have own formula");var A=ee>-1&&y[ee][te];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");y[x][g][1]=mE(A[1],{r:x-ee,c:g-te})}break;case"F":var O=0;for(w=1;w<j.length;++w)switch(j[w].charAt(0)){case"X":g=parseInt(j[w].slice(1))-1,++O;break;case"Y":for(x=parseInt(j[w].slice(1))-1,D=y.length;D<=x;++D)y[D]=[];break;case"M":R=parseInt(j[w].slice(1))/20;break;case"F":break;case"G":break;case"P":C=k[parseInt(j[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=j[w].slice(1).split(" "),D=parseInt(F[0],10);D<=parseInt(F[1],10);++D)R=parseInt(F[2],10),N[D-1]=R===0?{hidden:!0}:{wch:R},Es(N[D-1]);break;case"C":g=parseInt(j[w].slice(1))-1,N[g]||(N[g]={});break;case"R":x=parseInt(j[w].slice(1))-1,S[x]||(S[x]={}),R>0?(S[x].hpt=R,S[x].hpx=gl(R)):R===0&&(S[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}O<1&&(C=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return S.length>0&&(E["!rows"]=S),N.length>0&&(E["!cols"]=N),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,E]}function i(h,p){var m=a(h,p),x=m[0],g=m[1],v=Cl(x,p);return Bt(g).forEach(function(w){v[w]=g[w]}),v}function l(h,p){return Fs(i(h,p),p)}function o(h,p,m,x){var g="C;Y"+(m+1)+";X"+(x+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+ix(h.f,{r:m,c:x}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,p){p.forEach(function(m,x){var g="F;W"+(x+1)+" "+(x+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=nc(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=ac(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,p){p.forEach(function(m,x){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*sc(m.hpx)+";"),g.length>2&&h.push(g+"R"+(x+1))})}function d(h,p){var m=["ID;PWXL;N;E"],x=[],g=tt(h["!ref"]),v,w=Array.isArray(h),y=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&c(m,h["!cols"]),h["!rows"]&&u(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var k=g.s.r;k<=g.e.r;++k)for(var C=g.s.c;C<=g.e.c;++C){var E=He({r:k,c:C});v=w?(h[k]||[])[C]:h[E],!(!v||v.v==null&&(!v.f||v.F))&&x.push(o(v,h,k,C))}return m.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:i,from_sheet:d}}(),qk=function(){function e(s,i){switch(i.type){case"base64":return t(cn(s),i);case"binary":return t(s,i);case"buffer":return t(Xe&&Buffer.isBuffer(s)?s.toString("binary"):Cs(s),i);case"array":return t(li(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var l=s.split(`
`),o=-1,c=-1,u=0,d=[];u!==l.length;++u){if(l[u].trim()==="BOT"){d[++o]=[],c=0;continue}if(!(o<0)){var h=l[u].trim().split(","),p=h[0],m=h[1];++u;for(var x=l[u]||"";(x.match(/["]/g)||[]).length&1&&u<l.length-1;)x+=`
`+l[++u];switch(x=x.trim(),+p){case-1:if(x==="BOT"){d[++o]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?d[o][c]=!0:x==="FALSE"?d[o][c]=!1:isNaN(Xn(m))?isNaN(pl(m).getDate())?d[o][c]=m:d[o][c]=kt(m):d[o][c]=Xn(m),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),d[o][c++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return Cl(e(s,i),i)}function n(s,i){return Fs(r(s,i),i)}var a=function(){var s=function(o,c,u,d,h){o.push(c),o.push(u+","+d),o.push('"'+h.replace(/"/g,'""')+'"')},i=function(o,c,u,d){o.push(c+","+u),o.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(o){var c=[],u=tt(o["!ref"]),d,h=Array.isArray(o);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var x=He({r:p,c:m});if(d=h?(o[p]||[])[m]:o[x],!d){i(c,1,0,"");continue}switch(d.t){case"n":var g=d.w;!g&&d.v!=null&&(g=d.v),g==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,g,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=un(d.z||ze[14],er(kt(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var v=`\r
`,w=c.join(v);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Zk=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),m=-1,x=-1,g=0,v=[];g!==p.length;++g){var w=p[g].trim().split(":");if(w[0]==="cell"){var y=Ct(w[1]);if(v.length<=y.r)for(m=v.length;m<=y.r;++m)v[m]||(v[m]=[]);switch(m=y.r,x=y.c,w[2]){case"t":v[m][x]=e(w[3]);break;case"v":v[m][x]=+w[3];break;case"vtf":var k=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[m][x]=!!+w[4];break;default:v[m][x]=+w[4];break}w[2]=="vtf"&&(v[m][x]=[v[m][x],k])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(d,h){return Cl(r(d,h),h)}function a(d,h){return Fs(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],m,x="",g=Ur(d["!ref"]),v=Array.isArray(d),w=g.s.r;w<=g.e.r;++w)for(var y=g.s.c;y<=g.e.c;++y)if(x=He({r:w,c:y}),m=v?(d[w]||[])[y]:d[x],!(!m||m.v==null||m.t==="z")){switch(p=["cell",x,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=er(kt(m.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=m.w||un(m.z||ze[14],k);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[s,i,l,i,c(d),o].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),xl=function(){function e(u,d,h,p,m){m.raw?d[h][p]=u:u===""||(u==="TRUE"?d[h][p]=!0:u==="FALSE"?d[h][p]=!1:isNaN(Xn(u))?isNaN(pl(u).getDate())?d[h][p]=u:d[h][p]=kt(u):d[h][p]=Xn(u))}function t(u,d){var h=d||{},p=[];if(!u||u.length===0)return p;for(var m=u.split(/[\r\n]/),x=m.length-1;x>=0&&m[x].length===0;)--x;for(var g=10,v=0,w=0;w<=x;++w)v=m[w].indexOf(" "),v==-1?v=m[w].length:v++,g=Math.max(g,v);for(w=0;w<=x;++w){p[w]=[];var y=0;for(e(m[w].slice(0,g).trim(),p,w,y,h),y=1;y<=(m[w].length-g)/10+1;++y)e(m[w].slice(g+(y-1)*10,g+y*10).trim(),p,w,y,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var d={},h=!1,p=0,m=0;p<u.length;++p)(m=u.charCodeAt(p))==34?h=!h:!h&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p]);if(!m.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p])}return m.sort(function(x,g){return x[0]-g[0]||n[x[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(u,d){var h=d||{},p="",m=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=a(u.slice(0,1024)):h&&h.FS?p=h.FS:p=a(u.slice(0,1024));var g=0,v=0,w=0,y=0,k=0,C=p.charCodeAt(0),E=!1,S=0,N=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var F=h.dateNF!=null?_3(h.dateNF):null;function R(){var D=u.slice(y,k),T={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)T.t="z";else if(h.raw)T.t="s",T.v=D;else if(D.trim().length===0)T.t="s",T.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(T.t="s",T.v=D.slice(2,-1).replace(/""/g,'"')):e8(D)?(T.t="n",T.f=D.slice(1)):(T.t="s",T.v=D);else if(D=="TRUE")T.t="b",T.v=!0;else if(D=="FALSE")T.t="b",T.v=!1;else if(!isNaN(w=Xn(D)))T.t="n",h.cellText!==!1&&(T.w=D),T.v=w;else if(!isNaN(pl(D).getDate())||F&&D.match(F)){T.z=h.dateNF||ze[14];var j=0;F&&D.match(F)&&(D=N3(D,h.dateNF,D.match(F)||[]),j=1),h.cellDates?(T.t="d",T.v=kt(D,j)):(T.t="n",T.v=er(kt(D,j))),h.cellText!==!1&&(T.w=un(T.z,T.v instanceof Date?er(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=D;if(T.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][v]=T):m[He({c:v,r:g})]=T),y=k+1,N=u.charCodeAt(y),x.e.c<v&&(x.e.c=v),x.e.r<g&&(x.e.r=g),S==C)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;k<u.length;++k)switch(S=u.charCodeAt(k)){case 34:N===34&&(E=!E);break;case C:case 10:case 13:if(!E&&R())break e;break}return k-y>0&&R(),m["!ref"]=Ge(x),m}function i(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):Cl(t(u,d),d)}function l(u,d){var h="",p=d.type=="string"?[0,0,0,0]:px(u,d);switch(d.type){case"base64":h=cn(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):d.codepage&&typeof nt<"u"?h=nt.utils.decode(d.codepage,u):h=Xe&&Buffer.isBuffer(u)?u.toString("binary"):Cs(u);break;case"array":h=li(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=mt(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=mt(h):d.type=="binary"&&typeof nt<"u"&&d.codepage&&(h=nt.utils.decode(d.codepage,nt.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Zk.to_sheet(d.type=="string"?h:mt(h),d):i(h,d)}function o(u,d){return Fs(l(u,d),d)}function c(u){for(var d=[],h=tt(u["!ref"]),p,m=Array.isArray(u),x=h.s.r;x<=h.e.r;++x){for(var g=[],v=h.s.c;v<=h.e.c;++v){var w=He({r:x,c:v});if(p=m?(u[x]||[])[v]:u[w],!p||p.v==null){g.push("          ");continue}for(var y=(p.w||(ya(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(v===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:o,to_sheet:l,from_sheet:c}}();function UI(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Jk.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return xl.to_workbook(e,t)}}var Xs=function(){function e(b,A,O){if(b){hr(b,b.l||0);for(var P=O.Enum||ee;b.l<b.length;){var U=b.read_shift(2),q=P[U]||P[65535],J=b.read_shift(2),B=b.l+J,ne=q.f&&q.f(b,J,O);if(b.l=B,A(ne,q,U))return}}}function t(b,A){switch(A.type){case"base64":return r(rn(cn(b)),A);case"binary":return r(rn(b),A);case"buffer":case"array":return r(b,A)}throw"Unsupported type "+A.type}function r(b,A){if(!b)return b;var O=A||{},P=O.dense?[]:{},U="Sheet1",q="",J=0,B={},ne=[],fe=[],M={s:{r:0,c:0},e:{r:0,c:0}},ue=O.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)O.Enum=ee,e(b,function(pe,Me,Ke){switch(Ke){case 0:O.vers=pe,pe>=4096&&(O.qpro=!0);break;case 6:M=pe;break;case 204:pe&&(q=pe);break;case 222:q=pe;break;case 15:case 51:O.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:Ke==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=O.dateNF||ze[14],O.cellDates&&(pe[1].t="d",pe[1].v=A0(pe[1].v))),O.qpro&&pe[3]>J&&(P["!ref"]=Ge(M),B[U]=P,ne.push(U),P=O.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},J=pe[3],U=q||"Sheet"+(J+1),q="");var Be=O.dense?(P[pe[0].r]||[])[pe[0].c]:P[He(pe[0])];if(Be){Be.t=pe[1].t,Be.v=pe[1].v,pe[1].z!=null&&(Be.z=pe[1].z),pe[1].f!=null&&(Be.f=pe[1].f);break}O.dense?(P[pe[0].r]||(P[pe[0].r]=[]),P[pe[0].r][pe[0].c]=pe[1]):P[He(pe[0])]=pe[1];break}},O);else if(b[2]==26||b[2]==14)O.Enum=te,b[2]==14&&(O.qpro=!0,b.l=0),e(b,function(pe,Me,Ke){switch(Ke){case 204:U=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>J&&(P["!ref"]=Ge(M),B[U]=P,ne.push(U),P=O.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},J=pe[3],U="Sheet"+(J+1)),ue>0&&pe[0].r>=ue)break;O.dense?(P[pe[0].r]||(P[pe[0].r]=[]),P[pe[0].r][pe[0].c]=pe[1]):P[He(pe[0])]=pe[1],M.e.c<pe[0].c&&(M.e.c=pe[0].c),M.e.r<pe[0].r&&(M.e.r=pe[0].r);break;case 27:pe[14e3]&&(fe[pe[14e3][0]]=pe[14e3][1]);break;case 1537:fe[pe[0]]=pe[1],pe[0]==J&&(U=pe[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(P["!ref"]=Ge(M),B[q||U]=P,ne.push(q||U),!fe.length)return{SheetNames:ne,Sheets:B};for(var ye={},Te=[],ve=0;ve<fe.length;++ve)B[ne[ve]]?(Te.push(fe[ve]||ne[ve]),ye[fe[ve]]=B[fe[ve]]||B[ne[ve]]):(Te.push(fe[ve]),ye[fe[ve]]={"!ref":"A1"});return{SheetNames:Te,Sheets:ye}}function n(b,A){var O=A||{};if(+O.codepage>=0&&Rn(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var P=qr(),U=tt(b["!ref"]),q=Array.isArray(b),J=[];Ne(P,0,s(1030)),Ne(P,6,o(U));for(var B=Math.min(U.e.r,8191),ne=U.s.r;ne<=B;++ne)for(var fe=Pt(ne),M=U.s.c;M<=U.e.c;++M){ne===U.s.r&&(J[M]=St(M));var ue=J[M]+fe,ye=q?(b[ne]||[])[M]:b[ue];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?Ne(P,13,p(ne,M,ye.v)):Ne(P,14,x(ne,M,ye.v));else{var Te=ya(ye);Ne(P,15,d(ne,M,Te.slice(0,239)))}}return Ne(P,1),P.end()}function a(b,A){var O=A||{};if(+O.codepage>=0&&Rn(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var P=qr();Ne(P,0,i(b));for(var U=0,q=0;U<b.SheetNames.length;++U)(b.Sheets[b.SheetNames[U]]||{})["!ref"]&&Ne(P,27,L(b.SheetNames[U],q++));var J=0;for(U=0;U<b.SheetNames.length;++U){var B=b.Sheets[b.SheetNames[U]];if(!(!B||!B["!ref"])){for(var ne=tt(B["!ref"]),fe=Array.isArray(B),M=[],ue=Math.min(ne.e.r,8191),ye=ne.s.r;ye<=ue;++ye)for(var Te=Pt(ye),ve=ne.s.c;ve<=ne.e.c;++ve){ye===ne.s.r&&(M[ve]=St(ve));var pe=M[ve]+Te,Me=fe?(B[ye]||[])[ve]:B[pe];if(!(!Me||Me.t=="z"))if(Me.t=="n")Ne(P,23,R(ye,ve,J,Me.v));else{var Ke=ya(Me);Ne(P,22,S(ye,ve,J,Ke.slice(0,239)))}}++J}}return Ne(P,1),P.end()}function s(b){var A=de(2);return A.write_shift(2,b),A}function i(b){var A=de(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var O=0,P=0,U=0,q=0;q<b.SheetNames.length;++q){var J=b.SheetNames[q],B=b.Sheets[J];if(!(!B||!B["!ref"])){++U;var ne=Ur(B["!ref"]);O<ne.e.r&&(O=ne.e.r),P<ne.e.c&&(P=ne.e.c)}}return O>8191&&(O=8191),A.write_shift(2,O),A.write_shift(1,U),A.write_shift(1,P),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function l(b,A,O){var P={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&O.qpro?(P.s.c=b.read_shift(1),b.l++,P.s.r=b.read_shift(2),P.e.c=b.read_shift(1),b.l++,P.e.r=b.read_shift(2),P):(P.s.c=b.read_shift(2),P.s.r=b.read_shift(2),A==12&&O.qpro&&(b.l+=2),P.e.c=b.read_shift(2),P.e.r=b.read_shift(2),A==12&&O.qpro&&(b.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function o(b){var A=de(8);return A.write_shift(2,b.s.c),A.write_shift(2,b.s.r),A.write_shift(2,b.e.c),A.write_shift(2,b.e.r),A}function c(b,A,O){var P=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(P[0].c=b.read_shift(1),P[3]=b.read_shift(1),P[0].r=b.read_shift(2),b.l+=2):(P[2]=b.read_shift(1),P[0].c=b.read_shift(2),P[0].r=b.read_shift(2)),P}function u(b,A,O){var P=b.l+A,U=c(b,A,O);if(U[1].t="s",O.vers==20768){b.l++;var q=b.read_shift(1);return U[1].v=b.read_shift(q,"utf8"),U}return O.qpro&&b.l++,U[1].v=b.read_shift(P-b.l,"cstr"),U}function d(b,A,O){var P=de(7+O.length);P.write_shift(1,255),P.write_shift(2,A),P.write_shift(2,b),P.write_shift(1,39);for(var U=0;U<P.length;++U){var q=O.charCodeAt(U);P.write_shift(1,q>=128?95:q)}return P.write_shift(1,0),P}function h(b,A,O){var P=c(b,A,O);return P[1].v=b.read_shift(2,"i"),P}function p(b,A,O){var P=de(7);return P.write_shift(1,255),P.write_shift(2,A),P.write_shift(2,b),P.write_shift(2,O,"i"),P}function m(b,A,O){var P=c(b,A,O);return P[1].v=b.read_shift(8,"f"),P}function x(b,A,O){var P=de(13);return P.write_shift(1,255),P.write_shift(2,A),P.write_shift(2,b),P.write_shift(8,O,"f"),P}function g(b,A,O){var P=b.l+A,U=c(b,A,O);if(U[1].v=b.read_shift(8,"f"),O.qpro)b.l=P;else{var q=b.read_shift(2);k(b.slice(b.l,b.l+q),U),b.l+=q}return U}function v(b,A,O){var P=A&32768;return A&=-32769,A=(P?b:0)+(A>=8192?A-16384:A),(P?"":"$")+(O?St(A):Pt(A))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(b,A){hr(b,0);for(var O=[],P=0,U="",q="",J="",B="";b.l<b.length;){var ne=b[b.l++];switch(ne){case 0:O.push(b.read_shift(8,"f"));break;case 1:q=v(A[0].c,b.read_shift(2),!0),U=v(A[0].r,b.read_shift(2),!1),O.push(q+U);break;case 2:{var fe=v(A[0].c,b.read_shift(2),!0),M=v(A[0].r,b.read_shift(2),!1);q=v(A[0].c,b.read_shift(2),!0),U=v(A[0].r,b.read_shift(2),!1),O.push(fe+M+":"+q+U)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(b.read_shift(2));break;case 6:{for(var ue="";ne=b[b.l++];)ue+=String.fromCharCode(ne);O.push('"'+ue.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:B=O.pop(),J=O.pop(),O.push(["AND","OR"][ne-20]+"("+J+","+B+")");break;default:if(ne<32&&y[ne])B=O.pop(),J=O.pop(),O.push(J+y[ne]+B);else if(w[ne]){if(P=w[ne][1],P==69&&(P=b[b.l++]),P>O.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+O.join("|")+"|");return}var ye=O.slice(-P);O.length-=P,O.push(w[ne][0]+"("+ye.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}O.length==1?A[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function C(b){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=b.read_shift(2),A[3]=b[b.l++],A[0].c=b[b.l++],A}function E(b,A){var O=C(b);return O[1].t="s",O[1].v=b.read_shift(A-4,"cstr"),O}function S(b,A,O,P){var U=de(6+P.length);U.write_shift(2,b),U.write_shift(1,O),U.write_shift(1,A),U.write_shift(1,39);for(var q=0;q<P.length;++q){var J=P.charCodeAt(q);U.write_shift(1,J>=128?95:J)}return U.write_shift(1,0),U}function N(b,A){var O=C(b);O[1].v=b.read_shift(2);var P=O[1].v>>1;if(O[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return O[1].v=P,O}function F(b,A){var O=C(b),P=b.read_shift(4),U=b.read_shift(4),q=b.read_shift(2);if(q==65535)return P===0&&U===3221225472?(O[1].t="e",O[1].v=15):P===0&&U===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var J=q&32768;return q=(q&32767)-16446,O[1].v=(1-J*2)*(U*Math.pow(2,q+32)+P*Math.pow(2,q)),O}function R(b,A,O,P){var U=de(14);if(U.write_shift(2,b),U.write_shift(1,O),U.write_shift(1,A),P==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var q=0,J=0,B=0,ne=0;return P<0&&(q=1,P=-P),J=Math.log2(P)|0,P/=Math.pow(2,J-31),ne=P>>>0,ne&2147483648||(P/=2,++J,ne=P>>>0),P-=ne,ne|=2147483648,ne>>>=0,P*=Math.pow(2,32),B=P>>>0,U.write_shift(4,B),U.write_shift(4,ne),J+=16383+(q?32768:0),U.write_shift(2,J),U}function D(b,A){var O=F(b);return b.l+=A-14,O}function T(b,A){var O=C(b),P=b.read_shift(4);return O[1].v=P>>6,O}function j(b,A){var O=C(b),P=b.read_shift(8,"f");return O[1].v=P,O}function Z(b,A){var O=j(b);return b.l+=A-10,O}function re(b,A){return b[b.l+A-1]==0?b.read_shift(A,"cstr"):""}function W(b,A){var O=b[b.l++];O>A-1&&(O=A-1);for(var P="";P.length<O;)P+=String.fromCharCode(b[b.l++]);return P}function Q(b,A,O){if(!(!O.qpro||A<21)){var P=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var U=b.read_shift(A-21,"cstr");return[P,U]}}function H(b,A){for(var O={},P=b.l+A;b.l<P;){var U=b.read_shift(2);if(U==14e3){for(O[U]=[0,""],O[U][0]=b.read_shift(2);b[b.l];)O[U][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return O}function L(b,A){var O=de(5+b.length);O.write_shift(2,14e3),O.write_shift(2,A);for(var P=0;P<b.length;++P){var U=b.charCodeAt(P);O[O.l++]=U>127?95:U}return O[O.l++]=0,O}var ee={0:{n:"BOF",f:Kt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:Z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function zI(e){var t={},r=e.match(Ir),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=$e(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Cp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var HI=function(){var e=Zo("t"),t=Zo("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var l={t:"s",v:st(i[1])},o=s.match(t);return o&&(l.s=zI(o[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),$I=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var o=a.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(s.push("<"+o+">"),i.push("</"+o+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),VI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,WI=/<(?:\w+:)?r>/,GI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(mt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=mt(e),r&&(n.h=jp(n.t))):e.match(WI)&&(n.r=mt(e),n.t=st(mt((e.replace(GI,"").match(VI)||[]).join("").replace(Ir,""))),r&&(n.h=$I(HI(n.r)))),n):{t:""}}var YI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,KI=/<(?:\w+:)?(?:si|sstItem)>/g,XI=/<\/(?:\w+:)?(?:si|sstItem)>/;function JI(e,t){var r=[],n="";if(!e)return r;var a=e.match(YI);if(a){n=a[2].replace(KI,"").split(XI);for(var s=0;s!=n.length;++s){var i=tx(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=$e(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var qI=/^\s|\s$|[\t\n\r]/;function Qk(e,t){if(!t.bookSST)return"";var r=[$t];r[r.length]=_e("sst",null,{xmlns:gi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(qI)&&(s+=' xml:space="preserve"'),s+=">"+ft(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ZI(e){return[e.read_shift(4),e.read_shift(4)]}function QI(e,t){var r=[],n=!1;return Ya(e,function(s,i,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function eD(e,t){return t||(t=de(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var tD=fF;function rD(e){var t=qr();ge(t,159,eD(e));for(var r=0;r<e.length;++r)ge(t,19,tD(e[r]));return ge(t,160),t.end()}function eE(e){if(typeof nt<"u")return nt.utils.encode(si,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ja(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function nD(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ja(e,4),t.U=ja(e,4),t.W=ja(e,4),t}function aD(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function sD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(aD(e));return t}function iD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function lD(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ja(e,4),t.U=ja(e,4),t.W=ja(e,4),t}function oD(e){var t=lD(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function tE(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function rE(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function cD(e){var t=ja(e);switch(t.Minor){case 2:return[t.Minor,uD(e)];case 3:return[t.Minor,fD()];case 4:return[t.Minor,dD(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function uD(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=tE(e,r),a=rE(e,e.length-e.l);return{t:"Std",h:n,v:a}}function fD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function dD(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ir,function(s){var i=$e(s);switch(Sa(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=i[l]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function hD(e,t){var r={},n=r.EncryptionVersionInfo=ja(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=tE(e,a),t-=a,r.EncryptionVerifier=rE(e,t),r}function mD(e){var t={},r=t.EncryptionVersionInfo=ja(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function rx(e){var t=0,r,n=eE(e),a=n.length+1,s,i,l,o,c;for(r=ks(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],l=t&16384?1:0,o=t<<1&32767,c=l|o,t=c^i;return t^52811}var nE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,l){return n(i^l)},s=function(i){for(var l=t[i.length-1],o=104,c=i.length-1;c>=0;--c)for(var u=i[c],d=0;d!=7;++d)u&64&&(l^=r[o]),u*=2,--o;return l};return function(i){for(var l=eE(i),o=s(l),c=l.length,u=ks(16),d=0;d!=16;++d)u[d]=0;var h,p,m;for((c&1)===1&&(h=o>>8,u[c]=a(e[0],h),--c,h=o&255,p=l[l.length-1],u[c]=a(p,h));c>0;)--c,h=o>>8,u[c]=a(l[c],h),--c,h=o&255,u[c]=a(l[c],h);for(c=15,m=15-l.length;m>0;)h=o>>8,u[c]=a(e[m],h),--c,--m,h=o&255,u[c]=a(l[c],h),--c,--m;return u}}(),pD=function(e,t,r,n,a){a||(a=t),n||(n=nE(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},xD=function(e){var t=0,r=nE(e);return function(n){var a=pD("",n,t,r);return t=a[1],a[0]}};function gD(e,t,r,n){var a={key:Kt(e),verificationBytes:Kt(e)};return r.password&&(a.verifier=rx(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=xD(r.password)),a}function vD(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=mD(e):n.Data=hD(e,t),n}function yD(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?vD(e,t-2,n):gD(e,r.biff>=8?t:t-2,r,n),n}var aE=function(){function e(a,s){switch(s.type){case"base64":return t(cn(a),s);case"binary":return t(a,s);case"buffer":return t(Xe&&Buffer.isBuffer(a)?a.toString("binary"):Cs(a),s);case"array":return t(li(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},l=i.dense?[]:{},o=a.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(u,d){Array.isArray(l)&&(l[d]=[]);for(var h=/\\\w+\b/g,p=0,m,x=-1;m=h.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(p,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[d][x]=v:l[He({r:d,c:x})]=v}break}p=h.lastIndex}x>c.e.c&&(c.e.c=x)}),l["!ref"]=Ge(c),l}function r(a,s){return Fs(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=tt(a["!ref"]),l,o=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var d=He({r:c,c:u});l=o?(a[c]||[])[u]:a[d],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(ya(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function wD(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function rc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function SD(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var l=0,o=0,c=a+s;switch(o=i/(c>1?2-c:c),a){case t:l=((r-n)/i+6)%6;break;case r:l=(n-t)/i+2;break;case n:l=(t-r)/i+4;break}return[l/6,o,c/2]}function kD(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],l=6*t,o;if(r!==0)switch(l|0){case 0:case 6:o=a*l,i[0]+=a,i[1]+=o;break;case 1:o=a*(2-l),i[0]+=o,i[1]+=a;break;case 2:o=a*(l-2),i[1]+=a,i[2]+=o;break;case 3:o=a*(4-l),i[1]+=o,i[2]+=a;break;case 4:o=a*(l-4),i[2]+=a,i[0]+=o;break;case 5:o=a*(6-l),i[2]+=o,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Uf(e,t){if(t===0)return e;var r=SD(wD(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),rc(kD(r))}var sE=6,ED=15,_D=1,Nr=sE;function nc(e){return Math.floor((e+Math.round(128/Nr)/256)*Nr)}function ac(e){return Math.floor((e-5)/Nr*100+.5)/100}function zf(e){return Math.round((e*Nr+5)/Nr*256)/256}function Rd(e){return zf(ac(nc(e)))}function nx(e){var t=Math.abs(e-Rd(e)),r=Nr;if(t>.005)for(Nr=_D;Nr<ED;++Nr)Math.abs(e-Rd(e))<=t&&(t=Math.abs(e-Rd(e)),r=Nr);Nr=r}function Es(e){e.width?(e.wpx=nc(e.width),e.wch=ac(e.wpx),e.MDW=Nr):e.wpx?(e.wch=ac(e.wpx),e.width=zf(e.wch),e.MDW=Nr):typeof e.wch=="number"&&(e.width=zf(e.wch),e.wpx=nc(e.width),e.MDW=Nr),e.customWidth&&delete e.customWidth}var ND=96,iE=ND;function sc(e){return e*96/iE}function gl(e){return e*iE/96}var AD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function bD(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Ir)||[]).forEach(function(i){var l=$e(i);switch(Sa(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=yt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=yt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function TD(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Ir)||[]).forEach(function(i){var l=$e(i);switch(Sa(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function CD(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Ir)||[]).forEach(function(i){var l=$e(i);switch(Sa(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=mt(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?yt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?yt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?yt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?yt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?yt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?yt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?yt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Cp[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=yt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var o=Ys[a.color.index];a.color.index==81&&(o=Ys[1]),o||(o=Ys[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Uf(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function FD(e,t,r){t.NumberFmt=[];for(var n=Bt(ze),a=0;a<n.length;++a)t.NumberFmt[n[a]]=ze[n[a]];var s=e[0].match(Ir);if(s)for(a=0;a<s.length;++a){var i=$e(s[a]);switch(Sa(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=st(mt(i.formatCode)),o=parseInt(i.numFmtId,10);if(t.NumberFmt[o]=l,o>0){if(o>392){for(o=392;o>60&&t.NumberFmt[o]!=null;--o);t.NumberFmt[o]=l}xa(l,o)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function RD(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=_e("numFmt",null,{numFmtId:n,formatCode:ft(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=_e("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var xu=["numFmtId","fillId","fontId","borderId","xfId"],gu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ID(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Ir)||[]).forEach(function(s){var i=$e(s),l=0;switch(Sa(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],l=0;l<xu.length;++l)n[xu[l]]&&(n[xu[l]]=parseInt(n[xu[l]],10));for(l=0;l<gu.length;++l)n[gu[l]]&&(n[gu[l]]=yt(n[gu[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),i.textRotation!=null&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=yt(i.wrapText)),n.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function DD(e){var t=[];return t[t.length]=_e("cellXfs",null),e.forEach(function(r){t[t.length]=_e("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=_e("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var OD=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,o,c){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=l.match(t))&&FD(d,u,c),(d=l.match(a))&&CD(d,u,o,c),(d=l.match(n))&&TD(d,u,o,c),(d=l.match(s))&&bD(d,u,o,c),(d=l.match(r))&&ID(d,u,c),u}}();function lE(e,t){var r=[$t,_e("styleSheet",null,{xmlns:gi[0],"xmlns:vt":qt.vt})],n;return e.SSF&&(n=RD(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=DD(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function LD(e,t){var r=e.read_shift(2),n=Cr(e);return[r,n]}function PD(e,t,r){r||(r=de(6+4*t.length)),r.write_shift(2,e),or(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function jD(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=vF(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var l=e.read_shift(1);l>0&&(n.family=l);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=gF(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Cr(e),n}function MD(e,t){t||(t=de(25+4*32)),t.write_shift(2,e.sz*20),yF(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),jf(e.color,t);var n=0;return n=2,t.write_shift(1,n),or(e.name,t),t.length>t.l?t.slice(0,t.l):t}var BD=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Id,UD=Rr;function lv(e,t){t||(t=de(4*3+8*7+16*1)),Id||(Id=_0(BD));var r=Id[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(jf({auto:1},t),jf({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function zD(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function oE(e,t,r){r||(r=de(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Jl(e,t){return t||(t=de(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var HD=Rr;function $D(e,t){return t||(t=de(51)),t.write_shift(1,0),Jl(null,t),Jl(null,t),Jl(null,t),Jl(null,t),Jl(null,t),t.length>t.l?t.slice(0,t.l):t}function VD(e,t){return t||(t=de(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Pf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function WD(e,t,r){var n=de(2052);return n.write_shift(4,e),Pf(t,n),Pf(r,n),n.length>n.l?n.slice(0,n.l):n}function GD(e,t,r){var n={};n.NumberFmt=[];for(var a in ze)n.NumberFmt[a]=ze[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ya(e,function(o,c,u){switch(u){case 44:n.NumberFmt[o[0]]=o[1],xa(o[1],o[0]);break;case 43:n.Fonts.push(o),o.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=Uf(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function YD(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ge(e,615,Jn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ge(e,44,PD(a,t[a]))}),ge(e,616))}}function KD(e){var t=1;ge(e,611,Jn(t)),ge(e,43,MD({sz:12,color:{theme:1},name:"Calibri",family:2})),ge(e,612)}function XD(e){var t=2;ge(e,603,Jn(t)),ge(e,45,lv({patternType:"none"})),ge(e,45,lv({patternType:"gray125"})),ge(e,604)}function JD(e){var t=1;ge(e,613,Jn(t)),ge(e,46,$D()),ge(e,614)}function qD(e){var t=1;ge(e,626,Jn(t)),ge(e,47,oE({numFmtId:0},65535)),ge(e,627)}function ZD(e,t){ge(e,617,Jn(t.length)),t.forEach(function(r){ge(e,47,oE(r,0))}),ge(e,618)}function QD(e){var t=1;ge(e,619,Jn(t)),ge(e,48,VD({xfId:0,name:"Normal"})),ge(e,620)}function eO(e){var t=0;ge(e,505,Jn(t)),ge(e,506)}function tO(e){var t=0;ge(e,508,WD(t,"TableStyleMedium9","PivotStyleMedium4")),ge(e,509)}function rO(e,t){var r=qr();return ge(r,278),YD(r,e.SSF),KD(r),XD(r),JD(r),qD(r),ZD(r,t.cellXfs),QD(r),eO(r),tO(r),ge(r,279),r.end()}var nO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function aO(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ir)||[]).forEach(function(a){var s=$e(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[nO.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function sO(){}function iO(){}var lO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,oO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uO(e,t,r){t.themeElements={};var n;[["clrScheme",lO,aO],["fontScheme",oO,sO],["fmtScheme",cO,iO]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var fO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function cE(e,t){(!e||e.length===0)&&(e=ax());var r,n={};if(!(r=e.match(fO)))throw new Error("themeElements not found in theme");return uO(r[0],n,t),n.raw=e,n}function ax(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[$t];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function dO(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=sk(s,{type:"array"})}catch{return}var l=nn(i,"theme/theme/theme1.xml",!0);if(l)return cE(l,r)}}function hO(e){return e.read_shift(4)}function mO(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=pO(e,4);break;case 2:t.xclrValue=Hk(e);break;case 3:t.xclrValue=hO(e);break;case 4:e.l+=4;break}return e.l+=8,t}function pO(e,t){return Rr(e,t)}function xO(e,t){return Rr(e,t)}function gO(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=mO(e);break;case 6:n[1]=xO(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function vO(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(gO(e,r-e.l));return{ixfe:n,ext:s}}function yO(e,t){t.forEach(function(r){switch(r[0]){}})}function wO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Cr(e)}}function SO(e){var t=de(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),or(e.name,t),t.slice(0,t.l)}function kO(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function EO(e){var t=de(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function _O(e,t){var r=de(8+2*t.length);return r.write_shift(4,e),or(t,r),r.slice(0,r.l)}function NO(e){return e.l+=4,e.read_shift(4)!=0}function AO(e,t){var r=de(8);return r.write_shift(4,e),r.write_shift(4,1),r}function bO(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,l=2;return Ya(e,function(o,c,u){switch(u){case 335:n.Types.push({name:o.name});break;case 51:o.forEach(function(d){l==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):l==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:l=o?1:0;break;case 338:l=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function TO(){var e=qr();return ge(e,332),ge(e,334,Jn(1)),ge(e,335,SO({name:"XLDAPR",version:12e4,flags:3496657072})),ge(e,336),ge(e,339,_O(1,"XLDAPR")),ge(e,52),ge(e,35,Jn(514)),ge(e,4096,Jn(0)),ge(e,4097,En(1)),ge(e,36),ge(e,53),ge(e,340),ge(e,337,AO(1)),ge(e,51,EO([[1,0]])),ge(e,338),ge(e,333),e.end()}function CO(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Ir,function(l){var o=$e(l);switch(Sa(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==o.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[o.t-1].name,index:+o.v}):s==0&&n.Value.push({type:n.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+o.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return l}),n}function uE(){var e=[$t];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function FO(e){var t=[];if(!e)return t;var r=1;return(e.match(Ir)||[]).forEach(function(n){var a=$e(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function RO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=He(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function IO(e,t,r){var n=[];return Ya(e,function(s,i,l){switch(l){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function DO(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Ya(e,function(l,o,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!o.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function OO(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ki=1024;function fE(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[_e("xml",null,{"xmlns:v":tn.v,"xmlns:o":tn.o,"xmlns:x":tn.x,"xmlns:mv":tn.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ki<e*1e3;)Ki+=1e3;return t.forEach(function(s){var i=Ct(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var o=l.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=_e("v:fill",o,l),u={on:"t",obscured:"t"};++Ki,a=a.concat(["<v:shape"+Qo({id:"_x0000_s"+Ki,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,_e("v:shadow",null,u),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",mr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),mr("x:AutoFill","False"),mr("x:Row",String(i.r)),mr("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ov(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var l=Ct(i.ref);if(a?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[i.ref],!s){s={t:"z"},a?e[l.r][l.c]=s:e[i.ref]=s;var o=tt(e["!ref"]||"BDWGO1000001:A1");o.s.r>l.r&&(o.s.r=l.r),o.e.r<l.r&&(o.e.r=l.r),o.s.c>l.c&&(o.s.c=l.c),o.e.c<l.c&&(o.e.c=l.c);var c=Ge(o);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}s.c.push(u)})}function LO(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var o=$e(l[0]),c={author:o.authorId&&r[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},u=Ct(o.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&tx(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function dE(e){var t=[$t,_e("comments",null,{xmlns:gi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=ft(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(o){o.a&&(a=r.indexOf(ft(o.a))),s.push(o.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(mr("t",ft(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)i+=`Reply:
    `+s[l]+`
`;t.push(mr("t",ft(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function PO(e,t){var r=[],n=!1,a={},s=0;return e.replace(Ir,function(l,o){var c=$e(l);switch(Sa(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=o+l.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),r}function jO(e,t,r){var n=[$t,_e("ThreadedComments",null,{xmlns:qt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var o={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=o.id:o.parentId=s,i.ID=o.id,i.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(_e("threadedComment",mr("text",i.t||""),o))})}),n.push("</ThreadedComments>"),n.join("")}function MO(e,t){var r=[],n=!1;return e.replace(Ir,function(s){var i=$e(s);switch(Sa(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function BO(e){var t=[$t,_e("personList",null,{xmlns:qt.TCMNT,"xmlns:x":gi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(_e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function UO(e){var t={};t.iauthor=e.read_shift(4);var r=Si(e);return t.rfx=r.s,t.ref=He(r.s),e.l+=16,t}function zO(e,t){return t==null&&(t=de(36)),t.write_shift(4,e[1].iauthor),Fl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var HO=Cr;function $O(e){return or(e.slice(0,54))}function VO(e,t){var r=[],n=[],a={},s=!1;return Ya(e,function(l,o,c){switch(c){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function WO(e){var t=qr(),r=[];return ge(t,628),ge(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ge(t,632,$O(a.a)))})}),ge(t,631),ge(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Ct(n[0]),e:Ct(n[0])};ge(t,635,zO([s,a])),a.t&&a.t.length>0&&ge(t,637,hF(a)),ge(t,636),delete a.iauthor})}),ge(t,634),ge(t,629),t.end()}var GO="application/vnd.ms-office.vbaProject";function YO(e){var t=Ue.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ue.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ue.write(t)}function KO(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ue.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var hE=["xlsb","xlsm","xlam","biff8","xla"];function XO(){return{"!type":"dialog"}}function JO(){return{"!type":"dialog"}}function qO(){return{"!type":"macro"}}function ZO(){return{"!type":"macro"}}var al=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var l=!1,o=!1;s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return l?u+=t.c:--u,o?c+=t.r:--c,a+(l?"":"$")+St(u)+(o?"":"$")+Pt(c)}return function(a,s){return t=s,a.replace(e,r)}}(),sx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ix=function(){return function(t,r){return t.replace(sx,function(n,a,s,i,l,o){var c=Gp(i)-(s?0:r.c),u=Wp(o)-(l?0:r.r),d=u==0?"":l?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+h})}}();function mE(e,t){return e.replace(sx,function(r,n,a,s,i,l){return n+(a=="$"?a+s:St(Gp(s)+t.c))+(i=="$"?i+l:Pt(Wp(l)+t.r))})}function QO(e,t,r){var n=Ur(t),a=n.s,s=Ct(r),i={r:s.r-a.r,c:s.c-a.c};return mE(e,i)}function e8(e){return e.length!=1}function cv(e){return e.replace(/_xlfn\./g,"")}function Gt(e){e.l+=1}function _s(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function pE(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return xE(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=_s(e),l=_s(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function xE(e){var t=_s(e),r=_s(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function t8(e,t,r){if(r.biff<8)return xE(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=_s(e),i=_s(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function gE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return r8(e);var n=e.read_shift(r&&r.biff==12?4:2),a=_s(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function r8(e){var t=_s(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function n8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function a8(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return s8(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:l}}function s8(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function i8(e,t,r){var n=(e[e.l++]&96)>>5,a=pE(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function l8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=pE(e,s,r);return[n,a,i]}function o8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function c8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function u8(e,t,r){var n=(e[e.l++]&96)>>5,a=t8(e,t-1,r);return[n,a]}function f8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function uv(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function d8(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function h8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function m8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function p8(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function x8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function vE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function g8(e){return e.read_shift(2),vE(e)}function v8(e){return e.read_shift(2),vE(e)}function y8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=gE(e,0,r);return[n,a]}function w8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=a8(e,0,r);return[n,a]}function S8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=gE(e,0,r);return[n,a,s]}function k8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[N6[a],SE[a],n]}function E8(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:_8(e);return[a,(s[0]===0?SE:_6)[s[1]]]}function _8(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function N8(e,t,r){e.l+=r&&r.biff==2?3:4}function A8(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function b8(e){return e.l++,Ka[e.read_shift(1)]}function T8(e){return e.l++,e.read_shift(2)}function C8(e){return e.l++,e.read_shift(1)!==0}function F8(e){return e.l++,br(e)}function R8(e,t,r){return e.l++,Cc(e,t-1,r)}function I8(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ka[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=br(e);break;case 2:r[1]=ki(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function D8(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Si:T0)(e));return a}function O8(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var l=0;l!=a;++l)i[s][l]=I8(e,r.biff);return i}function L8(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function P8(e,t,r){if(r.biff==5)return j8(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function j8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function M8(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function B8(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function U8(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function z8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var H8=Rr,$8=Rr,V8=Rr;function Rc(e,t,r){return e.l+=2,[n8(e)]}function lx(e){return e.l+=6,[]}var W8=Rc,G8=lx,Y8=lx,K8=Rc;function yE(e){return e.l+=2,[Kt(e),e.read_shift(2)&1]}var X8=Rc,J8=yE,q8=lx,Z8=Rc,Q8=Rc,e6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function t6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=e6[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function r6(e){return e.l+=2,[e.read_shift(4)]}function n6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function a6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function s6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function i6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function l6(e){return e.l+=4,[0,0]}var fv={1:{n:"PtgExp",f:A8},2:{n:"PtgTbl",f:V8},3:{n:"PtgAdd",f:Gt},4:{n:"PtgSub",f:Gt},5:{n:"PtgMul",f:Gt},6:{n:"PtgDiv",f:Gt},7:{n:"PtgPower",f:Gt},8:{n:"PtgConcat",f:Gt},9:{n:"PtgLt",f:Gt},10:{n:"PtgLe",f:Gt},11:{n:"PtgEq",f:Gt},12:{n:"PtgGe",f:Gt},13:{n:"PtgGt",f:Gt},14:{n:"PtgNe",f:Gt},15:{n:"PtgIsect",f:Gt},16:{n:"PtgUnion",f:Gt},17:{n:"PtgRange",f:Gt},18:{n:"PtgUplus",f:Gt},19:{n:"PtgUminus",f:Gt},20:{n:"PtgPercent",f:Gt},21:{n:"PtgParen",f:Gt},22:{n:"PtgMissArg",f:Gt},23:{n:"PtgStr",f:R8},26:{n:"PtgSheet",f:n6},27:{n:"PtgEndSheet",f:a6},28:{n:"PtgErr",f:b8},29:{n:"PtgBool",f:C8},30:{n:"PtgInt",f:T8},31:{n:"PtgNum",f:F8},32:{n:"PtgArray",f:f8},33:{n:"PtgFunc",f:k8},34:{n:"PtgFuncVar",f:E8},35:{n:"PtgName",f:L8},36:{n:"PtgRef",f:y8},37:{n:"PtgArea",f:i8},38:{n:"PtgMemArea",f:M8},39:{n:"PtgMemErr",f:H8},40:{n:"PtgMemNoMem",f:$8},41:{n:"PtgMemFunc",f:B8},42:{n:"PtgRefErr",f:U8},43:{n:"PtgAreaErr",f:o8},44:{n:"PtgRefN",f:w8},45:{n:"PtgAreaN",f:u8},46:{n:"PtgMemAreaN",f:s6},47:{n:"PtgMemNoMemN",f:i6},57:{n:"PtgNameX",f:P8},58:{n:"PtgRef3d",f:S8},59:{n:"PtgArea3d",f:l8},60:{n:"PtgRefErr3d",f:z8},61:{n:"PtgAreaErr3d",f:c8},255:{}},o6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},c6={1:{n:"PtgElfLel",f:yE},2:{n:"PtgElfRw",f:Z8},3:{n:"PtgElfCol",f:W8},6:{n:"PtgElfRwV",f:Q8},7:{n:"PtgElfColV",f:K8},10:{n:"PtgElfRadical",f:X8},11:{n:"PtgElfRadicalS",f:q8},13:{n:"PtgElfColS",f:G8},15:{n:"PtgElfColSV",f:Y8},16:{n:"PtgElfRadicalLel",f:J8},25:{n:"PtgList",f:t6},29:{n:"PtgSxName",f:r6},255:{}},u6={0:{n:"PtgAttrNoop",f:l6},1:{n:"PtgAttrSemi",f:x8},2:{n:"PtgAttrIf",f:m8},4:{n:"PtgAttrChoose",f:d8},8:{n:"PtgAttrGoto",f:h8},16:{n:"PtgAttrSum",f:N8},32:{n:"PtgAttrBaxcel",f:uv},33:{n:"PtgAttrBaxcel",f:uv},64:{n:"PtgAttrSpace",f:g8},65:{n:"PtgAttrSpaceSemi",f:v8},128:{n:"PtgAttrIfError",f:p8},255:{}};function Ic(e,t,r,n){if(n.biff<8)return Rr(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=O8(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=D8(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Rr(e,t)),s}function Dc(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=fv[s]||fv[o6[s]],(s===24||s===25)&&(a=(s===24?c6:u6)[e[e.l+1]]),!a||!a.f?Rr(e,t):i.push([a.n,a.f(e,t,r)]);return i}function f6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var d6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function h6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function wE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function dv(e,t,r){var n=wE(e,t,r);return n=="#REF"?n:h6(n,r)}function Er(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},l=[],o,c,u,d=0,h=0,p,m="";if(!e[0]||!e[0][0])return"";for(var x=-1,g="",v=0,w=e[0].length;v<w;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=l.pop(),c=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:g=Lt(" ",e[0][x][1][1]);break;case 1:g=Lt("\r",e[0][x][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+g,x=-1}l.push(c+d6[y[0]]+o);break;case"PtgIsect":o=l.pop(),c=l.pop(),l.push(c+" "+o);break;case"PtgUnion":o=l.pop(),c=l.pop(),l.push(c+","+o);break;case"PtgRange":o=l.pop(),c=l.pop(),l.push(c+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=_o(y[1][1],i,a),l.push(No(u,s));break;case"PtgRefN":u=r?_o(y[1][1],r,a):y[1][1],l.push(No(u,s));break;case"PtgRef3d":d=y[1][1],u=_o(y[1][2],i,a),m=dv(n,d,a),l.push(m+"!"+No(u,s));break;case"PtgFunc":case"PtgFuncVar":var k=y[1][0],C=y[1][1];k||(k=0),k&=127;var E=k==0?[]:l.slice(-k);l.length-=k,C==="User"&&(C=E.shift()),l.push(C+"("+E.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":p=zg(y[1][1],r?{s:r}:i,a),l.push(Td(p,a));break;case"PtgArea":p=zg(y[1][1],i,a),l.push(Td(p,a));break;case"PtgArea3d":d=y[1][1],p=y[1][2],m=dv(n,d,a),l.push(m+"!"+Td(p,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],N=S?S.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),l.push(N);break;case"PtgNameX":var F=y[1][1];h=y[1][2];var R;if(a.biff<=5)F<0&&(F=-F),n[F]&&(R=n[F][h]);else{var D="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][h]&&n[F][h].itab>0&&(D=n.SheetNames[n[F][h].itab-1]+"!"):D=n.SheetNames[h-1]+"!"),n[F]&&n[F][h])D+=n[F][h].Name;else if(n[0]&&n[0][h])D+=n[0][h].Name;else{var T=(wE(n,F,a)||"").split(";;");T[h-1]?D=T[h-1]:D+="SH33TJSERRX"}l.push(D);break}R||(R={Name:"SH33TJSERRY"}),l.push(R.Name);break;case"PtgParen":var j="(",Z=")";if(x>=0){switch(g="",e[0][x][1][0]){case 2:j=Lt(" ",e[0][x][1][1])+j;break;case 3:j=Lt("\r",e[0][x][1][1])+j;break;case 4:Z=Lt(" ",e[0][x][1][1])+Z;break;case 5:Z=Lt("\r",e[0][x][1][1])+Z;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(j+l.pop()+Z);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[He(u)]){var W=n.sharedf[He(u)];l.push(Er(W,i,re,n,a))}else{var Q=!1;for(o=0;o!=n.arrayf.length;++o)if(c=n.arrayf[o],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){l.push(Er(c[1],i,re,n,a)),Q=!0;break}Q||l.push(y[1])}break;case"PtgArray":l.push("{"+f6(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&H.indexOf(e[0][v][0])==-1){y=e[0][x];var L=!0;switch(y[1][0]){case 4:L=!1;case 0:g=Lt(" ",y[1][1]);break;case 5:L=!1;case 1:g=Lt("\r",y[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((L?g:"")+l.pop()+(L?"":g)),x=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function m6(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Rr(e,t-2)];var l=Dc(e,i,r);return t!==i+a&&(s=Ic(e,t-i-a,l,r)),e.l=n,[l,s]}function p6(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Rr(e,t-2)];var l=Dc(e,i,r);return t!==i+a&&(s=Ic(e,t-i-a,l,r)),e.l=n,[l,s]}function x6(e,t,r,n){var a=e.l+t,s=Dc(e,n,r),i;return a!==e.l&&(i=Ic(e,a-e.l,s,r)),[s,i]}function g6(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Dc(e,s,r);return s==65535?[[],Rr(e,t-2)]:(t!==s+2&&(a=Ic(e,n-s-2,i,r)),[i,a])}function v6(e){var t;if(Ra(e,e.l+6)!==65535)return[br(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function y6(e){if(e==null){var t=de(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return oi(e);return oi(0)}function Dd(e,t,r){var n=e.l+t,a=ka(e);r.biff==2&&++e.l;var s=v6(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=p6(e,n-e.l,r);return{cell:a,val:s[0],formula:l,shared:i>>3&1,tt:s[1]}}function w6(e,t,r,n,a){var s=ui(t,r,a),i=y6(e.v),l=de(6),o=33;l.write_shift(2,o),l.write_shift(4,0);for(var c=de(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var d=lr([s,i,l,c]);return d}function C0(e,t,r){var n=e.read_shift(4),a=Dc(e,n,r),s=e.read_shift(4),i=s>0?Ic(e,s,a,r):null;return[a,i]}var S6=C0,F0=C0,k6=C0,E6=C0,_6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},SE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},N6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function A6(e){var t="of:="+e.replace(sx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Od(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function b6(e){return e.replace(/\./,"!")}var bo={},sl={},To=typeof Map<"u";function ox(e,t,r){var n=0,a=e.length;if(r){if(To?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=To?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(To?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function R0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Nr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ac(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=zf(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Js(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Rs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){xa(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function kE(e,t,r,n,a,s){try{n.cellNF&&(e.z=ze[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=kt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ze[t]==null&&xa(E3[t]||"General",t),e.t==="e")e.w=e.w||Ka[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qo(e.v);else if(e.t==="d"){var i=er(e.v);(i|0)===i?e.w=i.toString(10):e.w=qo(i)}else{if(e.v===void 0)return"";e.w=ii(e.v,sl)}else e.t==="d"?e.w=un(t,er(e.v),sl):e.w=un(t,e.v,sl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Uf(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Uf(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function T6(e,t,r){if(e&&e["!ref"]){var n=tt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function C6(e,t){var r=tt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ge(r))}var F6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,R6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,I6=/<(?:\w:)?hyperlink [^>]*>/mg,D6=/"(\w*:\w*)"/,O6=/<(?:\w:)?col\b[^>]*[\/]?>/g,L6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,P6=/<(?:\w:)?pageMargins[^>]*\/>/g,EE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,j6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,M6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function B6(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(R6);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(EE);h?cx(h[0],l,a,r):(h=c.match(j6))&&z6(h[0],h[1]||"",l,a,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=c.slice(p,p+50).match(D6);m&&C6(l,m[1])}var x=c.match(M6);x&&x[1]&&eL(x[1],a);var g=[];if(t.cellStyles){var v=c.match(O6);v&&X6(g,v)}d&&nL(d[1],l,t,o,s,i);var w=u.match(L6);w&&(l["!autofilter"]=q6(w[0]));var y=[],k=u.match(F6);if(k)for(p=0;p!=k.length;++p)y[p]=tt(k[p].slice(k[p].indexOf('"')+1));var C=u.match(I6);C&&G6(l,C,n);var E=u.match(P6);if(E&&(l["!margins"]=Y6($e(E[0]))),!l["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(l["!ref"]=Ge(o)),t.sheetRows>0&&l["!ref"]){var S=tt(l["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>o.e.r&&(S.e.r=o.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>o.e.c&&(S.e.c=o.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ge(S))}return g.length>0&&(l["!cols"]=g),y.length>0&&(l["!merges"]=y),l}function U6(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ge(e[r])+'"/>';return t+"</mergeCells>"}function cx(e,t,r,n){var a=$e(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=st(mt(a.codeName)))}function z6(e,t,r,n,a){cx(e.slice(0,e.indexOf(">")),r,n,a)}function H6(e,t,r,n,a){var s=!1,i={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var o=t.SheetNames[r];try{t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}s=!0,i.codeName=da(ft(o))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+_e("outlinePr",null,c)}!s&&!l||(a[a.length]=_e("sheetPr",l,i))}var $6=["objects","scenarios","selectLockedCells","selectUnlockedCells"],V6=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function W6(e){var t={sheet:1};return $6.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),V6.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=rx(e.password).toString(16).toUpperCase()),_e("sheetProtection",null,t)}function G6(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=$e(mt(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+st(s.location))):(s.Target="#"+st(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=tt(s.ref),o=l.s.r;o<=l.e.r;++o)for(var c=l.s.c;c<=l.e.c;++c){var u=He({c,r:o});n?(e[o]||(e[o]=[]),e[o][c]||(e[o][c]={t:"z",v:void 0}),e[o][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function Y6(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function K6(e){return Js(e),_e("pageMargins",null,e)}function X6(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=$e(t[n],!0);a.hidden&&(a.hidden=yt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,nx(a.width)),Es(a);s<=i;)e[s++]=pt(a)}}function J6(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=_e("col",null,R0(a,n)));return r[r.length]="</cols>",r.join("")}function q6(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Z6(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ge(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Ur(a);i.s.r==i.e.r&&(i.e.r=Ur(t["!ref"]).e.r,a=Ge(i));for(var l=0;l<s.length;++l){var o=s[l];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==n){o.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),_e("autoFilter",null,{ref:a})}var Q6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function eL(e,t){t.Views||(t.Views=[{}]),(e.match(Q6)||[]).forEach(function(r,n){var a=$e(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),yt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function tL(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,a),{})}function rL(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ka[e.v];break;case"d":n&&n.cellDates?a=kt(e.v,-1).toISOString():(e=pt(e),e.t="n",a=""+(e.v=er(kt(e.v)))),typeof e.z>"u"&&(e.z=ze[14]);break;default:a=e.v;break}var l=mr("v",ft(a)),o={r:t},c=Rs(n.cellXfs,e,n);switch(c!==0&&(o.s=c),e.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=mr("v",""+ox(n.Strings,e.v,n.revStrings)),o.t="s";break}o.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=_e("f",ft(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(o.cm=1),_e("c",l,o)}var nL=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Zo("v"),i=Zo("f");return function(o,c,u,d,h,p){for(var m=0,x="",g=[],v=[],w=0,y=0,k=0,C="",E,S,N=0,F=0,R,D,T=0,j=0,Z=Array.isArray(p.CellXf),re,W=[],Q=[],H=Array.isArray(c),L=[],ee={},te=!1,b=!!u.sheetStubs,A=o.split(t),O=0,P=A.length;O!=P;++O){x=A[O].trim();var U=x.length;if(U!==0){var q=0;e:for(m=0;m<U;++m)switch(x[m]){case">":if(x[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(S=$e(x.slice(q,m),!0),N=S.r!=null?parseInt(S.r,10):N+1,F=-1,u.sheetRows&&u.sheetRows<N)continue;ee={},te=!1,S.ht&&(te=!0,ee.hpt=parseFloat(S.ht),ee.hpx=gl(ee.hpt)),S.hidden=="1"&&(te=!0,ee.hidden=!0),S.outlineLevel!=null&&(te=!0,ee.level=+S.outlineLevel),te&&(L[N-1]=ee)}break;case"<":q=m;break}if(q>=m)break;if(S=$e(x.slice(q,m),!0),N=S.r!=null?parseInt(S.r,10):N+1,F=-1,!(u.sheetRows&&u.sheetRows<N)){d.s.r>N-1&&(d.s.r=N-1),d.e.r<N-1&&(d.e.r=N-1),u&&u.cellStyles&&(ee={},te=!1,S.ht&&(te=!0,ee.hpt=parseFloat(S.ht),ee.hpx=gl(ee.hpt)),S.hidden=="1"&&(te=!0,ee.hidden=!0),S.outlineLevel!=null&&(te=!0,ee.level=+S.outlineLevel),te&&(L[N-1]=ee)),g=x.slice(m).split(e);for(var J=0;J!=g.length&&g[J].trim().charAt(0)=="<";++J);for(g=g.slice(J),m=0;m!=g.length;++m)if(x=g[m].trim(),x.length!==0){if(v=x.match(r),w=m,y=0,k=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,v!=null&&v.length===2){for(w=0,C=v[1],y=0;y!=C.length&&!((k=C.charCodeAt(y)-64)<1||k>26);++y)w=26*w+k;--w,F=w}else++F;for(y=0;y!=x.length&&x.charCodeAt(y)!==62;++y);if(++y,S=$e(x.slice(0,y),!0),S.r||(S.r=He({r:N-1,c:F})),C=x.slice(y),E={t:""},(v=C.match(s))!=null&&v[1]!==""&&(E.v=st(v[1])),u.cellFormula){if((v=C.match(i))!=null&&v[1]!==""){if(E.f=st(mt(v[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=cv(E.f)),v[0].indexOf('t="array"')>-1)E.F=(C.match(a)||[])[1],E.F.indexOf(":")>-1&&W.push([tt(E.F),E.F]);else if(v[0].indexOf('t="shared"')>-1){D=$e(v[0]);var B=st(mt(v[1]));u.xlfn||(B=cv(B)),Q[parseInt(D.si,10)]=[D,B,S.r]}}else(v=C.match(/<f[^>]*\/>/))&&(D=$e(v[0]),Q[D.si]&&(E.f=QO(Q[D.si][1],Q[D.si][2],S.r)));var ne=Ct(S.r);for(y=0;y<W.length;++y)ne.r>=W[y][0].s.r&&ne.r<=W[y][0].e.r&&ne.c>=W[y][0].s.c&&ne.c<=W[y][0].e.c&&(E.F=W[y][1])}if(S.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(b)E.t="z";else continue;else E.t=S.t||"n";switch(d.s.c>F&&(d.s.c=F),d.e.c<F&&(d.e.c=F),E.t){case"n":if(E.v==""||E.v==null){if(!b)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!b)continue;E.t="z"}else R=bo[parseInt(E.v,10)],E.v=R.t,E.r=R.r,u.cellHTML&&(E.h=R.h);break;case"str":E.t="s",E.v=E.v!=null?mt(E.v):"",u.cellHTML&&(E.h=jp(E.v));break;case"inlineStr":v=C.match(n),E.t="s",v!=null&&(R=tx(v[1]))?(E.v=R.t,u.cellHTML&&(E.h=R.h)):E.v="";break;case"b":E.v=yt(E.v);break;case"d":u.cellDates?E.v=kt(E.v,1):(E.v=er(kt(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=Nk[E.v];break}if(T=j=0,re=null,Z&&S.s!==void 0&&(re=p.CellXf[S.s],re!=null&&(re.numFmtId!=null&&(T=re.numFmtId),u.cellStyles&&re.fillId!=null&&(j=re.fillId))),kE(E,T,j,u,h,p),u.cellDates&&Z&&E.t=="n"&&xi(ze[T])&&(E.t="d",E.v=A0(E.v)),S.cm&&u.xlmeta){var fe=(u.xlmeta.Cell||[])[+S.cm-1];fe&&fe.type=="XLDAPR"&&(E.D=!0)}if(H){var M=Ct(S.r);c[M.r]||(c[M.r]=[]),c[M.r][M.c]=E}else c[S.r]=E}}}}L.length>0&&(c["!rows"]=L)}}();function aL(e,t,r,n){var a=[],s=[],i=tt(e["!ref"]),l="",o,c="",u=[],d=0,h=0,p=e["!rows"],m=Array.isArray(e),x={r:c},g,v=-1;for(h=i.s.c;h<=i.e.c;++h)u[h]=St(h);for(d=i.s.r;d<=i.e.r;++d){for(s=[],c=Pt(d),h=i.s.c;h<=i.e.c;++h){o=u[h]+c;var w=m?(e[d]||[])[h]:e[o];w!==void 0&&(l=rL(w,o,e,t))!=null&&s.push(l)}(s.length>0||p&&p[d])&&(x={r:c},p&&p[d]&&(g=p[d],g.hidden&&(x.hidden=1),v=-1,g.hpx?v=sc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(x.ht=v,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),a[a.length]=_e("row",s.join(""),x))}if(p)for(;d<p.length;++d)p&&p[d]&&(x={r:d+1},g=p[d],g.hidden&&(x.hidden=1),v=-1,g.hpx?v=sc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(x.ht=v,x.customHeight=1),g.level&&(x.outlineLevel=g.level),a[a.length]=_e("row","",x));return a.join("")}function _E(e,t,r,n){var a=[$t,_e("worksheet",null,{xmlns:gi[0],"xmlns:r":qt.r})],s=r.SheetNames[e],i=0,l="",o=r.Sheets[s];o==null&&(o={});var c=o["!ref"]||"A1",u=tt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ge(u)}n||(n={}),o["!comments"]=[];var d=[];H6(o,r,e,t,a),a[a.length]=_e("dimension",null,{ref:c}),a[a.length]=tL(o,t,e,r),t.sheetFormat&&(a[a.length]=_e("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),o["!cols"]!=null&&o["!cols"].length>0&&(a[a.length]=J6(o,o["!cols"])),a[i=a.length]="<sheetData/>",o["!links"]=[],o["!ref"]!=null&&(l=aL(o,t),l.length>0&&(a[a.length]=l)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),o["!protect"]&&(a[a.length]=W6(o["!protect"])),o["!autofilter"]!=null&&(a[a.length]=Z6(o["!autofilter"],o,r,e)),o["!merges"]!=null&&o["!merges"].length>0&&(a[a.length]=U6(o["!merges"]));var h=-1,p,m=-1;return o["!links"].length>0&&(a[a.length]="<hyperlinks>",o["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(m=ut(n,-1,ft(x[1].Target).replace(/#.*$/,""),qe.HLINK),p["r:id"]="rId"+m),(h=x[1].Target.indexOf("#"))>-1&&(p.location=ft(x[1].Target.slice(h+1))),x[1].Tooltip&&(p.tooltip=ft(x[1].Tooltip)),a[a.length]=_e("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete o["!links"],o["!margins"]!=null&&(a[a.length]=K6(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=mr("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(m=ut(n,-1,"../drawings/drawing"+(e+1)+".xml",qe.DRAW),a[a.length]=_e("drawing",null,{"r:id":"rId"+m}),o["!drawing"]=d),o["!comments"].length>0&&(m=ut(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",qe.VML),a[a.length]=_e("legacyDrawing",null,{"r:id":"rId"+m}),o["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function sL(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function iL(e,t,r){var n=de(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=sc(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var l=0,o=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[He(c)];m&&(d<0&&(d=p),h=p)}d<0||(++l,n.write_shift(4,d),n.write_shift(4,h))}var x=n.l;return n.l=o,n.write_shift(4,l),n.l=x,n.length>n.l?n.slice(0,n.l):n}function lL(e,t,r,n){var a=iL(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ge(e,0,a)}var oL=Si,cL=Fl;function uL(){}function fL(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=mF(e),r}function dL(e,t,r){r==null&&(r=de(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return jf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),wk(e,r),r.slice(0,r.l)}function hL(e){var t=Mn(e);return[t]}function mL(e,t,r){return r==null&&(r=de(8)),vi(t,r)}function pL(e){var t=yi(e);return[t]}function xL(e,t,r){return r==null&&(r=de(4)),wi(t,r)}function gL(e){var t=Mn(e),r=e.read_shift(1);return[t,r,"b"]}function vL(e,t,r){return r==null&&(r=de(9)),vi(t,r),r.write_shift(1,e.v?1:0),r}function yL(e){var t=yi(e),r=e.read_shift(1);return[t,r,"b"]}function wL(e,t,r){return r==null&&(r=de(5)),wi(t,r),r.write_shift(1,e.v?1:0),r}function SL(e){var t=Mn(e),r=e.read_shift(1);return[t,r,"e"]}function kL(e,t,r){return r==null&&(r=de(9)),vi(t,r),r.write_shift(1,e.v),r}function EL(e){var t=yi(e),r=e.read_shift(1);return[t,r,"e"]}function _L(e,t,r){return r==null&&(r=de(8)),wi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function NL(e){var t=Mn(e),r=e.read_shift(4);return[t,r,"s"]}function AL(e,t,r){return r==null&&(r=de(12)),vi(t,r),r.write_shift(4,t.v),r}function bL(e){var t=yi(e),r=e.read_shift(4);return[t,r,"s"]}function TL(e,t,r){return r==null&&(r=de(8)),wi(t,r),r.write_shift(4,t.v),r}function CL(e){var t=Mn(e),r=br(e);return[t,r,"n"]}function FL(e,t,r){return r==null&&(r=de(16)),vi(t,r),oi(e.v,r),r}function NE(e){var t=yi(e),r=br(e);return[t,r,"n"]}function RL(e,t,r){return r==null&&(r=de(12)),wi(t,r),oi(e.v,r),r}function IL(e){var t=Mn(e),r=Jp(e);return[t,r,"n"]}function DL(e,t,r){return r==null&&(r=de(12)),vi(t,r),Sk(e.v,r),r}function OL(e){var t=yi(e),r=Jp(e);return[t,r,"n"]}function LL(e,t,r){return r==null&&(r=de(8)),wi(t,r),Sk(e.v,r),r}function PL(e){var t=Mn(e),r=Yp(e);return[t,r,"is"]}function jL(e){var t=Mn(e),r=Cr(e);return[t,r,"str"]}function ML(e,t,r){return r==null&&(r=de(12+4*e.v.length)),vi(t,r),or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BL(e){var t=yi(e),r=Cr(e);return[t,r,"str"]}function UL(e,t,r){return r==null&&(r=de(8+4*e.v.length)),wi(t,r),or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zL(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var l=F0(e,n-e.l,r);i[3]=Er(l,null,a,r.supbooks,r)}else e.l=n;return i}function HL(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var l=F0(e,n-e.l,r);i[3]=Er(l,null,a,r.supbooks,r)}else e.l=n;return i}function $L(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var s=br(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var l=F0(e,n-e.l,r);i[3]=Er(l,null,a,r.supbooks,r)}else e.l=n;return i}function VL(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var s=Cr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var l=F0(e,n-e.l,r);i[3]=Er(l,null,a,r.supbooks,r)}else e.l=n;return i}var WL=Si,GL=Fl;function YL(e,t){return t==null&&(t=de(4)),t.write_shift(4,e),t}function KL(e,t){var r=e.l+t,n=Si(e),a=Kp(e),s=Cr(e),i=Cr(e),l=Cr(e);e.l=r;var o={rfx:n,relId:a,loc:s,display:l};return i&&(o.Tooltip=i),o}function XL(e,t){var r=de(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Fl({s:Ct(e[0]),e:Ct(e[0])},r),Xp("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return or(a||"",r),or(e[1].Tooltip||"",r),or("",r),r.slice(0,r.l)}function JL(){}function qL(e,t,r){var n=e.l+t,a=kk(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var l=S6(e,n-e.l,r);i[1]=l}else e.l=n;return i}function ZL(e,t,r){var n=e.l+t,a=Si(e),s=[a];if(r.cellFormula){var i=E6(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function QL(e,t,r){r==null&&(r=de(18));var n=R0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var AE=["left","right","top","bottom","header","footer"];function e5(e){var t={};return AE.forEach(function(r){t[r]=br(e)}),t}function t5(e,t){return t==null&&(t=de(6*8)),Js(e),AE.forEach(function(r){oi(e[r],t)}),t}function r5(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function n5(e,t,r){r==null&&(r=de(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function a5(e){var t=de(24);return t.write_shift(4,4),t.write_shift(4,1),Fl(e,t),t}function s5(e,t){return t==null&&(t=de(16*4+2)),t.write_shift(2,e.password?rx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function i5(){}function l5(){}function o5(e,t,r,n,a,s,i){if(!e)return e;var l=t||{};n||(n={"!id":{}});var o=l.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,m,x,g,v,w,y,k,C,E=[];l.biff=12,l["!row"]=0;var S=0,N=!1,F=[],R={},D=l.supbooks||a.supbooks||[[]];if(D.sharedf=R,D.arrayf=F,D.SheetNames=a.SheetNames||a.Sheets.map(function(H){return H.name}),!l.supbooks&&(l.supbooks=D,a.Names))for(var T=0;T<a.Names.length;++T)D[0][T+1]=a.Names[T];var j=[],Z=[],re=!1;ic[16]={n:"BrtShortReal",f:NE};var W;if(Ya(e,function(L,ee,te){if(!h)switch(te){case 148:c=L;break;case 0:p=L,l.sheetRows&&l.sheetRows<=p.r&&(h=!0),k=Pt(g=p.r),l["!row"]=p.r,(L.hidden||L.hpt||L.level!=null)&&(L.hpt&&(L.hpx=gl(L.hpt)),Z[L.r]=L);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:L[2]},L[2]){case"n":m.v=L[1];break;case"s":y=bo[L[1]],m.v=y.t,m.r=y.r;break;case"b":m.v=!!L[1];break;case"e":m.v=L[1],l.cellText!==!1&&(m.w=Ka[m.v]);break;case"str":m.t="s",m.v=L[1];break;case"is":m.t="s",m.v=L[1].t;break}if((x=i.CellXf[L[0].iStyleRef])&&kE(m,x.numFmtId,null,l,s,i),v=L[0].c==-1?v+1:L[0].c,l.dense?(o[g]||(o[g]=[]),o[g][v]=m):o[St(v)+k]=m,l.cellFormula){for(N=!1,S=0;S<F.length;++S){var b=F[S];p.r>=b[0].s.r&&p.r<=b[0].e.r&&v>=b[0].s.c&&v<=b[0].e.c&&(m.F=Ge(b[0]),N=!0)}!N&&L.length>3&&(m.f=L[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),l.cellDates&&x&&m.t=="n"&&xi(ze[x.numFmtId])){var A=os(m.v);A&&(m.t="d",m.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}W&&(W.type=="XLDAPR"&&(m.D=!0),W=void 0);break;case 1:case 12:if(!l.sheetStubs||d)break;m={t:"z",v:void 0},v=L[0].c==-1?v+1:L[0].c,l.dense?(o[g]||(o[g]=[]),o[g][v]=m):o[St(v)+k]=m,u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),W&&(W.type=="XLDAPR"&&(m.D=!0),W=void 0);break;case 176:E.push(L);break;case 49:W=((l.xlmeta||{}).Cell||[])[L-1];break;case 494:var O=n["!id"][L.relId];for(O?(L.Target=O.Target,L.loc&&(L.Target+="#"+L.loc),L.Rel=O):L.relId==""&&(L.Target="#"+L.loc),g=L.rfx.s.r;g<=L.rfx.e.r;++g)for(v=L.rfx.s.c;v<=L.rfx.e.c;++v)l.dense?(o[g]||(o[g]=[]),o[g][v]||(o[g][v]={t:"z",v:void 0}),o[g][v].l=L):(w=He({c:v,r:g}),o[w]||(o[w]={t:"z",v:void 0}),o[w].l=L);break;case 426:if(!l.cellFormula)break;F.push(L),C=l.dense?o[g][v]:o[St(v)+k],C.f=Er(L[1],u,{r:p.r,c:v},D,l),C.F=Ge(L[0]);break;case 427:if(!l.cellFormula)break;R[He(L[0].s)]=L[1],C=l.dense?o[g][v]:o[St(v)+k],C.f=Er(L[1],u,{r:p.r,c:v},D,l);break;case 60:if(!l.cellStyles)break;for(;L.e>=L.s;)j[L.e--]={width:L.w/256,hidden:!!(L.flags&1),level:L.level},re||(re=!0,nx(L.w/256)),Es(j[L.e+1]);break;case 161:o["!autofilter"]={ref:Ge(L)};break;case 476:o["!margins"]=L;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),L.name&&(a.Sheets[r].CodeName=L.name),(L.above||L.left)&&(o["!outline"]={above:L.above,left:L.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),L.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ee.T){if(!d||l.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},l),delete l.supbooks,delete l["!row"],!o["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(o["!ref"]=Ge(c||u)),l.sheetRows&&o["!ref"]){var Q=tt(o["!ref"]);l.sheetRows<=+Q.e.r&&(Q.e.r=l.sheetRows-1,Q.e.r>u.e.r&&(Q.e.r=u.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>u.e.c&&(Q.e.c=u.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ge(Q))}return E.length>0&&(o["!merges"]=E),j.length>0&&(o["!cols"]=j),Z.length>0&&(o["!rows"]=Z),o}function c5(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=pt(t),t.z=t.z||ze[14],t.v=er(kt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var o={r,c:n};switch(o.s=Rs(a.cellXfs,t,a),t.l&&s["!links"].push([He(o),t.l]),t.c&&s["!comments"].push([He(o),t.c]),t.t){case"s":case"str":return a.bookSST?(l=ox(a.Strings,t.v,a.revStrings),o.t="s",o.v=l,i?ge(e,18,TL(t,o)):ge(e,7,AL(t,o))):(o.t="str",i?ge(e,17,UL(t,o)):ge(e,6,ML(t,o))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ge(e,13,LL(t,o)):ge(e,2,DL(t,o)):i?ge(e,16,RL(t,o)):ge(e,5,FL(t,o)),!0;case"b":return o.t="b",i?ge(e,15,wL(t,o)):ge(e,4,vL(t,o)),!0;case"e":return o.t="e",i?ge(e,14,_L(t,o)):ge(e,3,kL(t,o)),!0}return i?ge(e,12,xL(t,o)):ge(e,1,mL(t,o)),!0}function u5(e,t,r,n){var a=tt(t["!ref"]||"A1"),s,i="",l=[];ge(e,145);var o=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){i=Pt(u),lL(e,t,a,u);var d=!1;if(u<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){u===a.s.r&&(l[h]=St(h)),s=l[h]+i;var p=o?(t[u]||[])[h]:t[s];if(!p){d=!1;continue}d=c5(e,p,u,h,n,t,d)}}ge(e,146)}function f5(e,t){!t||!t["!merges"]||(ge(e,177,YL(t["!merges"].length)),t["!merges"].forEach(function(r){ge(e,176,GL(r))}),ge(e,178))}function d5(e,t){!t||!t["!cols"]||(ge(e,390),t["!cols"].forEach(function(r,n){r&&ge(e,60,QL(n,r))}),ge(e,391))}function h5(e,t){!t||!t["!ref"]||(ge(e,648),ge(e,649,a5(tt(t["!ref"]))),ge(e,650))}function m5(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=ut(r,-1,n[1].Target.replace(/#.*$/,""),qe.HLINK);ge(e,494,XL(n,a))}}),delete t["!links"]}function p5(e,t,r,n){if(t["!comments"].length>0){var a=ut(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",qe.VML);ge(e,551,Xp("rId"+a)),t["!legacy"]=a}}function x5(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Ge(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Ur(s);l.s.r==l.e.r&&(l.e.r=Ur(t["!ref"]).e.r,s=Ge(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ge(e,161,Fl(tt(s))),ge(e,162)}}function g5(e,t,r){ge(e,133),ge(e,137,n5(t,r)),ge(e,138),ge(e,134)}function v5(e,t){t["!protect"]&&ge(e,535,s5(t["!protect"]))}function y5(e,t,r,n){var a=qr(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var o=tt(i["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ge(a,129),(r.vbaraw||i["!outline"])&&ge(a,147,dL(l,i["!outline"])),ge(a,148,cL(o)),g5(a,i,r.Workbook),d5(a,i),u5(a,i,e,t),v5(a,i),x5(a,i,r,e),f5(a,i),m5(a,i,n),i["!margins"]&&ge(a,476,t5(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&h5(a,i),p5(a,i,e,n),ge(a,130),a.end()}function w5(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=st((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function S5(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var l=0,o=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=w5(d);u.s.r=u.s.c=0,u.e.c=l,c=St(l),h[0].forEach(function(p,m){i[c+Pt(m)]={t:"n",v:p,z:h[1]},o=m}),u.e.r<o&&(u.e.r=o),++l}),l>0&&(i["!ref"]=Ge(u)),i}function k5(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,l=e.match(EE);return l&&cx(l[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function E5(e,t){e.l+=10;var r=Cr(e);return{name:r}}function _5(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ya(e,function(o,c,u){switch(u){case 550:s["!rel"]=o;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),o.name&&(a.Sheets[r].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ux=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],N5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],A5=[],b5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function mv(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=yt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function pv(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=yt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function bE(e){pv(e.WBProps,ux),pv(e.CalcPr,b5),mv(e.WBView,N5),mv(e.Sheets,A5),sl.date1904=yt(e.WBProps.date1904)}function T5(e){return!e.Workbook||!e.Workbook.WBProps?"false":yt(e.Workbook.WBProps.date1904)?"true":"false"}var C5="][*?/\\".split("");function TE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return C5.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function F5(e,t,r){e.forEach(function(n,a){TE(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function CE(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];F5(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)T6(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var R5=/<\w+:workbook/;function I5(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Ir,function(o,c){var u=$e(o);switch(Sa(u[0])){case"<?xml":break;case"<workbook":o.match(R5)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ux.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=yt(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=mt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=st(mt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=mt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),yt(u.hidden||"0")&&(s.Hidden=!0),i=c+o.length;break;case"</definedName>":s.Ref=st(mt(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return o}),gi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return bE(r),r}function FE(e){var t=[$t];t[t.length]=_e("workbook",null,{xmlns:gi[0],"xmlns:r":qt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ux.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=_e("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:ft(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=_e("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var o={name:l.Name};l.Comment&&(o.comment=l.Comment),l.Sheet!=null&&(o.localSheetId=""+l.Sheet),l.Hidden&&(o.hidden="1"),l.Ref&&(t[t.length]=_e("definedName",ft(l.Ref),o))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function D5(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=im(e),r.name=Cr(e),r}function O5(e,t){return t||(t=de(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Xp(e.strRelID,t),or(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function L5(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Cr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function P5(e,t){t||(t=de(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),wk(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function j5(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function M5(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=pF(e),i=k6(e,0,r),l=Kp(e);e.l=n;var o={Name:s,Ptg:i};return a<268435455&&(o.Sheet=a),l&&(o.Comment=l),o}function B5(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],ic[16]={n:"BrtFRTArchID$",f:j5},Ya(e,function(o,c,u){switch(u){case 156:i.SheetNames.push(o.name),r.Sheets.push(o);break;case 153:r.WBProps=o;break;case 39:o.Sheet!=null&&(t.SID=o.Sheet),o.Ref=Er(o.Ptg,null,null,i,t),delete t.SID,delete o.Ptg,s.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,o]):i[0]=[u,o],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(o),i.XTI=i.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),bE(r),r.Names=s,r.supbooks=i,r}function U5(e,t){ge(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ge(e,156,O5(a))}ge(e,144)}function z5(e,t){t||(t=de(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return or("SheetJS",t),or(Xo.version,t),or(Xo.version,t),or("7262",t),t.length>t.l?t.slice(0,t.l):t}function H5(e,t){t||(t=de(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function $5(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(ge(e,135),ge(e,158,H5(a)),ge(e,136))}}function V5(e,t){var r=qr();return ge(r,131),ge(r,128,z5()),ge(r,153,P5(e.Workbook&&e.Workbook.WBProps||null)),$5(r,e),U5(r,e),ge(r,132),r.end()}function W5(e,t,r){return t.slice(-4)===".bin"?B5(e,r):I5(e,r)}function G5(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?o5(e,n,r,a,s,i,l):B6(e,n,r,a,s,i,l)}function Y5(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?_5(e,n,r,a,s):k5(e,n,r,a,s)}function K5(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?qO():ZO()}function X5(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?XO():JO()}function J5(e,t,r,n){return t.slice(-4)===".bin"?GD(e,r,n):OD(e,r,n)}function q5(e,t,r){return cE(e,r)}function Z5(e,t,r){return t.slice(-4)===".bin"?QI(e,r):JI(e,r)}function Q5(e,t,r){return t.slice(-4)===".bin"?VO(e,r):LO(e,r)}function eP(e,t,r){return t.slice(-4)===".bin"?IO(e):FO(e)}function tP(e,t,r,n){return r.slice(-4)===".bin"?DO(e,t,r,n):void 0}function rP(e,t,r){return t.slice(-4)===".bin"?bO(e,t,r):CO(e,t,r)}function nP(e,t,r){return(t.slice(-4)===".bin"?V5:FE)(e)}function aP(e,t,r,n,a){return(t.slice(-4)===".bin"?y5:_E)(e,r,n,a)}function sP(e,t,r){return(t.slice(-4)===".bin"?rO:lE)(e,r)}function iP(e,t,r){return(t.slice(-4)===".bin"?rD:Qk)(e,r)}function lP(e,t,r){return(t.slice(-4)===".bin"?WO:dE)(e)}function oP(e){return(e.slice(-4)===".bin"?TO:uE)()}var RE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,IE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Un(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(RE),s,i,l,o;if(a)for(o=0;o!=a.length;++o)s=a[o].match(IE),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(i+1),n[l]=s[2].slice(1,s[2].length-1));return n}function cP(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(RE),a,s,i,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(IE),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var Co;function uP(e,t){var r=Co[e]||st(e);return r==="General"?ii(t):un(r,t)}function fP(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=yt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=kt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[st(t)]=a}function dP(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ka[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qo(e.v):e.w=ii(e.v):e.w=uP(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Co[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&xi(n)){var a=os(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function hP(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=AD[n.Pattern]||n.Pattern)}e[t.ID]=t}function mP(e,t,r,n,a,s,i,l,o,c){var u="General",d=n.StyleID,h={};c=c||{};var p=[],m=0;for(d===void 0&&l&&(d=l.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&p.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=yt(e);break;case"String":n.t="s",n.r=Ig(st(e)),n.v=e.indexOf("<")>-1?st(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(kt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=st(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Nk[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Ig(t||e));break}if(dP(n,u,c),c.cellFormula!==!1)if(n.Formula){var x=st(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=al(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=al("RC:RC",a):n.ArrayRange&&(n.F=al(n.ArrayRange,a),o.push([tt(n.F),n.F]))}else for(m=0;m<o.length;++m)a.r>=o[m][0].s.r&&a.r<=o[m][0].e.r&&a.c>=o[m][0].s.c&&a.c<=o[m][0].e.c&&(n.F=o[m][1]);c.cellStyles&&(p.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function pP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ld(e,t){var r=t||{};bl();var n=Yi(Mp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof nt<"u"?n=nt.utils.decode(65001,Ff(n)):n=mt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=pt(r);return i.type="string",xl.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Me){a.indexOf("<"+Me)>=0&&(s=!0)}),s)return qP(n,r);Co={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,o=[],c,u={},d=[],h=r.dense?[]:{},p="",m={},x={},g=Un('<Data ss:Type="String">'),v=0,w=0,y=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},E={},S="",N=0,F=[],R={},D={},T=0,j=[],Z=[],re={},W=[],Q,H=!1,L=[],ee=[],te={},b=0,A=0,O={Sheets:[],WBProps:{date1904:!1}},P={};ec.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var U="";l=ec.exec(n);)switch(l[3]=(U=l[3]).toLowerCase()){case"data":if(U=="data"){if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&o.push([l[3],!0]);break}if(o[o.length-1][1])break;l[1]==="/"?mP(n.slice(v,l.index),S,g,o[o.length-1][0]=="comment"?re:m,{c:w,r:y},C,W[w],x,L,r):(S="",g=Un(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Z.length>0&&(m.c=Z),(!r.sheetRows||r.sheetRows>y)&&m.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][w]=m):h[St(w)+Pt(y)]=m),m.HRef&&(m.l={Target:st(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(b=w+(parseInt(m.MergeAcross,10)|0),A=y+(parseInt(m.MergeDown,10)|0),F.push({s:{c:w,r:y},e:{c:b,r:A}})),!r.sheetStubs)m.MergeAcross?w=b+1:++w;else if(m.MergeAcross||m.MergeDown){for(var q=w;q<=b;++q)for(var J=y;J<=A;++J)(q>w||J>y)&&(r.dense?(h[J]||(h[J]=[]),h[J][q]={t:"z"}):h[St(q)+Pt(J)]={t:"z"});w=b+1}else++w;else m=cP(l[0]),m.Index&&(w=+m.Index-1),w<k.s.c&&(k.s.c=w),w>k.e.c&&(k.e.c=w),l[0].slice(-2)==="/>"&&++w,Z=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<k.s.r&&(k.s.r=y),y>k.e.r&&(k.e.r=y),l[0].slice(-2)==="/>"&&(x=Un(l[0]),x.Index&&(y=+x.Index-1)),w=0,++y):(x=Un(l[0]),x.Index&&(y=+x.Index-1),te={},(x.AutoFitHeight=="0"||x.Height)&&(te.hpx=parseInt(x.Height,10),te.hpt=sc(te.hpx),ee[y]=te),x.Hidden=="1"&&(te.hidden=!0,ee[y]=te));break;case"worksheet":if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"));d.push(p),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(h["!ref"]=Ge(k),r.sheetRows&&r.sheetRows<=k.e.r&&(h["!fullref"]=h["!ref"],k.e.r=r.sheetRows-1,h["!ref"]=Ge(k))),F.length&&(h["!merges"]=F),W.length>0&&(h["!cols"]=W),ee.length>0&&(h["!rows"]=ee),u[p]=h}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,o.push([l[3],!1]),c=Un(l[0]),p=st(c.Name),h=r.dense?[]:{},F=[],L=[],ee=[],P={name:p,Hidden:0},O.Sheets.push(P);break;case"table":if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else{if(l[0].slice(-2)=="/>")break;o.push([l[3],!1]),W=[],H=!1}break;case"style":l[1]==="/"?hP(C,E,r):E=Un(l[0]);break;case"numberformat":E.nf=st(Un(l[0]).Format||"General"),Co[E.nf]&&(E.nf=Co[E.nf]);for(var B=0;B!=392&&ze[B]!=E.nf;++B);if(B==392){for(B=57;B!=392;++B)if(ze[B]==null){xa(E.nf,B);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(Q=Un(l[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!H&&Q.wpx>10){H=!0,Nr=sE;for(var ne=0;ne<W.length;++ne)W[ne]&&Es(W[ne])}H&&Es(Q),W[Q.Index-1||W.length]=Q;for(var fe=0;fe<+Q.Span;++fe)W[W.length]=pt(Q);break;case"namedrange":if(l[1]==="/")break;O.Names||(O.Names=[]);var M=$e(l[0]),ue={Name:M.Name,Ref:al(M.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(ue.Sheet=O.Sheets.length-1),O.Names.push(ue);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?S+=n.slice(N,l.index):N=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Un(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?UF(R,U,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else o.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"));pP(re),Z.push(re)}else o.push([l[3],!1]),c=Un(l[0]),re={a:c.Author};break;case"autofilter":if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ye=Un(l[0]);h["!autofilter"]={ref:al(ye.Range).replace(/\$/g,"")},o.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&o.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((c=o.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&o.push([l[3],!0]);break;case"null":break;default:if(o.length==0&&l[3]=="document"||o.length==0&&l[3]=="uof")return wv(n,r);var Te=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else T=l.index+l[0].length;break;case"header":h["!margins"]||Js(h["!margins"]={},"xlml"),isNaN(+$e(l[0]).Margin)||(h["!margins"].header=+$e(l[0]).Margin);break;case"footer":h["!margins"]||Js(h["!margins"]={},"xlml"),isNaN(+$e(l[0]).Margin)||(h["!margins"].footer=+$e(l[0]).Margin);break;case"pagemargins":var ve=$e(l[0]);h["!margins"]||Js(h["!margins"]={},"xlml"),isNaN(+ve.Top)||(h["!margins"].top=+ve.Top),isNaN(+ve.Left)||(h["!margins"].left=+ve.Left),isNaN(+ve.Right)||(h["!margins"].right=+ve.Right),isNaN(+ve.Bottom)||(h["!margins"].bottom=+ve.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||l[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?fP(D,U,j,n.slice(T,l.index)):(j=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+o.join("|")}var pe={};return!r.bookSheets&&!r.bookProps&&(pe.Sheets=u),pe.SheetNames=d,pe.Workbook=O,pe.SSF=pt(ze),pe.Props=R,pe.Custprops=D,pe}function hm(e,t){switch(hx(t=t||{}),t.type||"base64"){case"base64":return Ld(cn(e),t);case"binary":case"buffer":case"file":return Ld(e,t);case"array":return Ld(Cs(e),t)}}function xP(e,t){var r=[];return e.Props&&r.push(zF(e.Props,t)),e.Custprops&&r.push(HF(e.Props,e.Custprops)),r.join("")}function gP(){return""}function vP(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(_e("NumberFormat",null,{"ss:Format":ft(ze[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(_e("Style",s.join(""),i))}),_e("Styles",r.join(""))}function DE(e){return _e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ix(e.Ref,{r:0,c:0})})}function yP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(DE(a)))}return _e("Names",r.join(""))}function wP(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var l=a[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(DE(l)))}return s.join("")}function SP(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(_e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(_e("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(_e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(_e("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(mr("ProtectContents","True")),e["!protect"].objects&&a.push(mr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(mr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(mr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(mr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":_e("WorksheetOptions",a.join(""),{xmlns:tn.x})}function kP(e){return e.map(function(t){var r=V3(t.t||""),n=_e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",n,{"ss:Author":t.a})}).join("")}function EP(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+ft(ix(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var o=Ct(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(o.r==i.r?"":"["+(o.r-i.r)+"]")+"C"+(o.c==i.c?"":"["+(o.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=ft(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=ft(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=i.c||c[u].s.r!=i.r||(c[u].e.c>c[u].s.c&&(l["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(l["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=Ka[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ze[14]);break;case"s":d="String",h=$3(e.v||"");break}var p=Rs(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=i.c+1;var m=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(x+=kP(e.c)),_e("Cell",x,l)}function _P(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=gl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function NP(e,t,r,n){if(!e["!ref"])return"";var a=tt(e["!ref"]),s=e["!merges"]||[],i=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Es(g);var w=!!g.width,y=R0(v,g),k={"ss:Index":v+1};w&&(k["ss:Width"]=nc(y.width)),g.hidden&&(k["ss:Hidden"]="1"),l.push(_e("Column",null,k))});for(var o=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[_P(c,(e["!rows"]||[])[c])],d=a.s.c;d<=a.e.c;++d){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>c)&&!(s[i].e.c<d)&&!(s[i].e.r<c)){(s[i].s.c!=d||s[i].s.r!=c)&&(h=!0);break}if(!h){var p={r:c,c:d},m=He(p),x=o?(e[c]||[])[d]:e[m];u.push(EP(x,m,e,t,r,n,p))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function AP(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?wP(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?NP(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(SP(s,t,e,r)),n.join("")}function bP(e,t){t||(t={}),e.SSF||(e.SSF=pt(ze)),e.SSF&&(bl(),bc(e.SSF),t.revssf=N0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Rs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xP(e,t)),r.push(gP()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(_e("Worksheet",AP(n,t,e),{"ss:Name":ft(e.SheetNames[n])}));return r[2]=vP(e,t),r[3]=yP(e),$t+_e("Workbook",r.join(""),{xmlns:tn.ss,"xmlns:o":tn.o,"xmlns:x":tn.x,"xmlns:ss":tn.ss,"xmlns:dt":tn.dt,"xmlns:html":tn.html})}function TP(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=wF(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=SF(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var CP=[60,1084,2066,2165,2175];function FP(e,t,r,n,a){var s=n,i=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}i.push(l),r.l+=s;for(var o=Ra(r,r.l),c=mm[o],u=0;c!=null&&CP.indexOf(o)>-1;)s=Ra(r,r.l+2),u=r.l+4,o==2066?u+=4:(o==2165||o==2175)&&(u+=12),l=r.slice(u,r.l+4+s),i.push(l),r.l+=4+s,c=mm[o=Ra(r,r.l)];var d=lr(i);hr(d,0);var h=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(h),h+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function aa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ze[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ka[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qo(e.v):e.w=ii(e.v):e.w=un(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&xi(ze[n]||String(n))){var a=os(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function vu(e,t,r){return{v:e,ixfe:t,t:r}}function RP(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},l=null,o=[],c="",u={},d,h="",p,m,x,g,v={},w=[],y,k,C=[],E=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},F=function(Oe){return Oe<8?Ys[Oe]:Oe<64&&E[Oe-8]||Ys[Oe]},R=function(Oe,At,rr){var ht=At.XF.data;if(!(!ht||!ht.patternType||!rr||!rr.cellStyles)){At.s={},At.s.patternType=ht.patternType;var pn;(pn=rc(F(ht.icvFore)))&&(At.s.fgColor={rgb:pn}),(pn=rc(F(ht.icvBack)))&&(At.s.bgColor={rgb:pn})}},D=function(Oe,At,rr){if(!(te>1)&&!(rr.sheetRows&&Oe.r>=rr.sheetRows)){if(rr.cellStyles&&At.XF&&At.XF.data&&R(Oe,At,rr),delete At.ixfe,delete At.XF,d=Oe,h=He(Oe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<i.s.r&&(i.s.r=Oe.r),Oe.c<i.s.c&&(i.s.c=Oe.c),Oe.r+1>i.e.r&&(i.e.r=Oe.r+1),Oe.c+1>i.e.c&&(i.e.c=Oe.c+1),rr.cellFormula&&At.f){for(var ht=0;ht<w.length;++ht)if(!(w[ht][0].s.c>Oe.c||w[ht][0].s.r>Oe.r)&&!(w[ht][0].e.c<Oe.c||w[ht][0].e.r<Oe.r)){At.F=Ge(w[ht][0]),(w[ht][0].s.c!=Oe.c||w[ht][0].s.r!=Oe.r)&&delete At.f,At.f&&(At.f=""+Er(w[ht][1],i,Oe,L,T));break}}rr.dense?(a[Oe.r]||(a[Oe.r]=[]),a[Oe.r][Oe.c]=At):a[h]=At}},T={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var j,Z=[],re=[],W=[],Q=[],H=!1,L=[];L.SheetNames=T.snames,L.sharedf=T.sharedf,L.arrayf=T.arrayf,L.names=[],L.XTI=[];var ee=0,te=0,b=0,A=[],O=[],P;T.codepage=1200,Rn(1200);for(var U=!1;e.l<e.length-1;){var q=e.l,J=e.read_shift(2);if(J===0&&ee===10)break;var B=e.l===e.length?0:e.read_shift(2),ne=mm[J];if(ne&&ne.f){if(t.bookSheets&&ee===133&&J!==133)break;if(ee=J,ne.r===2||ne.r==12){var fe=e.read_shift(2);if(B-=2,!T.enc&&fe!==J&&((fe&255)<<8|fe>>8)!==J)throw new Error("rt mismatch: "+fe+"!="+J);ne.r==12&&(e.l+=10,B-=10)}var M={};if(J===10?M=ne.f(e,B,T):M=FP(J,ne,e,B,T),te==0&&[9,521,1033,2057].indexOf(ee)===-1)continue;switch(J){case 34:r.opts.Date1904=S.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=M,!t.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=M;break;case 66:var ue=Number(M);switch(ue){case 21010:ue=1200;break;case 32768:ue=1e4;break;case 32769:ue=1252;break}Rn(T.codepage=ue),U=!0;break;case 317:T.rrtabid=M;break;case 25:T.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:T.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(a["!type"]="dialog"),M.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),M.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:C.push(M);break;case 430:L.push([M]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(M);break;case 24:case 536:P={Name:M.Name,Ref:Er(M.rgce,i,null,L,T)},M.itab>0&&(P.Sheet=M.itab-1),L.names.push(P),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(O[M.itab-1]={ref:Ge(M.rgce[0][0][1][2])});break;case 22:T.ExternCount=M;break;case 23:L.length==0&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(M),L.XTI=L.XTI.concat(M);break;case 2196:if(T.biff<8)break;P!=null&&(P.Comment=M[1]);break;case 18:a["!protect"]=M;break;case 19:M!==0&&T.WTF&&console.error("Password verifier: "+M);break;case 133:s[M.pos]=M,T.snames.push(M.name);break;case 10:{if(--te)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ge(i),t.sheetRows&&t.sheetRows<=i.e.r){var ye=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ge(i),i.e.r=ye}i.e.r++,i.e.c++}Z.length>0&&(a["!merges"]=Z),re.length>0&&(a["!objects"]=re),W.length>0&&(a["!cols"]=W),Q.length>0&&(a["!rows"]=Q),S.Sheets.push(N)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),T.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(T.biff=5,U=!0,Rn(T.codepage=28591)),T.biff==8&&M.BIFFVer==0&&M.dt==16&&(T.biff=2),te++)break;if(a=t.dense?[]:{},T.biff<8&&!U&&(U=!0,Rn(T.codepage=t.codepage||1252)),T.biff<5||M.BIFFVer==0&&M.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-B,name:c};s[Te.pos]=Te,T.snames.push(c)}else c=(s[q]||{name:""}).name;M.dt==32&&(a["!type"]="chart"),M.dt==64&&(a["!type"]="macro"),Z=[],re=[],T.arrayf=w=[],W=[],Q=[],H=!1,N={Hidden:(s[q]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[M.r]||[])[M.c]:a[He({c:M.c,r:M.r})])&&++M.c,y={ixfe:M.ixfe,XF:C[M.ixfe]||{},v:M.val,t:"n"},b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:M.c,r:M.r},y,t);break;case 5:case 517:y={ixfe:M.ixfe,XF:C[M.ixfe],v:M.val,t:M.t},b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:M.c,r:M.r},y,t);break;case 638:y={ixfe:M.ixfe,XF:C[M.ixfe],v:M.rknum,t:"n"},b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:M.c,r:M.r},y,t);break;case 189:for(var ve=M.c;ve<=M.C;++ve){var pe=M.rkrec[ve-M.c][0];y={ixfe:pe,XF:C[pe],v:M.rkrec[ve-M.c][1],t:"n"},b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:ve,r:M.r},y,t)}break;case 6:case 518:case 1030:{if(M.val=="String"){l=M;break}if(y=vu(M.val,M.cell.ixfe,M.tt),y.XF=C[y.ixfe],t.cellFormula){var Me=M.formula;if(Me&&Me[0]&&Me[0][0]&&Me[0][0][0]=="PtgExp"){var Ke=Me[0][0][1][0],Be=Me[0][0][1][1],Pe=He({r:Ke,c:Be});v[Pe]?y.f=""+Er(M.formula,i,M.cell,L,T):y.F=((t.dense?(a[Ke]||[])[Be]:a[Pe])||{}).F}else y.f=""+Er(M.formula,i,M.cell,L,T)}b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D(M.cell,y,t),l=M}break;case 7:case 519:if(l)l.val=M,y=vu(M,l.cell.ixfe,"s"),y.XF=C[y.ixfe],t.cellFormula&&(y.f=""+Er(l.formula,i,l.cell,L,T)),b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(M);var Ze=He(M[0].s);if(p=t.dense?(a[M[0].s.r]||[])[M[0].s.c]:a[Ze],t.cellFormula&&p){if(!l||!Ze||!p)break;p.f=""+Er(M[1],i,M[0],L,T),p.F=Ge(M[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;v[He(l.cell)]=M[0],p=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[He(l.cell)],(p||{}).f=""+Er(M[0],i,d,L,T)}}break;case 253:y=vu(o[M.isst].t,M.ixfe,"s"),o[M.isst].h&&(y.h=o[M.isst].h),y.XF=C[y.ixfe],b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:M.c,r:M.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:M.ixfe,XF:C[M.ixfe],t:"z"},b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:M.c,r:M.r},y,t));break;case 190:if(t.sheetStubs)for(var Nt=M.c;Nt<=M.C;++Nt){var tr=M.ixfe[Nt-M.c];y={ixfe:tr,XF:C[tr],t:"z"},b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:Nt,r:M.r},y,t)}break;case 214:case 516:case 4:y=vu(M.val,M.ixfe,"s"),y.XF=C[y.ixfe],b>0&&(y.z=A[y.ixfe>>8&63]),aa(y,t,r.opts.Date1904),D({c:M.c,r:M.r},y,t);break;case 0:case 512:te===1&&(i=M);break;case 252:o=M;break;case 1054:if(T.biff==4){A[b++]=M[1];for(var mn=0;mn<b+163&&ze[mn]!=M[1];++mn);mn>=163&&xa(M[1],b+163)}else xa(M[1],M[0]);break;case 30:{A[b++]=M;for(var Qn=0;Qn<b+163&&ze[Qn]!=M;++Qn);Qn>=163&&xa(M,b+163)}break;case 229:Z=Z.concat(M);break;case 93:re[M.cmo[0]]=T.lastobj=M;break;case 438:T.lastobj.TxO=M;break;case 127:T.lastobj.ImData=M;break;case 440:for(g=M[0].s.r;g<=M[0].e.r;++g)for(x=M[0].s.c;x<=M[0].e.c;++x)p=t.dense?(a[g]||[])[x]:a[He({c:x,r:g})],p&&(p.l=M[1]);break;case 2048:for(g=M[0].s.r;g<=M[0].e.r;++g)for(x=M[0].s.c;x<=M[0].e.c;++x)p=t.dense?(a[g]||[])[x]:a[He({c:x,r:g})],p&&p.l&&(p.l.Tooltip=M[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;p=t.dense?(a[M[0].r]||[])[M[0].c]:a[He(M[0])];var Xa=re[M[2]];p||(t.dense?(a[M[0].r]||(a[M[0].r]=[]),p=a[M[0].r][M[0].c]={t:"z"}):p=a[He(M[0])]={t:"z"},i.e.r=Math.max(i.e.r,M[0].r),i.s.r=Math.min(i.s.r,M[0].r),i.e.c=Math.max(i.e.c,M[0].c),i.s.c=Math.min(i.s.c,M[0].c)),p.c||(p.c=[]),m={a:M[1],t:Xa.TxO.t},p.c.push(m)}break;case 2173:yO(C[M.ixfe],M.ext);break;case 125:{if(!T.cellStyles)break;for(;M.e>=M.s;)W[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},H||(H=!0,nx(M.w/256)),Es(W[M.e+1])}break;case 520:{var ur={};M.level!=null&&(Q[M.r]=ur,ur.level=M.level),M.hidden&&(Q[M.r]=ur,ur.hidden=!0),M.hpt&&(Q[M.r]=ur,ur.hpt=M.hpt,ur.hpx=gl(M.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Js(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=M;break;case 161:a["!margins"]||Js(a["!margins"]={}),a["!margins"].header=M.header,a["!margins"].footer=M.footer;break;case 574:M.RTL&&(S.Views[0].RTL=!0);break;case 146:E=M;break;case 2198:j=M;break;case 140:k=M;break;case 442:c?N.CodeName=M||N.name:S.WBProps.CodeName=M||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=B}return r.SheetNames=Bt(s).sort(function(Qr,Oe){return Number(Qr)-Number(Oe)}).map(function(Qr){return s[Qr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&O.forEach(function(Qr,Oe){r.Sheets[r.SheetNames[Oe]]["!autofilter"]=Qr}),r.Strings=o,r.SSF=pt(ze),T.enc&&(r.Encryption=T.enc),j&&(r.Themes=j),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),L.names.length>0&&(S.Names=L.names),r.Workbook=S,r}var Fo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function IP(e,t,r){var n=Ue.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Jg(n,lm,Fo.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Ue.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=Jg(i,om,Fo.SI);for(var o in l)t[o]==null&&(t[o]=l[o])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Rk(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function DP(e,t){var r=[],n=[],a=[],s=0,i,l=Ag(lm,"n"),o=Ag(om,"n");if(e.Props)for(i=Bt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(l,i[s])?r:Object.prototype.hasOwnProperty.call(o,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Bt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(l,i[s])?r:Object.prototype.hasOwnProperty.call(o,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var c=[];for(s=0;s<a.length;++s)Mk.indexOf(a[s][0])>-1||Fk.indexOf(a[s][0])>-1||a[s][1]!=null&&c.push(a[s]);n.length&&Ue.utils.cfb_add(t,"/SummaryInformation",qg(n,Fo.SI,o,om)),(r.length||c.length)&&Ue.utils.cfb_add(t,"/DocumentSummaryInformation",qg(r,Fo.DSI,l,lm,c.length?c:null,Fo.UDI))}function fx(e,t){t||(t={}),hx(t),E0(),t.codepage&&k0(t.codepage);var r,n;if(e.FullPaths){if(Ue.find(e,"/encryption"))throw new Error("File is password-protected");r=Ue.find(e,"!CompObj"),n=Ue.find(e,"/Workbook")||Ue.find(e,"/Book")}else{switch(t.type){case"base64":e=rn(cn(e));break;case"binary":e=rn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}hr(e,0),n={content:e}}var a,s;if(r&&TP(r),t.bookProps&&!t.bookSheets)a={};else{var i=Xe?"buffer":"array";if(n&&n.content)a=RP(n.content,t);else if((s=Ue.find(e,"PerfectOffice_MAIN"))&&s.content)a=Xs.to_workbook(s.content,(t.type=i,t));else if((s=Ue.find(e,"NativeContent_MAIN"))&&s.content)a=Xs.to_workbook(s.content,(t.type=i,t));else throw(s=Ue.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ue.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=YO(e))}var l={};return e.FullPaths&&IP(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function OP(e,t){var r=t||{},n=Ue.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ue.utils.cfb_add(n,a,OE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&DP(e,n),r.biff==8&&e.vbaraw&&KO(n,Ue.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var ic={0:{f:sL},1:{f:hL},2:{f:IL},3:{f:SL},4:{f:gL},5:{f:CL},6:{f:jL},7:{f:NL},8:{f:VL},9:{f:$L},10:{f:zL},11:{f:HL},12:{f:pL},13:{f:OL},14:{f:EL},15:{f:yL},16:{f:NE},17:{f:BL},18:{f:bL},19:{f:Yp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:M5},40:{},42:{},43:{f:jD},44:{f:LD},45:{f:UD},46:{f:HD},47:{f:zD},48:{},49:{f:oF},50:{},51:{f:kO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Xk},62:{f:PL},63:{f:RO},64:{f:i5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:r5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fL},148:{f:oL,p:16},151:{f:JL},152:{},153:{f:L5},154:{},155:{},156:{f:D5},157:{},158:{},159:{T:1,f:ZI},160:{T:-1},161:{T:1,f:Si},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:WL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:wO},336:{T:-1},337:{f:NO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:im},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Kk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:qL},427:{f:ZL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:e5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:im},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:HO},633:{T:1},634:{T:-1},635:{T:1,f:UO},636:{T:-1},637:{f:dF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:E5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:l5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},mm={6:{f:Dd},10:{f:Za},12:{f:Kt},13:{f:Kt},14:{f:zt},15:{f:zt},16:{f:br},17:{f:zt},18:{f:zt},19:{f:Kt},20:{f:nv},21:{f:nv},23:{f:Kk},24:{f:sv},25:{f:zt},26:{},27:{},28:{f:lI},29:{},34:{f:zt},35:{f:av},38:{f:br},39:{f:br},40:{f:br},41:{f:br},42:{f:zt},43:{f:zt},47:{f:yD},49:{f:OR},51:{f:Kt},60:{},61:{f:CR},64:{f:zt},65:{f:DR},66:{f:Kt},77:{},80:{},81:{},82:{},85:{f:Kt},89:{},90:{},91:{},92:{f:vR},93:{f:uI},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:Xk},128:{f:XR},129:{f:wR},130:{f:Kt},131:{f:zt},132:{f:zt},133:{f:SR},134:{},140:{f:vI},141:{f:Kt},144:{},146:{f:SI},151:{},152:{},153:{},154:{},155:{},156:{f:Kt},157:{},158:{},160:{f:TI},161:{f:_I},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:WR},190:{f:GR},193:{f:Za},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Kt},220:{},221:{f:zt},222:{},224:{f:KR},225:{f:gR},226:{f:Za},227:{},229:{f:oI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ER},253:{f:PR},255:{f:NR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Bk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:Za},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eI},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:hI},439:{f:zt},440:{f:mI},441:{},442:{f:Fc},443:{},444:{f:Kt},445:{},446:{},448:{f:Za},449:{f:TR,r:2},450:{f:Za},512:{f:ev},513:{f:bI},515:{f:ZR},516:{f:MR},517:{f:rv},519:{f:CI},520:{f:AR},523:{},545:{f:iv},549:{f:Qg},566:{},574:{f:RR},638:{f:VR},659:{},1048:{},1054:{f:UR},1084:{},1212:{f:aI},2048:{f:xI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:pu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Za},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:kI,r:12},2173:{f:vO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nI,r:12},2197:{},2198:{f:dO,r:12},2199:{},2200:{},2201:{},2202:{f:sI,r:12},2203:{f:Za},2204:{},2205:{},2206:{},2207:{},2211:{f:bR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Kt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:NI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:wI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ev},1:{},2:{f:OI},3:{f:II},4:{f:RI},5:{f:rv},7:{f:PI},8:{},9:{f:pu},11:{},22:{f:Kt},30:{f:HR},31:{},32:{},33:{f:iv},36:{},37:{f:Qg},50:{f:jI},62:{},52:{},67:{},68:{f:Kt},69:{},86:{},126:{},127:{f:FI},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:MI},223:{},234:{},354:{},421:{},518:{f:Dd},521:{f:pu},536:{f:sv},547:{f:av},561:{},579:{},1030:{f:Dd},1033:{f:pu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ne(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Vp(r)&&e.push(r)}}function LP(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Ne(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],l=0,o=0,c=0;c+(i[l]||8224)<=8224;)c+=i[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(o,o+c)),o+=c;o<a;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(i[l]||8224)<=8224;)c+=i[l]||8224,l++;u.write_shift(2,c),e.push(r.slice(o,o+c)),o+=c}}}function Oc(e,t,r){return e||(e=de(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function PP(e,t,r,n){var a=de(9);return Oc(a,e,t),Uk(r,n||"b",a),a}function jP(e,t,r){var n=de(8+2*r.length);return Oc(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function MP(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?er(kt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Ne(e,2,LI(r,n,a)):Ne(e,3,DI(r,n,a));return;case"b":case"e":Ne(e,5,PP(r,n,t.v,t.t));return;case"s":case"str":Ne(e,4,jP(r,n,(t.v||"").slice(0,255)));return}Ne(e,1,Oc(null,r,n))}function BP(e,t,r,n){var a=Array.isArray(t),s=tt(t["!ref"]||"A1"),i,l="",o=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Ge(s)}for(var c=s.s.r;c<=s.e.r;++c){l=Pt(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(o[u]=St(u)),i=o[u]+l;var d=a?(t[c]||[])[u]:t[i];d&&MP(e,d,c,u)}}}function UP(e,t){for(var r=t||{},n=qr(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ne(n,r.biff==4?1033:r.biff==3?521:9,ex(e,16,r)),BP(n,e.Sheets[e.SheetNames[a]],a,r),Ne(n,10),n.end()}function zP(e,t,r){Ne(e,49,LR({sz:12,name:"Arial"},r))}function HP(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ne(e,1054,zR(a,t[a],r))})}function $P(e,t){var r=de(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ne(e,2151,r),r=de(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Wk(tt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ne(e,2152,r)}function VP(e,t){for(var r=0;r<16;++r)Ne(e,224,tv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ne(e,224,tv(n,0,t))})}function WP(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ne(e,440,pI(n)),n[1].Tooltip&&Ne(e,2048,gI(n))}delete t["!links"]}function GP(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Ne(e,125,EI(R0(a,n),a))})}}function YP(e,t,r,n,a){var s=16+Rs(a.cellXfs,t,a);if(t.v==null&&!t.bf){Ne(e,513,ui(r,n,s));return}if(t.bf)Ne(e,6,w6(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?er(kt(t.v)):t.v;Ne(e,515,QR(r,n,i,s));break;case"b":case"e":Ne(e,517,qR(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var l=ox(a.Strings,t.v,a.revStrings);Ne(e,253,jR(r,n,l,s))}else Ne(e,516,BR(r,n,(t.v||"").slice(0,255),s,a));break;default:Ne(e,513,ui(r,n,s))}}function KP(e,t,r){var n=qr(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[e]||{},o=Array.isArray(s),c=t.biff==8,u,d="",h=[],p=tt(s["!ref"]||"A1"),m=c?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}Ne(n,2057,ex(r,16,t)),Ne(n,13,En(1)),Ne(n,12,En(100)),Ne(n,15,jr(!0)),Ne(n,17,jr(!1)),Ne(n,16,oi(.001)),Ne(n,95,jr(!0)),Ne(n,42,jr(!1)),Ne(n,43,jr(!1)),Ne(n,130,En(1)),Ne(n,128,JR()),Ne(n,131,jr(!1)),Ne(n,132,jr(!1)),c&&GP(n,s["!cols"]),Ne(n,512,$R(p,t)),c&&(s["!links"]=[]);for(var x=p.s.r;x<=p.e.r;++x){d=Pt(x);for(var g=p.s.c;g<=p.e.c;++g){x===p.s.r&&(h[g]=St(g)),u=h[g]+d;var v=o?(s[x]||[])[g]:s[u];v&&(YP(n,v,x,g,t),c&&v.l&&s["!links"].push([u,v.l]))}}var w=l.CodeName||l.name||a;return c&&Ne(n,574,IR((i.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ne(n,229,cI(s["!merges"])),c&&WP(n,s),Ne(n,442,zk(w)),c&&$P(n,s),Ne(n,10),n.end()}function XP(e,t,r){var n=qr(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},l=r.biff==8,o=r.biff==5;if(Ne(n,2057,ex(e,5,r)),r.bookType=="xla"&&Ne(n,135),Ne(n,225,l?En(1200):null),Ne(n,193,qF(2)),o&&Ne(n,191),o&&Ne(n,192),Ne(n,226),Ne(n,92,yR("SheetJS",r)),Ne(n,66,En(l?1200:1252)),l&&Ne(n,353,En(0)),l&&Ne(n,448),Ne(n,317,AI(e.SheetNames.length)),l&&e.vbaraw&&Ne(n,211),l&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";Ne(n,442,zk(c))}Ne(n,156,En(17)),Ne(n,25,jr(!1)),Ne(n,18,jr(!1)),Ne(n,19,En(0)),l&&Ne(n,431,jr(!1)),l&&Ne(n,444,En(0)),Ne(n,61,FR()),Ne(n,64,jr(!1)),Ne(n,141,En(0)),Ne(n,34,jr(T5(e)=="true")),Ne(n,14,jr(!0)),l&&Ne(n,439,jr(!1)),Ne(n,218,En(0)),zP(n,e,r),HP(n,e.SSF,r),VP(n,r),l&&Ne(n,352,jr(!1));var u=n.end(),d=qr();l&&Ne(d,140,yI()),l&&r.Strings&&LP(d,252,_R(r.Strings)),Ne(d,10);var h=d.end(),p=qr(),m=0,x=0;for(x=0;x<e.SheetNames.length;++x)m+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var g=u.length+m+h.length;for(x=0;x<e.SheetNames.length;++x){var v=s[x]||{};Ne(p,133,kR({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[x]},r)),g+=t[x].length}var w=p.end();if(m!=w.length)throw new Error("BS8 "+m+" != "+w.length);var y=[];return u.length&&y.push(u),w.length&&y.push(w),h.length&&y.push(h),lr(y)}function JP(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=pt(ze)),e&&e.SSF&&(bl(),bc(e.SSF),r.revssf=N0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,mx(r),r.cellXfs=[],Rs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=KP(a,r,e);return n.unshift(XP(e,n,r)),lr(n)}function OE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ur(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return JP(e,t);case 4:case 3:case 2:return UP(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function xv(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,l=s&&s.index||e.length,o=L3(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<o.length;++i){var x=o[i].trim(),g=x.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var v=x.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var w=v[l].trim();if(w.match(/<t[dh]/i)){for(var y=w,k=0;y.charAt(0)=="<"&&(k=y.indexOf(">"))>-1;)y=y.slice(k+1);for(var C=0;C<m.length;++C){var E=m[C];E.s.c==u&&E.s.r<c&&c<=E.e.r&&(u=E.e.c+1,C=-1)}var S=$e(w.slice(0,w.indexOf(">")));h=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||h>1)&&m.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var N=S.t||S["data-t"]||"";if(!y.length){u+=h;continue}if(y=ok(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!y.length){u+=h;continue}var F={t:"s",v:y};r.raw||!y.trim().length||N=="s"||(y==="TRUE"?F={t:"b",v:!0}:y==="FALSE"?F={t:"b",v:!1}:isNaN(Xn(y))?isNaN(pl(y).getDate())||(F={t:"d",v:kt(y)},r.cellDates||(F={t:"n",v:er(F.v)}),F.z=r.dateNF||ze[14]):F={t:"n",v:Xn(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=F):n[He({r:c,c:u})]=F,u+=h}}}}return n["!ref"]=Ge(p),m.length&&(n["!merges"]=m),n}function LE(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,o=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){l=-1;break}l=a[c].e.r-a[c].s.r+1,o=a[c].e.c-a[c].s.c+1;break}if(!(l<0)){var u=He({r,c:i}),d=n.dense?(e[r]||[])[i]:e[u],h=d&&d.v!=null&&(d.h||jp(d.w||(ya(d),d.w)||""))||"",p={};l>1&&(p.rowspan=l),o>1&&(p.colspan=o),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(_e("td",h,p))}}var m="<tr>";return m+s.join("")+"</tr>"}var PE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',jE="</body></html>";function qP(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Fs(xv(r[0],t),t);var n=yx();return r.forEach(function(a,s){wx(n,xv(a,t),"Sheet"+(s+1))}),n}function ME(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function BE(e,t){var r=t||{},n=r.header!=null?r.header:PE,a=r.footer!=null?r.footer:jE,s=[n],i=Ur(e["!ref"]);r.dense=Array.isArray(e),s.push(ME(e,i,r));for(var l=i.s.r;l<=i.e.r;++l)s.push(LE(e,i,l,r));return s.push("</table>"+a),s.join("")}function UE(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Ct(n.origin):n.origin;a=i.r,s=i.c}var l=t.getElementsByTagName("tr"),o=Math.min(n.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=Ur(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),m=0,x=0,g=0,v=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&x<o;++m){var k=l[m];if(gv(k)){if(n.display)continue;p[x]={hidden:!0}}var C=k.children;for(g=v=0;g<C.length;++g){var E=C[g];if(!(n.display&&gv(E))){var S=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):ok(E.innerHTML),N=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<d.length;++h){var F=d[h];F.s.c==v+s&&F.s.r<x+a&&x+a<=F.e.r&&(v=F.e.c+1-s,h=-1)}y=+E.getAttribute("colspan")||1,((w=+E.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:x+a,c:v+s},e:{r:x+a+(w||1)-1,c:v+s+(y||1)-1}});var R={t:"s",v:S},D=E.getAttribute("data-t")||E.getAttribute("t")||"";S!=null&&(S.length==0?R.t=D||"z":n.raw||S.trim().length==0||D=="s"||(S==="TRUE"?R={t:"b",v:!0}:S==="FALSE"?R={t:"b",v:!1}:isNaN(Xn(S))?isNaN(pl(S).getDate())||(R={t:"d",v:kt(S)},n.cellDates||(R={t:"n",v:er(R.v)}),R.z=n.dateNF||ze[14]):R={t:"n",v:Xn(S)})),R.z===void 0&&N!=null&&(R.z=N);var T="",j=E.getElementsByTagName("A");if(j&&j.length)for(var Z=0;Z<j.length&&!(j[Z].hasAttribute("href")&&(T=j[Z].getAttribute("href"),T.charAt(0)!="#"));++Z);T&&T.charAt(0)!="#"&&(R.l={Target:T}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][v+s]=R):e[He({c:v+s,r:x+a})]=R,c.e.c<v+s&&(c.e.c=v+s),v+=y}}++x}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,x-1+a),e["!ref"]=Ge(c),x>=o&&(e["!fullref"]=Ge((c.e.r=l.length-m+x-1+a,c))),e}function zE(e,t){var r=t||{},n=r.dense?[]:{};return UE(n,e,t)}function ZP(e,t){return Fs(zE(e,t),t)}function gv(e){var t="",r=QP(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function QP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function ej(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(t.replace(/<[^>]*>/g,""));return[r]}var vv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function HE(e,t){var r=t||{},n=Mp(e),a=[],s,i,l={name:""},o="",c=0,u,d,h={},p=[],m=r.dense?[]:{},x,g,v={value:""},w="",y=0,k=[],C=-1,E=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,F={},R=[],D={},T=0,j=0,Z=[],re=1,W=1,Q=[],H={Names:[]},L={},ee=["",""],te=[],b={},A="",O=0,P=!1,U=!1,q=0;for(ec.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=ec.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?m["!ref"]=Ge(S):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=r.sheetRows-1,m["!ref"]=Ge(S)),R.length&&(m["!merges"]=R),Z.length&&(m["!rows"]=Z),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),h[u.name]=m,U=!1):x[0].charAt(x[0].length-2)!=="/"&&(u=$e(x[0],!1),C=E=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,m=r.dense?[]:{},R=[],Z=[],U=!0);break;case"table-row-group":x[1]==="/"?--N:++N;break;case"table-row":case"":if(x[1]==="/"){C+=re,re=1;break}if(d=$e(x[0],!1),d.?C=d.-1:C==-1&&(C=0),re=+d["number-rows-repeated"]||1,re<10)for(q=0;q<re;++q)N>0&&(Z[C+q]={level:N});E=-1;break;case"covered-table-cell":x[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(m[C]||(m[C]=[]),m[C][E]={t:"z"}):m[He({r:C,c:E})]={t:"z"}),w="",k=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++E,v=$e(x[0],!1),W=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=hv(st(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=st(v["string-value"]||""),r.dense?(m[C]||(m[C]=[]),m[C][E]=g):m[He({r:C,c:E})]=g),E+=W-1;else if(x[1]!=="/"){++E,w="",y=0,k=[],W=1;var J=re?C+re-1:C;if(E>S.e.c&&(S.e.c=E),E<S.s.c&&(S.s.c=E),C<S.s.r&&(S.s.r=C),J>S.e.r&&(S.e.r=J),v=$e(x[0],!1),te=[],b={},g={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=st(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(T=parseInt(v["number-matrix-rows-spanned"],10)||0,j=parseInt(v["number-matrix-columns-spanned"],10)||0,D={s:{r:C,c:E},e:{r:C+T-1,c:E+j-1}},g.F=Ge(D),Q.push([D,g.F])),v.formula)g.f=hv(v.formula);else for(q=0;q<Q.length;++q)C>=Q[q][0].s.r&&C<=Q[q][0].e.r&&E>=Q[q][0].s.c&&E<=Q[q][0].e.c&&(g.F=Q[q][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(T=parseInt(v["number-rows-spanned"],10)||0,j=parseInt(v["number-columns-spanned"],10)||0,D={s:{r:C,c:E},e:{r:C+T-1,c:E+j-1}},R.push(D)),v["number-columns-repeated"]&&(W=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=yt(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=kt(v["date-value"]),r.cellDates||(g.t="n",g.v=er(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=I3(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=A0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(w=st(v["string-value"]),k=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(P=!1,g.t==="s"&&(g.v=w||"",k.length&&(g.R=k),P=y==0),L.Target&&(g.l=L),te.length>0&&(g.c=te,te=[]),w&&r.cellText!==!1&&(g.w=w),P&&(g.t="z",delete g.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var B=0;B<re;++B){if(W=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[C+B]||(m[C+B]=[]),m[C+B][E]=B==0?g:pt(g);--W>0;)m[C+B][E+W]=pt(g);else for(m[He({r:C+B,c:E})]=g;--W>0;)m[He({r:C+B,c:E+W})]=pt(g);S.e.c<=E&&(S.e.c=E)}W=parseInt(v["number-columns-repeated"]||"1",10),E+=W-1,W=0,g={},w="",k=[]}L={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s;b.t=w,k.length&&(b.R=k),b.a=A,te.push(b)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);A="",O=0,w="",y=0,k=[];break;case"creator":x[1]==="/"?A=n.slice(O,x.index):O=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);w="",y=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(F[l.name]=o,(s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(o="",l=$e(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=$e(x[0],!1),o+=vv[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=$e(x[0],!1),o+=vv[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":o+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":i=$e(x[0],!1),ee=Od(i["cell-range-address"]);var ne={Name:i.name,Ref:ee[0]+"!"+ee[1]};U&&(ne.Sheet=p.length),H.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!v||!v["string-value"])){var fe=ej(n.slice(y,x.index));w=(w.length>0?w+`
`:"")+fe[0]}else $e(x[0],!1),y=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ee=Od($e(x[0])["target-range-address"]),h[ee[0]]["!autofilter"]={ref:ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(L=$e(x[0],!1),!L.href)break;L.Target=st(L.href),delete L.href,L.Target.charAt(0)=="#"&&L.Target.indexOf(".")>-1?(ee=Od(L.Target.slice(1)),L.Target="#"+ee[0]+"!"+ee[1]):L.Target.match(/^\.\.[\\\/]/)&&(L.Target=L.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var M={Sheets:h,SheetNames:p,Workbook:H};return r.bookSheets&&delete M.Sheets,M}function yv(e,t){t=t||{},kn(e,"META-INF/manifest.xml")&&IF(Yt(e,"META-INF/manifest.xml"),t);var r=nn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=HE(mt(r),t);return kn(e,"meta.xml")&&(n.Props=Tk(Yt(e,"meta.xml"))),n}function wv(e,t){return HE(e,t)}var tj=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return $t+t}}(),Sv=function(){var e=function(s){return ft(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,l){var o=[];o.push('      <table:table table:name="'+ft(i.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,u=0,d=Ur(s["!ref"]||"A1"),h=s["!merges"]||[],p=0,m=Array.isArray(s);if(s["!cols"])for(u=0;u<=d.e.c;++u)o.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",g=s["!rows"]||[];for(c=0;c<d.s.r;++c)x=g[c]?' table:style-name="ro'+g[c].ods+'"':"",o.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=d.e.r;++c){for(x=g[c]?' table:style-name="ro'+g[c].ods+'"':"",o.push("        <table:table-row"+x+`>
`),u=0;u<d.s.c;++u)o.push(t);for(;u<=d.e.c;++u){var v=!1,w={},y="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>u)&&!(h[p].s.r>c)&&!(h[p].e.c<u)&&!(h[p].e.r<c)){(h[p].s.c!=u||h[p].s.r!=c)&&(v=!0),w["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,w["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(v){o.push(r);continue}var k=He({r:c,c:u}),C=m?(s[c]||[])[u]:s[k];if(C&&C.f&&(w["table:formula"]=ft(A6(C.f)),C.F&&C.F.slice(0,k.length)==k)){var E=Ur(C.F);w["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,w["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!C){o.push(t);continue}switch(C.t){case"b":y=C.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=C.v?"true":"false";break;case"n":y=C.w||String(C.v||0),w["office:value-type"]="float",w["office:value"]=C.v||0;break;case"s":case"str":y=C.v==null?"":C.v,w["office:value-type"]="string";break;case"d":y=C.w||kt(C.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=kt(C.v).toISOString(),w["table:style-name"]="ce1";break;default:o.push(t);continue}var S=e(y);if(C.l&&C.l.Target){var N=C.l.Target;N=N.charAt(0)=="#"?"#"+b6(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),S=_e("text:a",S,{"xlink:href":N.replace(/&/g,"&amp;")})}o.push("          "+_e("table:table-cell",_e("text:p",S,{}),w)+`
`)}o.push(`        </table:table-row>
`)}return o.push(`      </table:table>
`),o.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var d=c["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Es(d),d.ods=l;var h=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}});var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=o;var d=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,l){var o=[$t],c=Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Qo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(o.push("<office:document"+c+u+`>
`),o.push(bk().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+c+`>
`),a(o,i),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)o.push(n(i.Sheets[i.SheetNames[d]],i,d));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),l.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function $E(e,t){if(t.bookType=="fods")return Sv(e,t);var r=Op(),n="",a=[],s=[];return n="mimetype",Ye(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ye(r,n,Sv(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ye(r,n,tj(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ye(r,n,$t+bk()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ye(r,n,LF(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ye(r,n,DF(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function pm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):mt(Cs(e))}function rj(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):rn(da(e))}function nj(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ns(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function kv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function aj(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function sj(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function lc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ct(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function jt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function lt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=lc(e,r),s=a&7;a=Math.floor(a/8);var i=0,l;if(a==0)break;switch(s){case 0:{for(var o=r[0];e[r[0]++]>=128;);l=e.slice(o,r[0])}break;case 5:i=4,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=lc(e,r),l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:l,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function fr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(ct(n*8+a.type)),a.type==2&&t.push(ct(a.data.length)),t.push(a.data))})}),Ns(t)}function dx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function wn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=lc(e,n),s=lt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:jt(s[1][0].data),messages:[]};s[2].forEach(function(l){var o=lt(l.data),c=jt(o[3][0].data);i.messages.push({meta:o,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=jt(s[3][0].data)>>>0>0),r.push(i)}return r}function bi(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ct(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ct(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:ct(i.data.length)}],n[2].push({data:fr(i.meta),type:2})});var s=fr(n);t.push(ct(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),Ns(t)}function ij(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=lc(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=t[r[0]],l>1&&(i|=t[r[0]+1]<<8),l>2&&(i|=t[r[0]+2]<<16),l>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var o=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ns(a)],o==0)throw new Error("Invalid offset 0");if(o>a[0].length)throw new Error("Invalid offset beyond length");if(c>=o)for(a.push(a[0].slice(-o)),c-=o;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-o,-o+c))}}var u=Ns(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Sn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ij(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ns(t)}function Ti(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=ct(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return Ns(t)}function lj(e,t,r,n){var a=fi(e),s=a.getUint32(4,!0),i=(n>1?12:8)+kv(s&(n>1?3470:398))*4,l=-1,o=-1,c=NaN,u=new Date(2001,0,1);s&512&&(l=a.getUint32(i,!0),i+=4),i+=kv(s&(n>1?12288:4096))*4,s&16&&(o=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(l>-1)d={t:"s",v:r[l]};else if(o>-1)d={t:"s",v:t[o]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function oj(e,t,r){var n=fi(e),a=n.getUint32(8,!0),s=12,i=-1,l=-1,o=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(o=aj(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:o};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Pd(e,t){var r=new Uint8Array(32),n=fi(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,sj(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function jd(e,t){var r=new Uint8Array(32),n=fi(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function cj(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return lj(e,t,r,e[0]);case 5:return oj(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function kr(e){var t=lt(e);return lc(t[1][0].data)}function Ev(e,t){var r=lt(t.data),n=jt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var l=lt(i.data),o=jt(l[1][0].data)>>>0;switch(n){case 1:s[o]=pm(l[3][0].data);break;case 8:{var c=e[kr(l[9][0].data)][0],u=lt(c.data),d=e[kr(u[1][0].data)][0],h=jt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=lt(d.data);s[o]=p[3].map(function(m){return pm(m.data)}).join("")}break}}),s}function uj(e,t){var r,n,a,s,i,l,o,c,u,d,h,p,m,x,g=lt(e),v=jt(g[1][0].data)>>>0,w=jt(g[2][0].data)>>>0,y=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&jt(g[8][0].data)>0||!1,k,C;if((s=(a=g[7])==null?void 0:a[0])!=null&&s.data&&t!=0)k=(l=(i=g[7])==null?void 0:i[0])==null?void 0:l.data,C=(c=(o=g[6])==null?void 0:o[0])==null?void 0:c.data;else if((d=(u=g[4])==null?void 0:u[0])!=null&&d.data&&t!=1)k=(p=(h=g[4])==null?void 0:h[0])==null?void 0:p.data,C=(x=(m=g[3])==null?void 0:m[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=y?4:1,S=fi(k),N=[],F=0;F<k.length/2;++F){var R=S.getUint16(F*2,!0);R<65535&&N.push([F,R])}if(N.length!=w)throw"Expected ".concat(w," cells, found ").concat(N.length);var D=[];for(F=0;F<N.length-1;++F)D[N[F][0]]=C.subarray(N[F][1]*E,N[F+1][1]*E);return N.length>=1&&(D[N[N.length-1][0]]=C.subarray(N[N.length-1][1]*E)),{R:v,cells:D}}function fj(e,t){var r,n=lt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?jt(n[7][0].data)>>>0>0?1:0:-1,s=dx(n[5],function(i){return uj(i,a)});return{nrows:jt(n[4][0].data)>>>0,data:s.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(o,c){if(i[l.R][c])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(c));i[l.R][c]=o}),i},[])}}function dj(e,t,r){var n,a=lt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(jt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(jt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ge(s);var i=lt(a[4][0].data),l=Ev(e,e[kr(i[4][0].data)][0]),o=(n=i[17])!=null&&n[0]?Ev(e,e[kr(i[17][0].data)][0]):[],c=lt(i[3][0].data),u=0;c[1].forEach(function(d){var h=lt(d.data),p=e[kr(h[2][0].data)][0],m=jt(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var x=fj(e,p);x.data.forEach(function(g,v){g.forEach(function(w,y){var k=He({r:u+v,c:y}),C=cj(w,l,o);C&&(r[k]=C)})}),u+=x.nrows})}function hj(e,t){var r=lt(t.data),n={"!ref":"A1"},a=e[kr(r[2][0].data)],s=jt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return dj(e,a[0],n),n}function mj(e,t){var r,n=lt(t.data),a={name:(r=n[1])!=null&&r[0]?pm(n[1][0].data):"",sheets:[]},s=dx(n[2],kr);return s.forEach(function(i){e[i].forEach(function(l){var o=jt(l.meta[1][0].data);o==6e3&&a.sheets.push(hj(e,l))})}),a}function pj(e,t){var r=yx(),n=lt(t.data),a=dx(n[1],kr);if(a.forEach(function(s){e[s].forEach(function(i){var l=jt(i.meta[1][0].data);if(l==2){var o=mj(e,i);o.sheets.forEach(function(c,u){wx(r,c,u==0?o.name:o.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Md(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var c;try{c=Sn(o.content)}catch(d){return console.log("?? "+o.content.length+" "+(d.message||d))}var u;try{u=wn(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&jt(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||i.forEach(function(o){s[o].forEach(function(c){var u=jt(c.meta[1][0].data)>>>0;if(u==1)if(!l)l=c;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return pj(s,l)}function xj(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&jt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var o=0,c=fi(e[7][0].data),u=0,d=[],h=fi(e[4][0].data),p=0,m=[],x=0;x<t.length;++x){if(t[x]==null){c.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}c.setUint16(x*2,u,!0),h.setUint16(x*2,p,!0);var g,v;switch(typeof t[x]){case"string":g=Pd({t:"s",v:t[x]},r),v=jd({t:"s",v:t[x]},r);break;case"number":g=Pd({t:"n",v:t[x]},r),v=jd({t:"n",v:t[x]},r);break;case"boolean":g=Pd({t:"b",v:t[x]},r),v=jd({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}d.push(g),u+=g.length,m.push(v),p+=v.length,++o}for(e[2][0].data=ct(o);x<e[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=Ns(d),e[3][0].data=Ns(m),o}function gj(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ur(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ge(n)));var s=Hf(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(A){return A.forEach(function(O){typeof O=="string"&&i.push(O)})});var l={},o=[],c=Ue.read(t.numbers,{type:"base64"});c.FileIndex.map(function(A,O){return[A,c.FullPaths[O]]}).forEach(function(A){var O=A[0],P=A[1];if(O.type==2&&O.name.match(/\.iwa/)){var U=O.content,q=Sn(U),J=wn(q);J.forEach(function(B){o.push(B.id),l[B.id]={deps:[],location:P,type:jt(B.messages[0].meta[1][0].data)}})}}),o.sort(function(A,O){return A-O});var u=o.filter(function(A){return A>1}).map(function(A){return[A,ct(A)]});c.FileIndex.map(function(A,O){return[A,c.FullPaths[O]]}).forEach(function(A){var O=A[0];if(A[1],!!O.name.match(/\.iwa/)){var P=wn(Sn(O.content));P.forEach(function(U){U.messages.forEach(function(q){u.forEach(function(J){U.messages.some(function(B){return jt(B.meta[1][0].data)!=11006&&nj(B.data,J[1])})&&l[J[0]].deps.push(U.id)})})})}});for(var d=Ue.find(c,l[1].location),h=wn(Sn(d.content)),p,m=0;m<h.length;++m){var x=h[m];x.id==1&&(p=x)}var g=kr(lt(p.messages[0].data)[1][0].data);for(d=Ue.find(c,l[g].location),h=wn(Sn(d.content)),m=0;m<h.length;++m)x=h[m],x.id==g&&(p=x);for(g=kr(lt(p.messages[0].data)[2][0].data),d=Ue.find(c,l[g].location),h=wn(Sn(d.content)),m=0;m<h.length;++m)x=h[m],x.id==g&&(p=x);for(g=kr(lt(p.messages[0].data)[2][0].data),d=Ue.find(c,l[g].location),h=wn(Sn(d.content)),m=0;m<h.length;++m)x=h[m],x.id==g&&(p=x);var v=lt(p.messages[0].data);{v[6][0].data=ct(n.e.r+1),v[7][0].data=ct(n.e.c+1);var w=kr(v[46][0].data),y=Ue.find(c,l[w].location),k=wn(Sn(y.content));{for(var C=0;C<k.length&&k[C].id!=w;++C);if(k[C].id!=w)throw"Bad ColumnRowUIDMapArchive";var E=lt(k[C].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var S=0;S<=n.e.c;++S){var N=[];N[1]=N[2]=[{type:0,data:ct(S+420690)}],E[1].push({type:2,data:fr(N)}),E[2].push({type:0,data:ct(S)}),E[3].push({type:0,data:ct(S)})}E[4]=[],E[5]=[],E[6]=[];for(var F=0;F<=n.e.r;++F)N=[],N[1]=N[2]=[{type:0,data:ct(F+726270)}],E[4].push({type:2,data:fr(N)}),E[5].push({type:0,data:ct(F)}),E[6].push({type:0,data:ct(F)});k[C].messages[0].data=fr(E)}y.content=Ti(bi(k)),y.size=y.content.length,delete v[46];var R=lt(v[4][0].data);{R[7][0].data=ct(n.e.r+1);var D=lt(R[1][0].data),T=kr(D[2][0].data);y=Ue.find(c,l[T].location),k=wn(Sn(y.content));{if(k[0].id!=T)throw"Bad HeaderStorageBucket";var j=lt(k[0].messages[0].data);for(F=0;F<s.length;++F){var Z=lt(j[2][0].data);Z[1][0].data=ct(F),Z[4][0].data=ct(s[F].length),j[2][F]={type:j[2][0].type,data:fr(Z)}}k[0].messages[0].data=fr(j)}y.content=Ti(bi(k)),y.size=y.content.length;var re=kr(R[2][0].data);y=Ue.find(c,l[re].location),k=wn(Sn(y.content));{if(k[0].id!=re)throw"Bad HeaderStorageBucket";for(j=lt(k[0].messages[0].data),S=0;S<=n.e.c;++S)Z=lt(j[2][0].data),Z[1][0].data=ct(S),Z[4][0].data=ct(n.e.r+1),j[2][S]={type:j[2][0].type,data:fr(Z)};k[0].messages[0].data=fr(j)}y.content=Ti(bi(k)),y.size=y.content.length;var W=kr(R[4][0].data);(function(){for(var A=Ue.find(c,l[W].location),O=wn(Sn(A.content)),P,U=0;U<O.length;++U){var q=O[U];q.id==W&&(P=q)}var J=lt(P.messages[0].data);{J[3]=[];var B=[];i.forEach(function(M,ue){B[1]=[{type:0,data:ct(ue)}],B[2]=[{type:0,data:ct(1)}],B[3]=[{type:2,data:rj(M)}],J[3].push({type:2,data:fr(B)})})}P.messages[0].data=fr(J);var ne=bi(O),fe=Ti(ne);A.content=fe,A.size=A.content.length})();var Q=lt(R[3][0].data);{var H=Q[1][0];delete Q[2];var L=lt(H.data);{var ee=kr(L[2][0].data);(function(){for(var A=Ue.find(c,l[ee].location),O=wn(Sn(A.content)),P,U=0;U<O.length;++U){var q=O[U];q.id==ee&&(P=q)}var J=lt(P.messages[0].data);{delete J[6],delete Q[7];var B=new Uint8Array(J[5][0].data);J[5]=[];for(var ne=0,fe=0;fe<=n.e.r;++fe){var M=lt(B);ne+=xj(M,s[fe],i),M[1][0].data=ct(fe),J[5].push({data:fr(M),type:2})}J[1]=[{type:0,data:ct(n.e.c+1)}],J[2]=[{type:0,data:ct(n.e.r+1)}],J[3]=[{type:0,data:ct(ne)}],J[4]=[{type:0,data:ct(n.e.r+1)}]}P.messages[0].data=fr(J);var ue=bi(O),ye=Ti(ue);A.content=ye,A.size=A.content.length})()}H.data=fr(L)}R[3][0].data=fr(Q)}v[4][0].data=fr(R)}p.messages[0].data=fr(v);var te=bi(h),b=Ti(te);return d.content=b,d.size=d.content.length,c}function VE(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function hx(e){VE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function mx(e){VE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function vj(e){return qe.WS.indexOf(e)>-1?"sheet":e==qe.CS?"chart":e==qe.DS?"dialog":e==qe.MS?"macro":e&&e.length?e:"sheet"}function yj(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,vj(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function wj(e,t,r,n,a,s,i,l,o,c,u,d){try{s[n]=Ao(nn(e,r,!0),t);var h=Yt(e,t),p;switch(l){case"sheet":p=G5(h,t,a,o,s[n],c,u,d);break;case"chart":if(p=Y5(h,t,a,o,s[n],c,u,d),!p||!p["!drawel"])break;var m=co(p["!drawel"].Target,t),x=tc(m),g=OO(nn(e,m,!0),Ao(nn(e,x,!0),m)),v=co(g,m),w=tc(v);p=S5(nn(e,v,!0),v,o,Ao(nn(e,w,!0),v),c,p);break;case"macro":p=K5(h,t,a,o,s[n],c,u,d);break;case"dialog":p=X5(h,t,a,o,s[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+l)}i[n]=p;var y=[];s&&s[n]&&Bt(s[n]).forEach(function(k){var C="";if(s[n][k].Type==qe.CMNT){C=co(s[n][k].Target,t);var E=Q5(Yt(e,C,!0),C,o);if(!E||!E.length)return;ov(p,E,!1)}s[n][k].Type==qe.TCMNT&&(C=co(s[n][k].Target,t),y=y.concat(PO(Yt(e,C,!0),o)))}),y&&y.length&&ov(p,y,!0,o.people||[])}catch(k){if(o.WTF)throw k}}function vn(e){return e.charAt(0)=="/"?e.slice(1):e}function WE(e,t){if(bl(),t=t||{},hx(t),kn(e,"META-INF/manifest.xml")||kn(e,"objectdata.xml"))return yv(e,t);if(kn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Md<"u"){if(e.FileIndex)return Md(e);var r=Ue.utils.cfb_new();return Cg(e).forEach(function(Z){Ye(r,Z,j3(e,Z))}),Md(r)}throw new Error("Unsupported NUMBERS file")}if(!kn(e,"[Content_Types].xml"))throw kn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):kn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Cg(e),a=FF(nn(e,"[Content_Types].xml")),s=!1,i,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",Yt(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!Yt(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var o={},c={};if(!t.bookSheets&&!t.bookProps){if(bo=[],a.sst)try{bo=Z5(Yt(e,vn(a.sst)),a.sst,t)}catch(Z){if(t.WTF)throw Z}t.cellStyles&&a.themes.length&&(o=q5(nn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=J5(Yt(e,vn(a.style)),a.style,o,t))}a.links.map(function(Z){try{var re=Ao(nn(e,tc(vn(Z))),Z);return tP(Yt(e,vn(Z)),re,Z,t)}catch{}});var u=W5(Yt(e,vn(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=Yt(e,vn(a.coreprops[0]),!0),h&&(d=Tk(h)),a.extprops.length!==0&&(h=Yt(e,vn(a.extprops[0]),!0),h&&jF(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=nn(e,vn(a.custprops[0]),!0),h&&(p=BF(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(re){return re.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(m.Props=d,m.Custprops=p),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var x={};t.bookDeps&&a.calcchain&&(x=eP(Yt(e,vn(a.calcchain)),a.calcchain));var g=0,v={},w,y;{var k=u.Sheets;d.Worksheets=k.length,d.SheetNames=[];for(var C=0;C!=k.length;++C)d.SheetNames[C]=k[C].name}var E=s?"bin":"xml",S=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,S+1)+"_rels/"+a.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");kn(e,N)||(N="xl/_rels/workbook."+E+".rels");var F=Ao(nn(e,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=rP(Yt(e,vn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=MO(Yt(e,vn(a.people[0])),t)),F&&(F=yj(F,u.Sheets));var R=Yt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var D="sheet";if(F&&F[g]?(w="xl/"+F[g][1].replace(/[\/]?xl\//,""),kn(e,w)||(w=F[g][1]),kn(e,w)||(w=N.replace(/_rels\/.*$/,"")+F[g][1]),D=F[g][2]):(w="xl/worksheets/sheet"+(g+1-R)+"."+E,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,j=0;j!=t.sheets.length;++j)typeof t.sheets[j]=="number"&&t.sheets[j]==g&&(T=1),typeof t.sheets[j]=="string"&&t.sheets[j].toLowerCase()==d.SheetNames[g].toLowerCase()&&(T=1);if(!T)continue e}}wj(e,w,y,d.SheetNames[g],g,v,i,D,t,u,o,c)}return m={Directory:a,Workbook:u,Props:d,Custprops:p,Deps:x,Sheets:i,SheetNames:d.SheetNames,Strings:bo,Styles:c,Themes:o,SSF:pt(ze)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(Z,re){Z=Z.replace(/^Root Entry[\/]/,""),m.keys.push(Z),m.files[Z]=e.FileIndex[re]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=Yt(e,vn(a.vba[0]),!0):a.defaults&&a.defaults.bin===GO&&(m.vbaraw=Yt(e,"xl/vbaProject.bin",!0))),m}function Sj(e,t){var r=t||{},n="Workbook",a=Ue.find(e,n);try{if(n="/!DataSpaces/Version",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(nD(a.content),n="/!DataSpaces/DataSpaceMap",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=sD(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=iD(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);oD(a.content)}catch{}if(n="/EncryptionInfo",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=cD(a.content);if(n="/EncryptedPackage",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function kj(e,t){return t.bookType=="ods"?$E(e,t):t.bookType=="numbers"?gj(e,t):t.bookType=="xlsb"?Ej(e,t):GE(e,t)}function Ej(e,t){Ki=1024,e&&!e.SSF&&(e.SSF=pt(ze)),e&&e.SSF&&(bl(),bc(e.SSF),t.revssf=N0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,To?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=hE.indexOf(t.bookType)>-1,a=Zp();mx(t=t||{});var s=Op(),i="",l=0;if(t.cellXfs=[],Rs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ye(s,i,Ck(e.Props,t)),a.coreprops.push(i),ut(t.rels,2,i,qe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}for(e.Props.Worksheets=e.Props.SheetNames.length,Ye(s,i,Ik(e.Props)),a.extprops.push(i),ut(t.rels,3,i,qe.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ye(s,i,Dk(e.Custprops)),a.custprops.push(i),ut(t.rels,4,i,qe.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},d=e.Sheets[e.SheetNames[l-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Ye(s,i,aP(l-1,i,t,e,u)),a.sheets.push(i),ut(t.wbrels,-1,"worksheets/sheet"+l+"."+r,qe.WS[0])}if(d){var p=d["!comments"],m=!1,x="";p&&p.length>0&&(x="xl/comments"+l+"."+r,Ye(s,x,lP(p,x)),a.comments.push(x),ut(u,-1,"../comments"+l+"."+r,qe.CMNT),m=!0),d["!legacy"]&&m&&Ye(s,"xl/drawings/vmlDrawing"+l+".vml",fE(l,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Ye(s,tc(i),nl(u))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ye(s,i,iP(t.Strings,i,t)),a.strs.push(i),ut(t.wbrels,-1,"sharedStrings."+r,qe.SST)),i="xl/workbook."+r,Ye(s,i,nP(e,i)),a.workbooks.push(i),ut(t.rels,1,i,qe.WB),i="xl/theme/theme1.xml",Ye(s,i,ax(e.Themes,t)),a.themes.push(i),ut(t.wbrels,-1,"theme/theme1.xml",qe.THEME),i="xl/styles."+r,Ye(s,i,sP(e,i,t)),a.styles.push(i),ut(t.wbrels,-1,"styles."+r,qe.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ye(s,i,e.vbaraw),a.vba.push(i),ut(t.wbrels,-1,"vbaProject.bin",qe.VBA)),i="xl/metadata."+r,Ye(s,i,oP(i)),a.metadata.push(i),ut(t.wbrels,-1,"metadata."+r,qe.XLMETA),Ye(s,"[Content_Types].xml",Ak(a,t)),Ye(s,"_rels/.rels",nl(t.rels)),Ye(s,"xl/_rels/workbook."+r+".rels",nl(t.wbrels)),delete t.revssf,delete t.ssf,s}function GE(e,t){Ki=1024,e&&!e.SSF&&(e.SSF=pt(ze)),e&&e.SSF&&(bl(),bc(e.SSF),t.revssf=N0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,To?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=hE.indexOf(t.bookType)>-1,a=Zp();mx(t=t||{});var s=Op(),i="",l=0;if(t.cellXfs=[],Rs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ye(s,i,Ck(e.Props,t)),a.coreprops.push(i),ut(t.rels,2,i,qe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length,Ye(s,i,Ik(e.Props)),a.extprops.push(i),ut(t.rels,3,i,qe.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ye(s,i,Dk(e.Custprops)),a.custprops.push(i),ut(t.rels,4,i,qe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Ye(s,i,_E(l-1,t,e,d)),a.sheets.push(i),ut(t.wbrels,-1,"worksheets/sheet"+l+"."+r,qe.WS[0])}if(h){var m=h["!comments"],x=!1,g="";if(m&&m.length>0){var v=!1;m.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+l+"."+r,Ye(s,g,jO(m,u,t)),a.threadedcomments.push(g),ut(d,-1,"../threadedComments/threadedComment"+l+"."+r,qe.TCMNT)),g="xl/comments"+l+"."+r,Ye(s,g,dE(m)),a.comments.push(g),ut(d,-1,"../comments"+l+"."+r,qe.CMNT),x=!0}h["!legacy"]&&x&&Ye(s,"xl/drawings/vmlDrawing"+l+".vml",fE(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ye(s,tc(i),nl(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ye(s,i,Qk(t.Strings,t)),a.strs.push(i),ut(t.wbrels,-1,"sharedStrings."+r,qe.SST)),i="xl/workbook."+r,Ye(s,i,FE(e)),a.workbooks.push(i),ut(t.rels,1,i,qe.WB),i="xl/theme/theme1.xml",Ye(s,i,ax(e.Themes,t)),a.themes.push(i),ut(t.wbrels,-1,"theme/theme1.xml",qe.THEME),i="xl/styles."+r,Ye(s,i,lE(e,t)),a.styles.push(i),ut(t.wbrels,-1,"styles."+r,qe.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ye(s,i,e.vbaraw),a.vba.push(i),ut(t.wbrels,-1,"vbaProject.bin",qe.VBA)),i="xl/metadata."+r,Ye(s,i,uE()),a.metadata.push(i),ut(t.wbrels,-1,"metadata."+r,qe.XLMETA),u.length>1&&(i="xl/persons/person.xml",Ye(s,i,BO(u)),a.people.push(i),ut(t.wbrels,-1,"persons/person.xml",qe.PEOPLE)),Ye(s,"[Content_Types].xml",Ak(a,t)),Ye(s,"_rels/.rels",nl(t.rels)),Ye(s,"xl/_rels/workbook."+r+".rels",nl(t.wbrels)),delete t.revssf,delete t.ssf,s}function px(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _j(e,t){return Ue.find(e,"EncryptedPackage")?Sj(e,t):fx(e,t)}function Nj(e,t){var r,n=e,a=t||{};return a.type||(a.type=Xe&&Buffer.isBuffer(e)?"buffer":"base64"),r=sk(n,a),WE(r,a)}function YE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return hm(e.slice(r),t);default:break e}return xl.to_workbook(e,t)}function Aj(e,t){var r="",n=px(e,t);switch(t.type){case"base64":r=cn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=li(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=mt(r)),t.type="binary",YE(r,t)}function bj(e,t){var r=e;return t.type=="base64"&&(r=cn(r)),r=nt.utils.decode(1200,r.slice(2),"str"),t.type="binary",YE(r,t)}function Tj(e){return e.match(/[^\x00-\x7F]/)?da(e):e}function Bd(e,t,r,n){return n?(r.type="string",xl.to_workbook(e,r)):xl.to_workbook(t,r)}function fn(e,t){E0();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return fn(new Uint8Array(e),(r=pt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),sl={},r.dateNF&&(sl.dateNF=r.dateNF),r.type||(r.type=Xe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Xe?"buffer":"binary",n=C3(e),typeof Uint8Array<"u"&&!Xe&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Tj(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=pt(r),r.type="array",fn(Fp(n),r)}switch((a=px(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return _j(Ue.read(n,r),r);break;case 9:if(a[1]<=8)return fx(n,r);break;case 60:return hm(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return UI(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return qk.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Nj(n,r):Bd(e,n,r,s);case 239:return a[3]===60?hm(n,r):Bd(e,n,r,s);case 255:if(a[1]===254)return bj(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Xs.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Xs.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return dm.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return aE.to_workbook(n,r);break;case 10:case 13:case 32:return Aj(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return BI.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?dm.to_workbook(n,r):Bd(e,n,r,s)}function _v(e,t){var r=t||{};return r.type="file",fn(e,r)}function KE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Tc(t.file,Ue.write(e,{type:Xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ue.write(e,t)}function Cj(e,t){var r=pt(t||{}),n=kj(e,r);return XE(n,r)}function Fj(e,t){var r=pt(t||{}),n=GE(e,r);return XE(n,r)}function XE(e,t){var r={},n=Xe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ue.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Ac(a))}return t.password&&typeof encrypt_agile<"u"?KE(encrypt_agile(a,t.password),t):t.type==="file"?Tc(t.file,a):t.type=="string"?mt(a):a}function Rj(e,t){var r=t||{},n=OP(e,r);return KE(n,r)}function la(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Jo(da(n));case"binary":return da(n);case"string":return e;case"file":return Tc(t.file,n,"utf8");case"buffer":return Xe?Ga(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):la(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ij(e,t){switch(t.type){case"base64":return Jo(e);case"binary":return e;case"string":return e;case"file":return Tc(t.file,e,"binary");case"buffer":return Xe?Ga(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function yu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Jo(r):t.type=="string"?mt(r):r;case"file":return Tc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function xx(e,t){E0(),CE(e);var r=pt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=xx(e,r);return r.type="array",Ac(n)}return Fj(e,r)}function I0(e,t){E0(),CE(e);var r=pt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=I0(e,r);return r.type="array",Ac(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return la(bP(e,r),r);case"slk":case"sylk":return la(Jk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return la(BE(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Ij(ZE(e.Sheets[e.SheetNames[a]],r),r);case"csv":return la(vx(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return la(qk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return yu(dm.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return la(xl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return la(aE.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return la(Zk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return la($E(e,r),r);case"wk1":return yu(Xs.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return yu(Xs.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),yu(OE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Rj(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Cj(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function gx(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function jn(e,t,r){var n=r||{};return n.type="file",n.file=t,gx(n),I0(e,n)}function Dj(e,t,r){var n=r||{};return n.type="file",n.file=t,gx(n),xx(e,n)}function Oj(e,t,r,n){var a=r||{};a.type="file",a.file=e,gx(a),a.type="buffer";var s=n;return s instanceof Function||(s=r),us.writeFile(e,I0(t,a),s)}function JE(e,t,r,n,a,s,i,l){var o=Pt(r),c=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=i?e[r][p]:e[n[p]+o];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[p]!=null&&(h[s[p]]=c);continue}var x=m.v;switch(m.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[p]!=null){if(x==null)if(m.t=="e"&&x===null)h[s[p]]=null;else if(c!==void 0)h[s[p]]=c;else if(u&&x===null)h[s[p]]=null;else continue;else h[s[p]]=u&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?x:ya(m,x,l);x!=null&&(d=!1)}}return{row:h,isempty:d}}function Hf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,l="",o={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":o=tt(u);break;case"number":o=tt(e["!ref"]),o.s.r=u;break;default:o=u}n>0&&(a=0);var d=Pt(o.s.r),h=[],p=[],m=0,x=0,g=Array.isArray(e),v=o.s.r,w=0,y={};g&&!e[v]&&(e[v]=[]);var k=c.skipHidden&&e["!cols"]||[],C=c.skipHidden&&e["!rows"]||[];for(w=o.s.c;w<=o.e.c;++w)if(!(k[w]||{}).hidden)switch(h[w]=St(w),r=g?e[v][w]:e[h[w]+d],n){case 1:s[w]=w-o.s.c;break;case 2:s[w]=h[w];break;case 3:s[w]=c.header[w-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=ya(r,null,c),x=y[i]||0,!x)y[i]=1;else{do l=i+"_"+x++;while(y[l]);y[i]=x,y[l]=1}s[w]=l}for(v=o.s.r+a;v<=o.e.r;++v)if(!(C[v]||{}).hidden){var E=JE(e,o,v,h,n,s,g,c);(E.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[m++]=E.row)}return p.length=m,p}var Nv=/"/g;function qE(e,t,r,n,a,s,i,l){for(var o=!0,c=[],u="",d=Pt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=l.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)u="";else if(p.v!=null){o=!1,u=""+(l.rawNumbers&&p.t=="n"?p.v:ya(p,null,l));for(var m=0,x=0;m!==u.length;++m)if((x=u.charCodeAt(m))===a||x===s||x===34||l.forceQuotes){u='"'+u.replace(Nv,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(o=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Nv,'""')+'"')):u="";c.push(u)}return l.blankrows===!1&&o?null:c.join(i)}function vx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=tt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,o=l.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(d[m]=St(m));for(var x=0,g=a.s.r;g<=a.e.r;++g)(p[g]||{}).hidden||(u=qE(e,a,g,d,i,o,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((x++?l:"")+u)));return delete n.dense,r.join("")}function ZE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=vx(e,t);if(typeof nt>"u"||t.type=="string")return r;var n=nt.utils.encode(1200,r,"str");return""+n}function Lj(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=tt(e["!ref"]),s="",i=[],l,o=[],c=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)i[l]=St(l);for(var u=a.s.r;u<=a.e.r;++u)for(s=Pt(u),l=a.s.c;l<=a.e.c;++l)if(t=i[l]+s,r=c?(e[u]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}o[o.length]=t+"="+n}return o}function QE(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Ct(n.origin):n.origin;i=o.r,l=o.c}var c,u={s:{c:0,r:0},e:{c:l,r:i+t.length-1+a}};if(s["!ref"]){var d=tt(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(i=d.e.r+1,u.e.r=i+t.length-1+a)}else i==-1&&(i=0,u.e.r=t.length-1+a);var h=n.header||[],p=0;t.forEach(function(x,g){Bt(x).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var w=x[v],y="z",k="",C=He({c:l+p,r:i+g+a});c=oc(s,C),w&&typeof w=="object"&&!(w instanceof Date)?s[C]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=er(w)),k=n.dateNF||ze[14]):w===null&&n.nullError&&(y="e",w=0),c?(c.t=y,c.v=w,delete c.w,delete c.R,k&&(c.z=k)):s[C]=c={t:y,v:w},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var m=Pt(i);if(a)for(p=0;p<h.length;++p)s[St(p+l)+m]={t:"s",v:h[p]};return s["!ref"]=Ge(u),s}function Pj(e,t){return QE(null,e,t)}function oc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ct(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?oc(e,He(t)):oc(e,He({r:t,c:r||0}))}function jj(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function yx(){return{SheetNames:[],Sheets:{}}}function wx(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(TE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Mj(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=jj(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Bj(e,t){return e.z=t,e}function e_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Uj(e,t,r){return e_(e,"#"+t,r)}function zj(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Hj(e,t,r,n){for(var a=typeof t!="string"?t:tt(t),s=typeof t=="string"?t:Ge(t),i=a.s.r;i<=a.e.r;++i)for(var l=a.s.c;l<=a.e.c;++l){var o=oc(e,i,l);o.t="n",o.F=s,delete o.v,i==a.s.r&&l==a.s.c&&(o.f=r,n&&(o.D=!0))}return e}var Ve={encode_col:St,encode_row:Pt,encode_cell:He,encode_range:Ge,decode_col:Gp,decode_row:Wp,split_cell:lF,decode_cell:Ct,decode_range:Ur,format_cell:ya,sheet_add_aoa:yk,sheet_add_json:QE,sheet_add_dom:UE,aoa_to_sheet:Cl,json_to_sheet:Pj,table_to_sheet:zE,table_to_book:ZP,sheet_to_csv:vx,sheet_to_txt:ZE,sheet_to_json:Hf,sheet_to_html:BE,sheet_to_formulae:Lj,sheet_to_row_object_array:Hf,sheet_get_cell:oc,book_new:yx,book_append_sheet:wx,book_set_sheet_visibility:Mj,cell_set_number_format:Bj,cell_set_hyperlink:e_,cell_set_internal_link:Uj,cell_add_comment:zj,sheet_set_array_formula:Hj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},D0;function $j(e){D0=e}function Vj(e,t){var r=D0(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=tt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,o=l.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(d[m]=St(m));var x=a.s.r,g=!1,v=0;return r._read=function(){if(!g)return g=!0,r.push("\uFEFF");for(;x<=a.e.r;)if(++x,!(p[x-1]||{}).hidden&&(u=qE(e,a,x-1,d,i,o,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),u||n.blankrows!==!1)))return r.push((v++?l:"")+u);return r.push(null)},r}function Wj(e,t){var r=D0(),n=t||{},a=n.header!=null?n.header:PE,s=n.footer!=null?n.footer:jE;r.push(a);var i=Ur(e["!ref"]);n.dense=Array.isArray(e),r.push(ME(e,i,n));var l=i.s.r,o=!1;return r._read=function(){if(l>i.e.r)return o||(o=!0,r.push("</table>"+s)),r.push(null);for(;l<=i.e.r;){r.push(LE(e,i,l,n)),++l;break}},r}function Gj(e,t){var r=D0({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,s=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)&&(a=3),typeof d){case"string":c=tt(d);break;case"number":c=tt(e["!ref"]),c.s.r=d;break;default:c=d}a>0&&(s=0);var h=Pt(c.s.r),p=[],m=0,x=Array.isArray(e),g=c.s.r,v=0,w={};x&&!e[g]&&(e[g]=[]);var y=u.skipHidden&&e["!cols"]||[],k=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(y[v]||{}).hidden)switch(p[v]=St(v),n=x?e[g][v]:e[p[v]+h],a){case 1:i[v]=v-c.s.c;break;case 2:i[v]=p[v];break;case 3:i[v]=u.header[v-c.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),o=l=ya(n,null,u),m=w[l]||0,!m)w[l]=1;else{do o=l+"_"+m++;while(w[o]);w[l]=m,w[o]=1}i[v]=o}return g=c.s.r+s,r._read=function(){for(;g<=c.e.r;)if(!(k[g-1]||{}).hidden){var C=JE(e,c,g,p,a,i,x,u);if(++g,C.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows)){r.push(C.row);return}}return r.push(null)},r}var Yj={to_json:Gj,to_html:Wj,to_csv:Vj,set_readable:$j};const Kj=Xo.version,t_=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ue,SSF:QS,parse_xlscfb:fx,parse_zip:WE,read:fn,readFile:_v,readFileSync:_v,set_cptable:ZC,set_fs:b3,stream:Yj,utils:Ve,version:Kj,write:I0,writeFile:jn,writeFileAsync:Oj,writeFileSync:jn,writeFileXLSX:Dj,writeXLSX:xx},Symbol.toStringTag,{value:"Module"})),vl="personCards",Xj="rosterPins",Jj="supervisorPool",qj="supervisorConfig",Av=new Set(["N","V1","V2","SV"]),In=e=>(e||"").toString().trim().toLocaleUpperCase("tr-TR"),r_=(e,t)=>new Date(e,t+1,0).getDate();function Zj(e){let t=e>>>0;return function(){t+=1831565813;let r=Math.imul(t^t>>>15,1|t);return r^=r+Math.imul(r^r>>>7,61|r),((r^r>>>14)>>>0)/4294967296}}function Xi(e,t){try{const r=localStorage.getItem(e);return r?JSON.parse(r):t}catch{return t}}function Qj(e){return(e||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(//g,"G").replace(//g,"U").replace(//g,"S").replace(//g,"I").replace(//g,"O").replace(//g,"C").replace(//g,"g").replace(//g,"u").replace(//g,"s").replace(//g,"i").replace(//g,"o").replace(//g,"c")}function Tn(e){return Qj(In(e)).replace(/\s+/g," ").trim()}function bv(e){return Tn(e).split(" ").filter(Boolean)}function eM(e){const t=In(e),r={"SERVS SORUMLUSU":["SERVS SORUMLUSU","SORUMLU"],SPERVZR:["SPERVZR","SUPERVISOR","SV"],"EKP SORUMLUSU":["EKP SORUMLUSU","SORUMLU"],RESSTASYON:["RESSTASYON"],"KIRMIZI VE SARI GREVLENDRME":["KIRMIZI","SARI"],KIRMIZI:["KIRMIZI"],SARI:["SARI"],OCUK:["OCUK"],YEL:["YEL"],ECZANE:["ECZANE"],"CERRAH MDAHELE":["CERRAH MDAHELE","CERRAH"],CERRAH:["CERRAH"],AI:["AI"],TRAJ:["TRAJ"]};for(const n of Object.keys(r))if(t.includes(n))return r[n];return t?[t.split(" ")[0]]:[]}function $f(e){return!e&&e!==0?[]:Array.isArray(e)?e:typeof e=="string"?e.split(/[;,|]/).map(t=>t.trim()).filter(Boolean):[]}function tM(e){var r,n,a,s,i,l,o,c,u,d,h;const t=[];for(const p of e||[]){const m=String((p==null?void 0:p.id)??(p==null?void 0:p.pid)??(p==null?void 0:p.tc)??(p==null?void 0:p.code)??""),x=(p==null?void 0:p.name)||(p==null?void 0:p.fullName)||(p==null?void 0:p.displayName)||(p==null?void 0:p["AD SOYAD"]);if(!m||!x)continue;const g=new Set;[p.areas,p.workAreas,p.skills,p.tags,(r=p==null?void 0:p.meta)==null?void 0:r.areas,(n=p==null?void 0:p.meta)==null?void 0:n.workAreas,(a=p==null?void 0:p.meta)==null?void 0:a.skills,(s=p==null?void 0:p.meta)==null?void 0:s.tags].forEach(w=>$f(w).forEach(y=>g.add(In(y))));const v=new Set;[p.shiftCodes,p.shifts,p.allowedShifts,p.vardiyaKodlari,p.vardiya,p.vardiyalar,(i=p==null?void 0:p.meta)==null?void 0:i.shiftCodes,(l=p==null?void 0:p.meta)==null?void 0:l.shifts].forEach(w=>$f(w).forEach(y=>v.add(In(y)))),t.push({id:m,name:x,nameCanon:Tn(x),role:p.role||((o=p==null?void 0:p.meta)==null?void 0:o.role)||null,code:p.code||((c=p==null?void 0:p.meta)==null?void 0:c.code)||null,areas:g,shiftCodes:v,weekendOff:!!(p.weekendOff||(u=p==null?void 0:p.meta)!=null&&u.weekendOff),nightAllowed:!(p.nightAllowed===!1||((d=p==null?void 0:p.meta)==null?void 0:d.nightAllowed)===!1||((h=p==null?void 0:p.meta)==null?void 0:h.geceYasak)===!0),meta:p})}return t}function ql(e,t,r,n,a,s=!0){var o,c;const i=new Date(r,n,a).getDay();if(e.weekendOff&&(i===0||i===6))return!1;if(!s)return!0;const l=eM(t.label);return!((o=e.areas)!=null&&o.size&&!l.some(u=>e.areas.has(In(u)))||t.shiftCode&&((c=e.shiftCodes)!=null&&c.size)&&!e.shiftCodes.has(In(t.shiftCode)))}function rM(e,t){if(e==null)return null;const r=String(e);return t.get(Tn(r))||r}function nM(e){const t=Xi(Jj,[]),r=new Set;for(const n of t||[]){const a=rM(n,e);a&&r.add(String(a))}return r}function aM(e){const t=["SORUMLU","SERVS SORUMLUSU","SPERVZR","SUPERVISOR","SV"];return e.filter(r=>{var n,a,s,i;if(r.role&&/sorumlu|supervis/i.test(r.role))return!0;for(const l of t)if((n=r.areas)!=null&&n.has(l)||(a=r.shiftCodes)!=null&&a.has(l)||$f((s=r.meta)==null?void 0:s.skills).some(o=>In(o)===l)||$f((i=r.meta)==null?void 0:i.tags).some(o=>In(o)===l))return!0;return!1})}function sM(e,t,r,n){const a=r_(r,n),s={};for(const i of e||[]){const l=Math.max(0,Number((i==null?void 0:i.defaultCount)||0)),o=Array.isArray(i==null?void 0:i.pattern)&&i.pattern.length===7?i.pattern.map(u=>Math.max(0,Number(u)||0)):[l,l,l,l,l,l,l],c=(t==null?void 0:t[i.id])||{};for(let u=1;u<=a;u++){const d=new Date(r,n,u).getDay(),h=(d+6)%7;let p=c[u];p==null&&(p=o[h]??l),i.weekendOff&&(d===0||d===6)&&(p=0),p=Math.max(0,Number(p)||0),s[u]||(s[u]={}),s[u][i.id]=p}}return s}function iM(){const e=[];["leavesV2","leaves","topluIzin","izinToplu","leavesGrid","leaveGrid","toplu-izin-listesi"].forEach(r=>{const n=Xi(r,null);n!=null&&e.push({key:r,data:n})});for(let r=0;r<localStorage.length;r++){const n=localStorage.key(r);if(/leave|izin/i.test(n))try{const a=JSON.parse(localStorage.getItem(n));a!=null&&e.push({key:n,data:a})}catch{}}return e}function lM(e){const r=String(e).match(/\d{1,2}/g);if(!r)return null;for(const n of r){const a=Number(n);if(a>=1&&a<=31)return a}return null}function oM(e){if(e==null)return!1;const t=String(e).trim();if(t===""||t==="0")return!1;const r=t.toLocaleLowerCase("tr-TR");return!["hayr","hayir","no"].includes(r)}function Ci(e,t){for(const r of Object.keys(t||{})){e[r]=e[r]||{};for(const n of Object.keys(t[r]))e[r][n]=Object.assign(e[r][n]||{},t[r][n])}return e}function Wu(e,{year:t,month0:r,staff:n}){const a=`${t}-${String(r+1).padStart(2,"0")}`,s={},i={},l=new Map,o=new Map;for(const h of n){l.set(h.nameCanon,h.id);const p=bv(h.nameCanon),m=p[p.length-1];if(m){const x=o.get(m)||[];x.push(h.id),o.set(m,x)}h.code&&l.set(Tn(h.code),h.id)}const c=(h,p)=>{!h||!p||(s[h]=s[h]||{},s[h][a]=s[h][a]||{},s[h][a][String(p)]=!0)},u=(h,p)=>{!h||!p||(i[h]=i[h]||{},i[h][a]=i[h][a]||{},i[h][a][String(p)]=!0)},d=h=>{const p=Tn(h);if(l.has(p))return{pid:l.get(p),canon:p};const m=bv(p);if(!m.length)return{pid:null,canon:p};const x=`${m[0]} ${m[m.length-1]}`;if(l.has(x))return{pid:l.get(x),canon:x};const g=m[m.length-1],v=o.get(g);return v&&v.length===1?{pid:v[0],canon:p}:{pid:null,canon:p}};for(const{data:h}of e){if(Array.isArray(h)){if(h.some(m=>m&&(m.personId!=null||m.id!=null||m.pid!=null||m.personCode)&&(m.date||m.year&&m.month&&m.day))){for(const m of h){const x=(m==null?void 0:m.personId)??(m==null?void 0:m.id)??(m==null?void 0:m.pid)??null,g=(m==null?void 0:m.personCode)||(m==null?void 0:m.code),v=(m==null?void 0:m.personName)||(m==null?void 0:m.name)||(m==null?void 0:m.fullName)||(m==null?void 0:m["AD SOYAD"]);let w=x?String(x):null;if(!w&&(g||v)){const E=Tn(g||v);w=l.get(E)||null}let y,k,C;if(m!=null&&m.date){const E=new Date(m.date);Number.isNaN(E)||(y=E.getFullYear(),k=E.getMonth()+1,C=E.getDate())}else y=Number(m.year),k=Number(m.month),C=Number(m.day);y===t&&k===r+1&&C&&(w?c(w,C):v&&u(Tn(v),C))}continue}if(h.length&&typeof h[0]=="object"){for(const m of h){const x=m.fullName||m.name||m["AD SOYAD"]||m.personName||m.employeeName||m.title,g=m.code||m.personCode,v=m.id??m.pid??m.tc??m.tcNo;let w=v?String(v):null,y=null;if(!w&&(x||g)){const C=d(g||x);w=C.pid,y=C.canon}const k=[m,m.days||m.DAYS||m.gunler||null].filter(C=>C&&typeof C=="object");for(const C of k)for(const E of Object.keys(C)){const S=lM(E);if(!S)continue;const N=C[E];oM(N)&&(w?c(w,S):(y||x)&&u(y||Tn(x),S))}}continue}if(Array.isArray(h.rows)||Array.isArray(h.items)){const m=Array.isArray(h.rows)?h.rows:h.items,x=Wu([{data:m}],{year:t,month0:r,staff:n});Ci(s,x.byId),Ci(i,x.byCanon);continue}}if(h&&typeof h=="object")if(Array.isArray(h.rows)||Array.isArray(h.items)){const p=Array.isArray(h.rows)?h.rows:h.items,m=Wu([{data:p}],{year:t,month0:r,staff:n});Ci(s,m.byId),Ci(i,m.byCanon)}else{const p=Object.values(h);if(p.length&&typeof p[0]=="object"){const m=Wu([{data:p}],{year:t,month0:r,staff:n});Ci(s,m.byId),Ci(i,m.byCanon)}}}try{console.info("[leaves] merged",{ym:a,byId:Object.keys(s).length,byCanon:Object.keys(i).length})}catch{}return{byId:s,byCanon:i}}function cM({year:e,month0:t,role:r="Nurse",rows:n,overrides:a,leavePolicy:s="hard",forcePins:i=!0,requireEligibility:l=!0}){var T,j,Z,re,W,Q,H,L,ee,te,b,A,O,P,U,q,J;const o=`${e}-${String(t+1).padStart(2,"0")}`,c=Zj(e*100+(t+1)),u=Xi(vl,[]),d=tM(u),h=new Map(d.map(B=>[B.id,B]));new Map(d.map(B=>[B.nameCanon,B]));const p=Wu(iM(),{year:e,month0:t,staff:d});try{const B=$a()||{},ne=Xi("allLeavesByNameV1",{})||{},fe=OS()||{ids:{},canon:{}},M=`${e}-${String(t+1).padStart(2,"0")}`;for(const[ue,ye]of Object.entries(B)){const Te=ye==null?void 0:ye[M];if(!Te)continue;const ve=String(ue),pe=h.get(ve),Me=pe==null?void 0:pe.nameCanon;for(const[Ke,Be]of Object.entries(Te||{})){let Pe=NaN;/^\d{4}-\d{2}-\d{2}$/.test(Ke)?Pe=parseInt(Ke.slice(8,10),10):Pe=parseInt(Ke,10),!(!Number.isFinite(Pe)||Pe<1||Pe>31)&&((Z=(j=(T=fe.ids)==null?void 0:T[ve])==null?void 0:j[M])!=null&&Z[String(Pe)]||((re=p.byId)[ve]??(re[ve]={}),(W=p.byId[ve])[M]??(W[M]={}),p.byId[ve][M][String(Pe)]=!0,Me&&((Q=p.byCanon)[Me]??(Q[Me]={}),(H=p.byCanon[Me])[M]??(H[M]={}),p.byCanon[Me][M][String(Pe)]=!0)))}}for(const[ue,ye]of Object.entries(ne)){const Te=ye==null?void 0:ye[M];if(!Te)continue;const ve=Tn(ue);for(const[pe,Me]of Object.entries(Te||{})){let Ke=NaN;/^\d{4}-\d{2}-\d{2}$/.test(pe)?Ke=parseInt(pe.slice(8,10),10):Ke=parseInt(pe,10),!(!Number.isFinite(Ke)||Ke<1||Ke>31)&&((te=(ee=(L=fe.canon)==null?void 0:L[ve])==null?void 0:ee[M])!=null&&te[String(Ke)]||((b=p.byCanon)[ve]??(b[ve]={}),(A=p.byCanon[ve])[M]??(A[M]={}),p.byCanon[ve][M][String(Ke)]=!0))}}}catch(B){console.warn("[roster] merge allLeaves fallback failed:",B)}const m=(B,ne)=>{var ue,ye,Te,ve,pe,Me;const fe=B.id,M=B.nameCanon;return!!((Te=(ye=(ue=p.byId)==null?void 0:ue[fe])==null?void 0:ye[o])!=null&&Te[String(ne)]||(Me=(pe=(ve=p.byCanon)==null?void 0:ve[M])==null?void 0:pe[o])!=null&&Me[String(ne)])},x=Xi(Xj,{}),g=((O=x==null?void 0:x[r])==null?void 0:O[o])||{},v=Xi(qj,{})||{},w=new Map(d.map(B=>[B.nameCanon,B.id])),y=B=>B==null?null:w.get(Tn(B))||String(B),k={primaryId:y(v.primary),assistants:(v.assistants||[]).map(y).filter(Boolean).map(String),fallbackPool:(v.fallbackPool||[]).map(y).filter(Boolean).map(String),weekdayOnly:v.weekdayOnly!==!1,ensureAssistCount:Number(v.ensureAssistCount??1)||1,assistDays:new Set(Array.isArray(v.assistDays)?v.assistDays.map(Number):v.assistDays&&typeof v.assistDays=="object"?Object.keys(v.assistDays).map(Number):[]),offDays:new Set(Array.isArray(v.offDays)?v.offDays.map(Number):v.offDays&&typeof v.offDays=="object"?Object.keys(v.offDays).map(Number):[])},C=nM(new Map(d.map(B=>[B.nameCanon,B.id])));let E=Array.from(C).map(B=>h.get(B)).filter(Boolean);E.length||(E=aM(d));const S=Object.fromEntries(d.map(B=>[B.id,0])),N=sM(n,a,e,t),F=r_(e,t),R={},D=[];for(let B=1;B<=F;B++){R[B]={};const ne=new Set,fe=new Date(e,t,B).getDay(),M=fe===0||fe===6;for(const ue of n||[]){if(!In((ue==null?void 0:ue.label)||"").includes("SERVS SORUMLUSU"))continue;const Te=((P=N[B])==null?void 0:P[ue.id])||0;let ve=Te;if(k.weekdayOnly&&M){R[B][ue.id]=[];continue}if(k.assistDays.has(B)){const Be=Math.max(0,Number(k.ensureAssistCount));ve=Math.max(Te,1+Be)}const pe=[],Me=Be=>!Be||s!=="ignore"&&m(Be,B)||!ql(Be,ue,e,t,B,l)||ne.has(Be.id)?!1:(pe.push(Be.name),ne.add(Be.id),S[Be.id]=(S[Be.id]||0)+1,!0),Ke=((U=g==null?void 0:g[B])==null?void 0:U[ue.id])||[];for(const Be of Ke){const Pe=h.get(String(Be));if(Pe&&!(s!=="ignore"&&(m(Pe,B)||!ql(Pe,ue,e,t,B,l)))&&!ne.has(Pe.id)&&(pe.push(Pe.name),ne.add(Pe.id),S[Pe.id]=(S[Pe.id]||0)+1,pe.length>=ve))break}if(pe.length<ve&&!k.offDays.has(B)&&k.primaryId){const Be=h.get(k.primaryId);Be&&Me(Be)}if(pe.length<ve)for(const Be of k.assistants){const Pe=h.get(Be);if(Pe&&Me(Pe)&&pe.length>=ve)break}if(pe.length<ve){let Pe=(k.fallbackPool.length?k.fallbackPool:E.map(Ze=>Ze.id)).map(Ze=>h.get(Ze)).filter(Boolean).filter(Ze=>!ne.has(Ze.id)).filter(Ze=>ql(Ze,ue,e,t,B,l)).filter(Ze=>s==="ignore"?!0:!m(Ze,B));Pe.sort((Ze,Nt)=>S[Ze.id]-S[Nt.id]||c()-.5);for(const Ze of Pe)if(Me(Ze)&&pe.length>=ve)break}pe.length<ve&&D.push({day:B,label:ue.label,need:ve,assigned:pe.length,note:"Supervisor aday yok"}),R[B][ue.id]=pe}for(const ue of n||[]){if(In((ue==null?void 0:ue.label)||"").includes("SERVS SORUMLUSU"))continue;const Te=((q=N[B])==null?void 0:q[ue.id])||0;if(Te<=0){R[B][ue.id]=[];continue}const ve=[],pe=((J=g==null?void 0:g[B])==null?void 0:J[ue.id])||[];for(const Be of pe){const Pe=h.get(String(Be));if(Pe&&!(s!=="ignore"&&(m(Pe,B)||!ql(Pe,ue,e,t,B,l)))&&!ne.has(Pe.id)&&(ve.push(Pe.name),ne.add(Pe.id),ve.length>=Te))break}let Me=d.filter(Be=>!ne.has(Be.id)).filter(Be=>ql(Be,ue,e,t,B,l)).filter(Be=>s==="ignore"?!0:!m(Be,B));if(Av.has(In((ue==null?void 0:ue.shiftCode)||""))&&B>1){const Be=R[B-1]||{},Pe=new Set;for(const Ze of n||[])if(Av.has(In((Ze==null?void 0:Ze.shiftCode)||"")))for(const Nt of Be[Ze.id]||[])Pe.add(Tn(Nt));Me=Me.filter(Ze=>!Pe.has(Ze.nameCanon))}for(;ve.length<Te&&Me.length;){const Be=Math.floor(c()*Me.length),Pe=Me.splice(Be,1)[0];ve.push(Pe.name),ne.add(Pe.id)}ve.length<Te&&D.push({day:B,label:ue.label,need:Te,assigned:ve.length}),R[B][ue.id]=ve}}return{namedAssignments:R,issues:D}}const cc=e=>String(e).padStart(2,"0"),n_=(e,t)=>`${e}-${cc(t)}`,ua=e=>(e??"").toString().trim().toLocaleUpperCase("tr"),uM=(e,t)=>{try{return JSON.parse(e)}catch{return t}},Zr=(e,t)=>uM(localStorage.getItem(e),t),fM=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),dM={people:"peopleV2",people_fallback:"people",leaves:"leavesV2",leaves_fallback:"leaves",workAreas:"workAreasV2",workAreas_fallback:"workAreas",workingHours:"workingHoursV2",workingHours_fallback:"workingHours",leaveTypes:"leaveTypesV2",leaveTypes_fallback:"leaveTypes",rules:"rulesV2",rules_fallback:"rules",requests:"requestsV1",requests_fallback:"requests",scheduleTarget:"scheduleRowsV2"};function hM(e,t){const r=new Date(e,t,0).getDate(),n=[];for(let a=1;a<=r;a++){const s=new Date(e,t-1,a);n.push({y:e,m:t,d:a,dow:s.getDay()})}return n}function mM(e,t){const r=new Date(e+"T00:00:00");return(new Date(t+"T00:00:00")-r)/(1e3*60*60*24)}function pM(e,t){return e==="N"?24:0}function xM(e){const t=e.people,r=e.people_fallback,n=Zr(t,Zr(r,[]));return Array.isArray(n)?n.filter(a=>a&&a.id&&a.name):[]}function gM(e,t,r){const n=r.leaves,a=r.leaves_fallback,s=Zr(n,Zr(a,{})),i=n_(e,t);return s&&typeof s=="object"?{ym:i,map:s}:{ym:i,map:{}}}function vM(e){const t=e.workAreas,r=e.workAreas_fallback,n=Zr(t,Zr(r,[]));return Array.isArray(n)?n:[]}function yM(e){const t=e.workingHours,r=e.workingHours_fallback,n=Zr(t,Zr(r,{}));return{shiftHours:(n==null?void 0:n.shiftHours)||{M:8,G:8,E:8,N:16,OFF:0},weeklyHourCap:Number(n==null?void 0:n.weeklyHourCap)||80,restAfterNightHours:Number(n==null?void 0:n.restAfterNightHours)||24}}function wM(e){const t=e.leaveTypes,r=e.leaveTypes_fallback,n=Zr(t,Zr(r,[])),a=new Map;for(const s of Array.isArray(n)?n:[])s!=null&&s.code&&a.set(ua(s.code),s);return a}function SM(e){const t=e.rules,r=e.rules_fallback,n=Zr(t,Zr(r,{}));return n&&typeof n=="object"?n:{}}function kM(e){const t=e.requests,r=e.requests_fallback,n=Zr(t,Zr(r,{}));return n&&typeof n=="object"?n:{}}function EM({people:e,allLeaves:t,year:r,month1_12:n}){var l;const a=n_(r,n),s=new Map;for(const o of e)s.set(o.id,new Map);const i=(t==null?void 0:t.map)||{};for(const o of Object.keys(i)){const c=i[o],u=(c==null?void 0:c[a])||{};for(const d of Object.keys(u)){const h=typeof u[d]=="object"?(l=u[d])==null?void 0:l.code:u[d],p=`${r}-${cc(n)}-${cc(Number(d))}`;s.has(o)||s.set(o,new Map),s.get(o).set(p,ua(h))}}return s}function _M({person:e,dateKey:t,shiftCode:r,lastAssignment:n,leavesByDay:a,leaveTypes:s,rules:i,workingHours:l,personHours:o}){var h,p,m,x;if(((h=a==null?void 0:a.get(e.id))==null?void 0:h.get(t))||(p=n==null?void 0:n.get(e.id))!=null&&p.get(t))return!1;const u=(m=n==null?void 0:n.get(e.id))==null?void 0:m.get("_lastShift");if(u&&pM(u)>=24){const v=n.get(e.id).get("_lastDate");if(v&&Math.abs(mM(v,t))<1)return!1}return!((o.get(e.id)||0)+(((x=l.shiftHours)==null?void 0:x[r])||0)>l.weeklyHourCap)}function Tv({person:e,dateKey:t,shiftCode:r,requests:n,personHours:a}){var u,d,h,p,m,x;let s=0;const i=(u=n==null?void 0:n.want)==null?void 0:u[t],l=(d=n==null?void 0:n.avoid)==null?void 0:d[t];(Array.isArray(i)?i.includes(e.id):(h=i==null?void 0:i.has)!=null&&h.call(i,e.id))&&(s+=10),(Array.isArray(l)?l.includes(e.id):(p=l==null?void 0:l.has)!=null&&p.call(l,e.id))&&(s-=10);const o=(x=(m=n==null?void 0:n.preferShift)==null?void 0:m[e.id])==null?void 0:x[t];o&&ua(o)===ua(r)&&(s+=5);const c=a.get(e.id)||0;return s+=Math.max(0,1e3-c),s}function NM({year:e,month1_12:t,people:r,workAreas:n,workingHours:a,leavesByDay:s,leaveTypes:i,rules:l,requests:o}){var p;const c=hM(e,t),u=[],d=new Map,h=new Map;for(const m of r)d.set(m.id,0);for(const m of c){const x=`${m.y}-${cc(m.m)}-${cc(m.d)}`;for(const g of Array.isArray(n)?n:[]){const v=Array.isArray(g.shifts)?g.shifts:[];for(const w of v){const{code:y,need:k=0,role:C}=w||{};for(let E=0;E<Number(k||0);E++){const N=r.filter(D=>(!C||ua(D.role)===ua(C))&&(!g.role||ua(D.role)===ua(g.role))&&(!g.serviceId||ua(D.serviceId)===ua(g.serviceId))).filter(D=>_M({person:D,dateKey:x,shiftCode:y,lastAssignment:h,leavesByDay:s,leaveTypes:i,rules:l,workingHours:a,personHours:d}));if(N.length===0){u.push({date:x,serviceId:g.id,shiftCode:y,personId:null,note:"BO"});continue}N.sort((D,T)=>Tv({person:D,dateKey:x,shiftCode:y,requests:o,personHours:d})-Tv({person:T,dateKey:x,shiftCode:y,requests:o,personHours:d})).reverse();const F=N[0];u.push({date:x,serviceId:g.id,shiftCode:y,personId:F.id});const R=((p=a.shiftHours)==null?void 0:p[y])||0;d.set(F.id,(d.get(F.id)||0)+R),h.has(F.id)||h.set(F.id,new Map),h.get(F.id).set(x,!0),h.get(F.id).set("_lastShift",y),h.get(F.id).set("_lastDate",x)}}}}return{rows:u,personHours:Object.fromEntries(d.entries())}}function AM({year:e,month1_12:t,writeToLS:r=!0,keys:n={}}={}){if(!Number.isFinite(e)||!Number.isFinite(t))throw new Error("year/month zorunlu");const a={...dM,...n||{}},s=xM(a),i=gM(e,t,a),l=vM(a),o=yM(a),c=wM(a),u=SM(a),d=kM(a),h=EM({people:s,allLeaves:i,year:e,month1_12:t}),{rows:p,personHours:m}=NM({year:e,month1_12:t,people:s,workAreas:l,workingHours:o,leavesByDay:h,leaveTypes:c,rules:u,requests:d}),x={year:e,month:t,rows:p,meta:{personHours:m,createdAt:Date.now()}};return r&&fM(a.scheduleTarget,x),x}const uc={people:["peopleV2","people","personel","staff","nurses","nurseList"],areas:["workAreasV2","workAreas"],shifts:["workingHoursV2","workingHours"],leaves:["leavesV2","leaves"],groupedPeople:["peopleByRole","staffByRole"]};function bM(e,t=null){try{const r=localStorage.getItem(e);return r?JSON.parse(r):t}catch{return t}}function fc(e,t=[]){for(const r of e){const n=bM(r,null);if(Array.isArray(n)&&n.length||n&&typeof n=="object"&&Object.keys(n).length)return n}return t}const Vf=e=>(e??"").toString().trim().toLocaleUpperCase("tr-TR"),O0=(e="")=>{const t=String(e).trim().toLocaleLowerCase("tr-TR");return["hemireler","hemsireler","doktorlar","doctors","personel","ekip"].includes(t)};function TM(e,t){const r=Vf(e||"");return/DOKTOR|DOCTOR|PHYS/.test(r)?"Doctor":/HEM|HEMS|NURS/.test(r)?"Nurse":t||(r?e:null)}function Sx(e,t=null,r=0){if(!e||e.cards||e.items||e.lists||e.columns||e.sections)return null;const n=e.fullName||e.name||e.displayName||e.personName||e.title||e.code;return!n||O0(n)?null:{id:e.id??e.personId??e.tc??e.tcNo??e.email??e.code??`P_${Date.now()}_${r}`,fullName:n,name:n,role:TM(e.role||e.departmentRole||e.title,t)||t,unit:e.unit||e.area||e.service||e.department||null,skills:e.skills||e.tags||[],meta:e}}function a_(e){const t=[],r=new Set;for(const n of e){const a=n.id!=null?`ID:${String(n.id).toLowerCase()}`:`NM:${Vf(n.fullName)}`;r.has(a)||(r.add(a),t.push(n))}return t}function CM(){const e=fc(uc.areas,[]),t=[];return(Array.isArray(e)?e:[]).forEach(r=>{var a;const n=(a=typeof r=="string"?r:(r==null?void 0:r.name)||(r==null?void 0:r.title)||(r==null?void 0:r.label))==null?void 0:a.toString().trim();n&&t.push({name:n,required:Number((r==null?void 0:r.required)??(r==null?void 0:r.minStaff)??(r==null?void 0:r.defaultCount)??1)||1,defaultShift:(r==null?void 0:r.defaultShift)||(r==null?void 0:r.shiftCode)||null})}),t}function FM(){const e=fc(uc.shifts,[]),t=new Set,r=[];return(Array.isArray(e)?e:[]).forEach((n,a)=>{const s=((n==null?void 0:n.code)||(n==null?void 0:n.name)||`S${a}`).toString().trim();!s||t.has(s)||(t.add(s),r.push({id:(n==null?void 0:n.id)??s,code:s,start:(n==null?void 0:n.start)??(n==null?void 0:n.from)??(n==null?void 0:n.begin)??(n==null?void 0:n.startTime)??"",end:(n==null?void 0:n.end)??(n==null?void 0:n.to)??(n==null?void 0:n.finish)??(n==null?void 0:n.endTime)??""}))}),r}function RM(){const e=fc(uc.people,[]),t=Array.isArray(e)?e:[],r=fc(uc.groupedPeople,{}),n=[];if(r&&typeof r=="object"){const a=[].concat(r.Nurse||[],r.DOCTOR||[],r.Doctor||[],r.All||[]);a.length&&n.push(...a)}return[...t,...n]}function*Ps(e,t){if(e){if(Array.isArray(e)){for(const r of e)yield*Ps(r,t);return}if(typeof e=="object"){if(Array.isArray(e.items))for(const r of e.items)yield*Ps(r,t);if(Array.isArray(e.cards))for(const r of e.cards)yield*Ps(r,t);if(Array.isArray(e.lists))for(const r of e.lists)yield*Ps(r,t);if(Array.isArray(e.columns))for(const r of e.columns){const n=/hem|nurs/i.test(r==null?void 0:r.title)?"Nurse":t;if(Array.isArray(r.cards))for(const a of r.cards)yield a;if(Array.isArray(r.items))for(const a of r.items)yield a;yield*Ps(r,n)}if(Array.isArray(e.sections))for(const r of e.sections)yield*Ps(r,t);if(e.id&&e.name&&Array.isArray(e.items))for(const r of e.items)yield r;!e.items&&!e.cards&&!e.lists&&!e.columns&&!e.sections&&(yield e)}}}function IM(){const e=Object.keys(localStorage),t=[];for(const r of e){if(!/people|person|nurs|hems|staff|flow|board|column|list|section/i.test(r))continue;let n;try{n=JSON.parse(localStorage.getItem(r))}catch{continue}if(n)for(const a of Ps(n)){const s=Sx(a,void 0);s&&t.push(s)}}return t}function DM(){return fc(uc.leaves,[])}function s_(){const e=DM(),t=[];return(Array.isArray(e)?e:[]).forEach((r,n)=>{const a=Sx({id:(r==null?void 0:r.personId)??(r==null?void 0:r.id)??(r==null?void 0:r.pid),fullName:(r==null?void 0:r.personName)||(r==null?void 0:r.name)||(r==null?void 0:r.employeeName),role:r==null?void 0:r.role},void 0,n);a&&t.push(a)}),t}function Lc(e){const t=[...RM(),...IM(),...s_()].map((a,s)=>Sx(a,void 0,s)).filter(Boolean).filter(a=>!O0(a.fullName)),r=a_(t);if(!e)return r;const n=Vf(e);return r.filter(a=>a.role?Vf(a.role)===n:n==="NURSE")}function OM(e="Nurse"){const t=s_().map(r=>r.role?r:{...r,role:e});return a_(t)}const Cv="supervisorConfig",Fv="supervisorPool";function i_(e,t){return new Date(e,t+1,0).getDate()}const LM=e=>(e||"").toString().trim().toLocaleUpperCase("tr-TR");function PM({open:e,onClose:t,role:r="Nurse",year:n=new Date().getFullYear(),month0:a=new Date().getMonth()}){const s=_.useMemo(()=>(Lc(r)||[]).map(D=>({id:String(D.id??D.pid??D.tc??D.code??D.fullName),name:D.fullName||D.name||D.displayName||String(D.id)})),[r]);_.useMemo(()=>new Map(s.map(D=>[LM(D.name),D.id])),[s]);const[i,l]=_.useState(""),[o,c]=_.useState([]),[u,d]=_.useState([]),[h,p]=_.useState(!0),[m,x]=_.useState(1),[g,v]=_.useState(new Set),[w,y]=_.useState(new Set),[k,C]=_.useState("");_.useEffect(()=>{try{const D=Fe.get(Cv,null)||{},T=Fe.get(Fv,[]);D.primary&&l(String(D.primary)),Array.isArray(D.assistants)&&c(D.assistants.map(String)),Array.isArray(D.fallbackPool)?d(D.fallbackPool.map(String)):Array.isArray(T)&&d(T.map(String)),p(D.weekdayOnly!==!1),x(Number(D.ensureAssistCount??1)||1);const j=Z=>Z?Array.isArray(Z)?new Set(Z.map(Number)):typeof Z=="object"?new Set(Object.keys(Z).map(Number)):new Set:new Set;v(j(D.assistDays)),y(j(D.offDays))}catch{}},[e]);const E=_.useMemo(()=>{const D=k.trim().toLocaleLowerCase("tr-TR");return D?s.filter(T=>T.name.toLocaleLowerCase("tr-TR").includes(D)):s},[s,k]),S=(D,T)=>{const j=new Set(D);return j.has(T)?j.delete(T):j.add(T),j},N=()=>{const D={primary:i||null,assistants:o||[],fallbackPool:u||[],weekdayOnly:h,ensureAssistCount:Math.max(0,Number(m)||0),assistDays:Array.from(g),offDays:Array.from(w)};Fe.set(Cv,D),Fe.set(Fv,D.fallbackPool||[]);try{window.dispatchEvent(new Event("supervisor:changed"))}catch{}t==null||t()};i_(n,a);const F=D=>{c(T=>T.includes(D)?T.filter(j=>j!==D):[...T,D])},R=D=>{d(T=>T.includes(D)?T.filter(j=>j!==D):[...T,D])};return f.jsxs("div",{className:`fixed inset-0 z-50 ${e?"":"pointer-events-none"}`,children:[f.jsx("div",{className:`absolute inset-0 bg-black/40 transition-opacity ${e?"opacity-100":"opacity-0"}`,onClick:t}),f.jsxs("div",{className:`absolute left-1/2 top-10 -translate-x-1/2 w-[900px] max-w-[95vw] rounded-xl border bg-white shadow-xl transition-all ${e?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:[f.jsxs("div",{className:"p-4 border-b flex items-center gap-3",children:[f.jsx("div",{className:"font-semibold",children:"Sorumlu Ayarlar"}),f.jsxs("span",{className:"text-xs text-slate-500",children:["(",r==="Doctor"?"Doktor":"Hemire",")"]}),f.jsx("button",{className:"ml-auto h-8 w-8 rounded hover:bg-slate-100 flex items-center justify-center",onClick:t,children:f.jsx(hC,{className:"w-4 h-4"})})]}),f.jsxs("div",{className:"p-4 grid grid-cols-12 gap-4",children:[f.jsxs("div",{className:"col-span-5",children:[f.jsx("div",{className:"mb-2 text-sm",children:"Personel"}),f.jsx("input",{value:k,onChange:D=>C(D.target.value),placeholder:"Ara...",className:"w-full h-9 rounded border px-2 mb-2"}),f.jsx("div",{className:"border rounded-lg h-[420px] overflow-auto",children:E.map(D=>f.jsxs("div",{className:"px-3 py-2 flex items-center gap-2 border-b last:border-b-0",children:[f.jsx("input",{type:"radio",name:"primary",checked:i===D.id,onChange:()=>l(D.id),title:"Asl Sorumlu"}),f.jsx("div",{className:"flex-1",children:D.name}),f.jsxs("label",{className:"text-xs inline-flex items-center gap-1",children:[f.jsx("input",{type:"checkbox",checked:o.includes(D.id),onChange:()=>F(D.id)}),"Yardmc"]}),f.jsxs("label",{className:"text-xs inline-flex items-center gap-1 ml-2",children:[f.jsx("input",{type:"checkbox",checked:u.includes(D.id),onChange:()=>R(D.id)}),"Havuz"]})]},D.id))}),f.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"pucu: Bir kiiyi hem Yardmc hem Havuz olarak iaretleyebilirsin."})]}),f.jsxs("div",{className:"col-span-7 space-y-4",children:[f.jsxs("div",{className:"rounded-lg border p-3",children:[f.jsx("div",{className:"font-medium mb-2",children:"Genel"}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("label",{className:"inline-flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:h,onChange:D=>p(D.target.checked)}),"Sadece hafta ii"]}),f.jsxs("div",{className:"flex items-center gap-2",children:["Yardmc kii says (assistDaysde min):",f.jsx("input",{type:"number",min:0,className:"h-8 w-16 rounded border px-2 text-center",value:m,onChange:D=>x(Number(D.target.value||0))})]})]})]}),f.jsxs("div",{className:"rounded-lg border p-3",children:[f.jsxs("div",{className:"font-medium mb-2",children:["Gn Ayarlar (",n,"-",String(a+1).padStart(2,"0"),")"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm mb-1",children:"Yardmc stenen Gnler"}),f.jsx(Rv,{year:n,month0:a,selected:g,onToggle:D=>v(T=>S(T,D))})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-sm mb-1",children:"Primary Yazlmasn (Off Days)"}),f.jsx(Rv,{year:n,month0:a,selected:w,onToggle:D=>y(T=>S(T,D))})]})]}),f.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Not: Assist gnlerinde, satrdaki ihtiya primary + belirtilen yardmc says kadar ykseltilir."})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx("button",{className:"h-9 px-3 rounded border",onClick:t,children:"Vazge"}),f.jsxs("button",{className:"h-9 px-3 rounded bg-sky-600 text-white inline-flex items-center gap-2",onClick:N,children:[f.jsx(bS,{className:"w-4 h-4"})," Kaydet"]})]})]})]})]})]})}function Rv({year:e,month0:t,selected:r,onToggle:n}){const a=i_(e,t);return f.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:a},(s,i)=>i+1).map(s=>{const i=r.has(s);return f.jsx("button",{className:`h-8 rounded border text-sm ${i?"bg-sky-600 text-white border-sky-600":"bg-white hover:bg-slate-50"}`,onClick:()=>n==null?void 0:n(s),children:s},s)})})}function jM(e,t="id"){const[r,n]=_.useState(()=>{try{const c=localStorage.getItem(e);return c?JSON.parse(c):[]}catch{return[]}});_.useEffect(()=>{try{const c=localStorage.getItem(e);n(c?JSON.parse(c):[])}catch{n([])}},[e]);const a=_.useRef(!0);_.useEffect(()=>{if(a.current){a.current=!1;return}try{localStorage.setItem(e,JSON.stringify(r))}catch{}},[r,e]);const s=_.useCallback(c=>{var h;const d=Object.prototype.hasOwnProperty.call(c??{},t)?c[t]:((h=crypto==null?void 0:crypto.randomUUID)==null?void 0:h.call(crypto))??Date.now();return n(p=>[...p,{...c,[t]:d}]),d},[t]),i=_.useCallback((c,u)=>{n(d=>d.map(h=>h[t]===c?{...h,...u}:h))},[t]),l=_.useCallback(c=>{n(u=>u.filter(d=>d[t]!==c))},[t]),o=_.useCallback(c=>{n(Array.isArray(c)?c:[])},[]);return{items:r,create:s,update:i,remove:l,replaceAll:o}}function Iv(e){return(e??"").toString().trim().toLocaleUpperCase("tr-TR").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")}async function MM(e,t={}){const{year:r,month0:n}=t,a=await e.arrayBuffer(),s=fn(a,{type:"array"}),i=s.Sheets[s.SheetNames[0]];if(!i)throw new Error("Excel sayfas bulunamad.");const l=Ve.sheet_to_json(i,{header:1,blankrows:!1});if(!(l!=null&&l.length)||l.length<2)throw new Error("Tablo bo grnyor.");const o=l[0].map(w=>(w??"").toString().trim()),c=o.map(Iv),u=w=>{const y=w.map(Iv);return c.findIndex(k=>y.some(C=>k.includes(C)))},d=u(["PERSONID","PERSON ID","PERSONEL ID","KISI ID","ID"]),h=u(["FULLNAME","AD SOYAD","ADI SOYADI","PERSONEL","ISIM","ADI"]),p=u(["SERVICE","SERVIS","SERVIS ADI","GOREV","CALISMA ALANI","ALAN"]),m=u(["SHIFTCODE","VARDIYA","VARDIYA KOD","VARDIYA KODU"]),x=u(["DATE","TARIH"]),g=u(["GUN","GUN NO","GUNNUMARASI","DAY"]);if(p<0||m<0||x<0&&g<0)throw new Error(`Excel dorulamas baarsz: Gerekli balklar bulunamad.
Gerekli: SERVS/GREV, VARDYA ve TARH (veya GN).
Bulunan balklar: ${o.join(", ")}`);const v=[];for(let w=1;w<l.length;w++){const y=l[w]||[],k=y[p],C=y[m],E=x>=0?y[x]:y[g];if((k==null||k==="")&&(C==null||C==="")&&(E==null||E===""))continue;const S=(k??"").toString().trim(),N=(C??"").toString().trim().split(/\s+/)[0];let F=E;if(x<0&&g>=0&&Number.isInteger(Number(E))&&Number.isInteger(r)&&Number.isInteger(n)){const T=Number(E);T>=1&&T<=31&&(F=new Date(r,n,T).toISOString().slice(0,10))}const R=d>=0?y[d]:void 0,D=h>=0?y[h]:void 0;v.push({service:S,shiftCode:N,date:F,personId:R,fullName:D})}if(!v.length)throw new Error("Geerli satr bulunamad.");return v}const BM="https://hastane15.onrender.com/api/auth",Dv=BM,UM=e=>{if(!Dv||/^https?:\/\//i.test(e))return e;const t=Dv.replace(/\/+$/,""),r=e.startsWith("/")?e:`/${e}`;return`${t}${r}`};async function Rl(e,{method:t="GET",body:r,token:n,headers:a}={}){const s={...a||{}},i=n||_p();i&&!s.Authorization&&(s.Authorization=`Bearer ${i}`),r!=null&&!s["Content-Type"]&&(s["Content-Type"]="application/json");const l=await fetch(UM(e),{method:t,credentials:"include",headers:s,body:r==null?void 0:typeof r=="string"?r:JSON.stringify(r)}),o=await l.text();let c=null;if(o)try{c=JSON.parse(o)}catch{c=o}if(!l.ok){const u=new Error(c&&(c.message||c.error)||`HTTP ${l.status}`);throw u.status=l.status,u.body=c,u}return c}async function zM({unitId:e,active:t=!0,search:r="",page:n=1,size:a=500,token:s}={}){try{const i=new URLSearchParams;e&&String(e).trim()!==""&&i.append("unitId",String(e)),i.append("active",String(t)),r&&i.append("q",r),i.append("page",String(n)),i.append("size",String(a));const l=await Rl(`/api/personnel?${i.toString()}`,{token:s});return(Array.isArray(l==null?void 0:l.items)?l.items:Array.isArray(l)?l:[]).map(c=>({id:c.id,fullName:c.fullName??`${c.first_name??""} ${c.last_name??""}`.trim(),title:c.title??c.title_name??"",service:c.service??c.department??""}))}catch(i){return(i==null?void 0:i.status)!==404&&console.error("fetchPersonnel err:",i),[]}}async function HM({personId:e,year:t,month:r,token:n}={}){try{const a=new URLSearchParams({personId:e,y:String(t),m:String(r)}),s=await Rl(`/api/schedule/monthly?${a.toString()}`,{token:n});return(Array.isArray(s==null?void 0:s.items)?s.items:Array.isArray(s)?s:[]).map(l=>({date:l.date,hours:Number(l.hours||0)}))}catch(a){return(a==null?void 0:a.status)!==404&&console.error("fetchMonthlySchedule err:",a),[]}}async function $M({year:e,month:t,token:r}={}){try{const n=new URLSearchParams({y:String(e),m:String(t)}),a=await Rl(`/api/holidays?${n.toString()}`,{token:r});return(Array.isArray(a==null?void 0:a.items)?a.items:Array.isArray(a)?a:[]).map(i=>({date:i.date,kind:i.kind==="arife"?"arife":"full",name:i.name}))}catch(n){return(n==null?void 0:n.status)!==404&&console.error("fetchHolidayCalendar err:",n),[]}}async function Ov({personId:e,year:t,month:r,token:n}={}){try{const a=new URLSearchParams({personId:e,y:String(t),m:String(r)}),s=await Rl(`/api/leaves?${a.toString()}`,{token:n});return(Array.isArray(s==null?void 0:s.items)?s.items:Array.isArray(s)?s:[]).map(l=>({start:l.start,end:l.end??l.start,type:l.type??"annual",partial:(l.partial??"none").toLowerCase(),hours:l.hours!=null?Number(l.hours):null}))}catch(a){return(a==null?void 0:a.status)!==404&&console.error("fetchLeaves err:",a),[]}}async function kx({sectionId:e,serviceId:t="",role:r="",year:n,month:a}={}){if(!e)throw new Error("sectionId gerekli");const s=new URLSearchParams({sectionId:e,year:String(n),month:String(a)});t!=null&&s.append("serviceId",String(t)),r!=null&&s.append("role",String(r));const i=await Rl(`/api/schedules/monthly?${s.toString()}`);return(i==null?void 0:i.schedule)||null}async function VM({sectionId:e,serviceId:t="",role:r="",year:n,month:a,data:s,meta:i}={}){if(!e)throw new Error("sectionId gerekli");const o=await Rl("/api/schedules/monthly",{method:"PUT",body:{sectionId:e,serviceId:t,role:r,year:n,month:a,data:s??{},meta:i??{}}});return(o==null?void 0:o.schedule)||null}let Wf=null;try{const{toast:e}=require("./Toaster");Wf=e}catch{Wf=null}const WM=["Paz","Pzt","Sal","ar","Per","Cum","Cmt"],GM=["Pzt","Sal","ar","Per","Cum","Cmt","Paz"],es=e=>(e||"").toString().trim().toLocaleUpperCase("tr-TR"),YM=e=>(e||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(//g,"G").replace(//g,"U").replace(//g,"S").replace(//g,"I").replace(//g,"O").replace(//g,"C").replace(//g,"g").replace(//g,"u").replace(//g,"s").replace(//g,"i").replace(//g,"o").replace(//g,"c"),Hs=e=>YM(es(e)).replace(/\s+/g," ").trim(),uo=e=>(e+6)%7;function Ud(e,{preferOneBased:t}={preferOneBased:!0}){const r=Number(e);if(!Number.isFinite(r))return new Date().getMonth();const n=Math.trunc(r);if(t){if(n>=1&&n<=12)return n-1;if(n>=0&&n<=11)return n}else{if(n>=0&&n<=11)return n;if(n>=1&&n<=12)return n-1}return(n%12+12)%12}const zd=e=>e===5||e===6,Cn=e=>!!e&&/^(hemire(ler)?|hemsire(ler)?|doktor(lar)?|personel|nurses?|doctors?)$/i.test(String(e).trim()),Lv=e=>{if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:t.toLocaleString("tr-TR")};function KM(e,t){const r=new Date(e,t+1,0).getDate(),n=new Date(e,t,1).getDay(),a=uo(n),s=Math.ceil((a+r)/7),i=Array.from({length:s},()=>Array(7).fill(null));let l=1;for(let o=0;o<s;o++)for(let c=0;c<7;c++)o*7+c>=a&&l<=r&&(i[o][c]=l++);return{weeks:s,matrix:i,daysInMonth:r}}function XM(e,t,r){if(e==null||e==="")return null;if(typeof e=="number"&&Number.isFinite(e)){const l=new Date(1899,11,30),o=new Date(l.getTime()+e*864e5);if(!Number.isNaN(o.getTime())&&o.getFullYear()===t&&o.getMonth()===r)return o.getDate()}const n=String(e).trim(),a=new Date(n);if(!Number.isNaN(a.getTime())&&a.getFullYear()===t&&a.getMonth()===r)return a.getDate();const s=n.match(/^(\d{1,2})[.\-\/](\d{1,2})[.\-\/](\d{2,4})$/);if(s){const l=+s[1],o=+s[2]-1;let c=+s[3];if(c<100&&(c+=2e3),c===t&&o===r)return l}const i=n.match(/^(\d{4})[.\-\/](\d{1,2})[.\-\/](\d{1,2})$/);if(i){const l=+i[1],o=+i[2]-1,c=+i[3];if(l===t&&o===r)return c}return null}function JM(e,t){var r,n,a,s,i,l,o,c,u;try{const d=$a(),h=jS(d,e,t+1),p=Fe.get("allLeavesByNameV1",{}),m=OS(),x=`${e}-${String(t+1).padStart(2,"0")}`,g=Oi(),v={};for(const[w,y]of Object.entries(h||{})){const k=w.startsWith("__name__:"),C=k?Hs(w.slice(9)):g.has(w)?Hs(g.get(w)):null;for(const E of Object.keys(y||{})){const S=Number(E);if(!Number.isFinite(S)||S<1||!k&&((a=(n=(r=m.ids)==null?void 0:r[w])==null?void 0:n[x])!=null&&a[String(S)])||k&&C&&((l=(i=(s=m.canon)==null?void 0:s[C])==null?void 0:i[x])!=null&&l[String(S)]))continue;const N=v[S]??(v[S]={ids:new Set,canon:new Set});k||N.ids.add(String(w)),C&&N.canon.add(C)}}for(const[w,y]of Object.entries(p||{})){const k=y==null?void 0:y[x];if(k)for(const C of Object.keys(k||{})){const E=Number(C);if(!Number.isFinite(E)||E<1)continue;const S=Hs(w);if((u=(c=(o=m.canon)==null?void 0:o[S])==null?void 0:c[x])!=null&&u[String(E)])continue;(v[E]??(v[E]={ids:new Set,canon:new Set})).canon.add(S)}}return v}catch(d){return console.warn("buildUnavailableByDay error:",d),{}}}function qM(e,t){var r,n;return(e==null?void 0:e.defaultShift)||((r=(t||[]).find(a=>a.code==="M"))==null?void 0:r.code)||((n=(t||[])[0])==null?void 0:n.code)||"M"}function Pv(e,t){const r=(e==null?void 0:e.fullName)||(e==null?void 0:e.name)||(e==null?void 0:e["AD SOYAD"]);if(!r||Cn(r))return null;const n=(e==null?void 0:e.id)??(e==null?void 0:e.pid)??(e==null?void 0:e.tc)??(e==null?void 0:e.tcNo)??(e==null?void 0:e.code)??r,a=(e==null?void 0:e.areas)||(e==null?void 0:e.workAreas)||(e==null?void 0:e["ALIMA ALANLARI"])||"",s=typeof a=="string"?a.split(/[;,/-]/).map(i=>i.trim()).filter(Boolean):Array.isArray(a)?a:[];return{id:String(n),name:String(r),role:t==="Doctor"?"Doctor":"Nurse",areas:s,weekendOff:!!(e!=null&&e.weekendOff),nightAllowed:!((e==null?void 0:e.nightAllowed)===!1||(e==null?void 0:e.geceYasak)===!0),dailyMax:1,monthlyMax:31,maxConsecutive:5,weight:1}}function jv(e){let r=((e==="Doctor"?Fe.get("doctors",[]):Fe.get("nurses",[]))||[]).map(n=>Pv(n,e)).filter(Boolean);return r.length||(r=(Lc()||[]).map(a=>Pv(a,e)).filter(Boolean)),r.length||(r=(Fe.get(vl,[])||[]).filter(a=>(a==null?void 0:a.name)&&!Cn(a.name)),r.length||(r=OM(e))),r=(r||[]).filter(n=>(n==null?void 0:n.name)&&!Cn(n.name)),Fe.set(vl,r),r}function Oi(){const e=new Map,t=Fe.get("nurses",[])||[],r=Fe.get("doctors",[])||[];for(const s of[...t,...r]){const i=(s==null?void 0:s.id)??(s==null?void 0:s.pid)??(s==null?void 0:s.tc)??(s==null?void 0:s.tcNo)??(s==null?void 0:s.code)??((s==null?void 0:s["AD SOYAD"])||(s==null?void 0:s.fullName)||(s==null?void 0:s.name)),l=(s==null?void 0:s.fullName)||(s==null?void 0:s.name)||(s==null?void 0:s["AD SOYAD"]);!i||!l||Cn(l)||e.set(String(i),String(l))}const n=Lc()||[];for(const s of n){const i=s==null?void 0:s.id,l=(s==null?void 0:s.fullName)||(s==null?void 0:s.name)||(s==null?void 0:s.displayName)||(s==null?void 0:s.code);!i||!l||Cn(l)||e.has(i)||e.set(i,l)}const a=Fe.get(vl,[])||[];for(const s of a){const i=s==null?void 0:s.id,l=(s==null?void 0:s.name)||(s==null?void 0:s.fullName)||(s==null?void 0:s.displayName);!i||!l||Cn(l)||e.has(i)||e.set(String(i),String(l))}return e}const ZM=_.forwardRef(function({year:t,month:r,setYear:n,setMonth:a,sectionId:s="calisma-cizelgesi",serviceId:i=""},l){var Ee,Re;const o=new Date,[c,u]=_.useState(parseInt(localStorage.getItem("plannerYear")||String(o.getFullYear()),10)),[d,h]=_.useState(parseInt(localStorage.getItem("plannerMonth")??String(o.getMonth()),10)),p=Number.isInteger(t)&&Number.isInteger(r),m=p?Number(t):c,x=p?Ud(r,{preferOneBased:!0}):Ud(d,{preferOneBased:!1}),g=typeof n=="function"?n:u,v=typeof a=="function"?G=>a(Number(G)):G=>h(Ud(G,{preferOneBased:!1}));_.useEffect(()=>{try{localStorage.setItem("plannerYear",String(m)),localStorage.setItem("plannerMonth",String(x)),localStorage.setItem("plannerMonth1",String(x+1))}catch(G){console.warn("plannerMonth write failed:",G)}},[m,x]);const{weeks:w,matrix:y,daysInMonth:k}=KM(m,x),C=x+1,E=Fe.get("activeRole","Nurse"),S=E==="Doctor"?"Doktorlar":"Hemireler",N=CM(),F=FM(),R=_.useMemo(()=>(N||[]).map(G=>G.name).filter(Boolean),[N]),D=F||[],j=`dutyRowDefs_${E}`,{items:Z,create:re,update:W,remove:Q,replaceAll:H}=jM(j,"id"),L="dutyMonthOverrides",ee=`${m}-${String(x+1).padStart(2,"0")}`,[te,b]=_.useState(()=>{var ae;const G=Fe.get(L,{});return((ae=G==null?void 0:G[E])==null?void 0:ae[ee])||{}});_.useEffect(()=>{const G=Fe.get(L,{}),ae=G[E]||{};ae[ee]=te,G[E]=ae,Fe.set(L,G)},[te,E,ee]),_.useEffect(()=>{var ae;const G=Fe.get(L,{});b(((ae=G==null?void 0:G[E])==null?void 0:ae[ee])||{})},[E,ee]);const A=Z,[O,P]=_.useState(!1),[U,q]=_.useState(!1),[J,B]=_.useState(null),ne=i==null?"":String(i),fe=_.useRef(null),M=_.useRef(null),[ue,ye]=_.useState("idle"),[Te,ve]=_.useState(null),pe=_.useCallback(G=>Object.fromEntries(Object.entries(G||{}).map(([ae,he])=>[ae,Object.fromEntries(Object.entries(he||{}).sort((xe,Ce)=>Number(xe[0])-Number(Ce[0])))]).sort((ae,he)=>String(ae[0]).localeCompare(String(he[0])))),[]),Me=_.useCallback((G,ae,he,xe,Ce)=>JSON.stringify({defs:G||[],overrides:pe(ae),roster:he||null,preview:xe||null,aiPlan:Ce||null}),[pe]),[Ke,Be]=_.useState(null),[Pe,Ze]=_.useState(null),[Nt,tr]=_.useState(()=>{const G=Fe.get("scheduleRowsV2");return G&&G.year===m&&G.month===x+1?G:null}),mn=_.useCallback(()=>Me(A,te,Pe,Ke,Nt),[A,te,Pe,Ke,Nt,Me]),[Qn,Xa]=_.useState(null),[ur,Qr]=_.useState(!1),Oe=_.useCallback((G,ae="info")=>{typeof Wf=="function"?Wf({title:ae==="error"?"Hata":ae==="success"?"Baarl":"Bilgi",desc:G,type:ae}):alert(G)},[]),At=(G,ae,he)=>{b(xe=>{const Ce=he===""?null:Math.max(0,Number(he||0)),Ie={...xe[G]||{}};return Ce==null?delete Ie[ae]:Ie[ae]=Ce,{...xe,[G]:Ie}})},rr=_.useCallback((G,ae)=>{const he=A.find(Ce=>Ce.id===G);if(!he)return;const xe=Math.max(0,Number(ae||0));b(Ce=>{const Ie={...Ce[G]||{}};for(let we=1;we<=k;we++){const je=new Date(m,x,we).getDay(),rt=je===0||je===6;Ie[we]=he.weekendOff&&rt?0:xe}return{...Ce,[G]:Ie}})},[A,k,m,x]),[ht,pn]=_.useState({label:"",shiftCode:"",defaultCount:0}),jc=()=>{if(!ht.label)return Oe("Grev (alma Alan) sein.","info");if(!ht.shiftCode)return Oe("Vardiya sein.","info");const G=Math.max(0,Number(ht.defaultCount||0)),ae=Date.now(),he={id:ae,label:ht.label,shiftCode:ht.shiftCode,defaultCount:G,pattern:[G,G,G,G,G,G,G],weekendOff:!1};re(he),rr(ae,G),pn({label:"",shiftCode:"",defaultCount:0})},Mc=(G,ae)=>{const he=Z.findIndex(we=>we.id===G);if(he<0)return;const xe=ae==="up"?he-1:he+1;if(xe<0||xe>=Z.length)return;const Ce=[...Z],[Ie]=Ce.splice(he,1);Ce.splice(xe,0,Ie),H(Ce)},P0=G=>{Q(G),b(ae=>{const{[G]:he,...xe}=ae;return xe})},Bc=G=>{const ae=Z.findIndex(we=>we.id===G);if(ae<0)return;const he=Z[ae],xe=Date.now(),Ce={...he,id:xe,label:`${he.label} (kopya)`},Ie=[...Z];Ie.splice(ae+1,0,Ce),H(Ie),b(we=>({...we,[xe]:{...we[he.id]||{}}}))},Uc=(G,ae,he)=>{const xe=Z.find(Ie=>Ie.id===G);if(!xe)return;const Ce=Array.isArray(xe.pattern)&&xe.pattern.length===7?[...xe.pattern]:Array(7).fill(xe.defaultCount||0);Ce[ae]=Math.max(0,Number(he||0)),W(G,{pattern:Ce})},[Il,j0]=_.useState(0),[Dl,Ei]=_.useState("all"),M0=G=>{const ae=Math.max(0,Number(Il||0));b(he=>{const xe=A.find(Ie=>Ie.id===G),Ce={...he[G]||{}};if(Dl==="all")for(let Ie=1;Ie<=k;Ie++){const we=new Date(m,x,Ie).getDay(),je=we===0||we===6;Ce[Ie]=xe!=null&&xe.weekendOff&&je?0:ae}else{const Ie=Number(Dl);for(let we=0;we<y.length;we++){const je=y[we][Ie];if(!je)continue;const rt=new Date(m,x,je).getDay(),ot=rt===0||rt===6;Ce[je]=xe!=null&&xe.weekendOff&&ot?0:ae}}return{...he,[G]:Ce}})},Ol=()=>{const G=["Grev","Vardiya","Grevli Kii (varsaylan)"];for(let ae=1;ae<=k;ae++){const he=new Date(m,x,ae).getDay();G.push(`${String(ae).padStart(2,"0")} (${WM[he]})`)}return G},B0=()=>{var xn;const G=Ol(),ae=[G],he={};for(const it of A){const bt=te[it.id]||{},Vt=[it.label,it.shiftCode,it.defaultCount||0];he[it.id]={};for(let gn=1;gn<=k;gn++){const vr=new Date(m,x,gn).getDay(),ea=uo(vr),Wt=Array.isArray(it.pattern)?it.pattern:Array(7).fill(it.defaultCount||0);let nr=bt[gn];nr==null&&(nr=Wt[ea]??(it.defaultCount||0)),it.weekendOff&&(vr===0||vr===6)&&(nr=0),nr=Math.max(0,Number(nr)||0),he[it.id][gn]=nr,Vt.push(nr)}ae.push(Vt)}if(b(he),Be({header:G,rows:ae.slice(1)}),!(jv(E)||[]).filter(it=>!it.role||it.role===E).length){Ze(null);return}const Ie=JM(m,x);Object.fromEntries(Object.entries(Ie).map(([it,bt])=>[Number(it),Array.from((bt==null?void 0:bt.ids)||[])]));const we=cM({year:m,month0:x,role:E,rows:A,overrides:he}),je=new Map((A||[]).map(it=>[String(it.id),it])),rt=Oi(),ot=new Map;for(const[it,bt]of rt.entries()){const Vt=Hs(bt);Vt&&(ot.has(Vt)||ot.set(Vt,[]),ot.get(Vt).push(String(it)))}const Et=[],gr=`${m}-${String(x+1).padStart(2,"0")}`;if(we!=null&&we.namedAssignments)for(const[it,bt]of Object.entries(we.namedAssignments)){const Vt=Number(it);if(!Number.isFinite(Vt)||Vt<1)continue;const gn=`${m}-${String(x+1).padStart(2,"0")}-${String(Vt).padStart(2,"0")}`;for(const[vr,ea]of Object.entries(bt||{})){const Wt=je.get(String(vr)),nr=(Wt==null?void 0:Wt.label)||String(vr),Pl=(Wt==null?void 0:Wt.shiftCode)||"";for(const _a of ea||[]){if(!_a||Cn(_a))continue;const Ja=Hs(_a),jl=Ja?ot.get(Ja):null;Et.push({date:gn,day:Vt,monthKey:gr,role:E,rowId:vr,roleLabel:nr,shiftCode:Pl,personName:_a,personId:(jl==null?void 0:jl[0])||null,source:"rosterPreview"})}}}if(we&&we.assignments){const it=we.issues?[...we.issues]:[],bt=we.namedAssignments||{},Vt=Oi(),gn=new Map;for(const[vr,ea]of Vt.entries())gn.set(String(vr),Hs(ea));for(const[vr,ea]of Object.entries(we.assignments)){const Wt=Number(vr),nr=Ie==null?void 0:Ie[Wt];if(!nr)continue;const Pl=nr.ids||new Set,_a=nr.canon||new Set;for(const[Ja,jl]of Object.entries(ea)){const _x=[],G0=[];for(const Ml of jl||[]){const $c=String(Ml),Vc=gn.get($c);Pl.has($c)||Vc&&_a.has(Vc)?G0.push(Ml):_x.push(Ml)}if(G0.length){we.assignments[Wt][Ja]=_x,bt[Wt]||(bt[Wt]={});const Ml=bt[Wt][Ja]||[],$c=G0.map(Na=>Vt.get(String(Na))).filter(Na=>Na&&!Cn(Na));bt[Wt][Ja]=Ml.filter(Na=>{const k_=Hs(Na);return!$c.includes(Na)&&!_a.has(k_)});const Vc=((xn=A.find(Na=>Na.id==Ja))==null?void 0:xn.label)||Ja;it.push({day:Wt,label:Vc,reason:"zin akmas"})}}}we.namedAssignments=bt,we.issues=it}Ze(we);const Je="generatedRoster",Qe=Fe.get(Je,{}),It=Qe[E]||{};It[`${m}-${String(x+1).padStart(2,"0")}`]=we,Qe[E]=It,Fe.set(Je,Qe);const Dt="generatedRosterFlat",Dr=Fe.get(Dt,{}),Ea=Dr[E]||{};Ea[gr]=Et,Dr[E]=Ea,Fe.set(Dt,Dr);try{window.dispatchEvent(new Event("planner:assignments"))}catch{}},U0=()=>{var G,ae;try{if(!A.length)return Oe("Da aktarmak iin nce en az bir satr ekleyin.","info");const xe=[Ol()];for(const Je of A){const Qe=(D||[]).find(xn=>es(xn.code)===es(Je.shiftCode)),It=Qe?`${Qe.code} ${Qe.start}${Qe.end}`:Je.shiftCode||"",Dt=Array.isArray(Je.pattern)?Je.pattern:Array(7).fill(Je.defaultCount||0),Dr=te[Je.id]||{},Ea=[Je.label,It,Je.defaultCount||0];for(let xn=1;xn<=k;xn++){const it=new Date(m,x,xn).getDay();let bt=Dr[xn];if(bt==null){const Vt=uo(it);bt=Dt[Vt]??0}Je.weekendOff&&(it===0||it===6)&&(bt=0),Ea.push(Math.max(0,Number(bt)||0))}xe.push(Ea)}const Ce=Pe,Ie=[["Grev","Vardiya",...Array.from({length:k},(Je,Qe)=>String(Qe+1))]];if(Ce&&Ce.namedAssignments)for(const Je of A){const Qe=[Je.label,Je.shiftCode];for(let It=1;It<=k;It++){const Dt=(((ae=(G=Ce.namedAssignments)==null?void 0:G[It])==null?void 0:ae[Je.id])||[]).filter(Dr=>!Cn(Dr));Qe.push(Dt.join(`
`))}Ie.push(Qe)}else Ie.push(["(Not)","Personel listesi bulunamad  Parametreler > Personel'den ekleyin."]);const we=[["Gn","Grev","Not"]];Ce&&Array.isArray(Ce.issues)&&Ce.issues.length?Ce.issues.forEach(Je=>we.push([Je.day,Je.label,Je.reason?`Yeterli aday bulunamad (${Je.reason})`:"Yeterli aday bulunamad"])):we.push(["-","-","Uyar yok"]);const je=Ve.book_new(),rt=Ve.aoa_to_sheet(xe),ot=Ve.aoa_to_sheet(Ie),Et=Ve.aoa_to_sheet(we);rt["!cols"]=[{wch:24},{wch:16},{wch:20},...Array.from({length:k},()=>({wch:6}))],ot["!cols"]=[{wch:24},{wch:12},...Array.from({length:k},()=>({wch:18}))],Et["!cols"]=[{wch:8},{wch:24},{wch:28}],Ve.book_append_sheet(je,rt,"Cizelge-Say"),Ve.book_append_sheet(je,ot,"Cizelge-Atama"),Ve.book_append_sheet(je,Et,"Uyarlar");const gr=`nobet_cizelgesi_${S.toLowerCase()}_${m}-${String(x+1).padStart(2,"0")}.xlsx`;jn(je,gr)}catch(he){console.error(he),Oe(`Excel'e aktarma srasnda hata: ${he.message||he}`,"error")}},zc=_.useRef(null),z0=()=>{var G;return(G=zc.current)==null?void 0:G.click()};function H0(G){if(!Array.isArray(G)||G.length===0){Oe("e aktarlan satr bulunamad.","info");return}const ae=new Map;(Z||[]).forEach(je=>ae.set(`${es(je.label)}|${es(je.shiftCode)}`,je));const he={...te||{}};let xe=0,Ce=0;const Ie=[];for(const je of G){const rt=String(je.service??"").trim(),ot=String(je.shiftCode??"").trim(),Et=XM(je.date,m,x);if(!rt||!ot||!Et){Ie.push(je);continue}const gr=`${es(rt)}|${es(ot)}`;let Je=ae.get(gr);if(!Je){const It=Date.now()+Math.floor(Math.random()*1e5),Dt=0,Dr={id:It,label:rt,shiftCode:ot,defaultCount:Dt,pattern:[Dt,Dt,Dt,Dt,Dt,Dt,Dt],weekendOff:!1};re(Dr),ae.set(gr,Dr),Je=Dr,xe++}he[Je.id]||(he[Je.id]={});const Qe=Number(he[Je.id][Et]||0);he[Je.id][Et]=Qe+1,Ce++}b(he);const we=[];Ce&&we.push(`${Ce} atama ilendi`),xe&&we.push(`${xe} yeni satr eklendi`),Ie.length&&we.push(`${Ie.length} satr atland (eksik servis/vardiya/tarih)`),Oe(we.join("  ")||"e aktarma tamamland.","success");try{localStorage.setItem("assignmentsBuffer",JSON.stringify(G)),window.dispatchEvent(new Event("planner:assignments"))}catch{}}const $0=async G=>{var he;const ae=(he=G.target.files)==null?void 0:he[0];if(ae)try{const xe=await MM(ae,{year:m,month0:x});H0(xe)}catch(xe){const Ce=xe&&xe.details?xe.details.join(`
`):(xe==null?void 0:xe.message)||"Bilinmeyen hata";Oe(Ce,"error"),console.error(xe)}finally{G.target.value=""}},Ll=async G=>{try{const ae=await G.arrayBuffer(),he=fn(ae,{type:"array"}),xe=he.Sheets[he.SheetNames[0]];if(!xe)throw new Error("alma sayfas bulunamad.");const Ce=Ve.sheet_to_json(xe,{header:1,blankrows:!1});if(!(Ce!=null&&Ce.length))throw new Error("Sayfa bo grnyor.");const Ie=Ce[0].map(Qe=>(Qe??"").toString().trim()),we=Ie.map(es),je=we.findIndex(Qe=>Qe.includes("GREV")||Qe.includes("GOREV")),rt=we.findIndex(Qe=>Qe.includes("VARDIYA")||Qe.includes("VARDYA")),ot=we.findIndex(Qe=>/G[O]REVL[I]|VARSAYILAN|K[I]S[I]|G[U]NL[U]K/.test(Qe));if(je<0||rt<0)throw new Error("Balklar bulunamad (Grev/Vardiya).");const Et=[];for(let Qe=0;Qe<Ie.length;Qe++){const It=String(Ie[Qe]??"").trim().match(/^(\d{1,2})/);if(!It)continue;const Dt=parseInt(It[1],10);Dt>=1&&Dt<=31&&Et.push({col:Qe,day:Dt})}if(!Et.length)throw new Error("Gn stunlar (1..31) bulunamad.");const gr=[],Je={};for(let Qe=1;Qe<Ce.length;Qe++){const It=Ce[Qe];if(!It||It.length===0)continue;const Dt=(It[je]??"").toString().trim(),Dr=(It[rt]??"").toString().trim(),Ea=ot>=0&&Number(It[ot]??0)||0;if(!Dt&&!Dr&&!Ea)continue;const xn=Date.now()+Qe,it=(Dr.split(/\s+/)[0]||Dr).trim(),bt={},Vt=[[],[],[],[],[],[],[]];for(const{col:vr,day:ea}of Et){const Wt=It[vr];if(Wt===""||Wt==null)continue;const nr=Number(Wt);if(!Number.isFinite(nr)||nr<0)continue;bt[ea]=nr;const Pl=new Date(m,x,ea).getDay(),_a=uo(Pl);Vt[_a].push(nr)}const gn=Vt.map(vr=>vr.length?vr[0]:Ea);gr.push({id:xn,label:Dt,shiftCode:it,defaultCount:Ea,pattern:gn,weekendOff:!1}),Je[xn]=bt}if(!gr.length)throw new Error("e aktarlacak satr bulunamad.");H(gr),b(Je),Be(null),Ze(null),Oe(`ablondan ${gr.length} satr ie aktarld.`,"success")}catch(ae){console.error(ae),Oe(`ablondan ykleme baarsz: ${ae.message||ae}`,"error")}},Hc=_.useRef(null);function V0(){try{const G={version:1,role:E,year:m,month0:x,ymKey:ee,overrides:te,exportedAt:new Date().toISOString()},ae=new Blob([JSON.stringify(G,null,2)],{type:"application/json"}),he=`overrides_${E}_${m}-${String(x+1).padStart(2,"0")}.json`,xe=document.createElement("a");xe.href=URL.createObjectURL(ae),xe.download=he,document.body.appendChild(xe),xe.click(),xe.remove()}catch(G){console.error(G),Oe(`JSON da aktarma hatas: ${G.message||G}`,"error")}}async function W0(G){var he;const ae=(he=G.target.files)==null?void 0:he[0];if(ae)try{const xe=await ae.text(),Ce=JSON.parse(xe);if(!Ce||typeof Ce!="object")throw new Error("Geersiz JSON.");if(Ce.role!==E)throw new Error(`Rol uyumuyor (beklenen: ${E}, dosya: ${Ce.role}).`);if(Ce.year!==m||Ce.month0!==x||Ce.ymKey!==ee)throw new Error("Yl/Ay uyumuyor.");if(!Ce.overrides||typeof Ce.overrides!="object")throw new Error("overrides alan bulunamad.");b(Ce.overrides),Oe("JSON ie aktarld ve uyguland.","success")}catch(xe){console.error(xe),Oe(`JSON ie aktarma hatas: ${xe.message||xe}`,"error")}finally{G.target.value=""}}const[I,Y]=_.useState(()=>Oi()),z=_.useCallback(()=>{try{window.dispatchEvent(new Event("planner:aiPlan"))}catch{}},[]),V=_.useCallback(()=>{const G=Fe.get("scheduleRowsV2");G&&G.year===m&&G.month===x+1?tr(G):tr(null),Y(Oi()),z()},[m,x,z]);_.useEffect(()=>{V()},[m,x,V]);function K(){const G=Fe.get("scheduleRowsV2");if(!G||!Array.isArray(G.rows)){Oe("Kaydedilmi otomatik plan bulunamad.","info");return}if(G.year!==m||G.month!==x+1){Oe("Seili yl/ay iin kaytl plan yok.","info");return}const ae=Oi();let he=0;const xe=G.rows.map(Ie=>{if(Ie.personId&&(!Ie.personName||Ie.personName==="")){const we=ae.get(Ie.personId);if(we&&!Cn(we))return he++,{...Ie,personName:we}}return Ie});if(he===0){Oe("Eksik isim bulunamad (zaten dolu).","info");return}const Ce={...G,rows:xe};Fe.set("scheduleRowsV2",Ce),tr(Ce),z(),Oe(`${he} satrn ismi dolduruldu.`,"success")}_.useEffect(()=>{let G=!1;return s?((async()=>{P(!0);try{const ae=await kx({sectionId:s,serviceId:ne,role:E,year:m,month:C});if(G)return;if(ae&&ae.data){const he=ae.data||{};if(Array.isArray(he.defs)&&H(he.defs),"overrides"in he){const xe=he.overrides&&typeof he.overrides=="object"?he.overrides:{};b(xe)}"preview"in he&&Be(he.preview||null),"roster"in he&&Ze(he.roster||null),"aiPlan"in he&&tr(he.aiPlan||null),B({updatedAt:ae.updatedAt||ae.createdAt||null,updatedBy:ae.updatedBy||ae.createdBy||null}),fe.current&&(clearTimeout(fe.current),fe.current=null),M.current=Me(Array.isArray(he.defs)?he.defs:he.rows||[],he.overrides||{},he.roster??null,he.preview??null,he.aiPlan??null),ye("idle"),ve(null)}else B(null),fe.current&&(clearTimeout(fe.current),fe.current=null),M.current=null,ye("dirty"),ve(null)}catch(ae){if(G)return;(ae==null?void 0:ae.status)===404?(B(null),fe.current&&(clearTimeout(fe.current),fe.current=null),M.current=null,ye("dirty"),ve(null)):(console.error("[DutyRowsEditor] getMonthlySchedule err:",ae),Oe((ae==null?void 0:ae.message)||"Sunucudan izelge yklenemedi.","error"),ye("error"),ve((ae==null?void 0:ae.message)||"Sunucudan izelge yklenemedi."))}finally{G||P(!1)}})(),()=>{G=!0}):()=>{G=!0}},[s,ne,E,m,C,H,Oe]),_.useEffect(()=>()=>P(!1),[]);const X=_.useCallback(async({silent:G=!1}={})=>{if(!s)return G?ye("error"):Oe("Sekme kimlii bulunamad.","error"),null;fe.current&&(clearTimeout(fe.current),fe.current=null),q(!0);try{const ae={version:1,defs:A,overrides:te,roster:Pe,preview:Ke,aiPlan:Nt,generatedAt:new Date().toISOString()},xe=await VM({sectionId:s,serviceId:ne,role:E,year:m,month:C,data:ae,meta:{role:E,daysInMonth:k,source:"DutyRowsEditor"}});return B({updatedAt:(xe==null?void 0:xe.updatedAt)||new Date().toISOString(),updatedBy:(xe==null?void 0:xe.updatedBy)||null}),M.current=Me(ae.defs,ae.overrides,ae.roster,ae.preview,ae.aiPlan),ye("saved"),ve(null),G||Oe("izelge kaydedildi.","success"),xe}catch(ae){throw console.error("[DutyRowsEditor] saveMonthlySchedule err:",ae),ye("error"),ve((ae==null?void 0:ae.message)||"izelge kaydedilemedi."),G||Oe((ae==null?void 0:ae.message)||"izelge kaydedilemedi.","error"),ae}finally{q(!1)}},[s,ne,E,m,C,A,te,Pe,Ke,Nt,k,Oe,Me]);_.useEffect(()=>{if(ue!=="saved")return;const G=setTimeout(()=>{ye("idle")},3e3);return()=>clearTimeout(G)},[ue]),_.useEffect(()=>{if(!s||O)return;const G=mn();if(G&&!U){if(G===M.current){(ue==="dirty"||ue==="saving"||ue==="error")&&(ye("idle"),ve(null));return}return ye("dirty"),ve(null),fe.current&&(clearTimeout(fe.current),fe.current=null),fe.current=setTimeout(async()=>{fe.current=null,ye("saving");try{await X({silent:!0})}catch{}},1200),()=>{fe.current&&(clearTimeout(fe.current),fe.current=null)}}},[s,O,U,mn,X,ue]);function ie(){if(Z!=null&&Z.length)return 0;const G=Array.isArray(N)?N:[],ae=D||[];if(!G.length||!ae.length)return Oe("Parametreler eksik: alma Alanlar / alma Saatleri tanml olmal.","error"),0;const he=Date.now(),xe=Ie=>he+Ie+Math.floor(Math.random()*1e3),Ce=G.map((Ie,we)=>{var Et;const je=(Et=Ie==null?void 0:Ie.name)==null?void 0:Et.toString().trim();if(!je)return null;const rt=Number((Ie==null?void 0:Ie.required)??1)||1,ot=qM(Ie,ae);return{id:xe(we),label:je,shiftCode:ot,defaultCount:rt,pattern:[rt,rt,rt,rt,rt,rt,rt],weekendOff:!1}}).filter(Boolean);return Ce.length?(H(Ce),setTimeout(()=>{Ce.forEach(Ie=>rr(Ie.id,Ie.defaultCount||0))},0),Ce.length):(Oe("Parametrelerden satr tretilemedi (isimler bo).","error"),0)}const me=()=>{try{AM({year:m,month1_12:x+1,writeToLS:!0}),Oe("Otomatik alma izelgesi oluturuldu.","success"),V()}catch(G){console.error(G),Oe("Plan retiminde hata: "+((G==null?void 0:G.message)||G),"error")}},se=()=>{const G=ie();B0(),(jv(E)||[]).some(xe=>!xe.role||xe.role===E)?Oe(`${G?`${G} satr eklendi, `:""}Liste oluturuldu.`,"success"):Oe(`${G?`${G} satr eklendi, `:""}Personel bulunamad: Sadece saysal liste retildi.`,"info")},le=()=>U0(),oe=G=>G&&Ll(G),Se=()=>{b({}),Be(null),Ze(null)};_.useImperativeHandle(l,()=>({ai:me,build:se,exportExcel:le,importTemplate:oe,reset:Se,save:X,isSaving:()=>U,setYear:g,setMonth:v}));const Ae=!!(J!=null&&J.updatedAt),De=O||U||ue!=="idle"||Ae;return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["alma izelgesi  ",S]}),De&&f.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-slate-500",children:[O&&f.jsx("span",{children:"Sunucudan izelge ykleniyor"}),(U||ue==="saving")&&f.jsx("span",{className:"text-sky-600",children:"Otomatik kaydediliyor"}),!O&&!U&&ue==="dirty"&&f.jsx("span",{className:"text-amber-600",children:"Kaydedilmemi deiiklikler var, otomatik kaydedilecek"}),!O&&!U&&ue==="error"&&f.jsxs("span",{className:"text-rose-600",children:["Kaydetme hatas: ",Te||"Bilinmeyen hata"]}),!O&&!U&&ue==="saved"&&Ae&&f.jsxs("span",{children:["Otomatik kaydedildi: ",Lv(J.updatedAt)||"-",J!=null&&J.updatedBy?` (kullanc: ${J.updatedBy})`:""]}),!O&&!U&&ue!=="saved"&&Ae&&f.jsxs("span",{children:["Son kayt: ",Lv(J.updatedAt)||"-",J!=null&&J.updatedBy?` (kullanc: ${J.updatedBy})`:""]}),!O&&!U&&!Ae&&ue==="idle"&&f.jsx("span",{children:"Otomatik kaydetme aktif. lk kayt iin deiiklik yapn."})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>Qr(!0),className:"px-3 py-2 rounded bg-violet-600 text-white text-sm",children:"Sorumlu Ayarlar"}),f.jsx("input",{ref:zc,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:$0}),f.jsx("button",{onClick:z0,className:"px-3 py-2 rounded border hover:bg-slate-50 text-sm",children:"Satr Bazl e Aktar (G1)"}),f.jsx("button",{onClick:V0,className:"px-3 py-2 rounded border hover:bg-slate-50 text-sm",children:"Ayn st-Yazmalarn ndir (JSON)"}),f.jsx("input",{ref:Hc,type:"file",accept:"application/json,.json",className:"hidden",onChange:W0}),f.jsx("button",{onClick:()=>{var G;return(G=Hc.current)==null?void 0:G.click()},className:"px-3 py-2 rounded border hover:bg-slate-50 text-sm",children:"JSONdan Geri Ykle"})]}),f.jsxs("div",{className:"rounded-lg border bg-white p-3",children:[f.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[f.jsx("div",{className:"text-sm font-medium",children:"Otomatik Plan (AI)  nizleme"}),f.jsx("button",{className:"ml-auto text-sm px-2 h-8 rounded border hover:bg-slate-50",onClick:V,children:"Yenile"}),f.jsx("button",{className:"text-sm px-2 h-8 rounded border hover:bg-slate-50",onClick:K,children:"simleri Doldur"})]}),Nt?f.jsxs("div",{className:"overflow-auto",children:[f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-slate-50",children:[f.jsx("th",{className:"p-2 text-left whitespace-nowrap",children:"Tarih"}),f.jsx("th",{className:"p-2 text-left whitespace-nowrap",children:"Grev (Servis)"}),f.jsx("th",{className:"p-2 text-left",children:"Vardiya"}),f.jsx("th",{className:"p-2 text-left",children:"Personel"}),f.jsx("th",{className:"p-2 text-left",children:"Not"})]})}),f.jsx("tbody",{children:Nt.rows.map((G,ae)=>{const he=G.personName||I.get(G.personId)||"",xe=he&&!Cn(he)?he:"";return f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"p-2 whitespace-nowrap",children:G.date}),f.jsx("td",{className:"p-2 whitespace-nowrap",children:G.serviceId||"-"}),f.jsx("td",{className:"p-2",children:G.shiftCode||"-"}),f.jsx("td",{className:"p-2",children:xe||f.jsx("em",{children:"BO"})}),f.jsx("td",{className:"p-2 text-slate-500",children:G.note||""})]},ae)})})]}),((Ee=Nt==null?void 0:Nt.meta)==null?void 0:Ee.personHours)&&f.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:[f.jsx("b",{children:"Kii Saatleri (toplam):"})," ",Object.entries(Nt.meta.personHours).map(([G,ae],he)=>f.jsxs("span",{children:[he?", ":"",G,": ",ae," saat"]},G))]})]}):f.jsxs("div",{className:"text-sm text-slate-500",children:["Henz bu yl/ay iin otomatik plan yok. stteki ",f.jsx("b",{children:"Yapay Zeka Destekli Liste"})," ile oluturun."]}),f.jsxs("p",{className:"mt-2 text-[11px] text-slate-500",children:["Not: Bu tablo ",f.jsx("code",{children:"people/peopleV2"}),", ",f.jsx("code",{children:"leaves/leavesV2"}),", ",f.jsx("code",{children:"workAreas/workAreasV2"})," vb. anahtarlardan okunur; sonu ",f.jsx("code",{children:"scheduleRowsV2"}),"ye kaydedilir."]})]}),Ke&&f.jsxs("div",{className:"rounded-lg border bg-white p-3",children:[f.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[f.jsx("div",{className:"text-sm font-medium",children:"Oluturulan Liste  (Say) nizleme"}),f.jsx("button",{className:"ml-auto text-sm px-2 h-8 rounded border hover:bg-slate-50",onClick:()=>Be(null),children:"Gizle"})]}),f.jsx("div",{className:"overflow-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{children:f.jsx("tr",{className:"bg-slate-50",children:Ol().map((G,ae)=>f.jsx("th",{className:"p-2 border-b text-left whitespace-nowrap",children:G},ae))})}),f.jsx("tbody",{children:A.map(G=>{const ae=[G.label,G.shiftCode,G.defaultCount||0];for(let he=1;he<=k;he++){const xe=new Date(m,x,he).getDay(),Ce=uo(xe),Ie=Array.isArray(G.pattern)?G.pattern:Array(7).fill(G.defaultCount||0);let we=(te[G.id]||{})[he];we==null&&(we=Ie[Ce]??(G.defaultCount||0)),G.weekendOff&&(xe===0||xe===6)&&(we=0),ae.push(we)}return f.jsx("tr",{className:"border-t",children:ae.map((he,xe)=>f.jsx("td",{className:`p-2 ${xe>=3?"text-center":""} whitespace-nowrap`,children:he},xe))},G.id)})})]})})]}),Pe&&f.jsxs("div",{className:"rounded-lg border bg-white p-3",children:[f.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[f.jsx("div",{className:"text-sm font-medium",children:"Kiilere Atama  nizleme"}),f.jsx("div",{className:"text-xs text-slate-500",children:"Dengesiz / Bo kalanlar Uyarlarda listelenir."}),f.jsx("button",{className:"ml-auto text-sm px-2 h-8 rounded border hover:bg-slate-50",onClick:()=>Ze(null),children:"Gizle"})]}),!!((Re=Pe.issues)!=null&&Re.length)&&f.jsxs("div",{className:"mb-3 rounded-md border border-amber-300 bg-amber-50 p-2 text-sm",children:[f.jsx("div",{className:"font-medium mb-1",children:"Uyarlar"}),f.jsx("ul",{className:"list-disc pl-5",children:Pe.issues.map((G,ae)=>f.jsxs("li",{children:["Gn ",G.day,", ",G.label," iin yeterli aday bulunamad",G.reason?` (${G.reason})`:"","."]},ae))})]}),f.jsx("div",{className:"overflow-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-slate-50",children:[f.jsx("th",{className:"p-2 text-left w-[240px]",children:"Grev"}),f.jsx("th",{className:"p-2 text-left w-[120px]",children:"Vardiya"}),Array.from({length:k}).map((G,ae)=>f.jsx("th",{className:"p-2 text-center",children:ae+1},ae))]})}),f.jsx("tbody",{children:A.map(G=>{const ae=G.shiftCode;return f.jsxs("tr",{className:"border-t align-top",children:[f.jsx("td",{className:"p-2 font-medium",children:G.label}),f.jsx("td",{className:"p-2",children:ae}),Array.from({length:k}).map((he,xe)=>{var we,je;const Ce=xe+1,Ie=(((je=(we=Pe.namedAssignments)==null?void 0:we[Ce])==null?void 0:je[G.id])||[]).filter(rt=>!Cn(rt));return f.jsx("td",{className:"p-2 text-center whitespace-pre-wrap",children:Ie.join(`
`)},xe)})]},G.id)})})]})})]}),f.jsxs("div",{className:"rounded-lg border bg-white p-3",children:[f.jsx("div",{className:"text-sm font-medium mb-2",children:"Yeni Satr Ekle"}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsxs("div",{className:"flex-1 min-w-[220px]",children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Grev (alma Alanlar)"}),f.jsxs("select",{value:ht.label,onChange:G=>pn(ae=>({...ae,label:G.target.value})),className:"w-full h-9 rounded border px-2",children:[f.jsx("option",{value:"",children:"Sein"}),R.map(G=>f.jsx("option",{value:G,children:G},G))]})]}),f.jsxs("div",{className:"flex-1 min-w-[220px]",children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Vardiya (alma Saatleri)"}),f.jsxs("select",{value:ht.shiftCode,onChange:G=>pn(ae=>({...ae,shiftCode:G.target.value})),className:"w-full h-9 rounded border px-2",children:[f.jsx("option",{value:"",children:"Sein"}),(D||[]).map(G=>f.jsxs("option",{value:G.code,children:[G.code," (",G.start,"",G.end,")"]},G.id||G.code))]})]}),f.jsxs("div",{className:"w-[160px]",children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Grevli Kii (varsaylan)"}),f.jsx("input",{type:"number",min:0,value:ht.defaultCount,onChange:G=>pn(ae=>({...ae,defaultCount:Number(G.target.value||0)})),className:"w-full h-9 rounded border px-2"})]}),f.jsx("div",{children:f.jsx("button",{onClick:jc,className:"h-9 px-3 rounded bg-sky-600 text-white text-sm",children:"Satr Ekle"})})]})]}),f.jsxs("div",{className:"rounded-lg border bg-white",children:[f.jsx("div",{className:"p-3 text-sm font-medium border-b",children:"Ayn Gnleri (PztPaz)"}),f.jsx("div",{className:"w-full overflow-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-slate-50",children:[f.jsx("th",{className:"p-2 text-left w-[240px]",children:"Grev"}),f.jsx("th",{className:"p-2 text-left w-[200px]",children:"Vardiya"}),f.jsx("th",{className:"p-2 text-center w-[150px]",children:"Grevli Kii"}),Array.from({length:7}).map((G,ae)=>f.jsx("th",{className:"p-2 text-center",children:GM[ae]},ae)),f.jsx("th",{className:"p-2 text-center w-[170px]",children:"lem"})]})}),f.jsxs("tbody",{children:[A.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:11,className:"p-3 text-slate-500",children:"Henz satr yok. Yukardan grev + vardiya ekleyin veya Excel'den ie aktarn."})}),A.map((G,ae)=>{const he=G.shiftCode||"",xe=Array.isArray(G.pattern)?G.pattern:Array(7).fill(G.defaultCount||0),Ce=te[G.id]||{},Ie=G.id===Qn;return f.jsxs("tr",{className:"border-t align-top relative",children:[f.jsx("td",{className:"p-2 font-medium",children:G.label}),f.jsx("td",{className:"p-2",children:he}),f.jsx("td",{className:"p-2 text-center",children:f.jsx("input",{type:"number",min:0,className:"w-20 h-8 rounded border px-2 text-center",value:Number(G.defaultCount||0),onChange:we=>{const je=Math.max(0,Number(we.target.value||0));W(G.id,{defaultCount:je,pattern:Array(7).fill(je)}),rr(G.id,je)},title:"Varsaylan kii saysn deitirir ve ayn tm gnlerine uygular"})}),Array.from({length:7}).map((we,je)=>f.jsx("td",{className:"p-2",children:f.jsx("div",{className:"flex flex-col gap-1",children:Array.from({length:w}).map((rt,ot)=>{const Et=y[ot][je],gr=Et?new Date(m,x,Et).getDay():null,Je=G.weekendOff&&gr!=null&&(gr===0||gr===6),Qe=Et?Ce[Et]??(Je?0:xe[je]??0):"";return f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"w-6 text-[10px] text-slate-500 text-right",children:Et??""}),Et?f.jsx("input",{type:"number",min:0,className:`w-14 h-7 rounded border text-center ${Je?"bg-slate-50 text-slate-400":""}`,value:Qe,onChange:It=>{Je||At(G.id,Et,It.target.value)},disabled:Je,title:Je?"Hafta sonu bu satr almaz":""}):f.jsx("div",{className:"w-14 h-7 rounded border border-dashed bg-slate-50/60"})]},ot)})})},je)),f.jsxs("td",{className:"p-2",children:[f.jsxs("div",{className:"inline-flex items-center gap-1",children:[f.jsx("button",{onClick:()=>Mc(G.id,"up"),disabled:ae===0,className:"h-8 w-8 rounded border bg-white disabled:opacity-40",title:"Yukar ta",children:f.jsx(eC,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>Mc(G.id,"down"),disabled:ae===A.length-1,className:"h-8 w-8 rounded border bg-white disabled:opacity-40",title:"Aa ta",children:f.jsx(Q4,{className:"w-4 h-4"})}),f.jsx("button",{className:"h-8 w-8 rounded border bg-white",title:"Kopyala",onClick:()=>Bc(G.id),children:f.jsx(tC,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>Xa(Ie?null:G.id),className:`h-8 w-8 rounded border ${Ie?"bg-slate-100":"bg-white"}`,title:"Satr Dzenle",children:f.jsx(TS,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>P0(G.id),className:"h-8 w-8 rounded border bg-rose-50 text-rose-700",title:"Sil",children:f.jsx(bp,{className:"w-4 h-4"})})]}),Ie&&f.jsxs("div",{className:"absolute z-10 mt-2 right-2 top-full w-[520px] rounded-lg border bg-white shadow-lg p-3",children:[f.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"Satr Dzenle"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Grev"}),f.jsxs("select",{className:"w-full h-9 rounded border px-2",value:G.label,onChange:we=>W(G.id,{label:we.target.value}),children:[f.jsx("option",{value:"",children:"Sein"}),R.map(we=>f.jsx("option",{value:we,children:we},we))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Vardiya"}),f.jsxs("select",{className:"w-full h-9 rounded border px-2",value:G.shiftCode,onChange:we=>W(G.id,{shiftCode:we.target.value}),children:[f.jsx("option",{value:"",children:"Sein"}),(D||[]).map(we=>f.jsxs("option",{value:we.code,children:[we.code," (",we.start,"",we.end,")"]},we.id||we.code))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Grevli Kii (varsaylan)"}),f.jsx("input",{type:"number",min:0,className:"w-full h-9 rounded border px-2",value:Number(G.defaultCount||0),onChange:we=>{const je=Math.max(0,Number(we.target.value||0));W(G.id,{defaultCount:je,pattern:Array(7).fill(je)}),rr(G.id,je)}})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Stun Deseni (PztPaz)"}),f.jsx("div",{className:"mt-1 grid grid-cols-7 gap-1",children:(G.pattern||[0,0,0,0,0,0,0]).map((we,je)=>f.jsx("input",{type:"number",min:0,className:"h-9 rounded border px-2 text-center",value:zd(je)&&G.weekendOff?0:we,onChange:rt=>!(zd(je)&&G.weekendOff)&&Uc(G.id,je,rt.target.value),disabled:zd(je)&&G.weekendOff},je))}),f.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[f.jsx("input",{id:`wk-${G.id}`,type:"checkbox",className:"h-4 w-4",checked:!!G.weekendOff,onChange:we=>{W(G.id,{weekendOff:we.target.checked}),we.target.checked&&rr(G.id,G.defaultCount||0)}}),f.jsx("label",{htmlFor:`wk-${G.id}`,className:"text-sm",children:"Hafta sonu almaz (CmtPaz = 0)"})]})]})]}),f.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[f.jsx("input",{type:"number",min:0,className:"w-20 h-9 rounded border px-2 text-center",value:Il,onChange:we=>j0(we.target.value)}),f.jsx("button",{className:"h-9 px-3 rounded bg-slate-800 text-white text-sm",onClick:()=>M0(G.id),children:"Bu Aya Uygula"}),f.jsxs("select",{className:"h-9 rounded border px-2",value:Dl,onChange:we=>Ei(we.target.value),children:[f.jsx("option",{value:"all",children:"Tm gnler"}),f.jsx("option",{value:"0",children:"Pzt"}),f.jsx("option",{value:"1",children:"Sal"}),f.jsx("option",{value:"2",children:"ar"}),f.jsx("option",{value:"3",children:"Per"}),f.jsx("option",{value:"4",children:"Cum"}),f.jsx("option",{value:"5",children:"Cmt"}),f.jsx("option",{value:"6",children:"Paz"})]}),f.jsx("button",{className:"ml-auto text-sm text-slate-500 hover:text-slate-700",onClick:()=>Xa(null),children:"Kapat"})]})]})]})]},G.id)})]})]})})]}),f.jsx(PM,{open:ur,onClose:()=>Qr(!1),role:E,year:m,month0:x})]})}),Hd=[{key:"sira",title:"sra no",width:8},{key:"unvan",title:"nvan",width:16},{key:"tckn",title:"T.C. Kimlik Numaras",width:18},{key:"adsoyad",title:"Ad Soyad",width:22}],$d=[{key:"aylikCalistigiSaat",title:"AYLIK ALITII SAAT",width:18},{key:"gecenAydanDevir",title:"Geen Aydan Devir (Saat)",width:20},{key:"gelecekAyaDevir",title:"Gelecek Aya Devir (Saat)",width:20},{key:"aylikCalisilacak",title:"Aylk allacak Mesai Saati",width:22},{key:"toplamCalisma",title:"TOPLAM ALIMA SAAT",width:20},{key:"ucretNobet",title:"creti denecek Nbet  Saati",width:22},{key:"birimDisi",title:"Birim D alma ..",width:28}],sa=e=>isFinite(e)?Number(e).toLocaleString("tr-TR"):"",Or=(e,t=0)=>{if(e==null)return t;const r=String(e).replace(",",".").replace(/[^0-9.\-]/g,""),n=parseFloat(r);return isNaN(n)?t:n},Mv=(e,t)=>`${e}-${String(t+1).padStart(2,"0")}`;function Bv(e){if(!e)return null;const t=String(e).match(/^(\d{1,2}):(\d{2})$/);if(!t)return null;const r=+t[1],n=+t[2];return r<0||r>29||n<0||n>59?null:r*60+n}function QM(e,t){const r=Bv(e),n=Bv(t);if(r==null||n==null)return 0;let a=n-r;return a<0&&(a+=24*60),Math.round(a/60*100)/100}function e7(e,t){if(!Number.isFinite(e)||!Number.isFinite(t))return[];const r=new Date(e,t,1),n=new Date(e,t+1,1),a=[];for(let s=r;s<n;s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)){const i=s.getDate(),l=s.getDay();a.push({ymd:`${e}-${String(t+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`,d:i,isWeekend:l===0||l===6})}return a}const t7=e=>(e||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(//g,"G").replace(//g,"U").replace(//g,"S").replace(//g,"I").replace(//g,"O").replace(//g,"C").replace(//g,"g").replace(//g,"u").replace(//g,"s").replace(//g,"i").replace(//g,"o").replace(//g,"c"),xm=e=>t7((e||"").toString().trim().toLocaleUpperCase("tr-TR")).replace(/\s+/g," ").trim();function Vd(e){try{const t=localStorage.getItem(e);if(!t)return[];const r=JSON.parse(t);if(Array.isArray(r))return r;if(r&&typeof r=="object"){const n=[];return Object.values(r).forEach(a=>{Array.isArray(a)&&n.push(...a)}),n}}catch{return[]}return[]}function r7(){const e=[...Vd("nurses"),...Vd("doctors"),...Vd(vl)],t=Lc();Array.isArray(t)&&e.push(...t);const r=new Map,n=new Map;return e.forEach((a,s)=>{if(!a)return;const i=a.fullName||a.name||a.displayName||a["AD SOYAD"]||a.personName||"";if(!i||O0(i))return;const l=a.id??a.personId??a.uid??a.pid??a.tc??a.tcNo??a.code??a.employeeId??`tmp-${s}`,o={id:l!=null?String(l):null,name:i,title:a.title||a.unvan||a.position||a.role||a.meta&&(a.meta.title||a.meta.role)||"",service:a.service||a.unit||a.department||a.branch||a.meta&&(a.meta.service||a.meta.unit||a.meta.department)||"",tckn:a.tckn||a.tc||a.tcKimlik||a.tcNo||a["T.C."]||a.nationalId||""},c=xm(i);if(o.id){const u=r.get(o.id);(!u||o.title&&!u.title||o.service&&!u.service||o.tckn&&!u.tckn)&&r.set(o.id,{...o})}if(c)if(!n.has(c))n.set(c,{...o});else{const u=n.get(c);o.title&&!u.title&&(u.title=o.title),o.service&&!u.service&&(u.service=o.service),o.tckn&&!u.tckn&&(u.tckn=o.tckn)}}),{byId:r,byCanon:n}}const l_=(e,t="")=>{const r=String(e||"").trim().toUpperCase(),n=String(t||"").trim().toUpperCase();return r?r.includes("4")?4:r.includes("8")||r==="M"||r==="GUND"?8:r.includes("12")?12:["YARIM","HALF"].some(a=>r.includes(a))?4:(["N","GECE","V2","V1","SV","24"].some(a=>r.includes(a))||n.includes("NBET")||n.includes("SORUMLU")||n.includes("RESS")||n.includes("TRAJ")||n.includes("CERRAH"),24):n.includes("YARIM")||n.includes("4 SAAT")?4:n.includes("POL")||n.includes("GNDZ")||n.includes("KISA")?8:24};function n7(e){if(!e&&e!==0)return null;if(e instanceof Date&&!isNaN(e)){const s=e.getFullYear(),i=e.getMonth()+1,l=e.getDate();return`${s}-${String(i).padStart(2,"0")}-${String(l).padStart(2,"0")}`}const t=String(e).trim(),r=t.match(/^(\d{4})-(\d{2})-(\d{2})(?:[T\s].*)?$/);if(r){const s=+r[1],i=+r[2],l=+r[3];if(s>1900&&i>=1&&i<=12&&l>=1&&l<=31)return`${s}-${String(i).padStart(2,"0")}-${String(l).padStart(2,"0")}`}const n=t.match(/^(\d{1,2})[./-](\d{1,2})[./-](\d{4})$/);if(n){const s=+n[1],i=+n[2],l=+n[3];if(l>1900&&i>=1&&i<=12&&s>=1&&s<=31)return`${l}-${String(i).padStart(2,"0")}-${String(s).padStart(2,"0")}`}const a=Number(t);return Number.isFinite(a)&&a>=1&&a<=31?a:null}function a7(){const[e,t]=_.useState({});return _.useEffect(()=>{const r=Fe.get("workingHours",[]),n={};(r||[]).forEach(a=>{let s=0;if((a==null?void 0:a.hours)!==void 0&&(a==null?void 0:a.hours)!==null&&String(a.hours).trim()!==""){const i=Number(a.hours);s=isNaN(i)?0:i}else s=QM(a==null?void 0:a.start,a==null?void 0:a.end);a!=null&&a.code&&(n[String(a.code).trim().toUpperCase()]=s)}),t(n)},[]),e}function s7(e){const[t,r]=_.useState([]);return _.useEffect(()=>{const n=Fe.get("nurses",[]),a=Fe.get("doctors",[]),s=(l,o)=>(l||[]).map((c,u)=>({id:c.id||`${o}-${u}`,unvan:c.title||c.role||o,adsoyad:c.name||`${c.firstName||""} ${c.lastName||""}`.trim(),tckn:c.tckn||c.nationalId||""})),i=e==="Doktorlar"?s(a,"Doktor"):s(n,"Hemire");r(i)},[e]),t}function wu(e){return{sira:"",unvan:(e==null?void 0:e.unvan)||"",tckn:(e==null?void 0:e.tckn)||"",adsoyad:(e==null?void 0:e.adsoyad)||"",days:{},aylikCalistigiSaat:0,gecenAydanDevir:0,gelecekAyaDevir:0,aylikCalisilacak:168,toplamCalisma:0,ucretNobet:0,birimDisi:0}}const i7=e=>{const t=String((e==null?void 0:e.adsoyad)||"").trim(),r=String((e==null?void 0:e.unvan)||"").trim()||String((e==null?void 0:e.tckn)||"").trim(),n=Object.values((e==null?void 0:e.days)||{}).some(a=>String(a||"").trim()!=="");return!t&&!r&&!n},l7=(e,t)=>String((e==null?void 0:e.adsoyad)||"").localeCompare(String((t==null?void 0:t.adsoyad)||""),"tr",{sensitivity:"base"}),Fi=(e,{sort:t=!0,renumber:r=!0,filterEmpty:n=!0}={})=>{let a=Array.isArray(e)?[...e]:[];return n&&(a=a.filter(s=>!i7(s))),t&&a.sort(l7),r&&(a=a.map((s,i)=>({...s,sira:i+1}))),a};function Su(e,t,r){let n=0;(t||[]).forEach(i=>{var d;const l=(((d=e==null?void 0:e.days)==null?void 0:d[i.ymd])??"").toString().trim();if(!l)return;const o=parseFloat(l.replace(",","."));if(!isNaN(o)){n+=o;return}const c=l.toUpperCase(),u=r[c];if(Number.isFinite(u)&&u>0){n+=u;return}n+=l_(c,(e==null?void 0:e.unvan)||"")});const a=Math.round(n*100)/100,s=a+Or(e==null?void 0:e.gecenAydanDevir,0)-Or(e==null?void 0:e.gelecekAyaDevir,0);return{aylikCalistigiSaat:a,toplamCalisma:s}}const o7=_.forwardRef(function({ym:t},r){const n=Number(t==null?void 0:t.year),a=Number(t==null?void 0:t.month),s=Math.max(0,Math.min(11,a-1)),l=Fe.get("activeRole","Nurse")==="Doctor"?"Doktorlar":"Hemireler",o=_.useMemo(()=>e7(n,s),[n,s]),c=s7(l),u=a7(),[d,h]=_.useState([]),[p,m]=_.useState(!1),[x,g]=_.useState(1),[v,w]=_.useState(!1),y=_.useRef(!1),k=_.useRef(null),C=_.useMemo(()=>`monthlyHoursSheet/${Mv(n,s)}`,[n,s]),E="monthlyHoursSheet/latest";_.useEffect(()=>{m(!1),y.current=!1;const H=Fe.get(C,null);if(Array.isArray(H)){const L=Fi(H,{sort:!0,renumber:!0,filterEmpty:!0});h(L),m(!0)}else{const L=Array.isArray(c)?c:[];if(L.length===0){h([]),m(!0);return}const ee=Fi(L.map(te=>wu(te)),{sort:!0,renumber:!0,filterEmpty:!0});h(ee),m(!0)}w(!Array.isArray(H))},[C,(c||[]).length,x]),_.useEffect(()=>{if(!p)return;const H=Fi(d,{sort:!1,renumber:!1,filterEmpty:!0});Fe.set(C,H),Fe.set(E,{ym:{year:n,month:a},rows:H})},[p,C,E,d,n,a]);const S=(H,L,ee)=>{h(te=>{const b=[...te||[]],A={...b[H]||{}},O={...A.days||{}};O[L]=ee,A.days=O;const P=Su(A,o,u);return b[H]={...A,...P},b})},N=(H,L,ee)=>{h(te=>{const b=[...te||[]];return b[H]={...b[H]||{},[L]:ee},b})},F=()=>h(H=>[...H||[],wu()]),R=()=>{Fe.remove(C),g(H=>H+1)},D=()=>{const L=[[...(Hd||[]).map(b=>b.title),...(o||[]).map(b=>b.ymd),...($d||[]).map(b=>b.title)]];(d||[]).forEach((b,A)=>{const O=[(b==null?void 0:b.sira)||A+1,(b==null?void 0:b.unvan)||"",(b==null?void 0:b.tckn)||"",(b==null?void 0:b.adsoyad)||"",...(o||[]).map(P=>{var U;return((U=b==null?void 0:b.days)==null?void 0:U[P.ymd])??""}),(b==null?void 0:b.aylikCalistigiSaat)??0,(b==null?void 0:b.gecenAydanDevir)??0,(b==null?void 0:b.gelecekAyaDevir)??0,(b==null?void 0:b.aylikCalisilacak)??168,(b==null?void 0:b.toplamCalisma)??0,(b==null?void 0:b.ucretNobet)??0,(b==null?void 0:b.birimDisi)??0];L.push(O)});const ee=Ve.aoa_to_sheet(L);ee["!cols"]=[...(Hd||[]).map(b=>({wch:b.width})),...(o||[]).map(()=>({wch:10})),...($d||[]).map(b=>({wch:b.width}))];const te=Ve.book_new();Ve.book_append_sheet(te,ee,"Sayfa1"),jn(te,`Aylik_Mesai_${n}-${String(a).padStart(2,"0")}.xlsx`)},T=H=>{const L=new FileReader;L.onload=ee=>{const te=fn(new Uint8Array(ee.target.result),{type:"array",cellDates:!0,dateNF:"yyyy-mm-dd"}),b=te.Sheets[te.SheetNames[0]],A=Ve.sheet_to_json(b,{header:1,raw:!1});if(!(A!=null&&A.length))return alert("Excel sayfas bo grnyor.");const O=A[0]||[],P=[];for(let J=0;J<O.length;J++){const B=n7(O[J]);if(B){if(typeof B=="string"){const[ne,fe]=B.split("-").map(Number);ne===n&&fe===a&&P.push({i:J,ymd:B})}else if(typeof B=="number"){const ne=`${n}-${String(a).padStart(2,"0")}-${String(B).padStart(2,"0")}`;P.push({i:J,ymd:ne})}}}if(!P.length){alert("Gn stunu bulunamad. Balklar tarih (YYYY-AA-GG) veya gn numaras (1..31) olmal; ayrca ay/yl bu sekmeyle ayn olmal.");return}const U=[];for(let J=1;J<A.length;J++){const B=A[J];if(!B||B.every(ye=>ye===""||ye===null||typeof ye>"u"))continue;const ne=wu();ne.sira=B[0]??"",ne.unvan=B[1]??"",ne.tckn=B[2]??"",ne.adsoyad=B[3]??"",ne.days={},P.forEach(({i:ye,ymd:Te})=>{ne.days[Te]=(B[ye]??"").toString()});const fe=4+P.length,M=(ye,Te=0)=>Or(B[fe+ye],Te);ne.aylikCalistigiSaat=M(0,0),ne.gecenAydanDevir=M(1,0),ne.gelecekAyaDevir=M(2,0),ne.aylikCalisilacak=M(3,168),ne.toplamCalisma=M(4,0),ne.ucretNobet=M(5,0),ne.birimDisi=M(6,0);const ue=Su(ne,o,u);U.push({...ne,...ue})}const q=Fi(U,{sort:!0,renumber:!0,filterEmpty:!0});h(q),m(!0),Fe.set(C,q),Fe.set(E,{ym:{year:n,month:a},rows:q}),alert("Excel ie aktarma tamamland.")},L.readAsArrayBuffer(H)},j=()=>{var H;return(H=k.current)==null?void 0:H.click()},Z=H=>{var ee;const L=(ee=H.target.files)==null?void 0:ee[0];L&&T(L),H.target.value=""},re=_.useMemo(()=>{const H={};(o||[]).forEach(U=>{H[U.ymd]=0});let L=0,ee=0,te=0,b=0,A=0,O=0,P=0;return(d||[]).forEach(U=>{L+=Or(U==null?void 0:U.aylikCalistigiSaat,0),ee+=Or(U==null?void 0:U.gecenAydanDevir,0),te+=Or(U==null?void 0:U.gelecekAyaDevir,0),b+=Or(U==null?void 0:U.aylikCalisilacak,0),A+=Or(U==null?void 0:U.toplamCalisma,0),O+=Or(U==null?void 0:U.ucretNobet,0),P+=Or(U==null?void 0:U.birimDisi,0),(o||[]).forEach(q=>{var M;const J=(((M=U==null?void 0:U.days)==null?void 0:M[q.ymd])??"").toString().trim();if(!J)return;const B=parseFloat(J.replace(",","."));if(!isNaN(B)){H[q.ymd]+=B;return}const ne=J.toUpperCase(),fe=u[ne];if(Number.isFinite(fe)&&fe>0){H[q.ymd]+=fe;return}H[q.ymd]+=l_(ne,(U==null?void 0:U.unvan)||"")})}),{perDay:H,right:{aylik:L,gecen:ee,gelecek:te,calisilacak:b,toplam:A,ucret:O,birimDisi:P}}},[d,o,u]),W=()=>{var P,U,q;const H=Mv(n,s),L=[];for(let J=0;J<localStorage.length;J++){const B=localStorage.key(J)||"",ne=B.toLowerCase();B.includes(H)&&(ne.includes("plan")||ne.includes("duty")||ne.includes("assign")||ne.includes("planner")||ne.includes("rows"))&&L.push(B)}const ee=J=>typeof J=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(J);let te=null,b="";for(const J of L)try{const B=JSON.parse(localStorage.getItem(J)||"null");if(Array.isArray(B)&&B.length&&((P=B[0])!=null&&P.adsoyad||(U=B[0])!=null&&U.name)&&((q=B[0])!=null&&q.days)){te=B,b="arrayRows";break}if(B&&typeof B=="object"){const ne=Object.keys(B);if(ne.length&&ee(ne[0])){te=B,b="byDate";break}}}catch{}if(!te){alert("Plan verisi bulunamad. Ltfen Plan sekmesinde bu aya ait veriyi kaydedin.");return}const A=(d||[]).map(J=>({...J,days:{...(J==null?void 0:J.days)||{}}}));if(b==="arrayRows"){const J=new Map(A.map((B,ne)=>[String((B==null?void 0:B.adsoyad)||"").trim().toUpperCase(),ne]));(te||[]).forEach(B=>{const ne=String((B==null?void 0:B.adsoyad)||(B==null?void 0:B.name)||"").trim().toUpperCase(),fe=J.get(ne);if(fe===void 0)return;const M=(B==null?void 0:B.days)||{};(o||[]).forEach(ue=>{const ye=M[ue.ymd];ye!=null&&(A[fe].days[ue.ymd]=ye)})})}else if(b==="byDate"){const J=new Map(A.map((B,ne)=>[String((B==null?void 0:B.adsoyad)||"").trim().toUpperCase(),ne]));Object.entries(te||{}).forEach(([B,ne])=>{(o||[]).find(fe=>fe.ymd===B)&&(ne||[]).forEach(fe=>{const M=String((fe==null?void 0:fe.adsoyad)||(fe==null?void 0:fe.name)||"").trim().toUpperCase(),ue=J.get(M);ue!==void 0&&(A[ue].days[B]=(fe==null?void 0:fe.code)??(fe==null?void 0:fe.hours)??"")})})}const O=Fi(A.map(J=>({...J,...Su(J,o,u)})),{sort:!0,renumber:!0,filterEmpty:!0});h(O),m(!0)},Q=_.useCallback(async({silent:H=!1}={})=>{var L;try{const ee=r7(),te=["Nurse","Doctor"],b=[];for(const q of te){const J=await kx({sectionId:"calisma-cizelgesi",serviceId:"",role:q,year:n,month:a}).catch(ue=>((ue==null?void 0:ue.status)!==404&&!H&&console.error("getMonthlySchedule err:",ue),null)),B=(J==null?void 0:J.data)||J||{},ne=(L=B==null?void 0:B.roster)==null?void 0:L.namedAssignments;if(!ne)continue;const fe=Array.isArray(B==null?void 0:B.defs)?B.defs:Array.isArray(B==null?void 0:B.rows)?B.rows:[],M=new Map;fe.forEach(ue=>{const ye=String((ue==null?void 0:ue.id)??(ue==null?void 0:ue.rowId)??"");ye&&M.set(ye,(ue==null?void 0:ue.shiftCode)||(ue==null?void 0:ue.label)||"")}),Object.entries(ne).forEach(([ue,ye])=>{const Te=Number(ue);if(!Number.isFinite(Te)||Te<1||Te>((o==null?void 0:o.length)||31))return;const ve=`${n}-${String(a).padStart(2,"0")}-${String(Te).padStart(2,"0")}`;Object.entries(ye||{}).forEach(([pe,Me])=>{const Ke=M.get(String(pe))||"";(Me||[]).forEach(Be=>{!Be||O0(Be)||b.push({name:Be,day:ve,shiftCode:Ke,role:q})})})})}if(!b.length){H||alert("alma izelgesi verisi bulunamad. nce ilgili ay kaydedin.");return}const A=Array.isArray(d)?d.map(q=>({...q,days:{...q.days||{}}})):[],O=new Map(A.map((q,J)=>[xm((q==null?void 0:q.adsoyad)||""),J])),P=(q,J)=>{if(O.has(q))return O.get(q);const B=wu({unvan:(J==null?void 0:J.title)||"",adsoyad:(J==null?void 0:J.name)||""});B.tckn=(J==null?void 0:J.tckn)||"",A.push(B);const ne=A.length-1;return O.set(q,ne),ne};b.forEach(q=>{const J=xm(q.name);if(!J)return;const B=ee.byCanon.get(J)||null,ne=P(J,B),fe=A[ne];B&&(B.title&&!fe.unvan&&(fe.unvan=B.title),B.tckn&&!fe.tckn&&(fe.tckn=B.tckn),B.name&&!fe.adsoyad&&(fe.adsoyad=B.name)),fe.adsoyad||(fe.adsoyad=q.name),fe.days[q.day]=q.shiftCode||""});const U=Fi(A.map(q=>({...q,...Su(q,o,u)})),{sort:!0,renumber:!0,filterEmpty:!0});h(U),m(!0),H||alert("alma izelgesi'nden aylk tablo dolduruldu.")}catch(ee){H||(console.error("fillFromDutyRoster err:",ee),alert("alma izelgesi verisi aktarlrken hata olutu."))}},[d,o,u,n,a]);return _.useEffect(()=>{!p||!v||y.current||(y.current=!0,Promise.resolve(Q({silent:!0})).finally(()=>{w(!1)}))},[p,v,Q]),_.useImperativeHandle(r,()=>({exportExcel:D,triggerImport:j,importExcelFile:T,fillFromPlanner:W,importFromRoster:Q,reset:R,addRow:F})),f.jsxs("div",{className:"space-y-3",children:[f.jsx("input",{ref:k,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:Z}),f.jsx("div",{className:"rounded-xl border bg-white overflow-auto",children:f.jsxs("table",{className:"min-w-full text-[13px]",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[(Hd||[]).map(H=>f.jsx("th",{style:{minWidth:H.width*8,border:"1px solid #e5e7eb",padding:4},children:H.title},H.key)),(o||[]).map(H=>f.jsx("th",{className:"text-center min-w-[60px]",style:{border:"1px solid #e5e7eb",padding:4},children:H.d},H.ymd)),($d||[]).map(H=>f.jsx("th",{style:{minWidth:H.width*7.2,border:"1px solid #e5e7eb",padding:4},children:H.title},H.key))]})}),f.jsx("tbody",{children:(d||[]).map((H,L)=>f.jsxs("tr",{style:{background:L%2?"#ffffff":"rgba(249,250,251,0.6)"},children:[f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 w-16",value:(H==null?void 0:H.sira)??"",onChange:ee=>N(L,"sira",ee.target.value)})}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 w-40",value:(H==null?void 0:H.unvan)??"",onChange:ee=>N(L,"unvan",ee.target.value)})}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 w-44",value:(H==null?void 0:H.tckn)??"",onChange:ee=>N(L,"tckn",ee.target.value)})}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 w-56",value:(H==null?void 0:H.adsoyad)??"",onChange:ee=>N(L,"adsoyad",ee.target.value)})}),(o||[]).map(ee=>{var te;return f.jsx("td",{className:"text-center",style:{border:"1px solid #e5e7eb",padding:4,background:ee.isWeekend?"#fff1f2":"transparent"},children:f.jsx("input",{className:"border rounded px-2 py-1 text-center w-14",placeholder:ee.isWeekend?"-":"",value:((te=H==null?void 0:H.days)==null?void 0:te[ee.ymd])??"",onChange:b=>S(L,ee.ymd,b.target.value)})},ee.ymd)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right",fontWeight:600},children:sa(H==null?void 0:H.aylikCalistigiSaat)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 text-right w-24",value:(H==null?void 0:H.gecenAydanDevir)??0,onChange:ee=>N(L,"gecenAydanDevir",Or(ee.target.value,0))})}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 text-right w-24",value:(H==null?void 0:H.gelecekAyaDevir)??0,onChange:ee=>N(L,"gelecekAyaDevir",Or(ee.target.value,0))})}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 text-right w-28",value:(H==null?void 0:H.aylikCalisilacak)??168,onChange:ee=>N(L,"aylikCalisilacak",Or(ee.target.value,168))})}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right",fontWeight:600},children:sa(H==null?void 0:H.toplamCalisma)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 text-right w-28",value:(H==null?void 0:H.ucretNobet)??0,onChange:ee=>N(L,"ucretNobet",Or(ee.target.value,0))})}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},children:f.jsx("input",{className:"border rounded px-2 py-1 text-right w-32",value:(H==null?void 0:H.birimDisi)??0,onChange:ee=>N(L,"birimDisi",Or(ee.target.value,0))})})]},L))}),f.jsx("tfoot",{children:f.jsxs("tr",{className:"bg-gray-100 font-semibold",children:[f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4},colSpan:4,children:"TOPLAM"}),(o||[]).map(H=>f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.perDay[H.ymd])},H.ymd)),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.right.aylik)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.right.gecen)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.right.gelecek)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.right.calisilacak)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.right.toplam)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.right.ucret)}),f.jsx("td",{style:{border:"1px solid #e5e7eb",padding:4,textAlign:"right"},children:sa(re.right.birimDisi)})]})})]})}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{className:"h-9 rounded-lg border bg-white px-3",onClick:F,children:"+ Satr Ekle"}),f.jsx("button",{className:"h-9 rounded-lg border bg-rose-50 text-rose-800 px-3",onClick:R,children:"Sfrla"}),f.jsx("div",{className:"text-xs text-gray-500",children:"Hafta sonu hcreleri grsel olarak iaretlidir."})]})]})}),c7=["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"];function u7({title:e,leftExtras:t=null,rightExtras:r=null,sticky:n=!1}){const{ym:a,setYear:s,setMonth:i,gotoPrev:l,gotoNext:o,gotoToday:c}=_c(),{year:u,month:d}=a;return f.jsxs("div",{className:`${n?"sticky top-0 z-30":""} flex items-center justify-between gap-2 p-2 rounded-2xl border bg-white`,children:[f.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[f.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-xl bg-gray-50 border",children:[f.jsx(NS,{size:16}),f.jsx("span",{className:"font-semibold",children:e||"Takvim"})]}),f.jsx("button",{onClick:l,className:"p-2 rounded-xl hover:bg-gray-100",title:"nceki Ay",children:f.jsx(Np,{size:18})}),f.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl bg-gray-50 border",children:[f.jsx("input",{type:"number",className:"w-20 outline-none bg-transparent",value:u,onChange:h=>s(parseInt(h.target.value||u,10))}),f.jsx("span",{children:"/"}),f.jsx("select",{className:"outline-none bg-transparent",value:d,onChange:h=>i(parseInt(h.target.value,10)),children:c7.map((h,p)=>f.jsx("option",{value:p+1,children:h},h))})]}),f.jsx("button",{onClick:o,className:"p-2 rounded-xl hover:bg-gray-100",title:"Sonraki Ay",children:f.jsx(Ap,{size:18})}),f.jsx("button",{onClick:c,className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50",children:"Bugn"}),t]}),f.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:r})]})}const gm=e=>String(e).padStart(2,"0"),Zl=(e,t)=>`${e}-${gm(t)}`,L0=(e,t)=>new Date(e,t,0).getDate(),f7=(e,t,r)=>`${e}-${gm(t)}-${gm(r)}`,d7=(e,t,r)=>{const n=new Date(e,t-1,r).getDay();return n===0||n===6},o_=e=>!!e&&/^(hemire(ler)?|hemsire(ler)?|doktor(lar)?|personel|nurses?|doctors?)$/i.test(String(e).trim());function h7(e){return(e||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(//g,"G").replace(//g,"U").replace(//g,"S").replace(//g,"I").replace(//g,"O").replace(//g,"C").replace(//g,"g").replace(//g,"u").replace(//g,"s").replace(//g,"i").replace(//g,"o").replace(//g,"c")}const Gu=e=>h7((e||"").toString().trim().toLocaleUpperCase("tr-TR")).replace(/\s+/g," ").trim();function Wd(e){try{const t=localStorage.getItem(e);if(!t)return[];const r=JSON.parse(t);if(Array.isArray(r))return r;if(r&&typeof r=="object"){const n=[];return Object.values(r).forEach(a=>{Array.isArray(a)&&n.push(...a)}),n}}catch{}return[]}function m7(){const e=[...Wd("nurses"),...Wd("doctors"),...Wd(vl)],t=Lc();Array.isArray(t)&&e.push(...t);const r=new Map,n=new Map,a=(s,i)=>{if(!s)return;const l=s.fullName||s.name||s.displayName||s["AD SOYAD"]||s.personName||s.title||"";if(!l||o_(l))return;const o=s.id??s.personId??s.uid??s.pid??s.tc??s.tcNo??s.code??s.employeeId??i??null,c={id:o!=null?String(o):null,name:l,title:s.title||s.unvan||s.position||s.role||s.meta&&(s.meta.title||s.meta.role)||"",service:s.service||s.unit||s.department||s.branch||s.meta&&(s.meta.service||s.meta.unit||s.meta.department)||""},u=Gu(l);if(c.id){const d=r.get(c.id);(!d||c.title&&!d.title||c.service&&!d.service)&&r.set(c.id,c)}if(u)if(!n.has(u))n.set(u,{...c});else{const d=n.get(u);c.title&&!d.title&&(d.title=c.title),c.service&&!d.service&&(d.service=c.service)}};return e.forEach((s,i)=>a(s,`tmp-${i}`)),{byId:r,byCanon:n}}function p7(){try{const e=JSON.parse(localStorage.getItem("workingHours")||"[]"),t={};return(e||[]).forEach(r=>{const n=String((r==null?void 0:r.code)||"").trim().toUpperCase();if(!n)return;let a=0;if((r==null?void 0:r.hours)!==void 0&&(r==null?void 0:r.hours)!==null&&String(r.hours).trim()!==""){const s=Number(r.hours);a=Number.isFinite(s)?s:0}else if(r!=null&&r.start&&(r!=null&&r.end)){const s=String(r.start).split(":"),i=String(r.end).split(":");if(s.length===2&&i.length===2){const l=Number(s[0])||0,o=Number(s[1])||0,c=Number(i[0])||0,u=Number(i[1])||0;let d=c*60+u-(l*60+o);Number.isFinite(d)||(d=0),d<0&&(d+=24*60),a=Math.round(d/60*100)/100}}t[n]=a}),t}catch{return{}}}const x7=(e,t="")=>{const r=String(e||"").trim().toUpperCase(),n=String(t||"").trim().toUpperCase();return r?r.includes("4")?4:r.includes("8")||r==="M"||r==="GUND"?8:r.includes("12")?12:["YARIM","HALF"].some(a=>r.includes(a))?4:(["N","GECE","V2","V1","SV","24"].some(a=>r.includes(a))||n.includes("NBET")||n.includes("SORUMLU")||n.includes("RESS")||n.includes("TRAJ")||n.includes("CERRAH"),24):n.includes("YARIM")||n.includes("4 SAAT")?4:n.includes("POL")||n.includes("GNDZ")||n.includes("KISA")?8:24},g7="outline-none text-center px-1.5 py-1 rounded-md border border-gray-300 bg-white text-[14px] md:text-sm font-semibold font-mono tabular-nums leading-tight focus:border-blue-500 focus:ring-2 focus:ring-blue-200 [appearance:textfield] [-moz-appearance:textfield]",v7="w-full outline-none px-2 py-1.5 rounded-md border border-gray-300 bg-white text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200",Gd="overtimeMatrixV3::",Uv="overtimeMatrixCfgV1",y7={department:"ACL SERVS",unitId:""},w7=(e,t)=>({id:crypto.randomUUID(),personId:"",person:"",title:"",service:"",days:Array.from({length:L0(e,t)},()=>"")}),c_=(e,t,r,n)=>{if(d7(e,t,r))return 0;const a=n.get(f7(e,t,r));return a==="full"?0:a==="arife"?4:8},S7=(e,t,r)=>{const n=new Map(r.map(i=>[i.date,i.kind])),a=L0(e,t);let s=0;for(let i=1;i<=a;i++)s+=c_(e,t,i,n);return s};function k7({year:e,month:t,leaves:r,holidays:n}){if(!(r!=null&&r.length))return 0;const a=new Map(n.map(o=>[o.date,o.kind])),s=L0(e,t),i=Array(s).fill(0),l=(o,c,u)=>{const d=new Date(o),h=new Date(c??o);for(let p=new Date(d);p<=h;p.setDate(p.getDate()+1))u(new Date(p))};for(const o of r)l(o.start,o.end,c=>{const u=c.getFullYear(),d=c.getMonth()+1,h=c.getDate();if(u!==e||d!==t)return;const p=c_(u,d,h,a);if(p===0)return;let m=0;(o.partial||"none").toLowerCase()==="none"?m=p:m=p/2;const g=h-1;i[g]=Math.min(p,i[g]+m)});return i.reduce((o,c)=>o+c,0)}const E7=_.forwardRef(function({hideToolbar:t=!1},r){const{ym:n}=_c(),{year:a,month:s}=n,[i,l]=_.useState(()=>({...y7,...JSON.parse(localStorage.getItem(Uv)||"null")||{}})),[o,c]=_.useState(()=>JSON.parse(localStorage.getItem(Gd+Zl(a,s))||"[]")),[u,d]=_.useState([]),[h,p]=_.useState([]),[m,x]=_.useState({}),[g,v]=_.useState(""),w=_.useRef(null),y=L0(a,s),k=_.useMemo(()=>p7(),[]),[C,E]=_.useState(!1);_.useEffect(()=>localStorage.setItem(Uv,JSON.stringify(i)),[i]),_.useEffect(()=>{localStorage.setItem(Gd+Zl(a,s),JSON.stringify(o))},[o,a,s]),_.useEffect(()=>{try{const W=JSON.parse(localStorage.getItem(Gd+Zl(a,s))||"[]");Array.isArray(W)&&c(W)}catch{}},[a,s]),_.useEffect(()=>{c(W=>(W||[]).map(Q=>{const H=[...Q.days||[]];H.length=y;for(let L=0;L<y;L++)typeof H[L]>"u"&&(H[L]="");return{...Q,days:H}}))},[y]),_.useEffect(()=>{(async()=>{const W=await zM({unitId:i.unitId||void 0,active:!0});d(W||[])})()},[i.unitId]),_.useEffect(()=>{(async()=>{const W=await $M({year:a,month:s});p(W||[])})()},[a,s]);const S=_.useMemo(()=>{const W=S7(a,s,h),Q=o.map(b=>{const A=(b.days||[]).reduce((O,P)=>O+(Number(P)||0),0);return{id:b.id,work:A}}),H=o.map(b=>{const A=m[b.personId]||[],O=k7({year:a,month:s,leaves:A,holidays:h});return{id:b.id,credited:O}}),L=o.map(b=>{var q,J;const A=((q=Q.find(B=>B.id===b.id))==null?void 0:q.work)||0,O=((J=H.find(B=>B.id===b.id))==null?void 0:J.credited)||0,P=Math.max(0,W-O),U=Math.max(0,A-P);return{id:b.id,work:A,credited:O,required:P,overtime:U}}),ee=L.reduce((b,A)=>b+A.work,0),te=L.reduce((b,A)=>b+A.overtime,0);return{stdMonthly:W,perRow:L,grandWork:ee,grandOT:te}},[o,a,s,h,m]),N=W=>c(Q=>Q.filter(H=>H.id!==W)),F=(W,Q,H)=>c(L=>L.map(ee=>ee.id===W?{...ee,[Q]:H}:ee)),R=(W,Q,H)=>c(L=>L.map(ee=>{if(ee.id!==W)return ee;const te=[...ee.days],b=String(H).replace(",",".");return te[Q]=b===""?"":Number(b),{...ee,days:te}})),D=()=>{confirm("Bu ayn izelgesi sfrlansn m?")&&c([])},T=_.useMemo(()=>{const W=k||{};return(Q,H="")=>{const L=String(Q||"").trim().toUpperCase();if(!L)return 0;const ee=W[L];let te=Number.isFinite(ee)?Number(ee):NaN;return(!Number.isFinite(te)||te<=0)&&(te=x7(L,H)),(!Number.isFinite(te)||te<=0)&&(te=24),te>0&&te<4&&(te=24),Math.round(te*100)/100}},[k]);async function j(){var W;if(!C){E(!0);try{const Q=["Nurse","Doctor"],H=[],L=m7(),ee=(U,q)=>{if(U!=null&&U.id&&L.byId.has(String(U.id)))return L.byId.get(String(U.id));const J=q||(U==null?void 0:U.fullName)||(U==null?void 0:U.name)||"",B=Gu(J);return B&&L.byCanon.has(B)?L.byCanon.get(B):null};for(const U of Q){const q=await kx({sectionId:"calisma-cizelgesi",serviceId:i.unitId||"",role:U,year:a,month:s}).catch(ue=>((ue==null?void 0:ue.status)!==404&&console.error("getMonthlySchedule err:",ue),null)),J=(q==null?void 0:q.data)||q||{},B=(W=J==null?void 0:J.roster)==null?void 0:W.namedAssignments;if(!B)continue;const ne=Array.isArray(J==null?void 0:J.defs)?J.defs:Array.isArray(J==null?void 0:J.rows)?J.rows:[],fe=new Map,M=new Map;ne.forEach(ue=>{const ye=String((ue==null?void 0:ue.id)??(ue==null?void 0:ue.rowId)??"");ye&&(fe.set(ye,(ue==null?void 0:ue.shiftCode)||""),M.set(ye,(ue==null?void 0:ue.label)||""))}),Object.entries(B).forEach(([ue,ye])=>{const Te=Number(ue);!Number.isFinite(Te)||Te<1||Te>y||Object.entries(ye||{}).forEach(([ve,pe])=>{const Me=Array.isArray(pe)?pe:[],Ke=fe.get(String(ve))||"",Be=M.get(String(ve))||"",Pe=T(Ke,Be);Me.forEach(Ze=>{!Ze||o_(Ze)||H.push({name:Ze,day:Te,hours:Pe,shiftCode:Ke,rowLabel:Be,role:U})})})})}if(!H.length){alert("Aktarlacak grev atamas bulunamad. nce alma izelgesi'ni doldurup kaydedin.");return}const te=new Map;(u||[]).forEach(U=>{const q=Gu(U.fullName||U.name||"");if(!q)return;const J=te.get(q)||[];J.push(U),te.set(q,J)});const b=new Map,A=(U,q,J,B)=>{if(b.has(U))return b.get(U);const ne=Array.from({length:y},()=>""),fe=(J==null?void 0:J.title)||(J==null?void 0:J.role)||"",M={id:crypto.randomUUID(),personId:(J==null?void 0:J.id)||"",person:(J==null?void 0:J.fullName)||q,title:((B==null?void 0:B.title)||fe||"").trim(),days:ne};return b.set(U,M),M};H.forEach(U=>{const q=Gu(U.name),J=q?te.get(q):null,B=Array.isArray(J)&&J.length?J[0]:null,ne=ee(B,U.name),fe=B!=null&&B.id?`id:${B.id}`:`name:${q||U.name}`,M=A(fe,U.name,B,ne);if(!M.title){const ve=ne||B||(Array.isArray(J)?J[0]:null),pe=(ve==null?void 0:ve.title)||(ve==null?void 0:ve.role)||"";M.title=(pe||M.title||"").trim()}const ue=U.day-1,ye=Number(M.days[ue])||0,Te=Number.isFinite(U.hours)?U.hours:0;Te>0&&(M.days[ue]=Math.round((ye+Te)*100)/100)});const O=Array.from(b.values()).sort((U,q)=>String(U.person||"").localeCompare(String(q.person||""),"tr",{sensitivity:"base"}));c(O);const P=Array.from(new Set(O.map(U=>U.personId).filter(U=>U&&String(U).trim()!=="")));if(P.length){const U=await Promise.all(P.map(async J=>{try{const B=await Ov({personId:J,year:a,month:s});return[J,B||[]]}catch(B){return console.error("fetchLeaves err:",B),[J,[]]}})),q={};U.forEach(([J,B])=>{q[J]=Array.isArray(B)?B:[]}),x(q)}else x({});alert(`alma izelgesinden ${H.length} atama aktarld.`)}finally{E(!1)}}}async function Z(W,Q){const H=u.find(te=>te.id===Q);c(te=>te.map(b=>b.id===W?{...b,personId:Q,person:(H==null?void 0:H.fullName)||"",title:(H==null?void 0:H.title)||"",service:(H==null?void 0:H.service)||""}:b));const L=await HM({personId:Q,year:a,month:s});c(te=>te.map(b=>{if(b.id!==W)return b;const A={...b,days:[...b.days]};for(const O of L||[]){const P=new Date(O.date).getDate();P>=1&&P<=A.days.length&&(A.days[P-1]=Number(O.hours))}return A}));const ee=await Ov({personId:Q,year:a,month:s});x(te=>({...te,[Q]:ee||[]}))}const re=()=>{const W=[i.department,...Array(y-1).fill(""),"AYLIK ALIMA SAAT (kii ba):",S.stdMonthly],Q=["Unvan","Ad Soyad",...Array.from({length:y},(te,b)=>`${b+1}`),"alma","zin(S)","Gereken","Fazla Mesai"],H=o.map(te=>{const b=S.perRow.find(A=>A.id===te.id)||{work:0,credited:0,required:0,overtime:0};return[te.title||"",te.person||"",...te.days.map(A=>A===""?"":Number(A)),Number(b.work.toFixed(2)),Number(b.credited.toFixed(2)),Number(b.required.toFixed(2)),Number(b.overtime.toFixed(2))]}),L=Ve.book_new(),ee=Ve.aoa_to_sheet([W,Q,...H]);ee["!cols"]=[{wch:16},{wch:24},{wch:16},...Array.from({length:y},()=>({wch:5})),{wch:9},{wch:9},{wch:9},{wch:10}],Ve.book_append_sheet(L,ee,`FazlaMesai-${Zl(a,s)}`),jn(L,`fazla-mesai-${Zl(a,s)}.xlsx`,{compression:!0})};return u.filter(W=>!g||W.fullName.toLowerCase().includes(g.toLowerCase())),_.useImperativeHandle(r,()=>({importFromRoster:j,exportExcel:re,reset:D})),f.jsxs("div",{className:"p-3 space-y-3",children:[!t&&f.jsx(u7,{title:"Fazla Mesai Takip Formu",leftExtras:f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl bg-gray-50 border",children:[f.jsx(TS,{size:16,className:"opacity-70"}),f.jsx("label",{className:"text-sm",children:"Birim:"}),f.jsx("input",{className:"w-48 outline-none bg-transparent",value:i.department,onChange:W=>l(Q=>({...Q,department:W.target.value}))}),f.jsx("label",{className:"text-sm ml-2",children:"UnitId:"}),f.jsx("input",{className:"w-32 outline-none bg-transparent",value:i.unitId,onChange:W=>l(Q=>({...Q,unitId:W.target.value}))})]}),f.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl border bg-white",children:[f.jsx(uC,{size:16,className:"opacity-70"}),f.jsx("input",{className:"outline-none bg-transparent",placeholder:"Personel ara",value:g,onChange:W=>v(W.target.value)})]})]}),rightExtras:f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:D,className:"flex items-center gap-1 px-3 py-1.5 rounded-xl bg-rose-600 text-white hover:bg-rose-700",children:[f.jsx(cC,{size:16})," Sfrla"]}),f.jsxs("button",{onClick:j,disabled:C,className:`flex items-center gap-1 px-3 py-1.5 rounded-xl ${C?"bg-blue-200 text-blue-700 cursor-wait":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[f.jsx(AS,{size:16}),C?"Dolduruluyor":"izelgeden Doldur"]}),f.jsxs("button",{onClick:()=>{var W;return(W=w.current)==null?void 0:W.click()},className:"flex items-center gap-1 px-3 py-1.5 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700",children:[f.jsx(dC,{size:16})," Excel Ykle"]}),f.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:()=>{}}),f.jsxs("button",{onClick:re,className:"flex items-center gap-1 px-3 py-1.5 rounded-xl bg-emerald-600 text-white hover:bg-emerald-700",children:[f.jsx(nC,{size:16})," .xlsx Da Aktar"]})]})}),f.jsxs("div",{className:"flex items-center justify-between p-3 rounded-2xl border bg-white sticky top-0 z-20",children:[f.jsx("div",{className:"text-lg font-semibold",children:i.department}),f.jsxs("div",{className:"text-sm opacity-70",children:["AYLIK ALIMA SAAT (kii ba): ",f.jsx("span",{className:"font-semibold",children:S.stdMonthly}),f.jsx("span",{className:"mx-2",children:""}),"GENEL TOPLAM ALIMA: ",f.jsx("span",{className:"font-semibold",children:S.grandWork})]})]}),f.jsx("div",{className:"rounded-2xl border overflow-auto",children:f.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-100 text-gray-700 text-sm sticky top-0 z-10",children:[f.jsx("th",{className:"p-2 text-left sticky left-0 z-20 bg-white",children:"Unvan"}),f.jsx("th",{className:"p-2 text-left sticky left-[160px] z-20 bg-white",children:"Ad Soyad"}),Array.from({length:y},(W,Q)=>f.jsx("th",{className:"p-2 text-center w-[3.5rem] md:w-[3.75rem] font-mono tabular-nums border-l border-gray-200",children:Q+1},Q)),f.jsx("th",{className:"p-2 text-right",children:"alma"}),f.jsx("th",{className:"p-2 text-right",children:"zin (S)"}),f.jsx("th",{className:"p-2 text-right",children:"Gereken"}),f.jsx("th",{className:"p-2 text-right",children:"Fazla Mesai"}),f.jsx("th",{className:"p-2 text-center w-12",children:"Sil"})]})}),f.jsx("tbody",{children:o.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:y+9,className:"p-6 text-center text-gray-500",children:"Kayt yok. Personel sein veya satr ekleyin."})}):o.map(W=>{const Q=S.perRow.find(H=>H.id===W.id)||{work:0,credited:0,required:0,overtime:0};return f.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 hover:bg-gray-100 transition-colors",children:[f.jsx("td",{className:"p-1 min-w-[160px] sticky left-0 z-10 bg-white shadow-[inset_-1px_0_0_0_rgba(0,0,0,0.06)]",children:f.jsx("input",{className:v7,value:W.title,onChange:H=>F(W.id,"title",H.target.value),placeholder:"Unvan"})}),f.jsx("td",{className:"p-1 min-w-[220px] sticky left-[160px] z-10 bg-white shadow-[inset_-1px_0_0_0_rgba(0,0,0,0.06)]",children:f.jsx(_7,{value:W.personId,people:u.filter(H=>!g||H.fullName.toLowerCase().includes(g.toLowerCase())),onChange:H=>Z(W.id,H),displayValue:W.person})}),W.days.map((H,L)=>f.jsx("td",{className:"p-1 text-center",children:f.jsx("input",{className:`${g7} h-8 md:h-9 w-[3.5rem] md:w-[3.75rem]`,value:H===""?"":H,placeholder:"-",inputMode:"decimal",onChange:ee=>R(W.id,L,ee.target.value)})},L)),f.jsx("td",{className:"p-2 text-right tabular-nums font-mono",children:Q.work.toFixed(2)}),f.jsx("td",{className:"p-2 text-right tabular-nums font-mono",children:Q.credited.toFixed(2)}),f.jsx("td",{className:"p-2 text-right tabular-nums font-mono",children:Q.required.toFixed(2)}),f.jsx("td",{className:"p-2 text-right tabular-nums font-semibold font-mono text-rose-600",children:Q.overtime.toFixed(2)}),f.jsx("td",{className:"p-2 text-center",children:f.jsx("button",{onClick:()=>N(W.id),className:"p-1.5 rounded-lg hover:bg-rose-50 text-rose-600",children:f.jsx(bp,{size:16})})})]},W.id)})})]})}),f.jsxs("div",{className:"rounded-2xl border p-3 bg-white",children:[f.jsx("div",{className:"text-sm font-medium mb-2",children:"Personel Listesi"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 max-h-64 overflow-auto",children:u.filter(W=>!g||W.fullName.toLowerCase().includes(g.toLowerCase())).map(W=>f.jsxs("button",{onClick:()=>c(Q=>[...Q,{...w7(a,s),personId:W.id,person:W.fullName,title:W.title,service:W.service}]),className:"text-left p-2 rounded-lg border hover:bg-blue-50",children:[f.jsx("div",{className:"font-medium",children:W.fullName}),f.jsxs("div",{className:"text-xs opacity-70",children:[W.title,"  ",W.service]})]},W.id))})]})]})});function _7({value:e,people:t,onChange:r,displayValue:n}){const[a,s]=_.useState(!1),[i,l]=_.useState(""),o=t.filter(c=>!i||c.fullName.toLowerCase().includes(i.toLowerCase()));return f.jsxs("div",{className:"relative",children:[f.jsx("input",{className:"w-full outline-none px-2 py-1.5 rounded-md border border-gray-300 bg-white text-sm",value:n||"",onFocus:()=>s(!0),onChange:c=>l(c.target.value),placeholder:"Ad Soyad"}),a&&f.jsx("div",{className:"absolute z-20 mt-1 w-full max-h-56 overflow-auto bg-white border rounded-md shadow",children:o.length===0?f.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Sonu yok"}):o.map(c=>f.jsxs("div",{className:"px-3 py-2 text-sm hover:bg-blue-50 cursor-pointer",onMouseDown:()=>{r(c.id),s(!1),l("")},children:[f.jsx("div",{className:"font-medium",children:c.fullName}),f.jsxs("div",{className:"text-xs opacity-70",children:[c.title,"  ",c.service]})]},c.id))})]})}const zv=["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],u_="lastLeaveCodeV1",N7=(e="Y")=>{try{return localStorage.getItem(u_)||e}catch{return e}},Yd=e=>{try{localStorage.setItem(u_,e)}catch{}},Kd=e=>String(e).padStart(2,"0"),qs=e=>(e??"").toString().trim().toLocaleUpperCase("tr"),A7=e=>qs((e==null?void 0:e.code)??(e==null?void 0:e.kisaltma)??(e==null?void 0:e.abbr)??(e==null?void 0:e.short)??(e==null?void 0:e.KISALTMA)??""),b7=e=>((e==null?void 0:e.name)??(e==null?void 0:e.turAdi)??(e==null?void 0:e.title)??(e==null?void 0:e.TUR_ADI)??(e==null?void 0:e.TR_ADI)??"").toString();function T7(e=""){return qs(e).replace(/\s+/g," ")}function f_(e){if(!e)return"";if(typeof e=="string")return qs(e);if(Array.isArray(e))return e.map(f_).filter(Boolean).join(",");if(typeof e=="object"){const t=e.code??e.type??e.kind??e.short??"";return qs(t)}return qs(e)}const C7=[{code:"Y",name:"Yllk zin"},{code:"R",name:"Rapor"},{code:"S",name:"St zni"},{code:"AN",name:"Ay Sonu Nbeti"},{code:"B",name:"Boluk stei"}];function F7({title:e,people:t=[],year:r,month:n,selectedService:a=null,serviceId:s=null,personLeaves:i,leaveTypes:l=[]}){var re;const o=Math.max(0,Math.min(11,Number(n)||0)),c=`${r}-${Kd(o+1)}`,u=zv[o]||"",d=_.useMemo(()=>new Date(r,o+1,0).getDate(),[r,o]),h=_.useMemo(()=>Array.from({length:d},(W,Q)=>Q+1),[d]),p=_.useMemo(()=>{const W=Array.isArray(l)&&l.length?l:C7,Q=new Set,H=[];for(const L of W){const ee=A7(L);!ee||Q.has(ee)||(Q.add(ee),H.push({code:ee,name:b7(L)}))}return H.sort((L,ee)=>L.code.localeCompare(ee.code,"tr",{sensitivity:"base"}))},[l]),m=_.useMemo(()=>p.map(W=>W.code),[p]),x=((re=p[0])==null?void 0:re.code)||"Y",[g,v]=_.useState(()=>{const W=N7(x);return m.includes(W)?W:x});_.useEffect(()=>{m.includes(g)||(v(x),Yd(x))},[m,x,g]);const[w,y]=_.useState(0),k=_.useMemo(()=>i||$a(),[i,w,c]);_.useEffect(()=>{const W=()=>y(Q=>Q+1);return window.addEventListener("leaves:changed",W),window.addEventListener("storage",W),()=>{window.removeEventListener("leaves:changed",W),window.removeEventListener("storage",W)}},[]);const C=_.useMemo(()=>{const W=a??s??null,Q=(t||[]).filter(L=>!W||(L==null?void 0:L.service)===W||(L==null?void 0:L.serviceId)===W),H=Fe.get("allLeavesByNameV1",{});return Q.map(L=>{var P,U;const ee=T7(L.fullName||L.name||""),te=L!=null&&L.id?String(L.id):"",b=((P=k==null?void 0:k[te])==null?void 0:P[c])||{},O={...te?{}:((U=H==null?void 0:H[ee])==null?void 0:U[c])||{},...b};return{id:String(te||ee||Math.random()),personId:te,name:L.fullName||L.name||ee,canon:ee,monthly:O}})},[t,a,s,k,c]),E=(W,Q)=>{const H=(W==null?void 0:W[`${c}-${Kd(Q)}`])??(W==null?void 0:W[Kd(Q)])??(W==null?void 0:W[String(Q)]);return f_(H)},S=(W,Q,H,L)=>{Tf({personId:W,personName:Q,year:r,month:o+1,day:H,code:L}),y(ee=>ee+1)},N=(W,Q,H)=>{Cf({personId:W,personName:Q,year:r,month:o+1,day:H}),y(L=>L+1)},F=(W,Q,H,L)=>{const ee=qs(g||x),te=qs(L||"");te&&te===ee?N(W,Q,H):S(W,Q,H,ee)},[R,D]=_.useState(null),T=_.useRef(null);_.useEffect(()=>{const W=Q=>{R!=null&&R.open&&T.current&&!T.current.contains(Q.target)&&D(null)};return window.addEventListener("mousedown",W),()=>window.removeEventListener("mousedown",W)},[R]);const j=(W,Q,H,L,ee)=>{const te=W.currentTarget.getBoundingClientRect();D({open:!0,x:Math.round(te.left+window.scrollX),y:Math.round(te.bottom+window.scrollY+4),pid:Q,name:H,day:L,current:ee||null})},Z=W=>{if(!(R!=null&&R.open))return;const Q=W||x;v(Q),Yd(Q),S(R.pid,R.name,R.day,Q),D(null)};return f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-4 relative",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"font-semibold",children:e||`Toplu zin Listesi  ${u} ${r}`}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[f.jsx("span",{children:"Varsaylan kod:"}),f.jsx("select",{value:g,onChange:W=>{v(W.target.value),Yd(W.target.value)},className:"border rounded px-2 py-1",title:"Tek tkta kullanlacak kod",children:p.map(W=>f.jsxs("option",{value:W.code,children:[W.code,W.name?`  ${W.name}`:""]},W.code))})]})]}),f.jsx("div",{className:"overflow-auto mt-3",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"text-slate-500",children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-left w-64 px-2 py-1",children:"Ad Soyad"}),h.map(W=>f.jsx("th",{className:"text-center px-1 py-1",children:W},W))]})}),f.jsxs("tbody",{children:[C.map(W=>f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"px-2 py-1 font-medium text-slate-800",children:W.name}),h.map(Q=>{const H=E(W.monthly,Q),L=!!H;return f.jsx("td",{className:`text-center px-1 py-1 cursor-pointer select-none ${L?"bg-emerald-50 hover:bg-emerald-100":"hover:bg-slate-50"}`,title:L?`zin: ${H}  Tek tk deitir/kaldr  ift tk: kaldr  Shift: tr se  Ctrl/Cmd: kaldr`:"Tek tk: ekle  Shift: tr se",onClick:ee=>{ee.shiftKey?j(ee,W.id,W.name,Q,H):ee.metaKey||ee.ctrlKey?N(W.id,W.name,Q):F(W.id,W.name,Q,H)},onDoubleClick:()=>N(W.id,W.name,Q),onContextMenu:ee=>{ee.preventDefault(),N(W.id,W.name,Q)},children:f.jsx("div",{className:`h-7 min-w-[28px] mx-auto rounded-md grid place-items-center ${L?"border border-emerald-300 text-emerald-700 font-semibold":"border border-transparent text-slate-300"}`,style:{lineHeight:1},children:L?H:""})},`${W.id}-${Q}`)})]},W.id)),C.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:1+h.length,className:"px-3 py-6 text-center text-gray-500",children:"Kii bulunamad. (Personel listesi veya filtreyi kontrol edin.)"})})]})]})}),(R==null?void 0:R.open)&&f.jsxs("div",{ref:T,style:{position:"absolute",left:R.x,top:R.y,zIndex:1e3,minWidth:220},className:"rounded-lg shadow-lg border border-slate-200 bg-white p-1",children:[f.jsxs("div",{className:"px-2 py-1 text-xs text-slate-500",children:[zv[o]," ",R.day]}),f.jsx("div",{className:"max-h-64 overflow-auto",children:p.map(W=>f.jsxs("button",{onClick:()=>Z(W.code),className:`w-full text-left px-3 py-2 rounded hover:bg-slate-100 ${R.current===W.code?"bg-emerald-50 border border-emerald-200":""}`,children:[f.jsx("span",{className:"font-medium",children:W.code}),W.name?f.jsx("span",{className:"ml-2 text-slate-500",children:W.name}):null]},W.code))}),f.jsx("div",{className:"border-t mt-1 pt-1 flex gap-1",children:f.jsx("button",{onClick:()=>D(null),className:"px-3 py-2 rounded bg-white hover:bg-slate-100 text-sm",children:"Kapat"})})]})]})}const R7={ocak:1,ubat:2,subat:2,mart:3,nisan:4,mays:5,mayis:5,haziran:6,temmuz:7,austos:8,agustos:8,eyll:9,eylul:9,ekim:10,kasm:11,kasim:11,aralk:12,aralik:12},I7={avoid:[/istemiyor/,/olm(?:asn|asin)/,/yasak/,/eitimde/,/egitimde/,/operasyon/,/rapor/,/katlamaz/,/izinsiz balamak istemiyor/],prefer:[/istiyor/,/olsun/,/talep/,/mmknse/,/muknse/,/tercih/]},D7={NOBET:[/nbet/,/nobet/],OFF:[/bo gn/,/bos gun/,/izin/,/off/]},O7=/(\d{1,2})(?:\s*[-]\s*(\d{1,2}))?\s+(ocak|ubat|subat|mart|nisan|mays|mayis|haziran|temmuz|austos|agustos|eyll|eylul|ekim|kasm|kasim|aralk|aralik)/giu;function L7(e){return(e||"").toString().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLocaleUpperCase("tr").replace(/\s+/g," ").trim()}function P7(e,t){const r=e.toLocaleLowerCase("tr");for(const[n,a]of Object.entries(I7))if(a.some(s=>s.test(r)))return n;return t==="OFF"?"prefer":"avoid"}function j7(e,t){const r=e.toLocaleLowerCase("tr");for(const[n,a]of Object.entries(D7))if(a.some(s=>s.test(r)))return n;return t==="OFF"?"OFF":t==="SHIFT"?"NOBET":null}function d_({text:e="",type:t="NOTE",date:r,defaultYear:n,defaultMonth:a}){const s=e.toLocaleLowerCase("tr"),i=P7(s,t),l=j7(s,t),o=[];let c;for(;c=O7.exec(s);){const u=Number(c[1]),d=c[2]?Number(c[2]):u,h=c[3],p=R7[h.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLocaleLowerCase("tr")];if(!Number.isFinite(u)||u<1||u>31)continue;const m=p??a,x=n??(r?new Date(r).getFullYear():new Date().getFullYear());o.push({startDay:u,endDay:d,month:m,year:x,intent:i,shift:l})}if(!o.length)if(r){const u=new Date(r);o.push({startDay:u.getDate(),endDay:u.getDate(),month:u.getMonth()+1,year:u.getFullYear(),intent:i,shift:l})}else a&&n&&o.push({startDay:null,endDay:null,month:a,year:n,intent:i,shift:l});return{intent:i,shift:l,segments:o}}const M7="requestBoxV1";function B7(e){(e.startDay==null||e.startDay<1)&&(e.startDay=1),(e.endDay==null||e.endDay<e.startDay)&&(e.endDay=e.startDay);const t=r=>Math.min(Math.max(r,1),31);return e.startDay=t(e.startDay),e.endDay=t(e.endDay),e}function U7({year:e,month1:t,strictMonth:r=!0}={}){let n=[];try{n=JSON.parse(localStorage.getItem(M7)||"[]"),Array.isArray(n)||(n=[])}catch{n=[]}const a=Number(e)||new Date().getFullYear(),s=Number(t)||new Date().getMonth()+1,i={},l=(o,c)=>{const u=o.canon;if(!u)return;const d=i[u]||(i[u]={personId:o.personId||null,personName:o.personName||null,avoid:[],prefer:[]});(c.intent==="avoid"?d.avoid:d.prefer).push(B7({startDay:c.startDay,endDay:c.endDay,month:c.month,year:c.year,shift:c.shift||null}))};for(const o of n){const c=(o==null?void 0:o.text)||"",u={personId:(o==null?void 0:o.personId)||null,personName:(o==null?void 0:o.personName)||"",canon:o!=null&&o.personName?L7(o.personName):null};let d=o==null?void 0:o.analysis;if((!d||!Array.isArray(d.segments)||!d.segments.length)&&(d=d_({text:c,type:(o==null?void 0:o.type)||"NOTE",date:(o==null?void 0:o.date)||null,defaultYear:a,defaultMonth:s})),!(!d||!d.segments))for(const h of d.segments){const p=h.year||a,m=h.month||s;r&&(p!==a||m!==s)||l(u,{intent:h.intent||d.intent,shift:h.shift||d.shift||null,startDay:h.startDay??null,endDay:h.endDay??null,month:m,year:p})}}return{byPerson:i,raw:n}}const z7=new Set(["N","V1","V2","SV"]),H7=["Pzt","Sal","ar","Per","Cum","Cmt","Paz"],$7=e=>(e||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),""),h_=e=>$7(ha(e)).replace(/\s+/g," ").trim(),ha=e=>(e??"").toString().trim().toLocaleUpperCase("tr"),V7=e=>{let t=e>>>0;return()=>{t+=1831565813;let r=Math.imul(t^t>>>15,1|t);return r^=r+Math.imul(r^r>>>7,61|r),((r^r>>>14)>>>0)/4294967296}},W7=(e,t)=>e&&e.length?e[Math.floor(t()*e.length)]:void 0,G7=(e,t)=>{const r=new Date(e,t-1,1),n=[];for(;r.getMonth()+1===t;){const a=String(r.getDate()).padStart(2,"0"),s=H7[r.getDay()===0?6:r.getDay()-1];n.push(`${a} (${s})`),r.setDate(r.getDate()+1)}return n},Y7=e=>{const t=ha(e),r={"SERVS SORUMLUSU":["SERVS SORUMLUSU"],SPERVZR:["SPERVZR","SV"],"EKP SORUMLUSU":["EKP SORUMLUSU"],RESSTASYON:["RESSTASYON"],"KIRMIZI VE SARI GREVLENDRME":["KIRMIZI","SARI"],KIRMIZI:["KIRMIZI"],SARI:["SARI"],OCUK:["OCUK"],YEL:["YEL"],ECZANE:["ECZANE"],"CERRAH MDAHELE":["CERRAH MDAHELE","CERRAH"],AI:["AI"],TRAJ:["TRAJ"]};for(const n of Object.keys(r))if(t.includes(n))return r[n];return t?[t.split(" ")[0]]:[]};function K7(e,t,r){const n=ha(r),a=Y7(t),s=[];for(const i of e){const l=ha(i["ALIMA ALANLARI"]),c=(","+ha(i["VARDYE KODLARI"]).replace(/\s+/g,"")+",").includes(","+n+","),u=a.some(d=>l.includes(d));c&&u&&s.push(i["AD SOYAD"])}if(s.length===0)for(const i of e)(","+ha(i["VARDYE KODLARI"]).replace(/\s+/g,"")+",").includes(","+n+",")&&s.push(i["AD SOYAD"]);return s}const X7=(e,t,r,n,a)=>{if(n<0)return!1;for(let s=0;s<t.length;s++)if(e[s][n]===r&&a.has(t[s].vardiya))return!0;return!1};function J7(e,t,r){const n=(r==null?void 0:r.year)??new Date().getFullYear(),a=(r==null?void 0:r.month)??new Date().getMonth()+1,s=r==null?void 0:r.supervisorName,i=r==null?void 0:r.greenWeekday,l=r==null?void 0:r.greenWeekend,o=V7((r==null?void 0:r.seed)??n*100+a),c=new Set((r==null?void 0:r.nightShiftCodes)??Array.from(z7)),u=ha(s),{byPerson:d}=U7({year:n,month1:a,strictMonth:!0}),h=q7(d,n,a),p=(t||[]).map(E=>({gorev:ha(E.GREV),vardiya:ha(E["VARDYE TP"]),count:Math.max(0,Number(E["ALIAN K SAYISI"])||0)})).filter(E=>E.count>0),m=[];let x=0;for(const E of p){E.gorev.includes("YEL")&&E.vardiya==="V1"&&(x+=E.count);for(let S=0;S<E.count;S++)m.push({gorev:E.gorev,vardiya:E.vardiya,suffix:E.count>1?`  #${S+1}`:"",weekendOnly:!1})}if(x<4)for(let E=x+1;E<=4;E++)m.push({gorev:"YEL",vardiya:"V1",suffix:`  #${E} (Hafta Sonu)`,weekendOnly:!0});const g=G7(n,a),v=["GREV SATIRI",...g],w=m.map(E=>`${E.gorev} (${E.vardiya})${E.suffix}`),y=Array.from({length:m.length},()=>Array(g.length).fill("")),k=(r==null?void 0:r.unavailableByName)instanceof Map?r.unavailableByName:null,C=k?(E,S)=>{const N=h_(E);if(!N)return!1;const F=k.get(N);return!!(F&&F.has(S))}:()=>!1;for(let E=0;E<g.length;E++){const S=E+1,N=new Date(n,a-1,S).getDay(),F=N===0||N===6,R=F?l:i;let D=0;const T=new Set;for(let j=0;j<m.length;j++){const Z=m[j];if(Z.gorev.includes("SERVS SORUMLUSU")){let Q=F?"":s;Q&&(C(Q,S)||h!=null&&h.shouldAvoid(Q,S))&&(Q=""),y[j][E]=Q,Q&&T.add(Q);continue}if(Z.weekendOnly&&!F){y[j][E]="";continue}if(Z.gorev.includes("YEL")&&Z.vardiya==="V1"&&D>=R){y[j][E]="";continue}let re=K7(e,Z.gorev,Z.vardiya).filter(Q=>!T.has(Q)).filter(Q=>ha(Q)!==u);if(c.has(Z.vardiya)&&(re=re.filter(Q=>!X7(y,m,Q,E-1,c))),k&&(re=re.filter(Q=>!C(Q,S))),h&&(re=re.filter(Q=>!h.shouldAvoid(Q,S))),re.length===0){y[j][E]="";continue}const W=W7(re,o);y[j][E]=W,T.add(W),Z.gorev.includes("YEL")&&Z.vardiya==="V1"&&D++}}return{columns:v,rows:w,table:y}}function q7(e,t,r){if(!e||typeof e!="object")return null;const n=new Map;for(const[a,s]of Object.entries(e)){const i=new Set;((s==null?void 0:s.avoid)||[]).forEach(l=>{!l||l.year!==t||l.month!==r||Z7(l).forEach(o=>i.add(o))}),i.size&&n.set(a,i)}return n.size?{shouldAvoid(a,s){const i=h_(a);if(!i)return!1;const l=n.get(i);return l?l.has(s):!1}}:null}function Z7(e){const t=[],r=Number(e.startDay)||1,n=Number(e.endDay)||r,a=s=>Math.min(Math.max(s,1),31);for(let s=a(r);s<=a(n);s++)t.push(s);return t}function Q7(e,t){const r=Fe.get("nurses",[]),a=(Fe.get("scheduleTemplateRows",Fe.get("scheduleRowsV2",[]))||[]).map(d=>({GREV:d.gorev??d.Grev??d.GREV??d.areaName??"","VARDYE TP":d.vardiya??d.Vardiya??d["VARDYE TP"]??d.shift??"","ALIAN K SAYISI":Number(d.personCount??d["Grevli Kii"]??d["ALIAN K SAYISI"]??d.count??0)})),s=CC(r,e,t),i=J7(r,a,{year:e,month:t,supervisorName:"GAMZE ZTRK TEZKN",greenWeekday:3,greenWeekend:4,seed:e*100+t,unavailableByName:s}),{columns:l,rows:o,table:c}=i,u=o.map((d,h)=>{const p={label:d};return l.slice(1).forEach((m,x)=>{p[m]=c[h][x]||""}),p});Fe.set("scheduleRowsV2",u),window.dispatchEvent(new Event("storage"))}const Hv="scheduleSections",$v="scheduleActiveSectionId",ku=[{id:"calisma-cizelgesi",name:"alma izelgesi"},{id:"aylik-calisma-ve-mesai-saatleri-cizelgesi",name:"Aylk alma ve Mesai Saatleri izelgesi"},{id:"fazla-mesai-takip",name:"Fazla Mesai Takip Formu"},{id:"toplu-izin-listesi",name:"Toplu zin Listesi"}],Xd=e=>{const t=Number(e);return Number.isFinite(t)?t>=1&&t<=12?t-1:t>=0&&t<=11?t:(Math.round(t)%12+12)%12:0};function Jd(){try{const{hash:e,search:t}=window.location;if(e&&e.startsWith("#/cizelgeler")){const n=e.split("/"),a=decodeURIComponent(n[2]||n[n.length-1]||"");return a&&a!=="cizelgeler"?a:null}const r=new URLSearchParams(t).get("sec");return r?decodeURIComponent(r):null}catch{return null}}function Vv(){try{const e=["peopleAll","people","personList","personnel","nurses","staff"],t=r=>(r||[]).map(n=>{const a=(n==null?void 0:n.id)??(n==null?void 0:n.personId)??(n==null?void 0:n.pid)??(n==null?void 0:n.tc)??(n==null?void 0:n.kod)??(n==null?void 0:n.code)??"",s=(n==null?void 0:n.fullName)||(n==null?void 0:n.name)||[n==null?void 0:n.firstName,n==null?void 0:n.lastName].filter(Boolean).join(" ");return{id:String(a||"").trim(),name:s||"",fullName:s||"",service:(n==null?void 0:n.service)||(n==null?void 0:n.serviceId)||(n==null?void 0:n.department)||null,...n}}).filter(n=>n.id);for(const r of e){const n=localStorage.getItem(r);if(!n)continue;const a=JSON.parse(n);if(Array.isArray(a))return t(a);if(a&&typeof a=="object"){if(Array.isArray(a.items))return t(a.items);const s=Object.values(a).flatMap(i=>Array.isArray(i)?i:[]);if(s.length)return t(s)}}}catch{}return[]}function Wv(){try{const e=["leaveTypesV1","leaveTypes","izinTurleri","izinTurleriV1","vacationTypes","rules"];let t=null;for(const r of e){const n=localStorage.getItem(r);if(!n)continue;const a=JSON.parse(n);if(Array.isArray(a)&&a.length){t=a;break}if(a&&typeof a=="object"){if(Array.isArray(a.leaveTypes)){t=a.leaveTypes;break}if(Array.isArray(a.izinTurleri)){t=a.izinTurleri;break}if(Array.isArray(a.vacationTypes)){t=a.vacationTypes;break}}}return t?t.map(r=>{if(typeof r=="string"){const[i,l]=r.split(/[-]/).map(u=>u.trim()),o=i!=null&&i.length?i:r.trim(),c=l!=null&&l.length?l:"";return{code:o,name:c}}const n=(r==null?void 0:r.id)??(r==null?void 0:r.code)??(r==null?void 0:r.key)??(r==null?void 0:r.type)??"",a=(r==null?void 0:r.code)??(r==null?void 0:r.id)??(r==null?void 0:r.key)??(r==null?void 0:r.type)??"",s=(r==null?void 0:r.name)??(r==null?void 0:r.title)??(r==null?void 0:r.label)??"";return{id:String(n),code:String(a).trim(),name:String(s).trim()}}).filter(r=>r.code):[]}catch{return[]}}const Gv=e=>{const t=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/g;return e.split(t).map(r=>{const n=r.trim();return n.startsWith('"')&&n.endsWith('"')?n.slice(1,-1).replace(/""/g,'"'):n})},eB=e=>{const t=(e||"").replace(/\r/g,"").split(`
`).filter(Boolean);if(!t.length)return{header:[],rows:[]};const r=Gv(t[0]).map(a=>String(a||"").trim()),n=t.slice(1).map(Gv);return{header:r,rows:n}};async function tB(e){if((e.name.split(".").pop()||"").toLowerCase()==="csv"||e.type&&e.type.includes("csv")){const u=await e.text();return eB(u)}const n=await zS(()=>Promise.resolve().then(()=>t_),[]),a=await e.arrayBuffer(),s=n.read(a,{type:"array"}),i=s.Sheets[s.SheetNames[0]],l=n.utils.sheet_to_json(i,{header:1,raw:!1,defval:""}),o=(l[0]||[]).map(u=>String(u??"").trim()),c=l.slice(1).map(u=>o.map((d,h)=>String((u&&u[h])??"").trim()));return{header:o,rows:c}}const rB=e=>{const t=String(e||"").match(/\d{1,2}/);if(!t)return NaN;const r=parseInt(t[0],10);return r>=1&&r<=31?r:NaN};function nB({sectionId:e,year:t,month:r,setYear:n,setMonth:a,peopleAll:s,allLeaves:i,leaveTypes:l,selectedServiceId:o}){const c=_.useRef(null),u=_.useRef(null),d=_.useRef(null),h=_.useRef(null),p=_.useRef(null),m=_.useCallback(()=>Q7(t,r),[t,r]),x=_.useCallback(async()=>{const S=Xd(r)+1,N=await zS(()=>Promise.resolve().then(()=>t_),void 0),F=new Date(t,S,0).getDate(),R=`${t}-${String(S).padStart(2,"0")}`,D=["personId","name",...Array.from({length:F},(re,W)=>String(W+1))],T=(Array.isArray(s)?s:[]).map(re=>{var ee;const W=String(re.id??""),Q=re.fullName||re.name||"",H=((ee=i==null?void 0:i[W])==null?void 0:ee[R])||{},L=[W,Q];for(let te=1;te<=F;te++){const b=H==null?void 0:H[String(te)],A=b?typeof b=="object"?b.code||"":String(b):"";L.push(A||"")}return L}),j=N.utils.aoa_to_sheet([D,...T]),Z=N.utils.book_new();N.utils.book_append_sheet(Z,j,`Toplu_${R}`),N.writeFile(Z,`toplu-izin-${R}.xlsx`,{bookType:"xlsx"})},[s,i,t,r]),g=_.useCallback(()=>{var E;return(E=p.current)==null?void 0:E.click()},[]),v=_.useCallback(async E=>{var R;const N=Xd(r)+1,F=(R=E.target.files)==null?void 0:R[0];if(F)try{const{header:D,rows:T}=await tB(F);if(!D.length)return alert("Dosya bo veya hatal.");const j=new Date(t,N,0).getDate(),Z=D.findIndex(te=>te.toLowerCase()==="personid"||te.toLowerCase()==="id"),re=D.findIndex(te=>["name","ad","ad soyad"].includes(te.toLowerCase())),W=[];D.forEach((te,b)=>{const A=rB(te);Number.isFinite(A)&&A>=1&&A<=j&&W.push([A,b])});const Q=new Set,H=[];for(const[te,b]of W.sort((A,O)=>A[0]-O[0]))Q.has(te)||(H.push([te,b]),Q.add(te));if(!H.length)return alert("Gn stunlar (1..31) bulunamad.");const L=Object.fromEntries((s||[]).map(te=>[(te.fullName||te.name||"").trim().toLowerCase(),te]));let ee=0;T.forEach(te=>{let b=Z>=0?String(te[Z]||"").trim():"",A=null;if(!b&&re>=0){const P=String(te[re]||"").trim().toLowerCase(),U=L[P];U!=null&&U.id&&(b=String(U.id),A=U)}else if(b&&re>=0){const P=String(te[re]||"").trim().toLowerCase();A=L[P]||A}if(!b)return;!A&&s&&(A=(s||[]).find(P=>String(P.id)===b)||null);const O=(A==null?void 0:A.fullName)||(A==null?void 0:A.name)||"";for(const[P,U]of H){const q=String(te[U]||"").trim();q?(Tf({personId:b,personName:O,year:t,month:N,day:P,code:q}),ee++):Cf({personId:b,personName:O,year:t,month:N,day:P})}}),alert(`e aktarma tamamland. Gncellenen hcre: ${ee}`);try{window.dispatchEvent(new Event("leaves:changed"))}catch{}}catch(D){console.error(D),alert("Dosya okunurken hata olutu.")}finally{E.target.value=""}},[s,r,t]),w=()=>{},y={year:t,month:r,setYear:n,setMonth:a,onAi:w,onBuild:w,onExport:w,onImport:w,onReset:w},k=_.useCallback(()=>{var S;const E=d.current;E?(E.value="",E.click()):(S=c.current)!=null&&S.importTemplate&&alert("Dosya seici alamad.")},[]),C=_.useCallback(async E=>{var N,F;const S=(N=E.target.files)==null?void 0:N[0];if(S)try{(F=c.current)!=null&&F.importTemplate?await c.current.importTemplate(S):alert("e aktarm desteklenmiyor.")}finally{E.target.value=""}},[]);switch(e){case"calisma-cizelgesi":return f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ii,{title:"alma izelgesi",...y,onAi:()=>{var E,S;return((S=(E=c.current)==null?void 0:E.ai)==null?void 0:S.call(E))??y.onAi()},onBuild:()=>{var E,S;return((S=(E=c.current)==null?void 0:E.build)==null?void 0:S.call(E))??m()},onExport:()=>{var E,S;return((S=(E=c.current)==null?void 0:E.exportExcel)==null?void 0:S.call(E))??y.onExport()},onImport:k,onReset:()=>{var E,S;return((S=(E=c.current)==null?void 0:E.reset)==null?void 0:S.call(E))??y.onReset()}}),f.jsx("input",{ref:d,type:"file",accept:".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",className:"hidden",onChange:C}),f.jsx("div",{className:"rounded-lg border bg-white p-4",children:f.jsx(ZM,{ref:c,year:t,month:r,sectionId:e,serviceId:o})})]});case"aylik-calisma-ve-mesai-saatleri-cizelgesi":return f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ii,{title:"Aylk alma ve Mesai Saatleri izelgesi",...y,onBuild:()=>{var E,S;return((S=(E=u.current)==null?void 0:E.importFromRoster)==null?void 0:S.call(E))??y.onBuild()},onExport:()=>{var E,S;return((S=(E=u.current)==null?void 0:E.exportExcel)==null?void 0:S.call(E))??y.onExport()},onImport:()=>{var E,S;return((S=(E=u.current)==null?void 0:E.importExcel)==null?void 0:S.call(E))??y.onImport()},onReset:()=>{var E,S;return((S=(E=u.current)==null?void 0:E.reset)==null?void 0:S.call(E))??y.onReset()}}),f.jsx("div",{className:"rounded-lg border bg-white p-4",children:f.jsx(o7,{ref:u,ym:{year:t,month:r},setYm:E=>{const S=Number(E==null?void 0:E.year)||t,N=Number(E==null?void 0:E.month)||r;n(S),a(N)},hideToolbar:!0})})]});case"fazla-mesai-takip":return f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ii,{title:"Fazla Mesai Takip Formu",...y,onBuild:()=>{var E,S;return((S=(E=h.current)==null?void 0:E.importFromRoster)==null?void 0:S.call(E))??y.onBuild()},onExport:()=>{var E,S;return((S=(E=h.current)==null?void 0:E.exportExcel)==null?void 0:S.call(E))??y.onExport()},onReset:()=>{var E,S;return((S=(E=h.current)==null?void 0:E.reset)==null?void 0:S.call(E))??y.onReset()}}),f.jsx("div",{className:"rounded-lg border bg-white p-4",children:f.jsx(E7,{ref:h,hideToolbar:!0})})]});case"toplu-izin-listesi":return f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ii,{title:"Toplu zin Listesi",...y,onExport:x,onImport:g}),f.jsx("input",{ref:p,type:"file",accept:".xlsx,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/csv",className:"hidden",onChange:v}),f.jsx("div",{className:"rounded-lg border bg-white p-4",children:f.jsx(F7,{people:Array.isArray(s)?s:[],year:t,month:Xd(r),personLeaves:i,selectedService:o||null,leaveTypes:l})})]});default:return f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ii,{title:`Sekme: ${e}`,...y}),f.jsx("div",{className:"rounded-lg border bg-white p-4",children:f.jsx("div",{className:"text-sm text-slate-600",children:"zel sekme ierii (placeholder)."})})]})}}function aB(){var R,D;const e=_.useMemo(()=>{const T=Fe.get(Hv,ku);return Array.isArray(T)&&T.length?T:ku},[]),[t,r]=_.useState(e);_.useEffect(()=>{const T=()=>{const j=Fe.get(Hv,ku);r(Array.isArray(j)&&j.length?j:ku)};return window.addEventListener("storage",T),window.addEventListener("scheduleSectionsChanged",T),()=>{window.removeEventListener("storage",T),window.removeEventListener("scheduleSectionsChanged",T)}},[]);const[n,a]=_.useState(()=>{var Z,re;const T=Jd(),j=Fe.get($v,((Z=e[0])==null?void 0:Z.id)||"");return T||j||((re=e[0])==null?void 0:re.id)||""});_.useMemo(()=>t.find(T=>T.id===n)||t[0],[t,n]);const[s,i]=_.useState(()=>n?[n]:[]);_.useEffect(()=>{n&&i(T=>T.includes(n)?T:[...T,n])},[n]),_.useEffect(()=>{i(T=>T.filter(j=>t.some(Z=>Z.id===j)))},[t]);const l=_.useMemo(()=>{const T=new Set(s),j=[];for(const Z of t)T.delete(Z.id)&&j.push(Z.id);return T.forEach(Z=>j.push(Z)),j},[t,s]);_.useEffect(()=>{if(n){Fe.set($v,n);try{window.location.hash=`#/cizelgeler/${encodeURIComponent(n)}`}catch{}}},[n]),_.useEffect(()=>{const T=()=>{const j=Jd();j&&a(Z=>Z===j?Z:j)};return T(),window.addEventListener("hashchange",T),window.addEventListener("popstate",T),()=>{window.removeEventListener("hashchange",T),window.removeEventListener("popstate",T)}},[]),_.useEffect(()=>{var j;Jd()||t.some(Z=>Z.id===n)||a(((j=t[0])==null?void 0:j.id)||"")},[t,n]);const{ym:o,setYear:c,setMonth:u}=_c(),{year:d,month:h}=o,[p,m]=_.useState(()=>Vv());_.useEffect(()=>{const T=()=>m(Vv()),j=Z=>{(!Z||["peopleAll","people","personList","personnel","nurses","staff"].includes(Z.key))&&T()};return window.addEventListener("storage",j),window.addEventListener("people:changed",T),()=>{window.removeEventListener("storage",j),window.removeEventListener("people:changed",T)}},[]);const[x,g]=_.useState(()=>$a());_.useEffect(()=>{const T=()=>g($a());return window.addEventListener("leaves:changed",T),()=>window.removeEventListener("leaves:changed",T)},[]);const[v,w]=_.useState(()=>Wv());_.useEffect(()=>{const T=()=>w(Wv());return window.addEventListener("storage",T),window.addEventListener("leaveTypes:changed",T),()=>{window.removeEventListener("storage",T),window.removeEventListener("leaveTypes:changed",T)}},[]);const y=_.useCallback(T=>{a(T);try{window.location.hash=`#/cizelgeler/${encodeURIComponent(T)}`}catch{}},[]),k=FS(),[C,E]=_.useState(k.defaultServiceId),S=_.useCallback(T=>String((T==null?void 0:T.service)??(T==null?void 0:T.serviceId)??(T==null?void 0:T.department)??(T==null?void 0:T.departmentId)??(T==null?void 0:T.sectionId)??""),[]),N=_.useMemo(()=>{const T=Array.isArray(p)?p:[];if(k.isAdmin)return C?T.filter(Z=>S(Z)===String(C)):T;const j=new Set(k.allowedIds.map(String));return T.filter(Z=>j.has(S(Z)))},[p,k.isAdmin,k.allowedIds,C,S]),F=k.isAdmin?C||"":k.defaultServiceId;return f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsx("div",{className:"flex flex-wrap items-center gap-3",children:f.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pr-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:t.map(T=>f.jsx("button",{onClick:()=>y(T.id),title:T.id,className:`shrink-0 rounded-full border px-4 h-10 text-sm ${T.id===n?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50"}`,children:T.name},T.id))})}),f.jsx("div",{className:"flex items-center gap-2",children:k.isAdmin?f.jsxs(f.Fragment,{children:[f.jsx("label",{className:"text-sm text-slate-600",children:"Servis:"}),f.jsxs("select",{className:"h-9 px-2 rounded-lg border",value:C,onChange:T=>E(T.target.value),children:[f.jsx("option",{value:"",children:"Tm"}),(k.allowedIds||[]).map(T=>{const j=k.servicesById.get(String(T)),Z=(j==null?void 0:j.name)||(j==null?void 0:j.code)||T;return f.jsx("option",{value:T,children:Z},T)})]})]}):f.jsxs("span",{className:"text-xs px-2 py-1 rounded-lg bg-slate-100 text-slate-700",children:["Servis:",((R=k.servicesById.get(k.defaultServiceId))==null?void 0:R.name)||((D=k.servicesById.get(k.defaultServiceId))==null?void 0:D.code)||k.defaultServiceId||"-"]})}),f.jsx("div",{children:l.map(T=>{const j=t.find(re=>re.id===T);if(!j)return null;const Z=T===n;return f.jsx("div",{className:Z?"":"hidden",hidden:!Z,"aria-hidden":Z?"false":"true",children:f.jsx(nB,{sectionId:j.id,year:d,month:h,setYear:c,setMonth:u,peopleAll:N,allLeaves:x,leaveTypes:v,selectedServiceId:F})},T)})})]})}const Yv="workAreasV1",Ql=e=>(e||"").toString().trim().toLocaleUpperCase("tr-TR");function sB(){const[e,t]=_.useState(()=>{try{const v=localStorage.getItem(Yv);return v?JSON.parse(v):["AI","CERRAH MDAHELE","OCUK","ECZANE","EKP SORUMLUSU","KIRMIZI","KIRMIZI VE SARI ALAN GREVLENDRME","RESSTASYON","SARI","SERVS SORUMLUSU","SPERVZR","TRAJ","YEL"]}catch{return[]}}),[r,n]=_.useState(""),[a,s]=_.useState(null),[i,l]=_.useState(""),o=_.useRef(null);_.useEffect(()=>{try{localStorage.setItem(Yv,JSON.stringify(e))}catch{}},[e]);const c=()=>{const v=r.trim();if(!v)return alert("Alan ad bo olamaz.");if(e.some(w=>Ql(w)===Ql(v)))return alert("Bu alan zaten var.");t(w=>[...w,v]),n("")},u=v=>{a===v&&p(),t(w=>w.filter((y,k)=>k!==v))},d=v=>{s(v),l(e[v])},h=()=>{const v=i.trim();if(!v)return alert("Alan ad bo olamaz.");if(e.some((w,y)=>y!==a&&Ql(w)===Ql(v)))return alert("Bu ad zaten mevcut.");t(w=>w.map((y,k)=>k===a?v:y)),p()},p=()=>{s(null),l("")},m=()=>{confirm("Tm alanlar sfrlamak istiyor musunuz?")&&(p(),t([]))},x=()=>{const v=e.map(k=>({ALAN:k})),w=Ve.json_to_sheet(v),y=Ve.book_new();Ve.book_append_sheet(y,w,"CalismaAlanlari"),jn(y,"calisma_alanlari.xlsx")},g=v=>{var k;const w=(k=v.target.files)==null?void 0:k[0];if(!w)return;const y=new FileReader;y.onload=C=>{try{const E=fn(C.target.result,{type:"binary"}),S=E.Sheets.CalismaAlanlari??E.Sheets[E.SheetNames[0]],F=Ve.sheet_to_json(S,{defval:""}).map(T=>T.ALAN??T.alan??T.Alan??Object.values(T)[0]).map(String).map(T=>T.trim()).filter(Boolean),R=[],D=new Set;for(const T of F){const j=Ql(T);j&&j!=="ALAN"&&!D.has(j)&&(D.add(j),R.push(T))}p(),t(R),alert("Excel'den ykleme tamam.")}catch(E){console.error(E),alert("Excel yklenemedi. (Beklenen sayfa: CalismaAlanlari, balk: ALAN)")}finally{v.target.value=""}},y.readAsBinaryString(w)};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-end gap-2",children:[f.jsx("button",{type:"button",className:"px-3 py-2 text-sm border rounded",onClick:x,children:"Excele Aktar"}),f.jsxs("label",{className:"px-3 py-2 text-sm border rounded cursor-pointer",children:["Excelden Ykle",f.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:g})]}),f.jsx("button",{type:"button",className:"px-3 py-2 text-sm border rounded text-red-600",onClick:m,children:"Alanlar Sfrla"})]}),f.jsx("h3",{className:"font-medium",children:"alma Alanlar"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm mb-2 text-gray-500",children:"Mevcut Alanlar"}),f.jsxs("ol",{className:"space-y-1",children:[e.map((v,w)=>f.jsxs("li",{className:"flex items-center justify-between px-3 py-2 rounded border bg-white",children:[f.jsx("div",{className:"flex-1 min-w-0",children:a===w?f.jsx("input",{className:"w-full px-2 py-1 border rounded",value:i,onChange:y=>l(y.target.value),autoFocus:!0}):f.jsxs("span",{className:"truncate",children:[f.jsxs("b",{children:[w+1,"."]})," ",v]})}),f.jsx("div",{className:"flex items-center gap-2 ml-3",children:a===w?f.jsxs(f.Fragment,{children:[f.jsx("button",{type:"button",className:"text-sm px-2 py-1 border rounded",onClick:h,children:"Kaydet"}),f.jsx("button",{type:"button",className:"text-sm px-2 py-1 border rounded",onClick:p,children:"ptal"})]}):f.jsxs(f.Fragment,{children:[f.jsx("button",{type:"button",className:"text-sm px-2 py-1 border rounded",onClick:()=>d(w),children:"Dzenle"}),f.jsx("button",{type:"button",className:"text-sm px-2 py-1 border rounded",onClick:()=>u(w),children:"Sil"})]})})]},v+w)),e.length===0&&f.jsx("li",{className:"text-sm text-gray-500",children:"Henz alan yok."})]})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-sm mb-2 text-gray-500",children:"Ekle"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{className:"px-3 py-2 border rounded w-full",value:r,onChange:v=>n(v.target.value),placeholder:""}),f.jsx("button",{type:"button",className:"px-3 py-2 text-sm border rounded",onClick:c,children:"Ekle"})]}),f.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Not: Excel ie/da aktarma iin balk ",f.jsx("b",{children:"ALAN"})," kullanlr. lk stun deerleri alan ad olarak okunur."]})]})]})]})}const Gf=(e,t)=>[...e].sort((r,n)=>((r==null?void 0:r[t])||"").toString().localeCompare(((n==null?void 0:n[t])||"").toString(),"tr",{sensitivity:"base"})),Yu="workingHoursV2";function iB(e,t){const r=typeof t=="function"&&Array.isArray(e),[n,a]=_.useState(()=>{if(r)return[];try{const l=localStorage.getItem(Yu);return l?JSON.parse(l):[]}catch{return[]}}),s=l=>{r?t(o=>{const c=typeof l=="function"?l(o??[]):l;return Gf(c??[],"code")}):a(o=>{const u=typeof l=="function"?l(o??[]):l,d=Gf(u??[],"code");try{localStorage.setItem(Yu,JSON.stringify(d))}catch{}return d})},i=r?e??[]:n??[];return _.useEffect(()=>{if(!r)try{localStorage.setItem(Yu,JSON.stringify(i??[]))}catch{}},[r,i]),[i,s,r]}function lB({workingHours:e,setWorkingHours:t}){const[r,n,a]=iB(e,t),s={id:void 0,code:"",start:"08:00",end:"17:00"},[i,l]=_.useState(s),[o,c]=_.useState(null),u=_.useRef(null);_.useEffect(()=>{o||l(s)},[o]);const d=()=>{l(s),c(null)},h=y=>{if(y.preventDefault(),!i.code.trim())return;const k=(i.start||"").slice(0,5),C=(i.end||"").slice(0,5);if(k===C)alert("Uyar: Balang ve biti ayn. Bu vardiya 24 saat olarak kabul edilecek.");else{const[N,F]=k.split(":").map(Number),[R,D]=C.split(":").map(Number),T=N%24*60+F%60;R%24*60+D%60<T&&console.info("Bilgi: Bu vardiya gece devrediyor (ertesi gne tayor).")}const E=o??Date.now(),S={...i,id:E,code:i.code.trim(),start:k,end:C};n(N=>{const R=(Array.isArray(N)?N:[]).filter(D=>D.id!==E);return Gf([...R,S],"code")}),d()},p=y=>{c(y.id),l({id:y.id,code:y.code||"",start:(y.start||"08:00").slice(0,5),end:(y.end||"17:00").slice(0,5)})},m=y=>{n(k=>(k||[]).filter(C=>C.id!==y))},x=()=>{if(window.confirm(`Tm vardiya tanmlar silinsin mi?
Bu ilem geri alnamaz.`)&&(n([]),!a))try{localStorage.removeItem(Yu)}catch{}},g=()=>{const y=Ve.aoa_to_sheet([["KOD","BALANGI","BT","SRE"],...(r??[]).map(C=>[C.code,(C.start||"").slice(0,5),(C.end||"").slice(0,5),Nd(C.start,C.end)])]),k=Ve.book_new();Ve.book_append_sheet(k,y,"Vardiyalar"),jn(k,"calisma_saatleri.xlsx")},v=y=>{var E;const k=(E=y.target.files)==null?void 0:E[0];if(!k)return;const C=new FileReader;C.onload=S=>{const N=new Uint8Array(S.target.result),F=fn(N,{type:"array"}),R=F.Sheets.Vardiyalar??F.Sheets[F.SheetNames[0]],T=Ve.sheet_to_json(R,{defval:""}).map((j,Z)=>{const re=(j.KOD||j["VARDYE KODU"]||j["VARDIYE KODU"]||"").toString().trim(),W=(j.BALANGI||j.BASLANGIC||j.START||"08:00").toString().slice(0,5),Q=(j.BT||j.BITIS||j.END||"17:00").toString().slice(0,5);return re?{id:Date.now()+Z,code:re,start:W,end:Q}:null}).filter(Boolean);if(!T.length){alert("Excel balklar: KOD, BALANGI, BT");return}n(j=>Gf([...j??[],...T],"code")),u.current&&(u.current.value=""),alert(T.length+" kayt yklendi")},C.readAsArrayBuffer(k)},w=_.useMemo(()=>Nd(i.start,i.end),[i.start,i.end]);return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-end gap-2",children:[f.jsx("button",{type:"button",className:"px-3 py-2 text-sm border rounded",onClick:g,children:"Excele Aktar"}),f.jsxs("label",{className:"px-3 py-2 text-sm border rounded cursor-pointer",children:["Excelden Ykle",f.jsx("input",{ref:u,type:"file",accept:".xls,.xlsx",className:"hidden",onChange:v})]}),f.jsx("button",{type:"button",className:"px-3 py-2 text-sm border rounded text-red-600",onClick:x,children:"Vardiyeleri Sfrla"})]}),f.jsx("h3",{className:"font-medium",children:"alma Saatleri"}),f.jsxs("form",{onSubmit:h,className:"bg-white rounded-2xl shadow-sm p-4 grid md:grid-cols-5 gap-3 items-end",children:[f.jsx("input",{value:i.code,onChange:y=>l(k=>({...k,code:y.target.value})),placeholder:"",className:"px-3 py-2 border rounded"}),f.jsx("input",{type:"time",value:i.start,onChange:y=>l(k=>({...k,start:y.target.value.slice(0,5)})),className:"px-3 py-2 border rounded",title:"Balang (rn. 08:00)"}),f.jsx("input",{type:"time",value:i.end,onChange:y=>l(k=>({...k,end:y.target.value.slice(0,5)})),className:"px-3 py-2 border rounded",title:"Biti (rn. 17:00)"}),f.jsxs("div",{className:"text-sm text-slate-500 self-center",children:["Sre: ",w," saat"]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{type:"submit",className:"px-3 py-2 text-sm border rounded bg-emerald-600 text-white",children:o?"Gncelle":"Ekle"}),o&&f.jsx("button",{type:"button",onClick:d,className:"px-3 py-2 text-sm border rounded bg-slate-100",children:"ptal"})]})]}),f.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-4 overflow-x-auto",children:f.jsxs("table",{className:"w-full table-fixed text-sm",children:[f.jsxs("colgroup",{children:[f.jsx("col",{className:"w-28"}),f.jsx("col",{className:"w-28"}),f.jsx("col",{className:"w-28"}),f.jsx("col",{className:"w-28"}),f.jsx("col",{})]}),f.jsx("thead",{className:"text-slate-500",children:f.jsxs("tr",{className:"border-b",children:[f.jsx("th",{className:"px-3 py-2 text-left",children:"Kod"}),f.jsx("th",{className:"px-3 py-2 text-center",children:"Balang"}),f.jsx("th",{className:"px-3 py-2 text-center",children:"Biti"}),f.jsx("th",{className:"px-3 py-2 text-center",children:"Sre (saat)"}),f.jsx("th",{className:"px-3 py-2 text-right",children:"lem"})]})}),f.jsxs("tbody",{children:[(!r||r.length===0)&&f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-slate-400",children:"Henz kayt yok."})}),(r??[]).map(y=>f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"px-3 py-2",children:y.code}),f.jsx("td",{className:"px-3 py-2 text-center font-mono tabular-nums",children:(y.start||"").slice(0,5)}),f.jsx("td",{className:"px-3 py-2 text-center font-mono tabular-nums",children:(y.end||"").slice(0,5)}),f.jsx("td",{className:"px-3 py-2 text-center font-mono tabular-nums",children:Nd(y.start,y.end)}),f.jsx("td",{className:"px-3 py-2 text-right",children:f.jsxs("div",{className:"inline-flex gap-1",children:[f.jsx("button",{onClick:()=>p(y),className:"px-2 py-1 text-xs border rounded bg-slate-100",children:"Dzenle"}),f.jsx("button",{onClick:()=>m(y.id),className:"px-2 py-1 text-xs border rounded bg-slate-100",children:"Sil"})]})})]},y.id))]})]})})]})}const Ku="leaveTypesV2",Xu=["leaveTypes","izinTurleri"],ca=e=>(e??"").toString().trim().toLocaleUpperCase("tr"),Ri=e=>(e??"").toString().trim(),Eu=()=>{try{return crypto.randomUUID()}catch{return String(Date.now())+Math.random().toString(36).slice(2,8)}};function vm(e){return[...e||[]].sort((t,r)=>((t==null?void 0:t.code)||"").localeCompare((r==null?void 0:r.code)||"","tr",{sensitivity:"base"}))}function Kv(e){const t=new Map;for(const r of e||[]){const n=ca(r.code);if(n)if(!t.has(n))t.set(n,{...r,code:ca(r.code)});else{const a=t.get(n);t.set(n,{...a,...r,code:ca(r.code)})}}return Array.from(t.values())}function oB(e,t){const r=typeof t=="function"&&Array.isArray(e),n=()=>{try{const c=localStorage.getItem(Ku),u=c?JSON.parse(c):[];return Array.isArray(u)?u:[]}catch{return[]}},[a,s]=_.useState(()=>r?[]:n()),i=c=>{try{localStorage.setItem(Ku,JSON.stringify(c)),localStorage.setItem(Xu[0],JSON.stringify({leaveTypes:c})),localStorage.setItem(Xu[1],JSON.stringify(c)),window.dispatchEvent(new Event("leaveTypes:changed"))}catch{}},l=c=>{r?t(u=>{const d=Array.isArray(u)?u:[],h=typeof c=="function"?c(d):c,p=vm(Kv(h||[]));try{window.dispatchEvent(new Event("leaveTypes:changed"))}catch{}return p}):s(u=>{const d=Array.isArray(u)?u:[],h=typeof c=="function"?c(d):c,p=vm(Kv(h||[]));return i(p),p})};return _.useEffect(()=>{if(r)return;const c=u=>{u&&[Ku,...Xu].includes(u.key)&&s(n())};return window.addEventListener("storage",c),window.addEventListener("leaveTypes:changed",()=>s(n())),()=>{window.removeEventListener("storage",c),window.removeEventListener("leaveTypes:changed",()=>s(n()))}},[r]),[r?e??[]:a??[],l,r]}function cB({leaveTypes:e,setLeaveTypes:t}){const[r,n,a]=oB(e,t),[s,i]=_.useState({id:void 0,code:"",name:""}),[l,o]=_.useState(null),c=_.useRef(null),u=()=>{i({id:void 0,code:"",name:""}),o(null)},d=w=>{var S;(S=w==null?void 0:w.preventDefault)==null||S.call(w);const y=ca(s.code),k=Ri(s.name);if(!y||!k)return;const C=l??Eu(),E={id:C,code:y,name:k};n(N=>{const F=Array.isArray(N)?N:[],R=ca(y);return F.find(j=>ca(j.code)===R&&j.id!==C)?(alert("Ayn ksaltma zaten mevcut."),F):[...F.filter(j=>j.id!==C),E]}),u()},h=w=>{o(w.id),i({id:w.id,code:w.code||"",name:w.name||""})},p=w=>{n(y=>(y||[]).filter(k=>k.id!==w)),l===w&&u()},m=()=>{const w=["KOD","AD"],y=(r||[]).map(E=>[E.code,E.name]),k=Ve.aoa_to_sheet([w,...y]),C=Ve.book_new();Ve.book_append_sheet(C,k,"IzinTurleri"),jn(C,"izin_turleri.xlsx")},x=w=>{const y=(w||"").replace(/\r/g,"").split(`
`).filter(Boolean);if(!y.length)return[];const k=y[0].split(",").map(N=>N.trim().toLowerCase()),C=k.indexOf("kod")>=0?k.indexOf("kod"):0,E=k.indexOf("ad")>=0?k.indexOf("ad"):1;return y.slice(1).map(N=>N.split(",")).map(N=>({id:Eu(),code:ca(N[C]??""),name:Ri(N[E]??"")})).filter(N=>N.code&&N.name)},g=async w=>{var k;const y=(k=w.target.files)==null?void 0:k[0];if(y)try{const C=(y.name.split(".").pop()||"").toLowerCase();let E=[];if(C==="csv"||y.type&&y.type.includes("csv")){const F=await y.text();E=x(F)}else{const F=new Uint8Array(await y.arrayBuffer()),R=fn(F,{type:"array"}),D=R.Sheets.IzinTurleri??R.Sheets[R.SheetNames[0]],T=Ve.sheet_to_json(D,{header:1,defval:""});let j=1;if(T.length&&T[0].length){const Z=T[0].map(re=>Ri(re).toLowerCase());Z.includes("kod")&&Z.includes("ad")||(j=0)}E=T.slice(j).map(Z=>({id:Eu(),code:ca(Z[0]),name:Ri(Z[1])})).filter(Z=>Z.code&&Z.name)}if(!E.length){alert("ablon: 'KOD, AD' (ilk iki stun).");return}let S=0,N=0;n(F=>{const R=Array.isArray(F)?F:[],D=new Map(R.map(T=>[ca(T.code),T]));for(const T of E){const j=ca(T.code);if(D.has(j)){const Z=D.get(j);Ri(Z.name)!==Ri(T.name)&&(D.set(j,{...Z,name:T.name}),N++)}else D.set(j,{id:Eu(),code:j,name:T.name}),S++}return vm(Array.from(D.values()))}),alert(`${S} eklendi, ${N} gncellendi.`)}catch(C){console.error(C),alert("Dosya yklenirken hata olutu.")}finally{c.current&&(c.current.value="")}},v=()=>{if(window.confirm("Tm izin trleri silinsin mi?")){if(n([]),!a)try{localStorage.removeItem(Ku);for(const y of Xu)localStorage.removeItem(y);window.dispatchEvent(new Event("leaveTypes:changed"))}catch{}u()}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-end gap-2",children:[f.jsx("button",{onClick:m,className:"px-3 py-2 text-sm border rounded",children:"Excele Aktar"}),f.jsxs("label",{className:"px-3 py-2 text-sm border rounded cursor-pointer",children:["Excel/CSV'den Ykle",f.jsx("input",{ref:c,type:"file",accept:".xls,.xlsx,.csv,text/csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",className:"hidden",onChange:g})]}),f.jsx("button",{type:"button",onClick:v,className:"px-3 py-2 text-sm border rounded text-red-600",children:"zin Trlerini Sfrla"})]}),f.jsx("h3",{className:"font-medium",children:"zin Trleri"}),f.jsxs("form",{onSubmit:d,className:"bg-white rounded-2xl shadow-sm p-4 grid md:grid-cols-4 gap-3 items-end",children:[f.jsx("input",{value:s.code,onChange:w=>i(y=>({...y,code:w.target.value})),className:"w-full border rounded p-2 font-mono",placeholder:"Ksaltma (rn: R, , , S, AN...)"}),f.jsx("input",{value:s.name,onChange:w=>i(y=>({...y,name:w.target.value})),className:"md:col-span-2 w-full border rounded p-2",placeholder:"Tr ad (rn: Rapor, zin, cretsiz zin, S... )"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{type:"submit",className:"px-3 py-2 text-sm border rounded bg-emerald-600 text-white",children:l?"Gncelle":"Ekle"}),l&&f.jsx("button",{type:"button",onClick:u,className:"px-3 py-2 text-sm border rounded bg-slate-100",children:"ptal"})]})]}),f.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-4 overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"text-slate-500",children:f.jsxs("tr",{className:"border-b",children:[f.jsx("th",{className:"py-2 pr-2 text-left",children:"Ksaltma"}),f.jsx("th",{className:"py-2 pr-2 text-left",children:"Tr Ad"}),f.jsx("th",{className:"py-2 pr-2 text-right",children:"lem"})]})}),f.jsxs("tbody",{children:[(!r||r.length===0)&&f.jsx("tr",{children:f.jsx("td",{colSpan:3,className:"py-6 text-center text-slate-400",children:"Henz izin tr yok."})}),(r??[]).map(w=>f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"py-2 pr-2 font-mono",children:w.code}),f.jsx("td",{className:"py-2 pr-2",children:w.name}),f.jsxs("td",{className:"py-2 pr-2 text-right",children:[f.jsx("button",{onClick:()=>h(w),className:"text-xs px-2 py-1 border rounded bg-slate-100",children:"Dzenle"}),f.jsx("button",{onClick:()=>p(w.id),className:"text-xs px-2 py-1 border rounded bg-slate-100 ml-1",children:"Sil"})]})]},w.id))]})]})})]})}const qd="dutyRulesV2",ym=()=>crypto!=null&&crypto.randomUUID?crypto.randomUUID():String(Date.now())+Math.random().toString(36).slice(2,8),m_=e=>typeof e=="boolean"?e:["1","true","evet","aktif","yes"].includes(String(e).trim().toLowerCase()),Ju=(e="")=>e.replace(/_/g," ").toLowerCase().replace(/^\w/,t=>t.toUpperCase());function Yf(e=[]){return[...(e||[]).map((r,n)=>({...r,order:typeof r.order=="number"?r.order:n,enabled:typeof r.enabled=="boolean"?r.enabled:!0,name:typeof r.name=="string"?r.name:r.id}))].sort((r,n)=>r.order-n.order)}function uB(e,t){const r=typeof t=="function"&&Array.isArray(e),[n,a]=_.useState(()=>{if(r)return[];try{const l=localStorage.getItem(qd);return l?JSON.parse(l):[]}catch{return[]}}),s=l=>{r?t(o=>Yf(typeof l=="function"?l(o||[]):l)):a(o=>{const c=Yf(typeof l=="function"?l(o||[]):l);try{localStorage.setItem(qd,JSON.stringify(c))}catch{}return c})},i=r?e??[]:n??[];return _.useEffect(()=>{if(!r)try{localStorage.setItem(qd,JSON.stringify(i??[]))}catch{}},[r,i]),[i,s,r]}const be={HARD:1,HIGH:2,MED:3,LOW:4},_u=[{id:"personel",label:"Personel & Yetkinlik"},{id:"kadro",label:"Kadro & Vardiya"},{id:"sure",label:"Sre & Dinlenme"},{id:"izin",label:"zin/Rapor"},{id:"adalet",label:"Gece/Tatil Adaleti"},{id:"cakisma",label:"akma/Saat"},{id:"tercih",label:"Tercih & Mazeret"},{id:"kidem",label:"Kdem & Unvan"}],_n={QUAL_ONLY_IN_SPECIALTY:{cat:"personel",level:be.HARD,desc:"Kii yalnzca kendi uzmanlk/unvanna uygun grevlerde alr."},CERT_REQUIRED_FOR_CRITICAL:{cat:"personel",level:be.HARD,desc:"Kritik grevler sadece gerekli sertifikal personele atanr."},TRIAGE_NURSES_ONLY:{cat:"personel",level:be.HARD,desc:"Triaj grevi yalnzca hemirelere atanr."},RESUS_MIN_TWO:{cat:"kadro",level:be.HARD,desc:"Ressitasyon alannda her vardiyada en az 2 salk personeli bulunur.",suggestedParams:{min:2}},RED_YELLOW_CHILD_MIN1:{cat:"kadro",level:be.HARD,desc:"Krmz, Sar ve ocuk alanlarnda her vardiyada en az 1 kii bulunur."},GREEN_MIN_STAFF:{cat:"kadro",level:be.HARD,desc:"Yeil alanda min. kadro: hafta ii 3, hafta sonu 4."},PHARMACY_ONE_PER_24H:{cat:"kadro",level:be.HARD,desc:"Eczaneye her 24 saatte 1 personel atanr."},SERVICE_LEAD_WEEKDAY_DAY:{cat:"kadro",level:be.HARD,desc:"Servis sorumlusu yalnz hafta ii gndz vardiyalarnda yazlr."},SUPERVISOR_UNUSED:{cat:"kadro",level:be.LOW,desc:"Spervizr vardiyas tanml fakat kullanlmyor."},RED_YELLOW_TEAMLEAD_ONE:{cat:"kadro",level:be.HARD,desc:"Krmz/Sar ekip sorumlusu her nbette 1 kii olur."},SURGERY_ROOM_MIN2:{cat:"kadro",level:be.HARD,desc:"Cerrahi mdahale odasnda her nbette 2 personel bulunur."},VACCINATION_UNUSED:{cat:"kadro",level:be.LOW,desc:"A uygulama nbeti tanml fakat kullanlmyor."},ROTATION_APPLIES:{cat:"personel",level:be.MED,desc:"Grev yerleri rotasyonla datlr."},NO_UNQUALIFIED_ASSIGN:{cat:"personel",level:be.HARD,desc:"Yetkin olmad alana atama yaplmaz."},SUPPORT_ROLES_OPTIONAL:{cat:"kadro",level:be.LOW,desc:"Destek rolleri ihtiya halinde tanmlanabilir."},WEEKLY_MAX_80H:{cat:"sure",level:be.HARD,desc:"Haftalk toplam alma saati st snr 80 saattir.",suggestedParams:{max:80}},DAILY_MAX_24H:{cat:"sure",level:be.HARD,desc:"Bir gnde toplam alma 24 saati geemez.",suggestedParams:{max:24}},MAX_CONSECUTIVE_6D:{cat:"sure",level:be.HARD,desc:"Maksimum ardk alma 6 gndr.",suggestedParams:{maxDays:6}},WEEKLY_MIN_1_OFF:{cat:"sure",level:be.HARD,desc:"Her hafta en az 1 gn kesintisiz tatil olmaldr.",suggestedParams:{minOffDays:1}},MIN_REST_11H:{cat:"sure",level:be.HARD,desc:"Vardiyalar arasnda en az 11 saat dinlenme olmaldr.",suggestedParams:{minHours:11}},OVERTIME_MINIMIZE:{cat:"sure",level:be.HIGH,desc:"Fazla mesai yaplabilir ama minimumda tutulur."},MONTHLY_TARGET_CALC:{cat:"sure",level:be.MED,desc:"Aylk hedef saat = (resmi i gn  8) olarak planlanr."},ONE_SHIFT_PER_DAY:{cat:"cakisma",level:be.HARD,desc:"Bir personele bir gnde yalnzca 1 vardiya atanr."},LONG_SHIFTS_MAX2_PER_WEEK:{cat:"sure",level:be.HIGH,desc:"16/24 saatlik uzun nbetler haftada en fazla 2 kez verilir.",suggestedParams:{maxPerWeek:2}},NIGHT_7_5H_NORM_INFO:{cat:"sure",level:be.LOW,desc:"Gece alma normu 7.5 saattir (salk sektr istisna olabilir)."},LEAVE_BLOCK_AN_FIRSTDAY:{cat:"izin",level:be.HARD,desc:"AN kodu olan personele yeni ayn ilk gn nbet yazlmaz."},LEAVE_BLOCK_GENERIC:{cat:"izin",level:be.HARD,desc:"zin/rapor kodlu gnlere atama yaplmaz; bazlar allm saylr. (B, D, E, E, G, U, H, R, RE, S, S, , , , Y vb.)"},NIGHT_FAIR_DISTRIBUTION:{cat:"adalet",level:be.HIGH,desc:"Gece nbetleri personel arasnda adil datlr."},NO_CONSEC_NIGHTS:{cat:"sure",level:be.HARD,desc:"Arka arkaya iki gece nbeti yazlmaz."},WEEKEND_NIGHTS_FAIR:{cat:"adalet",level:be.HIGH,desc:"Hafta sonu gece nbetleri adil paylalr."},NIGHT_BALANCE_MONTH_YEAR:{cat:"adalet",level:be.MED,desc:"Gece nbet saylar aylk/yllk dengelenir."},AN_CONSIDER_FOR_NIGHTS:{cat:"adalet",level:be.MED,desc:"AN kodu olanlar yeni ayda gece dalmnda dikkate alnr."},EQUAL_NIGHTS_EXCEPT_EXEMPT:{cat:"adalet",level:be.MED,desc:"Muaf/kdem zel durumlar dnda herkes eit sklkta geceye girer."},VOLUNTEERS_MORE_NIGHTS_IF_FAIR:{cat:"adalet",level:be.LOW,desc:"Gnll olanlara daha fazla gece verilebilir; adalet korunur."},HOLIDAY_EQUAL:{cat:"adalet",level:be.HIGH,desc:"Resmi/dini bayram nbetleri eit datlr."},HOLIDAY_SIMILAR_COUNT_YEAR:{cat:"adalet",level:be.MED,desc:"Yl genelinde herkese benzer sayda tatil nbeti der."},HOLIDAY_RESPECT_PREFS:{cat:"tercih",level:be.MED,desc:"Tatil gnlerinde tercihlere mmkn olduunca uyulur."},HOLIDAY_NO_CONSEC_ALL_DAYS:{cat:"adalet",level:be.HIGH,desc:"Bir bayramn tm gnleri ayn kiiye yazlmaz (ardk gn yasa)."},HOLIDAY_ROTATE_SPECIAL_DAYS:{cat:"adalet",level:be.MED,desc:"Ylba/bayram 1. gn gibi zel nbetler dnml verilir."},HOLIDAY_BEFORE_AFTER_ATTENTION:{cat:"adalet",level:be.LOW,desc:"Tatil ncesi/sonras nbetler dikkatle planlanr."},NO_MULTIPLE_ASSIGNMENTS_PER_DAY:{cat:"cakisma",level:be.HARD,desc:"Ayn gnde birden fazla nbet atanamaz."},NO_DOUBLE_BOOKING:{cat:"cakisma",level:be.HARD,desc:"Ayn anda iki grevde olunamaz."},NO_SPLIT_SHIFT:{cat:"cakisma",level:be.HARD,desc:"Blnm vardiya uygulanmaz."},NIGHT_NEXT_DAY_OFF:{cat:"sure",level:be.HARD,desc:"Gece nbeti tutan kii ertesi gn izinlidir."},LONG16_NEXT_DAY_LIGHT:{cat:"sure",level:be.HIGH,desc:"16 saatlik vardiya sonras ertesi gn ar/erken grevlere yazlmaz."},NIGHT_OFF_PLANNED:{cat:"sure",level:be.MED,desc:"Gece sonras izin nceden planlanr."},END_OF_MONTH_WEEKEND_NEXT_DAY_OFF:{cat:"sure",level:be.LOW,desc:"Ay sonu/hafta sonu nbetlerinden sonra ertesi gn izin uygulanr."},NO_IMMEDIATE_NEXT_NIGHT_AFTER_NIGHT:{cat:"sure",level:be.HARD,desc:"Gece nbetinden hemen sonra tekrar gece nbeti verilmez."},NO_OVERLAP_SHIFTS:{cat:"cakisma",level:be.HARD,desc:"Vardiyalar birbiriyle akamaz."},MIN_GAP_12H:{cat:"sure",level:be.HARD,desc:"Vardiyalar arasnda en az 12 saat boluk olmaldr.",suggestedParams:{minHours:12}},NO_OVERLAP_ANY:{cat:"cakisma",level:be.HARD,desc:"Hibir vardiya baka vardiya ile st ste gelmez."},SMOOTH_DAY_NIGHT_TRANSITIONS:{cat:"cakisma",level:be.MED,desc:"Gndzgece geileri akma olmayacak biimde planlanr."},TRY_RESPECT_OFF_REQUESTS:{cat:"tercih",level:be.MED,desc:"Bo gn (B) istei olan personele o gn nbet yazmamaya al."},CONSIDER_PREFERRED_SHIFTS:{cat:"tercih",level:be.LOW,desc:"Tercih ettii vardiyalar dikkate alnr."},AVOID_MAZERET_DAYS:{cat:"tercih",level:be.MED,desc:"Mazeret gnlerine nbet yazmamaya al."},ALLOW_SWAP_BY_RULES:{cat:"tercih",level:be.MED,desc:"Karlkl nbet deiimleri kurallara uygun yaplr."},FAIR_ON_MULTI_REQUESTS:{cat:"tercih",level:be.MED,desc:"oklu talepte adalet salanr."},COMMUNICATE_DURING_PLANNING:{cat:"tercih",level:be.LOW,desc:"Planlama srecinde personele dan, iletiim kur."},ALLOW_REASONABLE_FLEX:{cat:"tercih",level:be.LOW,desc:"Moral/motivasyon iin makul esneklik tannr."},SENIOR_MAY_EXEMPT:{cat:"kidem",level:be.MED,desc:"Kdemli personel baz nbetlerden muaf olabilir."},TEAM_LEAD_SHARED_AMONG_SENIORS:{cat:"kidem",level:be.MED,desc:"Ekip sorumluluu kdemliler arasnda dnml paylalr."},PREGNANT_NO_NIGHTS:{cat:"kidem",level:be.HARD,desc:"Hamile/emziren personel gece nbetine yazlmaz."},HEALTH_LIMITED_SHIFTS:{cat:"kidem",level:be.HARD,desc:"Salk raporu olan personel kstl vardiyalara yazlr."},SENIOR_PREFERENCES:{cat:"kidem",level:be.LOW,desc:"Kdemli personelin belirli tercih haklar tannabilir."},SENIOR_JUNIOR_BALANCE:{cat:"kidem",level:be.MED,desc:"Kdemgen dengesi gzetilir."},NO_TITLE_CONFLICTS:{cat:"kidem",level:be.HARD,desc:"Unvan atmas olmamaldr."},NO_ASSIGN_WITHOUT_TRAINING:{cat:"kidem",level:be.HARD,desc:"Gerekli eitim/oryantasyon olmadan atama yaplmaz."},FAIR_TOTAL_LOAD:{cat:"kidem",level:be.MED,desc:"Toplam yk (vardiya/saat) adil datlr."}},Xv=Object.keys(_n).map((e,t)=>{var r,n,a,s,i,l,o,c;return{id:e,name:e,enabled:!0,value:((n=(r=_n[e])==null?void 0:r.suggestedParams)==null?void 0:n.max)??((s=(a=_n[e])==null?void 0:a.suggestedParams)==null?void 0:s.min)??((l=(i=_n[e])==null?void 0:i.suggestedParams)==null?void 0:l.minHours)??((c=(o=_n[e])==null?void 0:o.suggestedParams)==null?void 0:c.maxPerWeek)??null,order:t}}),p_=(e="")=>e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"c").replace(//g,"g").replace(//g,"i").replace(//g,"I").replace(//g,"o").replace(//g,"s").replace(//g,"u").replace(/[^A-Za-z0-9]+/g,"_").replace(/^_+|_+$/g,"").replace(/_+/g,"_").toUpperCase(),fB=[{key:"personel grev trlerine gre kstlamalar",cat:"personel"},{key:"gnlk/haftalk grev snrlar",cat:"sure"},{key:"maksimum ardk alma gnleri",cat:"sure"},{key:"izin trleri",cat:"izin"},{key:"izinli personele",cat:"izin"},{key:"gece nbeti adaleti",cat:"adalet"},{key:"ardk gece",cat:"adalet"},{key:"resmi tatil",cat:"adalet"},{key:"ayn gn iinde birden fazla",cat:"cakisma"},{key:"nbet sonras izin",cat:"sure"},{key:"vardiya saat akmalar",cat:"cakisma"},{key:"personel tercihleri",cat:"tercih"},{key:"kdem ve unvan",cat:"kidem"}],dB=(e="")=>{const t=e.match(/(\d+(?:[.,]\d+)?)/);if(!t)return null;const r=Number(t[1].replace(",","."));return Number.isFinite(r)?r:null},hB=[{rx:/ayn[i] g[u]n.*tek vardiya|bir g[u]nde.*tek vardiya|ayn g[u]n.*yaln[i]zca.*1/i,id:"ONE_SHIFT_PER_DAY"},{rx:/ard[a][i]k gece|arka arkaya.*gece/i,id:"NO_CONSEC_NIGHTS"},{rx:/haftal[i]k.*80\s*saat|80\s*saat.*hafta/i,id:"WEEKLY_MAX_80H"},{rx:/(bir g[u]n.*24\s*saat|24\s*saat.*g[u]n)/i,id:"DAILY_MAX_24H"},{rx:/(en az|min).*11\s*saat.*(dinlenme|ara)/i,id:"MIN_REST_11H"},{rx:/gece n[o]bet(ler|i).*adalet|adil.*gece/i,id:"NIGHT_FAIR_DISTRIBUTION"},{rx:/tatil.*(e[s]it|adil)|bayram.*d[a]t[i]l/i,id:"HOLIDAY_EQUAL"},{rx:/yeil alan.*hafta i[c]i.*3.*hafta sonu.*4/i,id:"GREEN_MIN_STAFF"},{rx:/res[u]sitasyon.*(2|iki).*personel/i,id:"RESUS_MIN_TWO"}],Nu={PERSONEL:"personel",PERSONNEL:"personel",YETKNLK:"personel",YETKINLIK:"personel",KADRO:"kadro",VARDIYA:"kadro",CREW:"kadro",SURE:"sure",DNLENME:"sure",DINLENME:"sure",REST:"sure",IZIN:"izin",RAPOR:"izin",HOLIDAY:"adalet",TATIL:"adalet",GECE:"adalet",ADALET:"adalet",NIGHT:"adalet",CAKISMA:"cakisma",AKIMA:"cakisma",SCHEDULING:"cakisma",TERCIH:"tercih",PREFERENCE:"tercih",KIDEM:"kidem",UNVAN:"kidem"},x_={HARD:{code:"HARD",level:be.HARD},KATI:{code:"HARD",level:be.HARD},STRICT:{code:"HARD",level:be.HARD},SOFT_HIGH:{code:"SOFT_HIGH",level:be.HIGH},HIGH:{code:"SOFT_HIGH",level:be.HIGH},"SOFT-YUKSEK":{code:"SOFT_HIGH",level:be.HIGH},SOFT_MED:{code:"SOFT_MED",level:be.MED},SOFT_MEDIUM:{code:"SOFT_MED",level:be.MED},MED:{code:"SOFT_MED",level:be.MED},MEDIUM:{code:"SOFT_MED",level:be.MED},SOFT_LOW:{code:"SOFT_LOW",level:be.LOW},LOW:{code:"SOFT_LOW",level:be.LOW}},Jv={HARD:"Kat",SOFT_HIGH:"Soft  Yksek",SOFT_MED:"Soft  Orta",SOFT_LOW:"Soft  Dk"},qv=(e="")=>{const t=e.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t},mB=e=>{if(!e)return null;const t=e.toString().trim().toUpperCase();if(Nu[t])return Nu[t];const r=t.replace(/[^A-Z0-9]+/g," ").split(/\s+/).filter(Boolean);for(const n of r)if(Nu[n])return Nu[n];return t.toLowerCase()},pB=e=>{if(!e)return null;const t=e.toString().trim().toUpperCase();return x_[t]||null},xB=(e="")=>{const t=e.split(/[;,]+/).map(n=>n.trim()).filter(Boolean).map(n=>{const[a,s]=n.split(/[:=]/);return s?[a.trim(),s.trim()]:null}).filter(Boolean);if(!t.length)return null;const r={};for(const[n,a]of t)r[n]=a;return r};function gB(e){const t=e.split(/\r?\n/),r=[];let n=null,a=null;for(const s of t){const i=s.trim();if(!i){n&&a&&n.body[a]&&(n.body[a]=`${n.body[a]}
`);continue}if(/^RULE\b/i.test(i)){n&&r.push(n);const o=i.match(/^RULE\s+([^:]+?)(?::|$)/i),c=o?qv(o[1]):`RULE_${r.length+1}`;n={id:p_(c).slice(0,48)||c.replace(/\s+/g,"_").toUpperCase(),rawId:c,body:{},source:[s]},a=null;continue}if(!n)continue;if(n.source.push(s),/^END\b/i.test(i)){r.push(n),n=null,a=null;continue}const l=i.match(/^([A-Z][A-Z0-9_]*)(?:\s*[:=]\s*|\s+)(.+)$/i);if(l){const o=l[1].toUpperCase();let c=l[2]??"";c=qv(c),n.body[o]=c,a=o}else if(a){const o=n.body[a]||"";n.body[a]=`${o}${o?`
`:""}${i}`}}return n&&r.push(n),r.length?r.map(s=>{const i=s.body,l=pB(i.PRIORITY||i.LEVEL||i.SEVERITY),o=mB(i.CATEGORY||i.CAT),c=(i.WEIGHT||i.PENALTY||"").trim(),u=c?c.toUpperCase():null,d=i.ENABLED?m_(i.ENABLED):!0,h=i.VALUE&&Number.isFinite(Number(i.VALUE))?Number(i.VALUE):null,p=i.NOTE||i.DESCRIPTION||null,m=i.TITLE||i.NAME||Ju(s.id),x=i.SCOPE?xB(i.SCOPE):null;return{id:s.id,name:m,enabled:d,value:h,cat:o,priority:(l==null?void 0:l.code)||null,levelOverride:(l==null?void 0:l.level)||null,weight:u,scope:x,note:p,dsl:{when:i.WHEN||null,then:i.THEN||null,else:i.ELSE||null,weight:u,scope:x,priority:(l==null?void 0:l.code)||null,raw:s.source.join(`
`)}}}):[]}function vB(e){const t=e.split(/\r?\n/).map(l=>l.trim()).filter(l=>l.length);let r=null;const n=[],a=l=>{const o=l.toLowerCase(),c=fB.find(u=>o.includes(u.key));return c?(r=c.cat,!0):!!(/^[A-Z0-9\s\/\-:,]+$/.test(l)&&l.length>=10)},s=l=>/^(\d+[\).\-])\s+/.test(l);for(const l of t){if(a(l)||!s(l))continue;const o=l.replace(/^(\d+[\).\-])\s+/,""),c=hB.find(h=>h.rx.test(o)),u=c?c.id:p_(o).slice(0,48)||ym(),d=dB(o);n.push({id:u,name:o,value:d,enabled:!0,cat:r})}const i=new Map;for(const l of n)i.has(l.id)||i.set(l.id,l);return Array.from(i.values())}function Zv(e){const t=(e||"").trim();if(!t)return[];const r=gB(t);return r.length?r.map((n,a)=>({...n,order:a})):vB(t).map((n,a)=>({...n,order:a}))}function yB({value:e,onChange:t,placeholder:r="deer"}){const[n,a]=_.useState(!1),[s,i]=_.useState(e??"");_.useEffect(()=>i(e??""),[e]);const l=()=>{const o=s===""?null:Number(s);s!==""&&Number.isNaN(o)||(t(o),a(!1))};return n?f.jsx("input",{autoFocus:!0,type:"number",className:"text-[12px] px-2 py-1 rounded border w-20",value:s,onChange:o=>i(o.target.value),onBlur:l,onKeyDown:o=>{o.key==="Enter"&&l(),o.key==="Escape"&&a(!1)}}):f.jsx("button",{type:"button",className:"text-[11px] px-2 py-0.5 rounded border bg-white hover:bg-gray-50",onClick:()=>a(!0),title:"Deeri dzenle",children:e??f.jsx("span",{className:"text-gray-400",children:r})})}function wB({rules:e,setRules:t}){const[r,n]=uB(e,t),[a,s]=_.useState("all"),[i,l]=_.useState({}),[o,c]=_.useState({id:void 0,name:"",value:"",enabled:!0}),[u,d]=_.useState(null),[h,p]=_.useState(!1),[m,x]=_.useState(""),[g,v]=_.useState({}),[w,y]=_.useState(!1),[k,C]=_.useState(!1),[E,S]=_.useState(""),N=_.useMemo(()=>Yf(r),[r]),F=_.useRef(null);_.useEffect(()=>{(!Array.isArray(r)||r.length===0)&&n(Xv)},[]);const R=()=>{confirm("Tam ablon eklensin mi? (mevcutlar korunur)")&&n(A=>{const O=new Set((A||[]).map(U=>U.id)),P=Xv.filter(U=>!O.has(U.id));return[...A||[],...P].map((U,q)=>({...U,order:q}))})},D=()=>{confirm("Tm nbet kurallar silinsin mi?")&&(n([]),c({id:void 0,name:"",value:"",enabled:!0}),d(null),p(!1),v({}))},T=()=>{const A=[["id","name","value","enabled","order"]],O=N.map(q=>[q.id,q.name,q.value??"",q.enabled?1:0,q.order]),P=Ve.aoa_to_sheet([...A,...O]);P["!cols"]=[{wch:32},{wch:44},{wch:10},{wch:8},{wch:8}];const U=Ve.book_new();Ve.book_append_sheet(U,P,"NobetKurallari"),jn(U,`NobetKurallari_${new Date().toISOString().slice(0,10)}.xlsx`)},j=()=>{var A;return(A=F.current)==null?void 0:A.click()},Z=async A=>{var P;const O=(P=A.target.files)==null?void 0:P[0];if(A.target.value="",!!O)try{const U=await O.arrayBuffer(),q=fn(U,{type:"array"}),J=q.Sheets[q.SheetNames[0]],B=Ve.sheet_to_json(J,{header:1,defval:""});if(!B||B.length<2)throw new Error("Geerli veri yok");const ne=(B[0]||[]).map(Te=>String(Te||"").trim().toLowerCase()),fe=(Te,ve)=>{const pe=ne.indexOf(Te);return pe>=0?pe:ve},M=B.slice(1).map(Te=>{const ve=String(Te[fe("id",0)]||"").trim()||ym(),pe=String(Te[fe("name",1)]||"").trim(),Me=Te[fe("value",2)],Ke=Me===""||Me===null||Number.isNaN(Number(Me))?null:Number(Me),Be=m_(Te[fe("enabled",3)]),Pe=Number(Te[fe("order",4)]);return{id:ve,name:pe,value:Ke,enabled:Be,order:Number.isFinite(Pe)?Pe:void 0}}).filter(Te=>Te.id),ue=new Map;for(const Te of M)ue.set(Te.id,Te);const ye=Yf(Array.from(ue.values()));n(ye),alert(`Toplam ${ye.length} kural ie aktarld.`)}catch(U){console.error(U),alert("Excel ie aktarma hatas: "+((U==null?void 0:U.message)||String(U)))}},re=()=>{c({id:void 0,name:"",value:"",enabled:!0}),d(null)},W=A=>{var J;(J=A==null?void 0:A.preventDefault)==null||J.call(A);const O=(o.name||"").trim(),P=o.value===""||o.value===null||Number.isNaN(Number(o.value))?null:Number(o.value);if(!O)return;const U=u??(O.toUpperCase().replace(/[^A-Z0-9_]+/g,"_")||ym()),q={id:U,name:O,value:P,enabled:!!o.enabled};n(B=>[...(Array.isArray(B)?B:[]).filter(ue=>ue.id!==U),q].map((ue,ye)=>({...ue,order:ye}))),re()},Q=A=>{d(A.id),c({id:A.id,name:A.name||A.id,value:A.value??"",enabled:!!A.enabled})},H=A=>{n(O=>(O||[]).filter(P=>P.id!==A).map((P,U)=>({...P,order:U}))),u===A&&(re(),p(!1))},L=(A,O)=>{const P=[...N],U=P.findIndex(B=>B.id===A);if(U<0)return;const q=O==="up"?U-1:U+1;if(q<0||q>=P.length)return;[P[U],P[q]]=[P[q],P[U]];const J=P.map((B,ne)=>({...B,order:ne}));n(B=>(B||[]).map(ne=>{const fe=J.find(M=>M.id===ne.id);return fe?{...ne,order:fe.order}:ne}))},ee=_.useMemo(()=>{const A=a==="all"?N:N.filter(P=>{var U;return(((U=_n[P.id])==null?void 0:U.cat)||P.cat)===a}),O=m.trim().toLowerCase();return O?A.filter(P=>{const U=_n[P.id]||{};return(P.id||"").toLowerCase().includes(O)||(P.name||"").toLowerCase().includes(O)||(U.desc||"").toLowerCase().includes(O)}):A},[N,a,m]),te=A=>{var U;const O=_n[A.id],P=(O==null?void 0:O.level)??A.levelOverride??(A.priority?(U=x_[A.priority])==null?void 0:U.level:null);return P===be.HARD?f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-red-50 text-red-700 border-red-200",children:"Kat"}):P===be.HIGH?f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-amber-50 text-amber-700 border-amber-200",children:"Soft  Yksek"}):P===be.MED?f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-sky-50 text-sky-700 border-sky-200",children:"Soft  Orta"}):f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-slate-100 text-slate-600 border-slate-200",children:"Soft  Dk"})},b=_.useMemo(()=>Zv(E||""),[E]);return f.jsxs("div",{className:"space-y-4 text-sm md:text-base",children:[f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-4 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h2",{className:"text-xl md:text-2xl font-semibold tracking-tight",children:"Nbet Kurallar"}),f.jsxs("span",{className:"px-2 py-0.5 rounded-full text-xs bg-gray-100 border border-gray-200",children:[N.length," kural"]})]}),f.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[f.jsx("input",{value:m,onChange:A=>x(A.target.value),placeholder:"Kural ara",className:"px-3 py-2 rounded-xl border bg-white w-56"}),f.jsx("button",{onClick:()=>{re(),p(!0)},className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",title:"Yeni kural ekle",children:"Yeni"}),f.jsx("button",{onClick:()=>y(!0),className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",children:"Hzl Ekle"}),f.jsx("button",{onClick:()=>C(!0),className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",children:"Metinden Ykle"}),f.jsx("button",{onClick:R,className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",children:"Varsaylanlar Ekle"}),f.jsx("button",{onClick:T,className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",children:"Excele Aktar"}),f.jsx("input",{ref:F,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:Z}),f.jsx("button",{onClick:j,className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",children:"Excelden Ykle"}),f.jsx("button",{onClick:D,disabled:!N.length,className:"px-3 py-2 rounded-xl bg-red-50 text-red-700 border border-red-200 disabled:opacity-50",children:"Kurallar Sfrla"})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx("button",{onClick:()=>s("all"),className:`px-3 py-1.5 rounded-xl border ${a==="all"?"bg-black text-white":"bg-white hover:bg-gray-50"}`,children:"Tm"}),_u.map(A=>f.jsx("button",{onClick:()=>s(A.id),className:`px-3 py-1.5 rounded-xl border ${a===A.id?"bg-black text-white":"bg-white hover:bg-gray-50"}`,children:A.label},A.id))]}),Object.keys(g).filter(A=>g[A]).length>0&&f.jsxs("div",{className:"flex items-center gap-2 p-2 bg-amber-50 border border-amber-200 rounded-xl",children:[f.jsxs("div",{className:"text-xs font-medium",children:[Object.keys(g).filter(A=>g[A]).length," kural seildi"]}),f.jsx("button",{className:"px-2 py-1 text-xs rounded border bg-white",onClick:()=>n(A=>(A||[]).map(O=>g[O.id]?{...O,enabled:!0}:O)),children:"Etkinletir"}),f.jsx("button",{className:"px-2 py-1 text-xs rounded border bg-white",onClick:()=>n(A=>(A||[]).map(O=>g[O.id]?{...O,enabled:!1}:O)),children:"Devre D"}),f.jsx("button",{className:"px-2 py-1 text-xs rounded border bg-white hover:bg-red-50 text-red-600",onClick:()=>n(A=>(A||[]).filter(O=>!g[O.id])),children:"Seilileri Sil"}),f.jsx("button",{className:"ml-auto px-2 py-1 text-xs rounded border",onClick:()=>v({}),children:"Seimi temizle"})]}),f.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[!ee.length&&f.jsx("div",{className:"p-4 text-gray-500",children:"Seili kategoride kural yok."}),ee.map((A,O)=>{var B,ne,fe;const P=_n[A.id]||{},U=P.cat||A.cat||null,q=!!i[A.id],J=P.uiTitle||P.desc||A.name||Ju(A.id);return f.jsx("div",{className:"p-4 border-b last:border-b-0",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("input",{type:"checkbox",className:"mt-1",checked:!!g[A.id],onChange:M=>v(ue=>({...ue,[A.id]:M.target.checked?!0:void 0}))}),f.jsxs("div",{className:"w-6 text-right text-xs font-semibold mt-1",children:[O+1,"."]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsx("div",{className:"font-medium truncate",title:J,children:J}),f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-gray-50 text-gray-500 border-gray-200",children:A.id}),te(A),!_n[A.id]&&A.priority&&f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-gray-50 text-gray-600 border-gray-200",children:Jv[A.priority]||A.priority}),U&&f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-gray-50 text-gray-700 border-gray-200",children:(B=_u.find(M=>M.id===U))==null?void 0:B.label}),f.jsxs("label",{className:"ml-2 inline-flex items-center gap-1 text-[11px] cursor-pointer select-none",children:[f.jsx("input",{type:"checkbox",checked:!!A.enabled,onChange:M=>n(ue=>(ue||[]).map(ye=>ye.id===A.id?{...ye,enabled:M.target.checked}:ye))}),A.enabled?"Aktif":"Pasif"]}),f.jsx(yB,{value:A.value,placeholder:"deer",onChange:M=>n(ue=>(ue||[]).map(ye=>ye.id===A.id?{...ye,value:M}:ye))})]}),f.jsx("div",{className:"text-gray-700 mt-1",children:P.desc||A.note||((ne=A.dsl)==null?void 0:ne.then)||((fe=A.dsl)==null?void 0:fe.when)||"Kural aklamas"}),f.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[f.jsx("button",{onClick:()=>l(M=>({...M,[A.id]:!q})),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-gray-50",children:q?"Kapat":"Neden?"}),f.jsx("button",{onClick:()=>{Q(A),p(!0)},className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-gray-50",children:"Dzenle"}),f.jsx("button",{onClick:()=>H(A.id),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-red-50 text-red-600",children:"Sil"}),f.jsx("button",{onClick:()=>L(A.id,"up"),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-gray-50",children:""}),f.jsx("button",{onClick:()=>L(A.id,"down"),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-gray-50",children:""})]}),q&&f.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[f.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[f.jsx("div",{className:"text-xs font-semibold mb-1",children:"Neden var?"}),f.jsx("div",{className:"text-sm text-gray-700",children:P.why||"Kaynak dokmandaki gvenlik, mevzuat ve adalet gereksinimleri."})]}),f.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[f.jsx("div",{className:"text-xs font-semibold mb-1",children:"rnek"}),f.jsx("div",{className:"text-sm text-gray-700",children:P.example||"Uygulama rnei kurum pratiklerine gre ekillenir."})]}),P.suggestedParams&&f.jsxs("div",{className:"md:col-span-2 bg-gray-50 border rounded-xl p-3",children:[f.jsx("div",{className:"text-xs font-semibold mb-1",children:"nerilen parametreler"}),f.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:JSON.stringify(P.suggestedParams,null,2)})]})]})]})]})},A.id)})]}),h&&f.jsxs("div",{className:"fixed inset-0 z-50",children:[f.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>p(!1)}),f.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl border-l flex flex-col",children:[f.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[f.jsx("div",{className:"font-semibold",children:"Kural Dzenle"}),f.jsx("button",{onClick:()=>p(!1),className:"px-2 py-1 text-sm rounded border",children:"Kapat"})]}),f.jsxs("div",{className:"p-4 overflow-auto",children:[f.jsxs("form",{onSubmit:A=>{W(A),p(!1)},className:"flex flex-col gap-3",children:[f.jsx("label",{className:"text-sm",children:"Kural Bal / ID"}),f.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"rn: Gece nbeti adaleti",value:o.name,onChange:A=>c(O=>({...O,name:A.target.value}))}),f.jsx("label",{className:"text-sm",children:"Deer (opsiyonel / say)"}),f.jsx("input",{type:"number",className:"border rounded-xl px-3 py-2",placeholder:"rn: 80, 24, 11...",value:o.value,onChange:A=>c(O=>({...O,value:A.target.value}))}),f.jsxs("label",{className:"inline-flex items-center gap-2 text-sm mt-1",children:[f.jsx("input",{type:"checkbox",checked:!!o.enabled,onChange:A=>c(O=>({...O,enabled:A.target.checked}))}),"Kural aktif"]}),f.jsxs("div",{className:"flex gap-2 pt-1",children:[f.jsx("button",{type:"submit",className:"px-3 py-2 border rounded-xl bg-emerald-600 text-white",children:u?"Gncelle":"Ekle"}),f.jsx("button",{type:"button",onClick:()=>{re(),p(!1)},className:"px-3 py-2 border rounded-xl bg-slate-100",children:"ptal"})]})]}),u&&(()=>{const A=_n[u]||{};return f.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[f.jsx("div",{className:"font-semibold",children:"Aklama"}),f.jsx("div",{className:"text-gray-700",children:A.desc||""}),A.suggestedParams&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"font-semibold mt-2",children:"nerilen parametreler"}),f.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-2",children:JSON.stringify(A.suggestedParams,null,2)})]})]})})()]})]})]}),w&&f.jsxs("div",{className:"fixed inset-0 z-50",children:[f.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>y(!1)}),f.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-lg bg-white shadow-xl border-l flex flex-col",children:[f.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[f.jsx("div",{className:"font-semibold",children:"Hzl Kural Ekle"}),f.jsx("button",{onClick:()=>y(!1),className:"px-2 py-1 text-sm rounded border",children:"Kapat"})]}),f.jsx("div",{className:"p-4 space-y-3 overflow-auto",children:["ONE_SHIFT_PER_DAY","MIN_REST_11H","NO_CONSEC_NIGHTS","WEEKLY_MAX_80H","DAILY_MAX_24H","HOLIDAY_EQUAL","NIGHT_FAIR_DISTRIBUTION","LEAVE_BLOCK_GENERIC","RED_YELLOW_CHILD_MIN1","GREEN_MIN_STAFF"].map(A=>{var P;const O=_n[A];return f.jsxs("div",{className:"border rounded-xl p-3",children:[f.jsx("div",{className:"font-medium",children:(O==null?void 0:O.desc)||A}),f.jsx("div",{className:"text-xs text-gray-600 mt-1",children:(P=_u.find(U=>U.id===(O==null?void 0:O.cat)))==null?void 0:P.label}),f.jsxs("div",{className:"mt-2 flex gap-2",children:[f.jsx("button",{className:"px-2 py-1 text-xs rounded border bg-white",onClick:()=>{n(U=>{if(new Set((U||[]).map(B=>B.id)).has(A))return U;const J={id:A,name:A,enabled:!0,value:null,order:(U==null?void 0:U.length)||0};return[...U||[],J]})},children:"Ekle"}),f.jsx("button",{className:"px-2 py-1 text-xs rounded border bg-white",onClick:()=>{n(U=>[{id:A,name:A,enabled:!0,value:null,order:0},...U||[]].map((J,B)=>({...J,order:B})))},children:"En ste ekle"})]})]},A)})})]})]}),k&&f.jsxs("div",{className:"fixed inset-0 z-50",children:[f.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>C(!1)}),f.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-3xl bg-white shadow-xl border-l flex flex-col",children:[f.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[f.jsx("div",{className:"font-semibold",children:"Metinden Kural Ykle"}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("button",{onClick:()=>C(!1),className:"px-2 py-1 text-sm rounded border",children:"Kapat"})})]}),f.jsxs("div",{className:"p-4 grid gap-3",style:{gridTemplateRows:"1fr auto auto"},children:[f.jsx("textarea",{value:E,onChange:A=>S(A.target.value),placeholder:`Buraya dokmandan kopyaladn metni yaptr.
(RULE bloklar veya balk + numaral maddeler)`,className:"border rounded-xl p-3 h-[48vh] resize-none font-mono text-[12px]"}),f.jsx("div",{className:"mt-1 border rounded-xl p-3 max-h-56 overflow-auto text-sm",children:b.length===0?f.jsx("div",{className:"text-gray-500",children:"nizleme iin RULE bloklar veya numaral maddeler ieren metin yaptrn."}):b.map((A,O)=>{var P;return f.jsxs("div",{className:"flex items-center justify-between py-1 border-b last:border-b-0",children:[f.jsxs("div",{className:"truncate space-x-1",children:[f.jsxs("span",{className:"text-gray-500 mr-2",children:[O+1,"."]}),f.jsx("span",{className:"font-medium",children:A.name||Ju(A.id)}),A.priority&&f.jsx("span",{className:"text-[10px] px-1 py-0.5 rounded border bg-gray-50 text-gray-600 border-gray-200",children:Jv[A.priority]||A.priority}),A.weight&&f.jsx("span",{className:"text-[10px] px-1 py-0.5 rounded border bg-indigo-50 text-indigo-600 border-indigo-200",children:A.weight}),A.cat&&f.jsx("span",{className:"text-[10px] px-1 py-0.5 rounded border bg-gray-50 text-gray-600 border-gray-200",children:((P=_u.find(U=>U.id===A.cat))==null?void 0:P.label)||A.cat}),A.value!=null&&f.jsxs("span",{className:"text-xs text-gray-600",children:["(",A.value,")"]})]}),N.some(U=>U.id===A.id)&&f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-amber-50 text-amber-700 border-amber-200",children:"Mevcut ID"})]},`${A.id}_${O}`)})}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",onClick:()=>{S(`
RULE REST_AFTER_N:
  TITLE "Gece Sonras 24 Saat Dinlenme"
  CATEGORY Sure & Dinlenme
  PRIORITY HARD
  WHEN prev_shift in ["N","V1","V2"]
  THEN FORBID shift in ["M","M4","N","V1"]
  NOTE "Gece veya uzun vardiyadan kan personele ertesi gn ar grev yazlmaz."
END

Resmi tatil nbetlerinin eit dalm
1. Yl boyunca her personele benzer sayda tatil nbeti dmelidir.
2. Ardk tm tatil gnleri ayn personele yazlmamaldr.
`.trim())},children:"rnek Doldur"}),f.jsx("button",{className:"px-3 py-2 rounded-xl bg-emerald-600 text-white",onClick:()=>{const A=Zv(E||"");if(!A.length){alert("Metinden kural karlamad. RULE bloklar veya numaral maddeler iermeli.");return}let O=0;n(P=>{const U=new Set((P||[]).map(J=>J.id)),q=[...P||[]];for(const J of A)U.has(J.id)||(q.push({id:J.id,name:J.name||Ju(J.id),value:J.value??null,enabled:J.enabled??!0,order:q.length,cat:J.cat||void 0,priority:J.priority||void 0,levelOverride:J.levelOverride||void 0,weight:J.weight||void 0,scope:J.scope||void 0,note:J.note||void 0,dsl:J.dsl||void 0}),U.add(J.id),O+=1);return q.map((J,B)=>({...J,order:B}))}),C(!1),S(""),alert(O?`${O} yeni kural eklendi.`:"Tm kurallar zaten listede mevcuttu.")},children:"Ayrtr ve Ekle"}),f.jsx("div",{className:"text-xs text-gray-500",children:"pucu: Say ieren cmlelerde (80, 24, 6, 11 gibi) deer alan otomatik dolar."})]})]})]})]})]})}const Qv="requestBoxV1",ey="requestBoxLastPersonV1";function SB(){const e=Number(localStorage.getItem("plannerYear"))||new Date().getFullYear(),t=Number(localStorage.getItem("plannerMonth1"))||new Date().getMonth()+1;return{year:e,month1:t}}function kB(e){const t=["bulkLeavesV1","bulkLeaves","topluIzinV1"],r=i=>{try{const l=localStorage.getItem(i);return l?JSON.parse(l):null}catch{return null}},n=i=>(i||[]).map((l,o)=>{if(Array.isArray(l)){const[h,p]=l;return{id:String(p??o+1),name:String(h??`Kii ${o+1}`),service:""}}const c=l.id??l.personId??l.tc??l.TC??l.kimlikNo??l.tcKimlikNo??String(o+1),u=l.name??l.fullName??[l.firstName,l.lastName].filter(Boolean).join(" ")??l.personelAdi??l.adSoyad??l.personName??l.AdSoyad??String(l),d=l.service??l.serviceId??l.department??l.servis??l.Servis??"";return{id:String(c),name:String(u),service:String(d||"")}}).filter(l=>l.id&&l.name);if(Array.isArray(e)&&e.length)return n(e);const a=r("peopleV1")||r("personsV1");if(Array.isArray(a)&&a.length)return n(a);const s=["peopleAll","people","personList","personnel","nurses","staff"];for(const i of s){const l=r(i);if(l){if(Array.isArray(l)&&l.length)return n(l);if(l&&typeof l=="object"){const o=Array.isArray(l.items)?l.items:Array.from(Object.values(l)).flat();if(Array.isArray(o)&&o.length)return n(o)}}}for(const i of t){const l=r(i);if(Array.isArray(l)&&l.length){const o=n(l.map(u=>({id:u.personId??u.tc??u.TC??u.id??u.kimlikNo??u.tcKimlikNo,name:u.personName??u.name??u.fullName??[u.firstName,u.lastName].filter(Boolean).join(" ")??u.personelAdi??u.adSoyad??u.AdSoyad}))),c=new Map;for(const u of o){const d=u.id||u.name.toLowerCase();c.has(d)||c.set(d,u)}return Array.from(c.values())}}return[]}function EB({people:e}){const t=kB(e),r=_.useMemo(()=>{const S=new Set;for(const N of t)N.service&&S.add(N.service);return Array.from(S.values())},[t]),[n,a]=_.useState(()=>{try{const S=localStorage.getItem(Qv);return S?JSON.parse(S):[]}catch{return[]}}),[s,i]=_.useState("NOTE"),[l,o]=_.useState(""),[c,u]=_.useState(""),[d,h]=_.useState(""),[p,m]=_.useState(""),[x,g]=_.useState(()=>{try{return localStorage.getItem(ey)||""}catch{return""}});_.useEffect(()=>{try{localStorage.setItem(Qv,JSON.stringify(n))}catch{}},[n]),_.useEffect(()=>{try{x&&localStorage.setItem(ey,x)}catch{}},[x]);const v=t.find(S=>String(S.id)===String(x))||null,w=_.useMemo(()=>t.filter(S=>!(d&&S.service!==d||p&&!S.name.toLowerCase().includes(p.toLowerCase()))),[t,d,p]),y=()=>{const S=l.trim();if(!S&&!v&&!c)return;const{year:N,month1:F}=SB(),R=d_({text:S,type:s,date:c,defaultYear:N,defaultMonth:F});a(D=>[...D,{id:crypto!=null&&crypto.randomUUID?crypto.randomUUID():String(Date.now()),type:s,text:S||"",personId:(v==null?void 0:v.id)??null,personName:(v==null?void 0:v.name)??null,date:c||null,active:!0,createdAt:new Date().toISOString(),analysis:R}]),o("")},k=S=>a(N=>N.map(F=>F.id===S?{...F,active:!F.active}:F)),C=S=>a(N=>N.filter(F=>F.id!==S)),E=(S,N)=>a(F=>{const R=[...F],D=N==="up"?S-1:S+1;return D<0||D>=R.length?F:([R[S],R[D]]=[R[D],R[S]],R)});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-4 flex flex-wrap items-center gap-2",children:[f.jsxs("select",{value:s,onChange:S=>i(S.target.value),className:"border rounded-xl px-3 py-2",title:"stek tr",children:[f.jsx("option",{value:"NOTE",children:"Not/Mazeret (NOTE)"}),f.jsx("option",{value:"OFF",children:"Bo Gn stei (OFF)"}),f.jsx("option",{value:"SHIFT",children:"Vardiya Tercihi (SHIFT)"})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Kii:"}),t.length?f.jsxs(f.Fragment,{children:[f.jsxs("select",{value:d,onChange:S=>h(S.target.value),className:"border rounded-xl px-3 py-2 min-w-[140px]",title:"Servis filtrele",children:[f.jsx("option",{value:"",children:"Tm servisler"}),r.map(S=>f.jsx("option",{value:S,children:S},S))]}),f.jsx("input",{value:p,onChange:S=>m(S.target.value),placeholder:"Ara",className:"border rounded-xl px-3 py-2 min-w-[140px]"}),f.jsxs("select",{value:x,onChange:S=>g(S.target.value),className:"border rounded-xl px-3 py-2 min-w-[220px]",title:"Kii se",children:[f.jsx("option",{value:"",children:"(Seiniz)"}),w.map(S=>f.jsxs("option",{value:S.id,children:[S.name,S.service?`  ${S.service}`:""]},S.id))]})]}):f.jsx("span",{className:"text-xs text-gray-400",children:"Kii listesi bo"})]}),f.jsx("input",{type:"date",value:c,onChange:S=>u(S.target.value),className:"border rounded-xl px-3 py-2",title:"Tarih (opsiyonel)"}),f.jsx("input",{value:l,onChange:S=>o(S.target.value),placeholder:"stek/mazeret metni",className:"flex-1 min-w-[220px] border rounded-xl px-3 py-2",onKeyDown:S=>S.key==="Enter"&&y()}),f.jsx("button",{onClick:y,className:"px-3 py-2 rounded-xl border bg-white hover:bg-gray-50",children:"Ekle"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("div",{className:"font-semibold mb-2",children:"Kii"}),f.jsxs("div",{className:"bg-white border rounded-2xl p-3",children:[t.length===0?f.jsxs("div",{className:"text-sm text-gray-500",children:["Kii listesi bo. People tabndan ekleyebilir veya",f.jsx("code",{className:"mx-1",children:"peopleV1"}),"/",f.jsx("code",{children:"personsV1"})," ya da",f.jsx("code",{className:"mx-1",children:"bulkLeavesV1"})," anahtarn doldurabilirsiniz."]}):f.jsxs("select",{size:Math.min(10,Math.max(6,t.length)),value:x,onChange:S=>g(S.target.value),className:"w-full border rounded-xl p-2",children:[f.jsx("option",{value:"",children:"(Kii seiniz)"}),t.map(S=>f.jsx("option",{value:S.id,children:S.name},S.id))]}),f.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"pucu: Listeden bir kii seildiinde st formda otomatik kullanlr."})]})]}),f.jsxs("div",{className:"md:col-span-3",children:[f.jsx("div",{className:"font-semibold mb-2",children:"Kaytlar"}),f.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[!n.length&&f.jsx("div",{className:"p-4 text-gray-500",children:"Henz kayt yok."}),n.map((S,N)=>{var F,R;return f.jsxs("div",{className:"p-4 border-b last:border-b-0 flex items-start gap-3",children:[f.jsxs("div",{className:"w-6 text-right text-xs font-semibold mt-1",children:[N+1,"."]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-gray-50 text-gray-700 border-gray-200",children:S.type}),S.personName&&f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-sky-50 text-sky-700 border-sky-200",children:S.personName}),S.date&&f.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded border bg-emerald-50 text-emerald-700 border-emerald-200",children:S.date}),f.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded border ${S.active?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-100 text-slate-600 border-slate-200"}`,children:S.active?"Aktif":"Pasif"})]}),S.text&&f.jsx("div",{className:"mt-1 text-gray-800 break-words",children:S.text}),Array.isArray((F=S.analysis)==null?void 0:F.segments)&&((R=S.analysis)==null?void 0:R.segments.length)>0&&f.jsx("div",{className:"mt-2 text-xs text-slate-600 space-y-1",children:S.analysis.segments.map((D,T)=>f.jsxs("div",{children:[D.startDay?`${D.startDay}${D.endDay&&D.endDay!==D.startDay?`-${D.endDay}`:""}`:"Belirsiz gn",D.month?` ${NB(D.month)}`:""," ",D.year||""," "," ",D.intent==="avoid"?"Kan":"Tercih",D.shift?` (${D.shift})`:""]},T))}),f.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[f.jsx("button",{onClick:()=>k(S.id),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-gray-50",children:S.active?"Pasifletir":"Etkinletir"}),f.jsx("button",{onClick:()=>C(S.id),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-red-50 text-red-600",children:"Sil"}),f.jsx("button",{onClick:()=>E(N,"up"),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-gray-50",children:""}),f.jsx("button",{onClick:()=>E(N,"down"),className:"px-2 py-1 text-xs rounded-lg border bg-white hover:bg-gray-50",children:""})]})]})]},S.id)})]}),f.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Not: Kii ve tarih alanlar opsiyoneldir; yalnzca metinle de kayt oluturabilirsiniz."})]})]})]})}const _B=["","Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"];function NB(e){return _B[e]||`Ay ${e}`}const Ex="paramsActiveSubtabV1",ty="dutyRulesV2",AB=(...e)=>e.filter(Boolean).join(" "),fo=[{id:"calisma-alanlari",label:"alma Alanlar"},{id:"calisma-saatleri",label:"alma Saatleri"},{id:"izin-turleri",label:"zin Trleri"},{id:"nobet-kurallari",label:"Nbet Kurallar"},{id:"istek",label:"stek"}],eo="calisma-alanlari",Zs=e=>fo.some(t=>t.id===e);function bB(e){return(e||"").replace(/^#/,"").replace(/^\/+/,"")}function ry(){try{const e=bB(window.location.hash);if(!e)return null;const t=e.split("/").filter(Boolean),r=t.findIndex(n=>n==="parametreler");if(r>=0){const n=t[r+1];return Zs(n)?n:null}return null}catch{return null}}function TB(){try{const t=(new URL(window.location.href).searchParams.get("sub")||"").trim();return Zs(t)?t:null}catch{return null}}function CB(e){const t="#/parametreler/"+e;return window.location.hash===t}function ny(e){try{const t="#/parametreler/"+e;window.location.hash!==t&&(window.location.hash=t)}catch{}}function ay(){try{const e=localStorage.getItem(Ex);return Zs(e)?e:null}catch{return null}}function sy(e){try{Zs(e)&&localStorage.setItem(Ex,e)}catch{}}function iy(){try{localStorage.removeItem(Ex)}catch{}}function FB(){const e=_.useMemo(()=>ry()??TB()??ay()??eo,[]),[t,r]=_.useState(Zs(e)?e:eo),[n,a]=_.useState(()=>{try{return JSON.parse(localStorage.getItem(ty)||"[]")}catch{return[]}});_.useEffect(()=>{try{localStorage.setItem(ty,JSON.stringify(n))}catch{}},[n]),_.useEffect(()=>{if(!Zs(t)){iy(),r(eo);return}sy(t),CB(t)||ny(t)},[t]),_.useEffect(()=>{const o=()=>{const c=ry();if(c&&c!==t)r(c);else if(!c){const u=ay()??eo;u!==t&&r(u)}};return window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[t]);const s=o=>{Zs(o)&&(sy(o),ny(o),r(o))},i=o=>{const c=fo.findIndex(d=>d.id===t),u=Math.min(fo.length-1,Math.max(0,c+o));s(fo[u].id)},l=()=>{iy(),s(eo)};return f.jsxs("div",{className:"p-4",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[fo.map(o=>f.jsx("button",{type:"button",onClick:()=>s(o.id),className:AB("px-3 py-2 text-sm rounded border",t===o.id?"bg-blue-50 border-blue-400":"bg-white"),children:o.label},o.id)),f.jsxs("div",{className:"ml-auto flex gap-2",children:[f.jsx("button",{type:"button",className:"px-2 py-2 text-sm border rounded",onClick:()=>i(-1),title:"nceki",children:""}),f.jsx("button",{type:"button",className:"px-2 py-2 text-sm border rounded",onClick:()=>i(1),title:"Sonraki",children:""}),f.jsx("button",{type:"button",className:"px-2 py-1 text-xs border rounded",onClick:l,children:"Sfrla"})]})]}),f.jsxs("div",{className:"mt-2",children:[t==="calisma-alanlari"&&f.jsx(sB,{}),t==="calisma-saatleri"&&f.jsx(lB,{}),t==="izin-turleri"&&f.jsx(cB,{}),t==="nobet-kurallari"&&f.jsx(wB,{rules:n,setRules:a}),t==="istek"&&f.jsx(EB,{})]})]})}function RB({tabs:e=[],activeId:t,onSelect:r,onMove:n,onAdd:a,onRename:s,onRemove:i,getHref:l,storageKey:o="TopTabsBar"}){const[c,u]=Mr.useState(""),d=e.filter(S=>!S.hidden),h=d.some(S=>S.id===t),p=Mr.useMemo(()=>({tabs:`${o}:tabs`,active:`${o}:active`,input:`${o}:input`}),[o]),m=Mr.useCallback((S={})=>{try{S.tabs&&localStorage.setItem(p.tabs,JSON.stringify(S.tabs)),typeof S.activeId<"u"&&localStorage.setItem(p.active,String(S.activeId??"")),typeof S.input<"u"&&localStorage.setItem(p.input,String(S.input??""))}catch{}},[p]);Mr.useEffect(()=>{m({tabs:e})},[JSON.stringify(e)]),Mr.useEffect(()=>{m({activeId:t})},[t,m]),Mr.useEffect(()=>{try{const S=localStorage.getItem(p.input);S&&!c&&u(S)}catch{}},[]),Mr.useEffect(()=>{m({input:c})},[c,m]);const x=()=>{const S=c.trim();S&&(a==null||a(S),u(""))},g=()=>{const S=c.trim();!S||!h||(s==null||s(t,S),u(""))},v=()=>{h&&(i==null||i(t))},w=S=>n==null?void 0:n(S,"left"),y=S=>n==null?void 0:n(S,"right"),k=S=>{S.key==="Enter"?S.shiftKey&&h?(S.preventDefault(),g()):(S.preventDefault(),x()):S.key==="Escape"&&u("")},C=(S,N)=>{S.button===1&&(S.preventDefault(),i==null||i(N))},E=S=>{if(S){try{window.history.pushState({},"",S),window.dispatchEvent(new PopStateEvent("popstate"));return}catch{}S.startsWith("#")?window.location.hash=S:window.location.href=S}};return f.jsxs("div",{className:"flex items-center gap-4 w-full",children:[f.jsx("div",{className:"flex items-center gap-3 overflow-x-auto pr-2",children:d.map(S=>{const N=S.id===t,F=!!S.disabled,R="whitespace-nowrap rounded-full border px-4 py-2 flex items-center gap-2 transition select-none",D=F?"cursor-not-allowed opacity-60":"cursor-pointer",T=N?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-800 hover:bg-slate-50",j=()=>{if(F)return;r==null||r(S.id);const Z=S.href??(typeof l=="function"?l(S):null);Z&&E(Z)};return f.jsxs("div",{onClick:j,onAuxClick:Z=>!F&&C(Z,S.id),className:`${R} ${D} ${T}`,title:N?"Aktif sekme":F?"Bu sekmeye eriiminiz yok":"Sekmeye ge",children:[f.jsx("span",{className:"truncate max-w-[220px]",children:S.title}),!F&&f.jsxs("span",{className:"flex items-center gap-1 ml-2",children:[f.jsx("span",{onClick:Z=>{Z.stopPropagation(),w(S.id)},title:"Sola ta",className:"p-1 rounded hover:bg-white/20 cursor-pointer",children:f.jsx(Np,{size:16})}),f.jsx("span",{onClick:Z=>{Z.stopPropagation(),y(S.id)},title:"Saa ta",className:"p-1 rounded hover:bg-white/20 cursor-pointer",children:f.jsx(Ap,{size:16})})]})]},S.id)})}),f.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[f.jsx("input",{value:c,onChange:S=>u(S.target.value),onKeyDown:k,className:"h-10 w-[260px] rounded border px-3",placeholder:"Yeni sekme ad",title:"Enter: Ekle  Shift+Enter: Dzenle  Esc: Temizle"}),f.jsxs("button",{onClick:x,className:"flex items-center gap-1 bg-emerald-600 text-white rounded px-3 py-2",title:"Sekme ekle (Enter)",children:[f.jsx(lC,{size:16})," Ekle"]}),f.jsxs("button",{onClick:g,disabled:!h,className:"flex items-center gap-1 rounded px-3 py-2 border hover:bg-slate-50 disabled:opacity-50",title:"Aktif sekmeyi yeniden adlandr (Shift+Enter)",children:[f.jsx(iC,{size:16})," Dzenle"]}),f.jsxs("button",{onClick:v,disabled:!h,className:"flex items-center gap-1 rounded px-3 py-2 border bg-red-50 hover:bg-red-100 disabled:opacity-50",title:"Aktif sekmeyi sil (Orta tk ile sekmeyi de kapatabilirsin)",children:[f.jsx(bp,{size:16})," Sil"]})]})]})}function IB({person:e}){const t="bg-rose-600",r=d=>(d??"").toString().trim(),n=d=>{const h=new Set,p=[];for(const m of d){const x=m.toLocaleLowerCase("tr-TR");h.has(x)||(h.add(x),p.push(m))}return p},a=d=>[...d].sort((h,p)=>h.localeCompare(p,"tr-TR",{sensitivity:"base"})),s=()=>{const d=(e==null?void 0:e.areas)??(e==null?void 0:e.workAreas)??(e==null?void 0:e.services)??(e==null?void 0:e.workAreaIds)??[],p=(Array.isArray(d)?d:[]).map(m=>r(typeof m=="string"?m:(m==null?void 0:m.name)||(m==null?void 0:m.label)||(m==null?void 0:m.title)||(m==null?void 0:m.id))).filter(Boolean);return a(n(p))},i=()=>{const d=(e==null?void 0:e.shiftCodes)??(e==null?void 0:e.codes)??(e==null?void 0:e.shifts)??[],p=(Array.isArray(d)?d:[]).map(m=>r(typeof m=="string"?m:(m==null?void 0:m.code)||(m==null?void 0:m.id))).filter(Boolean);return a(n(p))},l=s(),o=i(),c=({children:d})=>f.jsx("div",{className:"col-span-1 text-[11px] md:text-[12px] text-slate-500",children:d}),u=({children:d,strong:h})=>f.jsx("div",{className:"col-span-2 text-[12px] md:text-[13px] "+(h?"font-semibold text-slate-800":"font-medium text-slate-700"),children:d});return f.jsxs("div",{className:"relative rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:[f.jsx("div",{className:`mx-3 mt-3 h-2 rounded-full ${t}`}),f.jsxs("div",{className:"p-3 space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-x-2 gap-y-1",children:[f.jsx(c,{children:"UNVANI"}),f.jsx(u,{children:(e==null?void 0:e.title)||(e==null?void 0:e.unvan)||"-"}),f.jsx(c,{children:"T.C. KMLK NO"}),f.jsx(u,{children:(e==null?void 0:e.tc)||(e==null?void 0:e.tckn)||"-"}),f.jsx(c,{children:"AD SOYAD"}),f.jsx(u,{strong:!0,children:(e==null?void 0:e.name)||(e==null?void 0:e.fullName)||"-"}),f.jsx(c,{children:"TELEFON NUMARASI"}),f.jsx(u,{children:(e==null?void 0:e.phone)||"-"}),f.jsx(c,{children:"MAL ADRES"}),f.jsx(u,{children:(e==null?void 0:e.mail)||(e==null?void 0:e.email)||"-"})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"ALIMA ALANLARI"}),f.jsx("div",{className:"flex gap-1.5 flex-wrap",children:l.length?l.map(d=>f.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-slate-100 border border-slate-200 text-slate-700",title:d,children:d},d)):f.jsx("span",{className:"text-[11px] text-slate-400 italic",children:"-"})})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"VARDYE KODLARI"}),f.jsx("div",{className:"flex gap-1.5 flex-wrap",children:o.length?o.map(d=>f.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-amber-50 border border-amber-200 text-amber-800 ring-1 ring-amber-200/60",title:d,children:d},d)):f.jsx("span",{className:"text-[11px] text-slate-400 italic",children:"-"})})]})]})]})}const ly=(...e)=>e.filter(Boolean).join(" "),qu=(e,t)=>[...e].sort((r,n)=>((r==null?void 0:r[t])||"").toString().localeCompare(((n==null?void 0:n[t])||"").toString(),"tr",{sensitivity:"base"})),Zd={Doctor:"Doctor"},Ta={acil:"acil",dahiliye:"dahiliye",kardiyoloji:"kardiyoloji",ortopedi:"ortopedi",pediatri:"pediatri",yogunbakim:"yogunbakim"},DB=[{id:Ta.acil,name:"Acil Servis"},{id:Ta.dahiliye,name:"Dahiliye"},{id:Ta.kardiyoloji,name:"Kardiyoloji"},{id:Ta.ortopedi,name:"Ortopedi"},{id:Ta.pediatri,name:"Pediatri"},{id:Ta.yogunbakim,name:"Youn Bakm"}],OB=(e="")=>e.toString().trim().toLocaleLowerCase("tr-TR").replace(/[]/g,"g").replace(/[]/g,"u").replace(/[]/g,"s").replace(/[I]/g,"i").replace(/[]/g,"o").replace(/[]/g,"c").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),wm=e=>(e??"").toString().trim();function LB(e){const r=(Array.isArray(e)?e:[]).map(s=>{const i=wm(typeof s=="string"?s:(s==null?void 0:s.name)||(s==null?void 0:s.label)||(s==null?void 0:s.title)||(s==null?void 0:s.id)),l=typeof s=="object"&&(s!=null&&s.id)?String(s.id):OB(i);return i?{id:l,name:i}:null}).filter(Boolean),n=new Set,a=[];for(const s of r){const i=s.id.toLocaleLowerCase("tr-TR");n.has(i)||(n.add(i),a.push(s))}return qu(a,"name")}function oy({label:e,role:t,people:r=[],setPeople:n,workAreas:a=[],workingHours:s=[]}){const i=_.useMemo(()=>LB(a),[a]),l={id:void 0,role:t,service:Ta.acil,name:"",title:t===Zd.Doctor?"Uzman":"Hemire",tc:"",phone:"",mail:"",workAreaIds:[],shiftCodes:[]},[o,c]=_.useState(l),[u,d]=_.useState(null),h=_.useRef(null),p=S=>c(N=>{const F=N.workAreaIds.includes(S);return{...N,workAreaIds:F?N.workAreaIds.filter(R=>R!==S):[...N.workAreaIds,S]}}),m=S=>c(N=>{var R;const F=(R=N.shiftCodes)==null?void 0:R.includes(S);return{...N,shiftCodes:F?N.shiftCodes.filter(D=>D!==S):[...N.shiftCodes||[],S]}}),x=()=>{c(l),d(null)},g=S=>{if(S.preventDefault(),!o.name.trim())return;const N=u??Date.now(),F=(o.workAreaIds||[]).map(D=>{var T;return(T=i.find(j=>j.id===D))==null?void 0:T.name}).filter(Boolean),R={...o,id:N,name:o.name.trim(),workAreaIds:Array.isArray(o.workAreaIds)?o.workAreaIds:[],areas:F};n(D=>qu([...D.filter(T=>T.id!==N),R],"name")),x()},v=S=>{const F=(Array.isArray(S.areas)?S.areas.map(wm):[]).map(D=>{var T;return(T=i.find(j=>j.name===D))==null?void 0:T.id}).filter(Boolean),R=Array.isArray(S.workAreaIds)&&S.workAreaIds.length&&S.workAreaIds||Array.isArray(S.areaIds)&&S.areaIds.length&&S.areaIds||F||[];d(S.id),c({...l,...S,workAreaIds:R})},w=S=>n(N=>qu(N.filter(F=>F.id!==S),"name")),y=()=>{const S=[["ROL","SERVIS","UNVANI","T.C. KMLK NO","AD SOYAD","TELEFON NUMARASI","MAL ADRES","ALIMA ALANLARI","VARDYE KODLARI"],...r.map(R=>{const D=Array.isArray(R.areas)&&R.areas.length?R.areas:(R.workAreaIds||R.areaIds||[]).map(T=>{var j;return(j=i.find(Z=>Z.id===T))==null?void 0:j.name}).filter(Boolean);return[R.role,R.service,R.title,R.tc,R.name,R.phone,R.mail,D.join(", "),(R.shiftCodes||[]).join(", ")]})],N=Ve.aoa_to_sheet(S),F=Ve.book_new();Ve.book_append_sheet(F,N,e.toUpperCase()),jn(F,`${e.replace(/\s/g,"_").toUpperCase()}.xlsx`)},k=()=>{const S=[["ROL","SERVIS","UNVANI","T.C. KMLK NO","AD SOYAD","TELEFON NUMARASI","MAL ADRES","ALIMA ALANLARI","VARDYE KODLARI"],[t,Ta.acil,t===Zd.Doctor?"Uzman":"Hemire","","Ad Soyad","","","Alan1, Alan2","KOD1, KOD2"]],N=Ve.aoa_to_sheet(S),F=Ve.book_new();Ve.book_append_sheet(F,N,"SABLON"),jn(F,`${e.replace(/\s/g,"_").toUpperCase()}_SABLON.xlsx`)},C=()=>{var S;return(S=h.current)==null?void 0:S.click()},E=S=>{var R;const N=(R=S.target.files)==null?void 0:R[0];if(!N)return;const F=new FileReader;F.onload=D=>{const T=new Uint8Array(D.target.result),j=fn(T,{type:"array"}),Z=j.Sheets[j.SheetNames[0]],W=Ve.sheet_to_json(Z,{defval:""}).map((Q,H)=>{if((Q.ROL||t).toString().trim()!==t)return null;const ee=(Q.SERVIS||Q.SERVS||Ta.acil).toString().trim().toLowerCase(),te=(Q.UNVANI||Q.UNVAN||(t===Zd.Doctor?"Uzman":"Hemire")).toString().trim(),b=(Q["T.C. KMLK NO"]||Q.TC||"").toString().trim(),A=(Q["AD SOYAD"]||Q.NAME||"").toString().trim(),O=(Q["TELEFON NUMARASI"]||Q.TELEFON||"").toString().trim(),P=(Q["MAL ADRES"]||Q.MAIL||"").toString().trim(),q=(Q["ALIMA ALANLARI"]||Q.ALANLAR||"").toString().split(/,|;/).map(fe=>fe.trim()).filter(Boolean),J=q.map(fe=>{var M;return(M=i.find(ue=>ue.name===fe))==null?void 0:M.id}).filter(Boolean),ne=(Q["VARDYE KODLARI"]||Q["VARDIYE KODLARI"]||"").toString().split(/,|;/).map(fe=>fe.trim()).filter(Boolean);return A?{id:Date.now()+H,role:t,service:ee,title:te,tc:b,name:A,phone:O,mail:P,workAreaIds:J,areas:q,shiftCodes:ne}:null}).filter(Boolean);if(!W.length){alert("Excel balklar: ROL,SERVIS,UNVANI,T.C. KMLK NO,AD SOYAD,TELEFON NUMARASI,MAL ADRES,ALIMA ALANLARI,VARDYE KODLARI");return}n(Q=>qu([...Q||[],...W],"name")),h.current&&(h.current.value=""),alert(W.length+" kayt yklendi")},F.readAsArrayBuffer(N)};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-4 flex items-center justify-between",children:[f.jsx("div",{className:"font-semibold",children:e}),f.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[f.jsx("button",{onClick:k,className:"px-3 py-2 rounded-xl bg-slate-100",children:"ablon"}),f.jsx("button",{onClick:y,className:"px-3 py-2 rounded-xl bg-slate-100",children:"Da Aktar"}),f.jsx("button",{onClick:C,className:"px-3 py-2 rounded-xl bg-sky-600 text-white",children:"Excel'den Ykle"}),f.jsx("input",{ref:h,type:"file",accept:".xls,.xlsx",className:"hidden",onChange:E})]})]}),f.jsxs("form",{onSubmit:g,className:"bg-white rounded-2xl shadow-sm p-4 grid md:grid-cols-3 gap-3 items-end",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Servis"}),f.jsx("select",{value:o.service,onChange:S=>c(N=>({...N,service:S.target.value})),className:"w-full border rounded p-2",children:DB.map(S=>f.jsx("option",{value:S.id,children:S.name},S.id))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Unvan"}),f.jsx("input",{value:o.title,onChange:S=>c(N=>({...N,title:S.target.value})),className:"w-full border rounded p-2",placeholder:"Unvan"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"T.C. Kimlik No"}),f.jsx("input",{value:o.tc,onChange:S=>c(N=>({...N,tc:S.target.value.replace(/\D/g,"").slice(0,11)})),className:"w-full border rounded p-2",placeholder:"11 hane"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Ad Soyad"}),f.jsx("input",{value:o.name,onChange:S=>c(N=>({...N,name:S.target.value})),className:"w-full border rounded p-2",placeholder:"Ad Soyad"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Telefon"}),f.jsx("input",{value:o.phone,onChange:S=>c(N=>({...N,phone:S.target.value})),className:"w-full border rounded p-2",placeholder:"Telefon"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500",children:"Mail"}),f.jsx("input",{value:o.mail,onChange:S=>c(N=>({...N,mail:S.target.value})),className:"w-full border rounded p-2",placeholder:"Mail"})]}),f.jsxs("div",{className:"md:col-span-3 border rounded p-2",children:[f.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"alma Alanlar"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.length===0&&f.jsx("span",{className:"text-xs text-slate-400",children:"nce alma alan ekleyin."}),i.map(S=>f.jsx("button",{type:"button",onClick:()=>p(S.id),className:ly("px-2 py-1 rounded-full text-xs border",o.workAreaIds.includes(S.id)?"bg-slate-900 text-white border-slate-900":"bg-white border-slate-200"),title:S.name,children:S.name},S.id))]})]}),f.jsxs("div",{className:"md:col-span-3 border rounded p-2",children:[f.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Vardiya Kodlar"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[(!Array.isArray(s)||s.length===0)&&f.jsx("span",{className:"text-xs text-slate-400",children:"nce alma Saatleri sekmesinden kod tanmlayn."}),s==null?void 0:s.map(S=>{var N;return f.jsx("button",{type:"button",onClick:()=>m(S.code),className:ly("px-2 py-1 rounded-full text-xs border",(N=o.shiftCodes)!=null&&N.includes(S.code)?"bg-amber-600 text-white border-amber-600":"bg-white border-slate-200"),title:`${S.code}${S.start&&S.end?` (${S.start}${S.end})`:""}`,children:S.code},S.id)})]})]}),f.jsxs("div",{className:"md:col-span-3 flex gap-2",children:[f.jsx("button",{type:"submit",className:"px-3 py-2 rounded-lg text-white bg-emerald-600",children:u?"Gncelle":"Ekle"}),u&&f.jsx("button",{type:"button",onClick:x,className:"px-3 py-2 rounded-lg bg-slate-100",children:"ptal"})]})]}),f.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[r.map(S=>f.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm p-3",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("div",{className:"font-semibold uppercase tracking-wide text-slate-800",children:S.name}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>v(S),className:"text-xs bg-slate-100 hover:bg-slate-200 px-2 py-1 rounded",children:"Dzenle"}),f.jsx("button",{onClick:()=>w(S.id),className:"text-xs bg-slate-100 hover:bg-slate-200 px-2 py-1 rounded",children:"Sil"})]})]}),f.jsx(IB,{person:S})]},S.id)),r.length===0&&f.jsx("div",{className:"text-sm text-slate-500",children:"Henz kayt yok."})]})]})}const cy={Doctor:"Doctor",Nurse:"Nurse"},uy="personnelSections",fy="personnelActiveSectionId",PB=[{id:"hemsireler",name:"Hemireler",role:"nurse"},{id:"doktorlar",name:"Doktorlar",role:"doctor"}],dy=e=>new URLSearchParams(window.location.search).get(e),hy=(e,t)=>{const r=new URLSearchParams(window.location.search);t?r.set(e,t):r.delete(e);const n=`${window.location.pathname}?${r.toString()}${window.location.hash||""}`;window.history.pushState({},"",n),window.dispatchEvent(new Event("urlchange"))};function jB(e){const t={:"g",:"u",:"s",:"i",:"o",:"c",:"g",:"u",:"s",:"i",I:"i",:"o",:"c"};return(e||"").trim().replace(/[Ii]/g,r=>t[r]||r).toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").slice(0,60)}function MB(e,t){if(!t.has(e))return e;let r=2;for(;t.has(`${e}-${r}`);)r++;return`${e}-${r}`}const yl=e=>(e??"").toString().trim();function BB(e){const r=(Array.isArray(e)?e:[]).map(s=>yl(typeof s=="string"?s:(s==null?void 0:s.name)||(s==null?void 0:s.label)||(s==null?void 0:s.title)||(s==null?void 0:s.id))).filter(Boolean),n=new Set,a=[];for(const s of r){const i=s.toLocaleLowerCase("tr-TR");n.has(i)||(n.add(i),a.push(s))}return a}function UB(e){const r=(Array.isArray(e)?e:[]).map(s=>yl(typeof s=="string"?s:(s==null?void 0:s.code)||(s==null?void 0:s.id))).filter(Boolean),n=new Set,a=[];for(const s of r){const i=s.toLocaleLowerCase("tr-TR");n.has(i)||(n.add(i),a.push(s))}return a}function zB(e={}){return{...e,areas:BB(e.areas??e.workAreas??e.services??e.workAreaIds??[]),shiftCodes:UB(e.shiftCodes??e.codes??e.shifts??[])}}function Kf(e){return Array.isArray(e)?e.map(zB):[]}function my(e){return t=>{e(typeof t=="function"?r=>Kf(t(r)):Kf(t))}}function HB({workAreas:e,workingHours:t,nurses:r,setNurses:n,doctors:a,setDoctors:s}){var C,E,S;const[i,l]=_.useState(()=>Fe.get(uy,PB)),o=dy("sec")||Fe.get(fy,((C=i==null?void 0:i[0])==null?void 0:C.id)||""),[c,u]=_.useState(((E=i.find(N=>N.id===o))==null?void 0:E.id)||((S=i[0])==null?void 0:S.id)||""),d=_.useMemo(()=>i.find(N=>N.id===c)||i[0],[i,c]);_.useEffect(()=>{Fe.set(uy,i);try{window.dispatchEvent(new Event("personnelSectionsChanged"))}catch{}},[i]),_.useEffect(()=>{try{window.dispatchEvent(new Event("personnelSectionsChanged"))}catch{}},[]),_.useEffect(()=>{d&&(Fe.set(fy,d.id),hy("sec",d.id))},[d]),_.useEffect(()=>{const N=()=>{const F=dy("sec");F&&F!==c&&i.find(R=>R.id===F)&&u(F)};return window.addEventListener("urlchange",N),window.addEventListener("popstate",N),()=>{window.removeEventListener("urlchange",N),window.removeEventListener("popstate",N)}},[c,i]);const h=(N,F=c)=>{var D;l(N);const R=N.find(T=>T.id===F);u(R?F:((D=N==null?void 0:N[0])==null?void 0:D.id)||"")},p=(N,F)=>{const R=(F||"").trim();R&&h(i.map(D=>D.id===N?{...D,name:R}:D),N)},m=N=>{var T,j;const F=i.findIndex(Z=>Z.id===N);if(F<0)return;const R=i.filter(Z=>Z.id!==N);if(R.length===0)return;const D=((T=R[Math.max(0,F-1)])==null?void 0:T.id)||((j=R[0])==null?void 0:j.id)||"";h(R,D)},x=(N,F)=>{const R=i.findIndex(Z=>Z.id===N);if(R<0)return;const D=F==="left"?R-1:R+1;if(D<0||D>=i.length)return;const T=[...i],[j]=T.splice(R,1);T.splice(D,0,j),h(T,N)},g=i.map(N=>({id:N.id,title:N.name})),v=N=>`/personel?sec=${encodeURIComponent(N.id)}`,w=_.useMemo(()=>{const F=(Array.isArray(e)?e:[]).map(T=>yl(typeof T=="string"?T:(T==null?void 0:T.name)||(T==null?void 0:T.label)||(T==null?void 0:T.title)||(T==null?void 0:T.id))).filter(Boolean),R=new Set,D=[];for(const T of F){const j=T.toLocaleLowerCase("tr-TR");R.has(j)||(R.add(j),D.push(T))}return D},[e]),y=_.useMemo(()=>my(n),[n]),k=_.useMemo(()=>my(s),[s]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(RB,{tabs:g,activeId:c,onSelect:N=>{u(N),hy("sec",N)},onMove:x,onAdd:N=>{const F=/doktor|doctor/i.test(N)?"doctor":"nurse",R=jB(N)||(F==="doctor"?"doktor-grubu":"hemsire-grubu"),D=MB(R,new Set(i.map(T=>T.id)));h([...i,{id:D,name:N,role:F}],D)},onRename:p,onRemove:m,getHref:v,storageKey:"TopTabsBar:Personnel"}),f.jsx("div",{className:"rounded-lg border bg-white p-4",children:f.jsx($B,{section:d,workAreas:w,workingHours:t,nurses:Kf(r),setNurses:y,doctors:Kf(a),setDoctors:k})})]})}function $B({section:e,workAreas:t,workingHours:r,nurses:n,setNurses:a,doctors:s,setDoctors:i}){return e?e.role==="doctor"?f.jsx(oy,{label:e.name,role:cy.Doctor,people:s,setPeople:i,workAreas:t,workingHours:r}):f.jsx(oy,{label:e.name,role:cy.Nurse,people:n,setPeople:a,workAreas:t,workingHours:r}):null}async function VB(e){var r;const t=await La.post("/register",e);return(r=t.data)!=null&&r.token&&Gs(t.data.token),t.data}async function WB(e){var r;const t=await La.post("/login",e);return(r=t.data)!=null&&r.token&&Gs(t.data.token),t.data}const GB=e=>String(e||"").replace(/\D+/g,"").slice(0,11),g_=e=>{let t=String(e||"").replace(/\D+/g,"");return t.startsWith("0090")&&(t=t.slice(2)),t.length===11&&t.startsWith("0")?"90"+t.slice(1):t.length===10?"90"+t:t},YB=e=>/@/.test(String(e||""));function KB(e){const t=String(e||"").trim();if(!t)return"";if(YB(t))return t.toLowerCase();const r=t.replace(/\D+/g,"");return r.length===11?r:g_(r)}function XB(){const[e,t]=_.useState("login"),[r,n]=_.useState(!1),[a,s]=_.useState(""),[i,l]=_.useState(""),[o,c]=_.useState(""),[u,d]=_.useState(""),[h,p]=_.useState(""),[m,x]=_.useState(""),[g,v]=_.useState(""),[w,y]=_.useState(""),k=_.useMemo(()=>KB(i),[i]),C=_.useMemo(()=>GB(h),[h]),E=_.useMemo(()=>g_(m),[m]);async function S(j){if(j.preventDefault(),!r){s(""),n(!0);try{const{token:Z}=await WB({identifier:k,password:o});Z&&Gs(Z),s("Giri baarl, ynlendiriliyor"),setTimeout(()=>window.location.href="/",400)}catch(Z){s(Z.message||"Giri baarsz")}finally{n(!1)}}}async function N(j){if(j.preventDefault(),!r){s(""),n(!0);try{const Z={name:u.trim(),tc:C,phone:E,email:g.trim().toLowerCase(),password:w},{token:re}=await VB(Z);re&&Gs(re),s("Kayt baarl, giri yapld."),setTimeout(()=>window.location.href="/",600)}catch(Z){s(Z.message||"Kayt baarsz")}finally{n(!1)}}}const F="w-full rounded-lg border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-sky-400",R="w-full rounded-lg px-4 py-2 font-medium text-white bg-sky-600 hover:bg-sky-700 disabled:opacity-60",D=r||!k||(o||"").length<1,T=r||!u.trim()||C.length!==11||E.length<12||!g.trim()||(w||"").length<6;return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-slate-50 to-slate-100 p-4",children:f.jsxs("div",{className:"w-full max-w-md bg-white shadow-xl rounded-2xl p-6",children:[f.jsxs("div",{className:"text-center mb-4",children:[f.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-slate-100 text-slate-600",children:"Hastane Nbet Sistemi"}),f.jsx("h1",{className:"text-xl font-semibold mt-2",children:e==="login"?"Giri yap":"Hesap olutur"}),f.jsx("p",{className:"text-slate-500 text-sm",children:e==="login"?"TC / Telefon / E-posta ile giri yapn":"Ad Soyad, TC, Telefon, E-posta ile kayt olun"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-4 bg-slate-100 p-1 rounded-xl",children:[f.jsx("button",{className:`rounded-lg py-2 text-sm ${e==="login"?"bg-white shadow font-medium":""}`,onClick:()=>t("login"),children:"Giri"}),f.jsx("button",{className:`rounded-lg py-2 text-sm ${e==="register"?"bg-white shadow font-medium":""}`,onClick:()=>t("register"),children:"Kayt Ol"})]}),e==="login"?f.jsxs("form",{className:"space-y-3",onSubmit:S,children:[f.jsx("input",{className:F,placeholder:"TC / Telefon / E-posta",value:i,onChange:j=>l(j.target.value),required:!0,autoComplete:"username"}),f.jsx("input",{className:F,type:"password",placeholder:"Parola",value:o,onChange:j=>c(j.target.value),required:!0,autoComplete:"current-password"}),f.jsx("button",{className:R,disabled:D,children:r?"Gnderiliyor":"Giri Yap"})]}):f.jsxs("form",{className:"space-y-3",onSubmit:N,children:[f.jsx("input",{className:F,placeholder:"Ad Soyad",value:u,onChange:j=>d(j.target.value),required:!0}),f.jsx("input",{className:F,placeholder:"TC (11 hane)",value:h,onChange:j=>p(j.target.value),required:!0,inputMode:"numeric"}),f.jsx("input",{className:F,placeholder:"Telefon (5XXXXXXXXX / 0XXXXXXXXXX)",value:m,onChange:j=>x(j.target.value),required:!0,inputMode:"tel"}),f.jsx("input",{className:F,placeholder:"E-posta",type:"email",value:g,onChange:j=>v(j.target.value),required:!0}),f.jsx("input",{className:F,type:"password",placeholder:"Parola (min 6)",value:w,onChange:j=>y(j.target.value),required:!0,minLength:6,autoComplete:"new-password"}),f.jsx("button",{className:R,disabled:T,children:r?"Gnderiliyor":"Kayt Ol"})]}),!!a&&f.jsx("div",{className:"mt-4 text-center text-sm text-slate-700",children:a})]})})}const il={ADMIN:"ADMIN",AUTHORIZED:"AUTHORIZED",STANDARD:"STANDARD"},vt={USERS_READ:"USERS_READ",USERS_WRITE:"USERS_WRITE",SERVICES_READ:"SERVICES_READ",SERVICES_WRITE:"SERVICES_WRITE",SCHEDULE_READ:"SCHEDULE_READ",SCHEDULE_WRITE:"SCHEDULE_WRITE",LEAVES_READ:"LEAVES_READ",LEAVES_WRITE:"LEAVES_WRITE",PARAMETERS_READ:"PARAMETERS_READ",PARAMETERS_WRITE:"PARAMETERS_WRITE",EXPORT_IMPORT:"EXPORT_IMPORT"},JB=Object.values(vt),Qd={[il.ADMIN]:[...JB],[il.AUTHORIZED]:[vt.SERVICES_READ,vt.SCHEDULE_READ,vt.SCHEDULE_WRITE,vt.LEAVES_READ,vt.LEAVES_WRITE,vt.PARAMETERS_READ,vt.EXPORT_IMPORT],[il.STANDARD]:[vt.SERVICES_READ,vt.SCHEDULE_READ,vt.LEAVES_READ]},qB=e=>(e==null?void 0:e.role)===il.ADMIN,py=e=>(e==null?void 0:e.role)===il.AUTHORIZED,ZB=e=>(e==null?void 0:e.role)===il.STANDARD;function QB(e){return(Qd==null?void 0:Qd[e])||[]}function e9(e){if(!e)return[];const t=Array.isArray(e.permissions)?e.permissions:[],r=QB(e.role);return Array.from(new Set([...t,...r]))}function t9(e){return Array.isArray(e)?new Set(e):new Set}function xy(e,t){return t?t9(e==null?void 0:e.serviceIds).has(t):!1}function r9(e,t,r={}){if(!e||!t)return!1;if(qB(e))return!0;const{serviceId:n}=r;if(!e9(e).includes(t))return!1;switch(t){case vt.SERVICE_MANAGE:return!1;case vt.SERVICE_ASSIGN:case vt.ROSTER_EDIT:case vt.LEAVE_EDIT:return py(e)?xy(e,n):!1;case vt.ROSTER_VIEW:case vt.LEAVE_VIEW:case vt.SERVICE_VIEW:return py(e)?n?xy(e,n):!0:ZB(e)?!n:!1;default:return!0}}function Xf(e=""){return e.toString().trim().toUpperCase().replace(//g,"G").replace(//g,"U").replace(//g,"S").replace(//g,"I").replace(//g,"O").replace(//g,"C").replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,"")}function n9(e,t=300){const r=_.useRef();return(...n)=>{clearTimeout(r.current),r.current=setTimeout(()=>e(...n),t)}}const eh=e=>{const t=String(e??"").trim().toLowerCase();if(!t)return!0;const r=["1","true","evet","aktif","active","yes","x"],n=["0","false","hayir","hayr","pasif","inactive","no"];return r.includes(t)?!0:!n.includes(t)};function a9({open:e,onClose:t,onSubmit:r,existingCodes:n,initial:a}){const[s,i]=_.useState(""),[l,o]=_.useState(""),[c,u]=_.useState(!0);if(_.useEffect(()=>{e?(i((a==null?void 0:a.name)||""),o((a==null?void 0:a.code)||""),u(!a)):(i(""),o(""),u(!0))},[e,a]),!e)return null;const d=(l||"").toUpperCase(),h=d&&n.has(d)&&d!==((a==null?void 0:a.code)||"").toUpperCase();return f.jsx("div",{className:"fixed inset-0 z-50 bg-black/30 flex items-center justify-center p-4",children:f.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-5 shadow-xl",children:[f.jsx("div",{className:"mb-1 flex items-center justify-between",children:f.jsx("div",{className:"text-lg font-semibold",children:a?"Servisi Dzenle":"Yeni Servis"})}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"Ad"}),f.jsx("input",{className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-sky-400",placeholder:"rn. Genel Cerrahi",value:s,onChange:p=>{const m=p.target.value;i(m),c&&o(Xf(m))}})]}),f.jsx("div",{children:f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"Kod"}),f.jsx("input",{className:`w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 ${h?"border-red-400 focus:ring-red-300":"focus:ring-sky-400"}`,placeholder:"GENEL_CERRAHI",value:l,onChange:p=>{o(p.target.value.toUpperCase()),u(!1)}}),h&&f.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Bu kod zaten kullanlyor."})]}),f.jsx("button",{className:"h-10 px-3 border rounded-lg",onClick:()=>{o(Xf(s)),u(!0)},children:"Kod ret"})]})})]}),f.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[f.jsx("button",{className:"border rounded-xl px-4 py-2",onClick:t,children:"Vazge"}),f.jsx("button",{className:"rounded-xl bg-emerald-600 text-white px-4 py-2 hover:bg-emerald-700 disabled:opacity-50",disabled:!s.trim()||!l.trim()||h,onClick:()=>r({name:s.trim(),code:l.trim().toUpperCase()}),children:"Kaydet"})]})]})})}function s9({row:e,canManage:t,onEdit:r,onDelete:n,onToggle:a}){const s=f.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[11px] border "+(e.active?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-600"),children:e.active?"Aktif":"Pasif"});return f.jsxs("div",{className:"relative rounded-xl border bg-white shadow-sm",children:[f.jsxs("div",{className:"px-4 pt-3 pb-2 flex items-start justify-between",children:[f.jsx("div",{className:"text-[13px] font-semibold tracking-wide uppercase text-slate-800",children:e.name}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{className:"text-[12px] px-2 py-1 border rounded hover:bg-slate-50 disabled:opacity-50",disabled:!t,onClick:r,children:"Dzenle"}),f.jsx("button",{className:"text-[12px] px-2 py-1 border rounded hover:bg-red-50 text-red-600 disabled:opacity-50",disabled:!t,onClick:n,children:"Sil"})]})]}),f.jsx("div",{className:"mx-4 h-1 rounded-full bg-rose-500/80"}),f.jsx("div",{className:"p-4",children:f.jsxs("div",{className:"grid grid-cols-[140px_1fr] gap-y-2 text-[12px]",children:[f.jsx("div",{className:"text-slate-500",children:"KOD"}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("span",{className:"inline-flex items-center rounded-full border bg-yellow-50 text-yellow-800 px-2 py-0.5 font-mono",children:e.code})}),f.jsx("div",{className:"text-slate-500",children:"DURUM"}),f.jsxs("div",{className:"flex items-center gap-2",children:[s,t&&f.jsx("button",{className:"text-[12px] px-2 py-0.5 border rounded hover:bg-slate-50",onClick:a,children:e.active?"Pasifletir":"Aktifletir"})]})]})})]})}function i9(){const{user:e}=pi(),t=w0(),r=String((e==null?void 0:e.role)||"").toUpperCase(),n=new Set((e==null?void 0:e.permissions)||[]),a=r==="ADMIN"||n.has(vt.SERVICES_WRITE);if(!(a||r==="AUTHORIZED"||n.has(vt.SERVICES_READ)))return f.jsx("div",{className:"p-4 text-sm text-slate-600",children:"Bu sayfa iin yetkiniz yok."});const[i,l]=_.useState(""),[o,c]=_.useState("all"),[u,d]=_.useState("name"),[h,p]=_.useState(!0),[m,x]=_.useState(!1),[g,v]=_.useState(null),[w,y]=_.useState(0),k=()=>y(j=>j+1);n9((j,Z)=>{t.update(j,Z),k()},250);const C=_.useMemo(()=>{const j=i.trim().toLowerCase();let Z=t.list()||[];return j&&(Z=Z.filter(re=>(re.name||"").toLowerCase().includes(j)||(re.code||"").toLowerCase().includes(j))),o==="active"&&(Z=Z.filter(re=>re.active)),o==="passive"&&(Z=Z.filter(re=>!re.active)),Z=[...Z].sort((re,W)=>{const Q=(re[u]??"").toString().toLowerCase(),H=(W[u]??"").toString().toLowerCase();return Q<H?h?-1:1:Q>H?h?1:-1:0}),Z},[t,i,o,u,h,w]),E=_.useMemo(()=>new Set((t.list()||[]).map(j=>(j.code||"").toUpperCase())),[t,w]),S=_.useRef(null),N=()=>{const j=(Z,re)=>t.add({name:Z,code:re,active:!0});j("Kardiyoloji","KARDIYOLOJI"),j("Genel Cerrahi","GENEL_CERRAHI"),j("Acil Servis","ACIL"),j("Radyoloji","RADYOLOJI"),j("Biyokimya Lab.","BIYOKIMYA"),j("Ortopedi","ORTOPEDI"),k()};function F(){const j=["Ad,Kod,Aktif","Kardiyoloji,KARDIYOLOJI,1","Genel Cerrahi,GENEL_CERRAHI,1","Radyoloji,RADYOLOJI,1"].join(`
`),Z=new Blob([j],{type:"text/csv;charset=utf-8"}),re=URL.createObjectURL(Z),W=document.createElement("a");W.href=re,W.download="servis_sablon.csv",W.click(),URL.revokeObjectURL(re)}function R(){const j=(t.list()||[]).map(W=>({Ad:W.name||"",Kod:W.code||"",Aktif:W.active?1:0})),Z=Ve.json_to_sheet(j,{header:["Ad","Kod","Aktif"]}),re=Ve.book_new();Ve.book_append_sheet(re,Z,"Servisler"),jn(re,"servisler.xlsx")}function D(j){const Z=j.split(/\r?\n/).filter(Boolean);if(!Z.length)return[];const re=Z[0].split(",").map(Q=>Q.trim().toLowerCase()),W={name:re.findIndex(Q=>["ad","isim","name"].includes(Q)),code:re.findIndex(Q=>["kod","code"].includes(Q)),active:re.findIndex(Q=>["aktif","active","durum"].includes(Q))};return Z.slice(1).map(Q=>{const H=Q.split(",");return{name:(H[W.name]??"").trim(),code:(H[W.code]??"").trim(),active:eh(H[W.active])}}).filter(Q=>Q.name||Q.code)}async function T(j){var re;const Z=(re=j.target.files)==null?void 0:re[0];if(Z)try{let W=[];if(Z.name.toLowerCase().split(".").pop()==="csv"||Z.type.includes("csv")||Z.type.startsWith("text/")){const A=await Z.text();W=D(A)}else{const A=await Z.arrayBuffer(),O=fn(A,{type:"array"}),P=O.Sheets[O.SheetNames[0]],U=Ve.sheet_to_json(P,{header:1});if(U.length){const q=(U[0]||[]).map(B=>String(B||"").trim().toLowerCase()),J={name:q.findIndex(B=>["ad","isim","name"].includes(B)),code:q.findIndex(B=>["kod","code"].includes(B)),active:q.findIndex(B=>["aktif","active","durum"].includes(B))};W=U.slice(1).map(B=>({name:String(B[J.name]??"").trim(),code:String(B[J.code]??"").trim(),active:eh(B[J.active])})).filter(B=>B.name||B.code)}}if(!W.length){alert("Geerli bir satr bulunamad.");return}const H=t.list(),L=new Map(H.map(A=>[String(A.code||"").toUpperCase(),A])),ee=A=>{let O=(A||"").toUpperCase();if(O||(O=Xf("SERVIS")),!L.has(O))return O;let P=2;for(;L.has(`${O}_${P}`);)P++;return`${O}_${P}`};let te=0,b=0;W.forEach(A=>{var J,B;const O=(J=A.name)==null?void 0:J.trim();let P=((B=A.code)==null?void 0:B.trim().toUpperCase())||Xf(O);const U=eh(A.active);if(!O)return;const q=L.get(P);if(q)t.update(q.id,{name:O,active:U,code:P}),b++;else{P=ee(P);const ne=t.add({name:O,code:P,active:U});L.set(P,ne),te++}}),k(),alert(`Excelden ykleme tamamland.
Eklendi: ${te}
Gncellendi: ${b}`)}catch(W){console.error(W),alert("Dosya okunurken bir hata olutu. Ltfen ablona uygun dosya ykleyin.")}finally{j.target.value=""}}return f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsx("div",{className:"flex-1 min-w-[220px]",children:f.jsx("input",{className:"border rounded px-3 py-2 w-full",placeholder:"Ara (ad/kod)",value:i,onChange:j=>l(j.target.value)})}),f.jsxs("select",{className:"border rounded px-3 py-2",value:o,onChange:j=>c(j.target.value),children:[f.jsx("option",{value:"all",children:"Tm"}),f.jsx("option",{value:"active",children:"Sadece Aktif"}),f.jsx("option",{value:"passive",children:"Sadece Pasif"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("select",{className:"border rounded px-3 py-2",value:u,onChange:j=>d(j.target.value),children:[f.jsx("option",{value:"name",children:"Ada gre"}),f.jsx("option",{value:"code",children:"Koda gre"}),f.jsx("option",{value:"active",children:"Duruma gre"})]}),f.jsx("button",{className:"border rounded px-2 py-2",onClick:()=>p(j=>!j),title:"Sralama yn",children:h?"AZ":"ZA"})]}),f.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[f.jsx("button",{className:"px-3 py-2 rounded border",onClick:F,children:"ablon"}),f.jsx("button",{className:"px-3 py-2 rounded border",onClick:R,children:"Excele Aktar"}),a&&f.jsxs(f.Fragment,{children:[f.jsx("input",{ref:S,type:"file",accept:".xlsx,.xls,.csv,text/csv",className:"hidden",onChange:T}),f.jsx("button",{className:"px-3 py-2 rounded border",onClick:()=>{var j;return(j=S.current)==null?void 0:j.click()},children:"Excelden Ykle"}),f.jsx("button",{className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700",onClick:()=>{v(null),x(!0)},children:"Ekle"})]})]})]}),C.length===0&&f.jsxs("div",{className:"border rounded-xl p-4 text-sm text-slate-600 flex items-center justify-between",children:[f.jsx("span",{children:"Henz servis bulunamad."}),a&&f.jsx("button",{onClick:N,className:"px-3 py-2 rounded border",children:"Hzl Balat"})]}),C.length>0&&f.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:C.map(j=>f.jsx(s9,{row:j,canManage:a,onEdit:()=>{v(j),x(!0)},onDelete:()=>{confirm(`${j.name||j.code} silinsin mi?`)&&(t.remove(j.id),k())},onToggle:()=>{t.toggle(j.id),k()}},j.id))}),!a&&f.jsx("div",{className:"text-xs text-slate-500",children:"Not: Dzenleme yalnzca yetkisi olan kullanclar tarafndan yaplabilir."}),f.jsx(a9,{open:m,onClose:()=>x(!1),existingCodes:E,initial:g,onSubmit:j=>{if(g){const{name:Z,code:re}=j;Z!==g.name&&t.update(g.id,{name:Z}),re!==g.code&&t.update(g.id,{code:re})}else t.add({...j,active:!0});x(!1),v(null),k()}})]})}const v_="hastane:users";function Ia(){try{return JSON.parse(localStorage.getItem(v_)||"[]")}catch{return[]}}function Pc(e){localStorage.setItem(v_,JSON.stringify(e||[]))}function l9(e){const t=Ia(),r=t.findIndex(n=>n.id===e.id);return r>=0?t[r]=e:t.push(e),Pc(t),e}const to=e=>(e||"").toString().trim().toLowerCase().replace(/\s+/g," ");function o9(e){const t=to(e);return Ia().find(r=>to(r.tc)===t||to(r.email)===t||to(r.phone)===t||to(r.name)===t)}const c9=new Set(["ADMIN","AUTHORIZED","STANDARD"]);function u9(e){const t=String(e||"").toUpperCase();return c9.has(t)?t:"STANDARD"}const f9=new Set(["pending","active","rejected"]);function d9(e){const t=String(e||"").toLowerCase();return f9.has(t)?t:"pending"}function Au(e,t){const r=Ia(),n=r.findIndex(a=>a.id===e);n<0||(r[n].status=d9(t),Pc(r))}function h9(e,t){const r=Ia(),n=r.findIndex(a=>a.id===e);n<0||(r[n].role=u9(t||r[n].role),Pc(r))}function m9(e,t=[]){const r=Ia(),n=r.findIndex(a=>a.id===e);n<0||(r[n].services=Array.isArray(t)?t.map(String):[],Pc(r))}function gy(e){const t=o9(e);if(!t)throw new Error("Kullanc bulunamad.");return t.status="active",l9(t),t}function ho({children:e,tone:t="slate"}){const r={slate:"bg-slate-100 text-slate-700",green:"bg-emerald-100 text-emerald-700",amber:"bg-amber-100 text-amber-700",red:"bg-rose-100 text-rose-700"}[t]||"bg-slate-100 text-slate-700";return f.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${r}`,children:e})}function p9({open:e,initialIds:t=[],onClose:r,onSave:n}){const a=w0(),[s,i]=_.useState(()=>new Set((t||[]).map(String))),[l,o]=_.useState(""),c=_.useMemo(()=>{var m;const d=((m=a.list)==null?void 0:m.call(a))||[],h=l.trim().toLowerCase();let p=d;return h&&(p=p.filter(x=>String(x.name||"").toLowerCase().includes(h)||String(x.code||"").toLowerCase().includes(h))),[...p].sort((x,g)=>Number(g.active)-Number(x.active)||(x.name||"").localeCompare(g.name||""))},[a,l]);if(_.useEffect(()=>{e&&(i(new Set((t||[]).map(String))),o(""))},[e,t]),!e)return null;const u=d=>{const h=String(d),p=new Set(s);p.has(h)?p.delete(h):p.add(h),i(p)};return f.jsx("div",{className:"fixed inset-0 z-50 bg-black/30 flex items-center justify-center p-4",children:f.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-white shadow-xl",children:[f.jsxs("div",{className:"px-5 py-4 border-b flex items-center justify-between",children:[f.jsx("div",{className:"font-semibold",children:"Servis ata"}),f.jsx("input",{className:"h-9 rounded-lg border px-3 text-sm",placeholder:"Ara (ad/kod)",value:l,onChange:d=>o(d.target.value)})]}),f.jsx("div",{className:"max-h-[52vh] overflow-auto p-2",children:c.length===0?f.jsx("div",{className:"p-4 text-sm text-slate-600",children:"Servis bulunamad."}):f.jsx("ul",{className:"divide-y",children:c.map(d=>{const h=String(d.id??d._id??d.code??d.name),p=s.has(h);return f.jsxs("li",{className:"flex items-center gap-3 px-3 py-2",children:[f.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:p,onChange:()=>u(h)}),f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"text-[13px] font-medium",children:d.name||d.code}),f.jsx("div",{className:"text-[11px] text-slate-500",children:d.code})]}),f.jsx(ho,{tone:d.active?"green":"slate",children:d.active?"aktif":"pasif"})]},h)})})}),f.jsxs("div",{className:"px-5 py-4 border-t flex justify-end gap-2",children:[f.jsx("button",{className:"px-3 h-9 rounded-lg border",onClick:r,children:"ptal"}),f.jsx("button",{className:"px-4 h-9 rounded-lg bg-sky-600 text-white hover:bg-sky-700",onClick:()=>n(Array.from(s)),children:"Kaydet"})]})]})})}function x9(){const[e,t]=_.useState(()=>Ia()),[r,n]=_.useState(""),[a,s]=_.useState(null),i=w0(),l=_.useMemo(()=>{var v;const g=new Map;return(((v=i.list)==null?void 0:v.call(i))||[]).forEach(w=>{g.set(String(w.id??w._id??w.code??w.name),w)}),g},[i]);_.useEffect(()=>{const g=()=>t(Ia());return window.addEventListener("storage",g),()=>window.removeEventListener("storage",g)},[]);const o=_.useMemo(()=>{const g=r.trim().toLowerCase();let v=e||[];return g&&(v=v.filter(w=>[w.name,w.email,w.phone,w.tc,w.role,w.status].map(k=>String(k||"").toLowerCase()).some(k=>k.includes(g)))),v},[e,r]),c=()=>t(Ia()),u=g=>{const v=String(g||"").toUpperCase();return v==="ADMIN"?f.jsx(ho,{tone:"red",children:"ADMIN"}):v==="AUTHORIZED"||v==="STAFF"?f.jsx(ho,{tone:"amber",children:v}):f.jsx(ho,{children:"STANDARD"})},d=(g=[])=>{const w=(Array.isArray(g)?g:[]).map(y=>{const k=l.get(String(y));return k&&(k.name||k.code||"").trim()||null}).filter(Boolean);return w.length?w.join(", "):"-"},h=!!_p(),p=async g=>{if(!h){gy(g.email||g.tc||g.phone||g.name),Au(g.id,"active"),c();return}const v=String(g._id||g.id||"");if(v.length!==24){gy(g.email||g.tc||g.phone||g.name),Au(g.id,"active"),c();return}try{await La.post(`../users/${v}/activate`),Au(g.id,"active"),c()}catch(w){alert((w==null?void 0:w.message)||"Aktifletirme baarsz")}},m=(g,v)=>{h9(g.id,v),c()},x=g=>{Au(g.id,"pending"),c()};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{className:"h-10 px-3 rounded-lg border w-80",placeholder:"Ara: ad / tc / tel / mail / rol / durum",value:r,onChange:g=>n(g.target.value)}),f.jsx("button",{className:"h-10 px-3 rounded-lg border",onClick:c,children:"Yenile"})]}),o.length===0&&f.jsx("div",{className:"p-4 border rounded-xl text-sm text-slate-600",children:"Kayt bulunamad."}),f.jsx("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 xl:grid-cols-3",children:o.map(g=>{const v=g.id||g._id,w=(Array.isArray(g.serviceIds)?g.serviceIds:g.services)||[];return f.jsxs("div",{className:"rounded-xl border bg-white shadow-sm p-3",children:[f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsx("div",{className:"font-semibold text-[14px]",children:g.name||"-"}),f.jsx(ho,{tone:g.status==="active"?"green":g.status==="pending"?"amber":"slate",children:g.status||(g.active===!1?"pending":"active")})]}),f.jsxs("div",{className:"mt-2 text-[12px] space-y-1",children:[f.jsxs("div",{children:["TC: ",g.tc||"-"]}),f.jsxs("div",{children:["Tel: ",g.phone||"-"]}),f.jsxs("div",{children:["Mail: ",g.email||"-"]}),f.jsxs("div",{children:["Rol: ",u(g.role)]}),f.jsxs("div",{children:["Servisler: ",d(w)]})]}),f.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[g.status!=="active"?f.jsx("button",{className:"text-[12px] px-3 py-1 rounded bg-emerald-600 text-white",onClick:()=>p(g),children:"Aktifletir"}):f.jsx("button",{className:"text-[12px] px-3 py-1 rounded border",onClick:()=>x(g),children:"Askya al"}),f.jsx("button",{className:"text-[12px] px-3 py-1 rounded border",onClick:()=>{m(g,"ADMIN")},children:"Admin yap"}),f.jsx("button",{className:"text-[12px] px-3 py-1 rounded border",onClick:()=>{m(g,"AUTHORIZED")},children:"Yetkili yap"}),f.jsx("button",{className:"text-[12px] px-3 py-1 rounded border",onClick:()=>{m(g,"STANDARD")},children:"Standart yap"}),f.jsx("button",{className:"text-[12px] px-3 py-1 rounded border",onClick:()=>s({id:v,name:g.name||g.email||g.tc,services:w.map(String)}),children:"Servis ata"}),f.jsx("button",{className:"text-[12px] px-3 py-1 rounded border text-red-600",onClick:()=>{if(confirm(`"${g.name||g.email}" silinsin mi?`)){const y=(Ia()||[]).filter(k=>(k.id||k._id)!==v);Pc(y),c()}},children:"Sil"})]})]},v)})}),f.jsx(p9,{open:!!a,initialIds:(a==null?void 0:a.services)||[],onClose:()=>s(null),onSave:async g=>{try{h?await La.post(`../users/${a.id}/services`,{serviceIds:g}):m9(a.id,g),s(null),c()}catch(v){alert(v.message||"Kaydedilemedi")}}})]})}const y_="lastLeaveCodeV1",g9=(e="Y")=>{try{return localStorage.getItem(y_)||e}catch{return e}},vy=e=>{try{localStorage.setItem(y_,e)}catch{}},Qa=e=>String(e).padStart(2,"0"),v9=(e,t,r)=>["Paz","Pzt","Sal","ar","Per","Cum","Cmt"][new Date(e,t,r).getDay()]||"",Sm=e=>{if(!e)return"";if(typeof e=="string")return e.toUpperCase();if(Array.isArray(e))return e.map(Sm).filter(Boolean).join(",");if(typeof e=="object"){const t=e.code??e.type??e.kind??e.short??"";return String(t||"").toUpperCase()}return String(e).toUpperCase()};function y9({person:e,year:t,month:r,leaveTypes:n=[]}){var x;const[a,s]=_.useState(0),i=xC(t,r+1),l=_.useMemo(()=>{const g=(n||[]).map(v=>{const w=(v==null?void 0:v.kisaltma)??(v==null?void 0:v.code)??(v==null?void 0:v.abbr)??(v==null?void 0:v.short)??(v==null?void 0:v.Kod)??(v==null?void 0:v.Ksaltma)??"",y=(v==null?void 0:v.turAdi)??(v==null?void 0:v.name)??(v==null?void 0:v.TrAd)??String(w).toUpperCase();return{code:String(w||"").toUpperCase(),name:y}});return["Y","R","S","AN","B"].forEach(v=>{g.some(w=>w.code===v)||g.push({code:v,name:v})}),g.sort((v,w)=>v.code.localeCompare(w.code,"tr",{sensitivity:"base"}))},[n]),o=((x=l[0])==null?void 0:x.code)||"Y",[c,u]=_.useState(()=>{const g=g9(o);return l.some(v=>v.code===g)?g:o});_.useEffect(()=>{l.some(g=>g.code===c)||(u(o),vy(o))},[l,c,o]);const d=_.useMemo(()=>new Date(t,r+1,0).getDate(),[t,r]),h=_.useMemo(()=>{var w;const g=$a(),v=String((e==null?void 0:e.id)??"");return((w=g==null?void 0:g[v])==null?void 0:w[i])||{}},[e,i,a]);_.useEffect(()=>{const g=()=>s(v=>v+1);return window.addEventListener("leaves:changed",g),()=>window.removeEventListener("leaves:changed",g)},[]);const p=g=>{if(!(e!=null&&e.id))return;const v=`${i}-${Qa(g)}`,w=h[v]??h[Qa(g)]??h[String(g)]??null,y=Sm(w);y&&y===c?dg(e.id,v):fg(e.id,v,c),s(k=>k+1)},m=g=>{if(!(e!=null&&e.id))return;const v=`${i}-${Qa(g)}`;dg(e.id,v),s(w=>w+1)};return f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[f.jsxs("div",{className:"font-semibold",children:[(e==null?void 0:e.name)||"Kii","  ",i]}),f.jsxs("label",{className:"text-sm text-slate-500 flex items-center gap-2",children:["Varsaylan kod:",f.jsx("select",{value:c,onChange:g=>{u(g.target.value),vy(g.target.value)},className:"border rounded px-2 py-1 text-sm",title:"Tek tkta kullanlacak kod",children:l.map(g=>f.jsxs("option",{value:g.code,children:[g.code,"  ",g.name]},g.code))})]})]}),f.jsx("div",{className:"grid grid-cols-7 gap-2",children:Array.from({length:d},(g,v)=>v+1).map(g=>{const v=`${i}-${Qa(g)}`,w=h[v]??h[Qa(g)]??h[String(g)]??null,y=Sm(w);return f.jsxs("div",{className:"border rounded-xl p-2 hover:bg-slate-50 cursor-pointer",onClick:()=>p(g),onDoubleClick:()=>m(g),title:y?`${Qa(g)} ${i}  ${y}  Tek tk deitir/kaldr, ift tk temizle`:`${Qa(g)} ${i}  Tek tk ${c} yaz`,children:[f.jsxs("div",{className:"flex items-baseline justify-between mb-1",children:[f.jsx("span",{className:"text-xs text-slate-500",children:v9(t,r,g)}),f.jsx("span",{className:"text-xs font-medium",children:Qa(g)})]}),f.jsx("div",{className:"h-8 flex items-center",children:y?f.jsx("span",{className:"text-xs inline-flex px-2 py-0.5 rounded bg-amber-100 border border-amber-200 text-amber-900",children:y}):f.jsx("span",{className:"text-xs text-slate-400",children:""})})]},g)})}),f.jsxs("p",{className:"mt-3 text-xs text-slate-500",children:["pucu: Hcreye ",f.jsx("b",{children:"tek tk"})," seili kodu yazar/deitirir, ",f.jsx("b",{children:"ift tk"})," temizler. stten Varsaylan kodu deitirerek tek tkta yazlacak deeri belirleyebilirsin."]})]})}const w_="activeYM:v2";function S_(e){return e=Number(e),e<1?1:e>12?12:e}function w9(){try{const t=Fe.get(w_);if(t&&t.year&&t.month)return{year:Number(t.year),month:S_(t.month)}}catch{}const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1}}function S9({year:e,month:t}){if(!e||!t)return;const r={year:Number(e),month:S_(t)};try{Fe.set(w_,r)}catch{}try{window.dispatchEvent(new CustomEvent("activeYM:change",{detail:r}))}catch{}}const k9="HNS",E9=["people","areas","shifts","services","dutyRules","personLeavesV2","personLeaves","allLeaves","activeYM","plannerYear","plannerMonth","rosterCache","scheduleState","overtimeState"];function _9(){return new Date().toISOString()}function N9(e,t=null){try{return e?JSON.parse(e):t}catch{return t}}function A9(e=new Date){const t=r=>String(r).padStart(2,"0");return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}_${t(e.getHours())}-${t(e.getMinutes())}`}function b9(e=E9){const t={};return e.forEach(r=>{const n=localStorage.getItem(r);if(!n)return;const a=N9(n,null);a!=null&&(t[r]=a)}),t}function T9(){const e=b9();return{schema:"hns.backup.v1",createdAt:_9(),app:{name:"Hastane Nbet Sistemi",key:k9,version:"1.0"},items:e}}function C9(e){return new Blob([JSON.stringify(e,null,2)],{type:"application/json"})}function F9(e="yedek"){const t=T9(),r=C9(t),n=URL.createObjectURL(r),a=document.createElement("a"),s=A9();return a.href=n,a.download=`${e}_${s}.json`,document.body.appendChild(a),a.click(),a.remove(),setTimeout(()=>URL.revokeObjectURL(n),5e3),t}async function R9(e){if(!e||typeof e!="object")throw new Error("Geersiz yedek dosyas");const t=e.items||e;if(!t||typeof t!="object")throw new Error("Yedekte items bulunamad");for(const[r,n]of Object.entries(t))try{localStorage.setItem(r,JSON.stringify(n))}catch{}try{window.dispatchEvent(new Event("data:restored"))}catch{}return Object.keys(t)}function I9(e){return new Promise((t,r)=>{const n=new FileReader;n.onerror=()=>r(new Error("Dosya okunamad")),n.onload=()=>{try{const a=JSON.parse(String(n.result));R9(a).then(t).catch(r)}catch{r(new Error("JSON parse edilemedi"))}},n.readAsText(e,"utf-8")})}function D9({compact:e=!1}){const t=_.useRef(null),[r,n]=_.useState("");async function a(){try{F9("hns_yedek"),n(" Yedek indirildi"),setTimeout(()=>n(""),2e3)}catch(o){n(" Yedek indirilemedi: "+o.message)}}async function s(o){var u;const c=(u=o.target.files)==null?void 0:u[0];if(c)try{const d=await I9(c);n(` Yedekten yklendi (${d.length} anahtar)  sayfa yenileniyor`),setTimeout(()=>window.location.reload(),800)}catch(d){n(" Ykleme baarsz: "+d.message)}finally{o.target.value=""}}function i(){var o;(o=t.current)==null||o.click()}const l=e?"px-2 py-1 text-sm rounded bg-slate-100 hover:bg-slate-200":"px-3 py-2 text-sm rounded bg-slate-100 hover:bg-slate-200";return f.jsxs("div",{className:"flex items-center gap-8",children:[f.jsxs("div",{className:"flex items-center gap-8",children:[f.jsx("button",{className:l,onClick:a,children:" Yedei ndir"}),f.jsx("button",{className:l,onClick:i,children:" Yedekten Ykle"}),f.jsx("input",{ref:t,type:"file",accept:"application/json,.json",className:"hidden",onChange:s})]}),r&&f.jsx("div",{className:"text-xs text-slate-600",children:r})]})}function bu(e){try{window.history.pushState({},"",e),window.dispatchEvent(new Event("urlchange"))}catch{}}let yy=!1;function O9(){if(yy)return;yy=!0;const e=t=>{const r=window.history[t];return function(...n){const a=r.apply(this,n);try{window.dispatchEvent(new Event("urlchange"))}catch{}return a}};try{window.history.pushState=e("pushState"),window.history.replaceState=e("replaceState")}catch{}}const wy=[{id:"hemsireler",name:"Hemireler"},{id:"doktorlar",name:"Doktorlar"}],L9="h-9",Zu=`list-none inline-flex items-center ${L9} rounded-lg px-3 text-[14px] font-medium cursor-pointer border select-none transition-colors`,Qu="bg-sky-600 text-white border-sky-600",ef="bg-slate-100 hover:bg-slate-200 text-slate-800";function P9(){O9();const{user:e,logout:t}=pi();if(!e)return f.jsx(XB,{});const r=q=>String((q==null?void 0:q.role)||(q==null?void 0:q.roleKey)||(q==null?void 0:q.type)||"").toUpperCase(),n=q=>{try{return!!r9(e,q)}catch{return!1}},a=r(e)==="ADMIN"||n(vt.USERS_WRITE)||n(vt.PARAMETERS_WRITE)||n(vt.SERVICES_WRITE),s=!a&&(r(e)==="AUTHORIZED"||r(e)==="MANAGER"||r(e)==="STAFF"||n(vt.SCHEDULE_WRITE)||n(vt.LEAVES_WRITE)||Array.isArray(e==null?void 0:e.serviceIds)&&e.serviceIds.length>0),i=!!e&&!a&&!s,l=a||s,o=a||s,c=a,u=a||s,d=a,[h,p]=_.useState("plan"),[m,x]=_.useState(Fe.get("workAreas",[])),[g,v]=_.useState(Fe.get("nurses",[])),[w,y]=_.useState(Fe.get("doctors",[])),[k,C]=_.useState(Fe.get("workingHours",[])),[E,S]=_.useState(Fe.get("leaveTypes",[])),[N,F]=_.useState(Fe.get("personLeaves",{}));_.useEffect(()=>{Fe.set("workAreas",m)},[m]),_.useEffect(()=>{Fe.set("nurses",g)},[g]),_.useEffect(()=>{Fe.set("doctors",w)},[w]),_.useEffect(()=>{Fe.set("workingHours",k)},[k]),_.useEffect(()=>{Fe.set("leaveTypes",E)},[E]),_.useEffect(()=>{Fe.set("personLeaves",N)},[N]);const R=_.useMemo(()=>[...w||[],...g||[]],[w,g]),D=_.useMemo(()=>{if(!e)return[];if(a)return m;const q=new Set((e==null?void 0:e.serviceIds)||[]);return(m||[]).filter(J=>q.has(J.id))},[e,m,a]),T=_.useRef(null),j=_.useRef(null),Z=_.useRef(null),re=_.useRef({personnel:null,schedules:null,params:null}),W=q=>{q.current&&!q.current.open&&q.current.setAttribute("open","")},Q=q=>{q.current&&q.current.open&&q.current.removeAttribute("open")},H=_.useCallback(()=>Q(T),[]),L=_.useCallback(()=>Q(j),[]),ee=_.useCallback(()=>Q(Z),[]),[te,b]=_.useState(()=>Fe.get("personnelSections",wy));_.useEffect(()=>{const q=()=>{b(Fe.get("personnelSections",wy))};return window.addEventListener("personnelSectionsChanged",q),window.addEventListener("storage",q),()=>{window.removeEventListener("personnelSectionsChanged",q),window.removeEventListener("storage",q)}},[]),_.useEffect(()=>{const q=()=>{const{pathname:J,hash:B}=window.location;if(B.startsWith("#/parametreler")||J.startsWith("/parametreler")){if(!c)return p("plan");h!=="parameters"&&p("parameters");return}if(B.startsWith("#/cizelgeler")||J.startsWith("/cizelgeler")){if(!o)return p("plan");h!=="schedules"&&p("schedules");return}if(J.startsWith("/personel")){if(!l)return p("plan");h!=="personnel"&&p("personnel");return}if(J.startsWith("/kullanicilar")||B.startsWith("#/kullanicilar")){if(!d)return p("plan");h!=="users"&&p("users");return}if(J.startsWith("/servisler")||B.startsWith("#/servisler")){if(!u)return p("plan");h!=="services"&&p("services");return}h!=="plan"&&p("plan")};return q(),window.addEventListener("urlchange",q),window.addEventListener("popstate",q),window.addEventListener("hashchange",q),()=>{window.removeEventListener("urlchange",q),window.removeEventListener("popstate",q),window.removeEventListener("hashchange",q)}},[h,l,o,c,u,d]);const A=_.useCallback(q=>{p("schedules"),typeof location<"u"&&(location.hash=q?`/cizelgeler/${encodeURIComponent(q)}`:"/cizelgeler"),L()},[L]),O=_.useCallback(q=>{p("personnel"),bu(q?`/personel?sec=${encodeURIComponent(q)}`:"/personel"),H()},[H]),P=_.useCallback(q=>{p("parameters"),typeof location<"u"&&(location.hash=`/parametreler/${q}`),ee()},[ee]),U=_.useCallback(()=>{p("services"),bu("/servisler"),H(),L(),ee()},[H,L,ee]);return f.jsx(mC,{children:f.jsxs("div",{className:"w-screen h-screen bg-slate-50 text-slate-800 flex flex-col",children:[f.jsxs("header",{className:"sticky top-0 z-20 bg-white/95 backdrop-blur border-b shadow-sm",children:[f.jsxs("div",{className:"max-w-[1400px] mx-auto w-full px-4 py-2 flex items-center gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(NS,{className:"w-5 h-5 text-sky-600"}),f.jsx("div",{className:"font-semibold text-[14px] leading-none",children:"Hastane Nbet Sistemi v1.0.1"})]}),f.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[f.jsx(D9,{}),f.jsx(j9,{user:e,onLogout:async()=>{try{await(t==null?void 0:t())}catch{}}})]})]}),f.jsx("div",{className:"max-w-[1400px] mx-auto w-full px-4 pb-3",children:f.jsxs("nav",{className:"flex flex-wrap gap-2",children:[f.jsx(th,{active:h==="plan",onClick:()=>{p("plan"),typeof location<"u"&&(location.hash=""),bu("/"),H(),L(),ee()},children:i?"Takvimim":"Planlama"}),l&&f.jsx("div",{className:"relative z-20",onMouseEnter:()=>{clearTimeout(re.current.personnel),W(T),L(),ee()},onMouseLeave:()=>{re.current.personnel=setTimeout(()=>{H()},120)},children:f.jsxs("details",{className:"group",ref:T,onToggle:q=>{q.currentTarget.open&&(L(),ee())},children:[f.jsxs("summary",{className:`${Zu} ${h==="personnel"?Qu:ef}`,"aria-haspopup":"menu","aria-expanded":h==="personnel"?"true":"false",onClick:q=>{var B;p("personnel");const J=(B=T.current)==null?void 0:B.hasAttribute("open");q.currentTarget.setAttribute("aria-expanded",String(!J))},children:["Personel",f.jsx("svg",{className:"ml-1 h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":!0,children:f.jsx("path",{d:"M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.06l3.71-3.83a.75.75 0 1 1 1.08 1.04l-4.25 4.4a.75.75 0 0 1-1.08 0l-4.25-4.4a.75.75 0 0 1 .02-1.06z"})})]}),f.jsxs("div",{role:"menu",className:"absolute top-full left-0 mt-2 w-72 rounded-xl border bg-white shadow-lg overflow-hidden z-20",children:[te.map(q=>f.jsx(zn,{onSelect:()=>O(q.id),children:q.name},q.id)),f.jsx("div",{className:"border-t my-1"}),f.jsx(zn,{onSelect:()=>O(),children:"Personel sayfasn a"}),f.jsxs("div",{className:"px-3 py-2 text-xs text-gray-500",children:["Alt sekmeleri ",f.jsx("b",{children:"Personel"})," iinde ",f.jsx("i",{children:"Ekle / Dzenle / Sil"})," ile ynetebilirsiniz."]})]})]})}),o&&f.jsx("div",{className:"relative z-20",onMouseEnter:()=>{clearTimeout(re.current.schedules),W(j),H(),ee()},onMouseLeave:()=>{re.current.schedules=setTimeout(()=>{L()},120)},children:f.jsxs("details",{className:"group",ref:j,onToggle:q=>{q.currentTarget.open&&(H(),ee())},children:[f.jsxs("summary",{className:`${Zu} ${h==="schedules"?Qu:ef}`,"aria-haspopup":"menu","aria-expanded":h==="schedules"?"true":"false",children:["izelgeler",f.jsx("svg",{className:"ml-1 h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":!0,children:f.jsx("path",{d:"M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.06l3.71-3.83a.75.75 0 1 1 1.08 1.04l-4.25 4.4a.75.75 0 0 1-1.08 0l-4.25-4.4a.75.75 0 0 1 .02-1.06z"})})]}),f.jsxs("div",{role:"menu",className:"absolute top-full left-0 mt-2 w-96 rounded-xl border bg-white shadow-lg overflow-hidden z-20",children:[f.jsx(zn,{onSelect:()=>A("calisma-cizelgesi"),children:"alma izelgesi"}),f.jsx(zn,{onSelect:()=>A("aylik-calisma-ve-mesai-saatleri-cizelgesi"),children:"Aylk alma ve Mesai Saatleri izelgesi"}),f.jsx(zn,{onSelect:()=>A("fazla-mesai-takip"),children:"Fazla Mesai Takip Formu"}),f.jsx(zn,{onSelect:()=>A("toplu-izin-listesi"),children:"Toplu zin Listesi"}),f.jsx("div",{className:"border-t my-1"}),f.jsxs("div",{className:"px-3 py-2 text-xs text-gray-500",children:["Sekmeleri ",f.jsx("b",{children:"izelgeler"})," sayfasnda ",f.jsx("i",{children:"Ekle / Dzenle / Sil"})," ile ynetebilirsiniz."]})]})]})}),c&&f.jsx("div",{className:"relative z-30",onMouseEnter:()=>{clearTimeout(re.current.params),W(Z),H(),L()},onMouseLeave:()=>{re.current.params=setTimeout(()=>{ee()},120)},children:f.jsxs("details",{className:"group",ref:Z,onToggle:q=>{q.currentTarget.open&&(H(),L())},children:[f.jsxs("summary",{className:`${Zu} ${h==="parameters"?Qu:ef}`,"aria-haspopup":"menu","aria-expanded":h==="parameters"?"true":"false",children:["Parametreler",f.jsx("svg",{className:"ml-1 h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":!0,children:f.jsx("path",{d:"M5.23 7.21a.75.75 0 0 1 1.06.02L10 11.06l3.71-3.83a.75.75 0 1 1 1.08 1.04l-4.25 4.4a.75.75 0 0 1-1.08 0l-4.25-4.4a.75.75 0 0 1 .02-1.06z"})})]}),f.jsxs("div",{role:"menu",className:"absolute top-full left-0 mt-2 w-80 rounded-xl border bg-white shadow-lg overflow-hidden z-30",children:[f.jsx(zn,{onSelect:()=>P("calisma-alanlari"),children:"alma Alanlar"}),f.jsx(zn,{onSelect:()=>P("calisma-saatleri"),children:"alma Saatleri"}),f.jsx(zn,{onSelect:()=>P("izin-turleri"),children:"zin Trleri"}),f.jsx(zn,{onSelect:()=>P("nobet-kurallari"),children:"Nbet Kurallar"}),f.jsx(zn,{onSelect:()=>P("istek"),children:"stek"}),f.jsx("div",{className:"border-t my-1"}),f.jsxs("div",{className:"px-3 py-2 text-xs text-gray-500",children:["Alt sayfalar ",f.jsx("b",{children:"Parametreler"})," iinde sekmeli olarak alr."]})]})]})}),u&&f.jsx(th,{active:h==="services",onClick:U,children:"Servisler"}),d&&f.jsx(th,{active:h==="users",onClick:()=>{p("users"),bu("/kullanicilar")},children:"Kullanclar"})]})})]}),f.jsxs("main",{className:"flex-1 w-full px-6 py-6 space-y-6 overflow-auto max-w-[1400px] mx-auto",children:[h==="plan"&&(i?f.jsx(M9,{me:e,leaveTypes:E}):f.jsx(GC,{workAreas:D,nurses:g,doctors:w,peopleAll:R,leaveTypes:E,personLeaves:N,setPersonLeaves:F,workingHours:k})),h==="personnel"&&(l?f.jsx(HB,{workAreas:m,workingHours:k,nurses:g,setNurses:v,doctors:w,setDoctors:y}):f.jsx(Sy,{})),h==="schedules"&&(o?f.jsx(aB,{workAreas:D}):f.jsx(Sy,{})),h==="parameters"&&(c?f.jsx(FB,{workAreas:m,setWorkAreas:x,workingHours:k,setWorkingHours:C,leaveTypes:E,setLeaveTypes:S,nurses:g,doctors:w}):f.jsx(ky,{})),h==="services"&&(u?f.jsx(i9,{}):f.jsx(B9,{})),h==="users"&&(d?f.jsx(x9,{}):f.jsx(ky,{}))]})]})})}function j9({user:e,onLogout:t}){const[r,n]=Mr.useState(!1);if(!e)return null;const a=e.email||e.username||e.name||"Kullanc",s=(e.role||e.roleKey||"").toString().toLowerCase(),i=s==="admin"?"admin":s==="authorized"||s==="manager"||s==="staff"?"yetkili":"user";return f.jsxs("div",{className:"flex items-center gap-2 pl-2 ml-2 border-l",children:[f.jsxs("div",{className:"text-[13px] text-slate-600 truncate max-w-[220px]",children:[f.jsx("span",{className:"font-medium text-slate-800 truncate inline-block max-w-full",children:a})," ",f.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ml-1
          ${i==="admin"?"bg-rose-100 text-rose-700":i==="yetkili"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-700"}`,children:i})]}),f.jsxs("button",{className:"inline-flex items-center gap-1.5 text-[13px] px-2 py-1 rounded-lg bg-slate-100 hover:bg-slate-200 disabled:opacity-60",onClick:async()=>{if(!r){n(!0);try{await(t==null?void 0:t())}finally{n(!1);try{window.history.pushState({},"","/"),window.dispatchEvent(new Event("urlchange"))}catch{}}}},disabled:r,title:"k yap",children:[f.jsx(sC,{className:"w-4 h-4"}),r?"k yaplyor":"Logout"]})]})}function M9({me:e,leaveTypes:t}){const[r,n]=_.useState(()=>w9()),a=r.year,s=r.month-1,i=o=>{const c=new Date(a,s,1);c.setMonth(c.getMonth()+o);const u={year:c.getFullYear(),month:c.getMonth()+1};n(u),S9(u)},l=_.useMemo(()=>({id:String((e==null?void 0:e.id)??(e==null?void 0:e.userId)??(e==null?void 0:e.email)??"me"),name:(e==null?void 0:e.name)||(e==null?void 0:e.fullName)||(e==null?void 0:e.email)||"Ben",role:(e==null?void 0:e.role)||"USER"}),[e]);return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-4 flex items-center justify-between",children:[f.jsx("div",{className:"font-semibold",children:"Takvimim"}),f.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[f.jsx("button",{onClick:()=>i(-1),className:"px-2 py-1 rounded bg-slate-100",children:"nceki Ay"}),f.jsxs("div",{className:"text-slate-500",children:[s+1,".",a]}),f.jsx("button",{onClick:()=>i(1),className:"px-2 py-1 rounded bg-slate-100",children:"Sonraki Ay"})]})]}),f.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-4",children:f.jsx(y9,{person:l,year:a,month:s,leaveTypes:t})})]})}function Sy(){return f.jsx("div",{className:"p-4 rounded-md bg-yellow-50 border text-yellow-900",children:"Bu sayfay grmek iin giri yapmalsnz."})}function ky(){return f.jsxs("div",{className:"p-4 rounded-md bg-red-50 border text-red-900",children:["Bu sayfay yalnzca ",f.jsx("b",{children:"admin"})," kullanclar grebilir."]})}function B9(){return f.jsxs("div",{className:"p-4 rounded-md bg-amber-50 border text-amber-900",children:["Bu sayfay yalnzca ",f.jsx("b",{children:"admin"})," veya ",f.jsx("b",{children:"yetkili"})," kullanclar grebilir."]})}function th({active:e,onClick:t,children:r}){return f.jsx("button",{onClick:t,className:`${Zu} ${e?Qu:ef}`,children:r})}function zn({onSelect:e,children:t}){return f.jsx("button",{role:"menuitem",onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),e==null||e())},onClick:e,className:"w-full text-left px-4 py-2.5 text-[14px] hover:bg-gray-50 focus:bg-gray-50 focus:outline-none",children:t})}function U9(){const[e,t]=_.useState(""),[r,n]=_.useState(!1),[a,s]=_.useState("");async function i(l){if(l.preventDefault(),!e)return s("E-posta gerekli");n(!0),s("");try{await Y4(e),s(" Eer kaytlysa, sfrlama e-postas gnderildi.")}catch(o){s(" stek baarsz: "+((o==null?void 0:o.message)||"bilinmeyen hata"))}finally{n(!1)}}return f.jsxs("div",{className:"mt-4 p-3 rounded-lg border bg-white",children:[f.jsx("div",{className:"font-medium mb-2",children:"Parolam unuttum"}),f.jsxs("form",{onSubmit:i,className:"flex gap-2",children:[f.jsx("input",{type:"email",placeholder:"e-posta@ornek.com",value:e,onChange:l=>t(l.target.value),className:"flex-1 px-3 py-2 rounded border",disabled:r}),f.jsx("button",{type:"submit",disabled:r,className:"px-3 py-2 rounded bg-sky-600 text-white disabled:opacity-60",children:"Gnder"})]}),a&&f.jsx("div",{className:"text-sm mt-2 text-slate-600",children:a}),f.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["E-postadaki link seni ",f.jsx("code",{children:"/reset/<token>"})," sayfasna gtrecek."]})]})}function z9(){const[e,t]=_.useState("login");return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-sky-50",children:f.jsxs("div",{className:"w-[420px] rounded-2xl bg-white shadow-xl p-6",children:[f.jsxs("div",{className:"text-center mb-5",children:[f.jsx("span",{className:"inline-block text-xs px-3 py-1 rounded-full bg-sky-100 text-sky-700 mb-2",children:"Hastane Nbet Sistemi"}),f.jsx("h1",{className:"text-xl font-semibold",children:e==="login"?"Ho geldiniz":"Hesap olutur"}),f.jsx("p",{className:"text-sm text-slate-500",children:e==="login"?"Devam etmek iin kimlik ve parolanz girin.":"Ksa bir kaytla hemen balayn."})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[f.jsx("button",{className:`h-9 rounded-md text-sm font-medium border ${e==="login"?"bg-sky-600 text-white border-sky-600":"bg-white border-slate-200"}`,onClick:()=>t("login"),type:"button",children:"Giri"}),f.jsx("button",{className:`h-9 rounded-md text-sm font-medium border ${e==="register"?"bg-sky-600 text-white border-sky-600":"bg-white border-slate-200"}`,onClick:()=>t("register"),type:"button",children:"Kayt Ol"})]}),e==="login"?f.jsx(H9,{}):f.jsx($9,{onDone:()=>t("login")}),f.jsxs("p",{className:"text-[11px] text-center text-slate-500 mt-4",children:["lk kayt otomatik ",f.jsx("b",{children:"admin"})," olur. Dier kaytlar ",f.jsx("b",{children:"onay bekler"}),"."]})]})})}function H9(){const{login:e}=pi(),[t,r]=_.useState(""),[n,a]=_.useState(""),[s,i]=_.useState(!1),[l,o]=_.useState("");async function c(u){u.preventDefault(),o(""),i(!0);try{await e({identifier:t,password:n})}catch(d){o(d.message||"Giri baarsz")}finally{i(!1)}}return f.jsxs(f.Fragment,{children:[f.jsxs("form",{onSubmit:c,className:"space-y-3",noValidate:!0,children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-600",children:"Kimlik"}),f.jsx("input",{type:"text",name:"identifier",className:"mt-1 w-full h-10 px-3 rounded-md border border-slate-300 outline-none focus:ring-2 focus:ring-sky-200",placeholder:"E-posta / TC / Telefon / Ad Soyad",value:t,onChange:u=>r(u.target.value),autoComplete:"username",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-600",children:"Parola"}),f.jsx("input",{type:"password",className:"mt-1 w-full h-10 px-3 rounded-md border border-slate-300 outline-none focus:ring-2 focus:ring-sky-200",value:n,onChange:u=>a(u.target.value),autoComplete:"current-password",minLength:6,required:!0})]}),l&&f.jsx("div",{className:"text-sm p-2 rounded bg-rose-50 text-rose-700 border border-rose-200",children:l}),f.jsx("button",{disabled:s,className:"w-full h-10 rounded-md bg-sky-600 text-white font-medium hover:bg-sky-700 disabled:opacity-60",type:"submit",children:"Giri Yap"})]}),f.jsx(U9,{})]})}function $9({onDone:e}){const{register:t,login:r}=pi(),[n,a]=_.useState({name:"",email:"",password:""}),[s,i]=_.useState(!1),[l,o]=_.useState(""),[c,u]=_.useState(""),d=(p,m)=>a(x=>({...x,[p]:m}));async function h(p){p.preventDefault(),o(""),u(""),i(!0);try{await t({name:n.name,email:n.email,password:n.password,role:"user"})||(u("Bavurunuz alnd. Ynetici onayndan sonra giri yapabilirsiniz."),e==null||e())}catch(m){o(m.message||"Kayt baarsz")}finally{i(!1)}}return f.jsxs("form",{onSubmit:h,className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-600",children:"Ad Soyad (opsiyonel)"}),f.jsx("input",{className:"mt-1 w-full h-10 px-3 rounded-md border border-slate-300 outline-none focus:ring-2 focus:ring-sky-200",value:n.name,onChange:p=>d("name",p.target.value)})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-600",children:"E-posta"}),f.jsx("input",{type:"email",className:"mt-1 w-full h-10 px-3 rounded-md border border-slate-300 outline-none focus:ring-2 focus:ring-sky-200",value:n.email,onChange:p=>d("email",p.target.value),autoComplete:"email",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-600",children:"Parola"}),f.jsx("input",{type:"password",className:"mt-1 w-full h-10 px-3 rounded-md border border-slate-300 outline-none focus:ring-2 focus:ring-sky-200",value:n.password,onChange:p=>d("password",p.target.value),autoComplete:"new-password",minLength:6,required:!0})]})]}),l&&f.jsx("div",{className:"text-sm p-2 rounded bg-rose-50 text-rose-700 border border-rose-200",children:l}),c&&f.jsx("div",{className:"text-sm p-2 rounded bg-emerald-50 text-emerald-700 border border-emerald-200",children:c}),f.jsx("button",{disabled:s,className:"w-full h-10 rounded-md bg-sky-600 text-white font-medium hover:bg-sky-700 disabled:opacity-60",type:"submit",children:"Kayt Ol"})]})}function V9(){try{const t=(window.location.pathname||"/").split("/").filter(Boolean),r=t.findIndex(i=>i==="reset");if(r>=0&&t[r+1])return t[r+1];const a=(window.location.hash||"").replace(/^#\/?/,"").split("/").filter(Boolean),s=a.findIndex(i=>i==="reset");if(s>=0&&a[s+1])return a[s+1]}catch{}return""}function W9(){const e=_.useMemo(V9,[]),[t,r]=_.useState(""),[n,a]=_.useState(""),[s,i]=_.useState(!1),[l,o]=_.useState("");async function c(u){if(u.preventDefault(),!e)return o("Geersiz balant (token yok).");if(!t||t.length<6)return o("Parola en az 6 karakter olmal.");if(t!==n)return o("Parolalar elemiyor.");i(!0),o("");try{await K4(e,t),o(" Parola gncellendi. Giri sayfasna dnebilirsin."),setTimeout(()=>{try{window.history.pushState({},"","/"),window.dispatchEvent(new Event("urlchange"))}catch{}},1200)}catch(d){o(" Hata: "+((d==null?void 0:d.message)||"ilem baarsz"))}finally{i(!1)}}return f.jsx("div",{className:"w-full min-h-screen flex items-center justify-center bg-slate-50 p-6",children:f.jsxs("div",{className:"w-full max-w-md bg-white border rounded-2xl shadow-sm p-5",children:[f.jsx("div",{className:"text-lg font-semibold mb-2",children:"Yeni Parola Belirle"}),f.jsxs("div",{className:"text-xs text-slate-500 mb-4",children:["Token: ",f.jsx("code",{className:"break-all",children:e||"(yok)"})]}),f.jsxs("form",{onSubmit:c,className:"space-y-3",children:[f.jsx("input",{type:"password",placeholder:"Yeni parola",value:t,onChange:u=>r(u.target.value),className:"w-full px-3 py-2 rounded border",disabled:s}),f.jsx("input",{type:"password",placeholder:"Yeni parola (tekrar)",value:n,onChange:u=>a(u.target.value),className:"w-full px-3 py-2 rounded border",disabled:s}),f.jsx("button",{type:"submit",className:"w-full px-3 py-2 rounded bg-sky-600 text-white disabled:opacity-60",disabled:s,children:s?"Gnderiliyor":"Parolay Gncelle"})]}),l&&f.jsx("div",{className:"text-sm mt-3 text-slate-700",children:l})]})})}function G9(){return _c({syncLegacyLS:!0}),null}class Y9 extends Mr.Component{constructor(t){super(t),this.state={hasError:!1,errorMsg:""}}static getDerivedStateFromError(t){return{hasError:!0,errorMsg:(t==null?void 0:t.message)||"Bilinmeyen hata"}}componentDidCatch(t,r){}render(){return this.state.hasError?f.jsxs("div",{style:{padding:16,fontFamily:"system-ui",color:"#7f1d1d",background:"#fff1f2",borderRadius:12,margin:12},children:[f.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Bir eyler ters gitti."}),f.jsx("div",{style:{fontSize:12,opacity:.8},children:this.state.errorMsg})]}):this.props.children}}function K9(){const{user:e,loading:t}=pi();if(t)return f.jsx("div",{style:{padding:16,fontFamily:"system-ui"},children:"Uygulama ykleniyor..."});const r=!e&&(typeof location<"u"&&location.pathname.startsWith("/reset")||typeof location<"u"&&(location.hash||"").startsWith("#/reset"));return f.jsxs(_.Suspense,{fallback:f.jsx("div",{style:{padding:16},children:"Ekran ykleniyor"}),children:[f.jsx(G9,{}),f.jsx(Y9,{children:e?f.jsx(P9,{}):r?f.jsx(W9,{}):f.jsx(z9,{})})]})}const X9=()=>f.jsx(oT,{basename:"/hastane15",children:f.jsx(X4,{children:f.jsx(K9,{})})});rh.createRoot(document.getElementById("root")).render(f.jsx(Mr.StrictMode,{children:f.jsx(X9,{})}));
